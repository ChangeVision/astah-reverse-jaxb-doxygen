<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.4">
  <compounddef id="tablefind_8cpp" kind="file">
    <compoundname>tablefind.cpp</compoundname>
    <includes refid="tablefind_8h" local="yes">tablefind.h</includes>
    <includes local="no">math.h</includes>
    <includes local="yes">allheaders.h</includes>
    <includes refid="colpartitionset_8h" local="yes">colpartitionset.h</includes>
    <includes refid="tablerecog_8h" local="yes">tablerecog.h</includes>
    <incdepgraph>
      <node id="39495">
        <label>blobbox.h</label>
        <link refid="blobbox_8h"/>
        <childnode refid="39462" relation="include">
        </childnode>
        <childnode refid="39496" relation="include">
        </childnode>
        <childnode refid="39497" relation="include">
        </childnode>
        <childnode refid="39502" relation="include">
        </childnode>
        <childnode refid="39509" relation="include">
        </childnode>
      </node>
      <node id="39512">
        <label>tabvector.h</label>
        <link refid="tabvector_8h"/>
        <childnode refid="39513" relation="include">
        </childnode>
        <childnode refid="39462" relation="include">
        </childnode>
        <childnode refid="39479" relation="include">
        </childnode>
        <childnode refid="39496" relation="include">
        </childnode>
        <childnode refid="39483" relation="include">
        </childnode>
        <childnode refid="39461" relation="include">
        </childnode>
      </node>
      <node id="39484">
        <label>ndminx.h</label>
        <link refid="ndminx_8h"/>
      </node>
      <node id="39461">
        <label>bbgrid.h</label>
        <link refid="bbgrid_8h"/>
        <childnode refid="39462" relation="include">
        </childnode>
        <childnode refid="39475" relation="include">
        </childnode>
        <childnode refid="39483" relation="include">
        </childnode>
        <childnode refid="39485" relation="include">
        </childnode>
        <childnode refid="39493" relation="include">
        </childnode>
      </node>
      <node id="39509">
        <label>statistc.h</label>
        <link refid="statistc_8h"/>
        <childnode refid="39463" relation="include">
        </childnode>
        <childnode refid="39464" relation="include">
        </childnode>
        <childnode refid="39485" relation="include">
        </childnode>
      </node>
      <node id="39468">
        <label>stdlib.h</label>
      </node>
      <node id="39465">
        <label>platform.h</label>
        <link refid="platform_8h"/>
        <childnode refid="39466" relation="include">
        </childnode>
      </node>
      <node id="39459">
        <label>tablefind.h</label>
        <link refid="tablefind_8h"/>
        <childnode refid="39460" relation="include">
        </childnode>
        <childnode refid="39479" relation="include">
        </childnode>
        <childnode refid="39483" relation="include">
        </childnode>
      </node>
      <node id="39516">
        <label>tablerecog.h</label>
        <link refid="tablerecog_8h"/>
        <childnode refid="39460" relation="include">
        </childnode>
        <childnode refid="39488" relation="include">
        </childnode>
      </node>
      <node id="39492">
        <label>blckerr.h</label>
        <link refid="blckerr_8h"/>
        <childnode refid="39472" relation="include">
        </childnode>
      </node>
      <node id="39493">
        <label>allheaders.h</label>
      </node>
      <node id="39485">
        <label>scrollview.h</label>
        <link refid="scrollview_8h"/>
        <childnode refid="39463" relation="include">
        </childnode>
      </node>
      <node id="39467">
        <label>serialis.h</label>
        <link refid="serialis_8h"/>
        <childnode refid="39468" relation="include">
        </childnode>
        <childnode refid="39469" relation="include">
        </childnode>
        <childnode refid="39463" relation="include">
        </childnode>
        <childnode refid="39470" relation="include">
        </childnode>
        <childnode refid="39472" relation="include">
        </childnode>
        <childnode refid="39473" relation="include">
        </childnode>
      </node>
      <node id="39462">
        <label>clst.h</label>
        <link refid="clst_8h"/>
        <childnode refid="39463" relation="include">
        </childnode>
        <childnode refid="39464" relation="include">
        </childnode>
        <childnode refid="39467" relation="include">
        </childnode>
        <childnode refid="39474" relation="include">
        </childnode>
      </node>
      <node id="39458">
        <label>textord/tablefind.cpp</label>
        <link refid="tablefind.cpp"/>
        <childnode refid="39459" relation="include">
        </childnode>
        <childnode refid="39478" relation="include">
        </childnode>
        <childnode refid="39493" relation="include">
        </childnode>
        <childnode refid="39515" relation="include">
        </childnode>
        <childnode refid="39516" relation="include">
        </childnode>
      </node>
      <node id="39498">
        <label>stepblob.h</label>
        <link refid="stepblob_8h"/>
        <childnode refid="39475" relation="include">
        </childnode>
        <childnode refid="39483" relation="include">
        </childnode>
      </node>
      <node id="39471">
        <label>stddef.h</label>
      </node>
      <node id="39472">
        <label>errcode.h</label>
        <link refid="errcode_8h"/>
        <childnode refid="39464" relation="include">
        </childnode>
      </node>
      <node id="39507">
        <label>polyblk.h</label>
        <link refid="polyblk_8h"/>
        <childnode refid="39505" relation="include">
        </childnode>
        <childnode refid="39479" relation="include">
        </childnode>
        <childnode refid="39477" relation="include">
        </childnode>
        <childnode refid="39483" relation="include">
        </childnode>
        <childnode refid="39485" relation="include">
        </childnode>
        <childnode refid="39508" relation="include">
        </childnode>
      </node>
      <node id="39466">
        <label>limits.h</label>
      </node>
      <node id="39511">
        <label>alignedblob.h</label>
        <link refid="alignedblob_8h"/>
        <childnode refid="39461" relation="include">
        </childnode>
        <childnode refid="39495" relation="include">
        </childnode>
        <childnode refid="39491" relation="include">
        </childnode>
        <childnode refid="39512" relation="include">
        </childnode>
      </node>
      <node id="39480">
        <label>ipoints.h</label>
        <link refid="ipoints_8h"/>
        <childnode refid="39478" relation="include">
        </childnode>
      </node>
      <node id="39481">
        <label>mod128.h</label>
        <link refid="mod128_8h"/>
        <childnode refid="39477" relation="include">
        </childnode>
      </node>
      <node id="39496">
        <label>elst2.h</label>
        <link refid="elst2_8h"/>
        <childnode refid="39463" relation="include">
        </childnode>
        <childnode refid="39464" relation="include">
        </childnode>
        <childnode refid="39467" relation="include">
        </childnode>
        <childnode refid="39474" relation="include">
        </childnode>
      </node>
      <node id="39469">
        <label>string.h</label>
      </node>
      <node id="39483">
        <label>rect.h</label>
        <link refid="rect_8h"/>
        <childnode refid="39478" relation="include">
        </childnode>
        <childnode refid="39477" relation="include">
        </childnode>
        <childnode refid="39484" relation="include">
        </childnode>
        <childnode refid="39485" relation="include">
        </childnode>
        <childnode refid="39486" relation="include">
        </childnode>
      </node>
      <node id="39482">
        <label>bits16.h</label>
        <link refid="bits16_8h"/>
        <childnode refid="39464" relation="include">
        </childnode>
      </node>
      <node id="39514">
        <label>linefind.h</label>
        <link refid="linefind_8h"/>
      </node>
      <node id="39489">
        <label>tesscallback.h</label>
        <link refid="tesscallback_8h"/>
        <childnode refid="39464" relation="include">
        </childnode>
      </node>
      <node id="39460">
        <label>colpartitiongrid.h</label>
        <link refid="colpartitiongrid_8h"/>
        <childnode refid="39461" relation="include">
        </childnode>
        <childnode refid="39494" relation="include">
        </childnode>
        <childnode refid="39515" relation="include">
        </childnode>
      </node>
      <node id="39475">
        <label>coutln.h</label>
        <link refid="coutln_8h"/>
        <childnode refid="39476" relation="include">
        </childnode>
        <childnode refid="39481" relation="include">
        </childnode>
        <childnode refid="39482" relation="include">
        </childnode>
        <childnode refid="39483" relation="include">
        </childnode>
        <childnode refid="39492" relation="include">
        </childnode>
        <childnode refid="39485" relation="include">
        </childnode>
      </node>
      <node id="39497">
        <label>werd.h</label>
        <link refid="werd_8h"/>
        <childnode refid="39487" relation="include">
        </childnode>
        <childnode refid="39482" relation="include">
        </childnode>
        <childnode refid="39496" relation="include">
        </childnode>
        <childnode refid="39491" relation="include">
        </childnode>
        <childnode refid="39492" relation="include">
        </childnode>
        <childnode refid="39498" relation="include">
        </childnode>
        <childnode refid="39499" relation="include">
        </childnode>
      </node>
      <node id="39499">
        <label>ocrrow.h</label>
        <link refid="ocrrow_8h"/>
        <childnode refid="39463" relation="include">
        </childnode>
        <childnode refid="39500" relation="include">
        </childnode>
        <childnode refid="39497" relation="include">
        </childnode>
      </node>
      <node id="39473">
        <label>fileerr.h</label>
        <link refid="fileerr_8h"/>
        <childnode refid="39472" relation="include">
        </childnode>
      </node>
      <node id="39510">
        <label>tabfind.h</label>
        <link refid="tabfind_8h"/>
        <childnode refid="39511" relation="include">
        </childnode>
        <childnode refid="39489" relation="include">
        </childnode>
        <childnode refid="39512" relation="include">
        </childnode>
        <childnode refid="39514" relation="include">
        </childnode>
      </node>
      <node id="39478">
        <label>math.h</label>
      </node>
      <node id="39476">
        <label>crakedge.h</label>
        <link refid="crakedge_8h"/>
        <childnode refid="39477" relation="include">
        </childnode>
        <childnode refid="39481" relation="include">
        </childnode>
      </node>
      <node id="39474">
        <label>lsterr.h</label>
        <link refid="lsterr_8h"/>
        <childnode refid="39472" relation="include">
        </childnode>
      </node>
      <node id="39501">
        <label>quadratc.h</label>
        <link refid="quadratc_8h"/>
        <childnode refid="39477" relation="include">
        </childnode>
      </node>
      <node id="39505">
        <label>publictypes.h</label>
        <link refid="publictypes_8h"/>
      </node>
      <node id="39502">
        <label>ocrblock.h</label>
        <link refid="ocrblock_8h"/>
        <childnode refid="39503" relation="include">
        </childnode>
        <childnode refid="39504" relation="include">
        </childnode>
        <childnode refid="39499" relation="include">
        </childnode>
        <childnode refid="39506" relation="include">
        </childnode>
      </node>
      <node id="39487">
        <label>params.h</label>
        <link refid="params_8h"/>
        <childnode refid="39463" relation="include">
        </childnode>
        <childnode refid="39488" relation="include">
        </childnode>
        <childnode refid="39491" relation="include">
        </childnode>
      </node>
      <node id="39488">
        <label>genericvector.h</label>
        <link refid="genericvector_8h"/>
        <childnode refid="39463" relation="include">
        </childnode>
        <childnode refid="39468" relation="include">
        </childnode>
        <childnode refid="39489" relation="include">
        </childnode>
        <childnode refid="39472" relation="include">
        </childnode>
        <childnode refid="39490" relation="include">
        </childnode>
        <childnode refid="39484" relation="include">
        </childnode>
      </node>
      <node id="39470">
        <label>memry.h</label>
        <link refid="memry_8h"/>
        <childnode refid="39471" relation="include">
        </childnode>
        <childnode refid="39464" relation="include">
        </childnode>
      </node>
      <node id="39513">
        <label>blobgrid.h</label>
        <link refid="blobgrid_8h"/>
        <childnode refid="39461" relation="include">
        </childnode>
        <childnode refid="39495" relation="include">
        </childnode>
      </node>
      <node id="39504">
        <label>ocrpara.h</label>
        <link refid="ocrpara_8h"/>
        <childnode refid="39505" relation="include">
        </childnode>
        <childnode refid="39479" relation="include">
        </childnode>
        <childnode refid="39491" relation="include">
        </childnode>
      </node>
      <node id="39479">
        <label>elst.h</label>
        <link refid="elst_8h"/>
        <childnode refid="39463" relation="include">
        </childnode>
        <childnode refid="39464" relation="include">
        </childnode>
        <childnode refid="39467" relation="include">
        </childnode>
        <childnode refid="39474" relation="include">
        </childnode>
      </node>
      <node id="39494">
        <label>colpartition.h</label>
        <link refid="colpartition_8h"/>
        <childnode refid="39461" relation="include">
        </childnode>
        <childnode refid="39495" relation="include">
        </childnode>
        <childnode refid="39484" relation="include">
        </childnode>
        <childnode refid="39502" relation="include">
        </childnode>
        <childnode refid="39483" relation="include">
        </childnode>
        <childnode refid="39485" relation="include">
        </childnode>
        <childnode refid="39510" relation="include">
        </childnode>
        <childnode refid="39512" relation="include">
        </childnode>
      </node>
      <node id="39477">
        <label>points.h</label>
        <link refid="points_8h"/>
        <childnode refid="39463" relation="include">
        </childnode>
        <childnode refid="39478" relation="include">
        </childnode>
        <childnode refid="39479" relation="include">
        </childnode>
        <childnode refid="39480" relation="include">
        </childnode>
      </node>
      <node id="39503">
        <label>img.h</label>
        <link refid="img_8h"/>
        <childnode refid="39470" relation="include">
        </childnode>
      </node>
      <node id="39486">
        <label>tprintf.h</label>
        <link refid="tprintf_8h"/>
        <childnode refid="39487" relation="include">
        </childnode>
      </node>
      <node id="39508">
        <label>hpddef.h</label>
        <link refid="hpddef_8h"/>
      </node>
      <node id="39464">
        <label>host.h</label>
        <link refid="host_8h"/>
        <childnode refid="39465" relation="include">
        </childnode>
      </node>
      <node id="39506">
        <label>pdblock.h</label>
        <link refid="pdblock_8h"/>
        <childnode refid="39462" relation="include">
        </childnode>
        <childnode refid="39503" relation="include">
        </childnode>
        <childnode refid="39491" relation="include">
        </childnode>
        <childnode refid="39507" relation="include">
        </childnode>
        <childnode refid="39508" relation="include">
        </childnode>
      </node>
      <node id="39515">
        <label>colpartitionset.h</label>
        <link refid="colpartitionset_8h"/>
        <childnode refid="39494" relation="include">
        </childnode>
        <childnode refid="39488" relation="include">
        </childnode>
        <childnode refid="39483" relation="include">
        </childnode>
        <childnode refid="39512" relation="include">
        </childnode>
      </node>
      <node id="39463">
        <label>stdio.h</label>
      </node>
      <node id="39491">
        <label>strngs.h</label>
        <link refid="strngs_8h"/>
        <childnode refid="39463" relation="include">
        </childnode>
        <childnode refid="39469" relation="include">
        </childnode>
        <childnode refid="39465" relation="include">
        </childnode>
        <childnode refid="39470" relation="include">
        </childnode>
      </node>
      <node id="39490">
        <label>helpers.h</label>
        <link refid="helpers_8h"/>
        <childnode refid="39463" relation="include">
        </childnode>
        <childnode refid="39469" relation="include">
        </childnode>
      </node>
      <node id="39500">
        <label>quspline.h</label>
        <link refid="quspline_8h"/>
        <childnode refid="39501" relation="include">
        </childnode>
        <childnode refid="39467" relation="include">
        </childnode>
        <childnode refid="39470" relation="include">
        </childnode>
        <childnode refid="39483" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <innernamespace refid="namespacetesseract">tesseract</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//<sp/>File:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tablefind.cpp</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Description:<sp/>Helper<sp/>classes<sp/>to<sp/>find<sp/>tables<sp/>from<sp/>ColPartitions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Author:<sp/><sp/><sp/><sp/><sp/><sp/>Faisal<sp/>Shafait<sp/>(faisal.shafait@dfki.de)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Created:<sp/><sp/><sp/><sp/><sp/>Tue<sp/>Jan<sp/>06<sp/>11:13:01<sp/>PST<sp/>2009</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="comment">//<sp/>(C)<sp/>Copyright<sp/>2009,<sp/>Google<sp/>Inc.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Licensed<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the<sp/>&quot;License&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="comment">//<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance<sp/>with<sp/>the<sp/>License.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="comment">//<sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">//<sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,<sp/>software</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="comment">//<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="comment">//<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="comment">//<sp/>See<sp/>the<sp/>License<sp/>for<sp/>the<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="comment">//<sp/>limitations<sp/>under<sp/>the<sp/>License.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="comment">//</highlight></codeline>
<codeline lineno="19"><highlight class="comment"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_MSC_VER</highlight></codeline>
<codeline lineno="21"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#pragma<sp/>warning(disable:4244)<sp/><sp/>//<sp/>Conversion<sp/>warnings</highlight></codeline>
<codeline lineno="22"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="23"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="tablefind_8h" kindref="compound">tablefind.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;math.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>HAVE_CONFIG_H</highlight></codeline>
<codeline lineno="27"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#include<sp/>&quot;config_auto.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="29"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;allheaders.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="colpartitionset_8h" kindref="compound">colpartitionset.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="tablerecog_8h" kindref="compound">tablerecog.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespacetesseract-c__api-demo_1afed58feacb84df2de88bdd613cfdba6d" kindref="member">tesseract</ref><sp/>{</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="comment">//<sp/>These<sp/>numbers<sp/>are<sp/>used<sp/>to<sp/>calculate<sp/>the<sp/>global<sp/>median<sp/>stats.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="comment">//<sp/>They<sp/>just<sp/>set<sp/>an<sp/>upper<sp/>bound<sp/>on<sp/>the<sp/>stats<sp/>objects.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Maximum<sp/>vertical<sp/>spacing<sp/>between<sp/>neighbor<sp/>partitions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a00d83d0f6a701860dcf421bbbe283fef" kindref="member">kMaxVerticalSpacing</ref><sp/>=<sp/>500;</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Maximum<sp/>width<sp/>of<sp/>a<sp/>blob<sp/>in<sp/>a<sp/>partition.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a83ac44e5e0c7348fd8591b3cba175dff" kindref="member">kMaxBlobWidth</ref><sp/>=<sp/>500;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Minimum<sp/>whitespace<sp/>size<sp/>to<sp/>split<sp/>a<sp/>partition<sp/>(measured<sp/>as<sp/>a<sp/>multiple</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="comment">//<sp/>of<sp/>a<sp/>partition&apos;s<sp/>median<sp/>width).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1aeecbc7f84d79acc5731cfdcccc164bde" kindref="member">kSplitPartitionSize</ref><sp/>=<sp/>2.0;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="comment">//<sp/>To<sp/>insert<sp/>text,<sp/>the<sp/>partition<sp/>must<sp/>satisfy<sp/>these<sp/>size<sp/>constraints</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="comment">//<sp/>in<sp/>AllowTextPartition().<sp/>The<sp/>idea<sp/>is<sp/>to<sp/>filter<sp/>noise<sp/>partitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="comment">//<sp/>determined<sp/>by<sp/>the<sp/>size<sp/>compared<sp/>to<sp/>the<sp/>global<sp/>medians.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>Need<sp/>to<sp/>find<sp/>good<sp/>numbers<sp/>again.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a9b013c09ae4bd53f0b147f3945ae9c8c" kindref="member">kAllowTextHeight</ref><sp/>=<sp/>0.5;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a92f436872c90049797ee7b1356f50133" kindref="member">kAllowTextWidth</ref><sp/>=<sp/>0.6;</highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a744c12bd96933e697e5afff35c492dc0" kindref="member">kAllowTextArea</ref><sp/>=<sp/>0.8;</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="comment">//<sp/>The<sp/>same<sp/>thing<sp/>applies<sp/>to<sp/>blobs<sp/>(to<sp/>filter<sp/>noise).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>These<sp/>numbers<sp/>are<sp/>a<sp/>shot<sp/>in<sp/>the<sp/>dark...</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="comment">//<sp/>height<sp/>and<sp/>width<sp/>are<sp/>0.5<sp/>*<sp/>gridsize()<sp/>in<sp/>colfind.cpp</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight><highlight class="comment">//<sp/>area<sp/>is<sp/>a<sp/>rough<sp/>guess<sp/>for<sp/>the<sp/>size<sp/>of<sp/>a<sp/>period.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a0de56cf05a1e8a1aee7e6bcd81e34742" kindref="member">kAllowBlobHeight</ref><sp/>=<sp/>0.3;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1aa86b1f68578cb7c0b834b2a137376ed7" kindref="member">kAllowBlobWidth</ref><sp/>=<sp/>0.4;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a714f54e357a15f2578470c0430a9ec5f" kindref="member">kAllowBlobArea</ref><sp/>=<sp/>0.05;</highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Minimum<sp/>number<sp/>of<sp/>components<sp/>in<sp/>a<sp/>text<sp/>partition.<sp/>A<sp/>partition<sp/>having<sp/>fewer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="comment">//<sp/>components<sp/>than<sp/>that<sp/>is<sp/>more<sp/>likely<sp/>a<sp/>data<sp/>partition<sp/>and<sp/>is<sp/>a<sp/>candidate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="comment">//<sp/>table<sp/>cell.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a3fe030812946d2ca16b873bde30d5431" kindref="member">kMinBoxesInTextPartition</ref><sp/>=<sp/>10;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Maximum<sp/>number<sp/>of<sp/>components<sp/>that<sp/>a<sp/>data<sp/>partition<sp/>can<sp/>have</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1ac2d16b5be5214a804964b939c8111bc7" kindref="member">kMaxBoxesInDataPartition</ref><sp/>=<sp/>20;</highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Maximum<sp/>allowed<sp/>gap<sp/>in<sp/>a<sp/>text<sp/>partitions<sp/>as<sp/>a<sp/>multiple<sp/>of<sp/>its<sp/>median<sp/>size.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a632cb2dd79696389be8feb970de28e3e" kindref="member">kMaxGapInTextPartition</ref><sp/>=<sp/>4.0;</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Minimum<sp/>value<sp/>that<sp/>the<sp/>maximum<sp/>gap<sp/>in<sp/>a<sp/>text<sp/>partition<sp/>should<sp/>have<sp/>as<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="comment">//<sp/>factor<sp/>of<sp/>its<sp/>median<sp/>size.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a25dab2777976176c8de47ef2fb5b74a5" kindref="member">kMinMaxGapInTextPartition</ref><sp/>=<sp/>0.5;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="comment">//<sp/>The<sp/>amount<sp/>of<sp/>overlap<sp/>that<sp/>is<sp/>&quot;normal&quot;<sp/>for<sp/>adjacent<sp/>blobs<sp/>in<sp/>a<sp/>text</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="comment">//<sp/>partition.<sp/>This<sp/>is<sp/>used<sp/>to<sp/>calculate<sp/>gap<sp/>between<sp/>overlapping<sp/>blobs.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1af7577bf68e7e1466e0d58eb91ad999c6" kindref="member">kMaxBlobOverlapFactor</ref><sp/>=<sp/>4.0;</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Maximum<sp/>x-height<sp/>a<sp/>table<sp/>partition<sp/>can<sp/>have<sp/>as<sp/>a<sp/>multiple<sp/>of<sp/>global</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight><highlight class="comment">//<sp/>median<sp/>x-height</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a12f077d41b2f5c668c1b25912b9b6244" kindref="member">kMaxTableCellXheight</ref><sp/>=<sp/>2.0;</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Maximum<sp/>line<sp/>spacing<sp/>between<sp/>a<sp/>table<sp/>column<sp/>header<sp/>and<sp/>column<sp/>contents</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight><highlight class="comment">//<sp/>for<sp/>merging<sp/>the<sp/>two<sp/>(as<sp/>a<sp/>multiple<sp/>of<sp/>the<sp/>partition&apos;s<sp/>median_size).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1aae5eb999d710e50055ba3096b2f54c38" kindref="member">kMaxColumnHeaderDistance</ref><sp/>=<sp/>4;</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Minimum<sp/>ratio<sp/>of<sp/>num_table_partitions<sp/>to<sp/>num_text_partitions<sp/>in<sp/>a<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight><highlight class="comment">//<sp/>block<sp/>to<sp/>be<sp/>called<sp/>it<sp/>a<sp/>table<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a6a040ffaa830485299daa5c344ebe039" kindref="member">kTableColumnThreshold</ref><sp/>=<sp/>3.0;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Search<sp/>for<sp/>horizontal<sp/>ruling<sp/>lines<sp/>within<sp/>the<sp/>vertical<sp/>margin<sp/>as<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight><highlight class="comment">//<sp/>multiple<sp/>of<sp/>grid<sp/>size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1ac42d5746b048036811177c1bd95e7691" kindref="member">kRulingVerticalMargin</ref><sp/>=<sp/>3;</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Minimum<sp/>overlap<sp/>that<sp/>a<sp/>colpartition<sp/>must<sp/>have<sp/>with<sp/>a<sp/>table<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight><highlight class="comment">//<sp/>to<sp/>become<sp/>part<sp/>of<sp/>that<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a0f2ae212b6b475efca7981fd1dc51e29" kindref="member">kMinOverlapWithTable</ref><sp/>=<sp/>0.6;</highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Maximum<sp/>side<sp/>space<sp/>(distance<sp/>from<sp/>column<sp/>boundary)<sp/>that<sp/>a<sp/>typical</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight><highlight class="comment">//<sp/>text-line<sp/>in<sp/>flowing<sp/>text<sp/>should<sp/>have<sp/>as<sp/>a<sp/>multiple<sp/>of<sp/>its<sp/>x-height</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight><highlight class="comment">//<sp/>(Median<sp/>size).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1aee32ef58150f63a980c7b4f736c4a22a" kindref="member">kSideSpaceMargin</ref><sp/>=<sp/>10;</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Fraction<sp/>of<sp/>the<sp/>peak<sp/>of<sp/>x-projection<sp/>of<sp/>a<sp/>table<sp/>region<sp/>to<sp/>set<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight><highlight class="comment">//<sp/>threshold<sp/>for<sp/>the<sp/>x-projection<sp/>histogram</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1ae12e73878098046ae28b0d54408359f7" kindref="member">kSmallTableProjectionThreshold</ref><sp/>=<sp/>0.35;</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a39b11305adc922233ab775b31d94b6bb" kindref="member">kLargeTableProjectionThreshold</ref><sp/>=<sp/>0.45;</highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Minimum<sp/>number<sp/>of<sp/>rows<sp/>required<sp/>to<sp/>look<sp/>for<sp/>more<sp/>rows<sp/>in<sp/>the<sp/>projection.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1adf7c67274b1cdc63e4afeb2500796de7" kindref="member">kLargeTableRowCount</ref><sp/>=<sp/>6;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Minimum<sp/>number<sp/>of<sp/>rows<sp/>in<sp/>a<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a4947294f7e711f5f1713df9de000b1b8" kindref="member">kMinRowsInTable</ref><sp/>=<sp/>3;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight><highlight class="comment">//<sp/>The<sp/>number<sp/>of<sp/>&quot;whitespace<sp/>blobs&quot;<sp/>that<sp/>should<sp/>appear<sp/>between<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight><highlight class="comment">//<sp/>ColPartition&apos;s<sp/>bounding<sp/>box<sp/>and<sp/>the<sp/>column<sp/>tab<sp/>stops<sp/>to<sp/>the<sp/>left/right</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight><highlight class="comment">//<sp/>when<sp/>looking<sp/>for<sp/>center<sp/>justified<sp/>tab<sp/>stops.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a1daab9134060be235b5cc1ee94aceeaf" kindref="member">kRequiredFullJustifiedSpacing</ref><sp/>=<sp/>4.0;</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight><highlight class="comment">//<sp/>The<sp/>amount<sp/>of<sp/>padding<sp/>(multiplied<sp/>by<sp/>global_median_xheight_<sp/>during<sp/>use)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight><highlight class="comment">//<sp/>that<sp/>is<sp/>vertically<sp/>added<sp/>to<sp/>the<sp/>search<sp/>adjacent<sp/>leader<sp/>search<sp/>during</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight><highlight class="comment">//<sp/>ColPartition<sp/>marking.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a7c23a9af9374381d1a961227ce653ea6" kindref="member">kAdjacentLeaderSearchPadding</ref><sp/>=<sp/>2;</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Used<sp/>when<sp/>filtering<sp/>false<sp/>positives.<sp/>When<sp/>finding<sp/>the<sp/>last<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight><highlight class="comment">//<sp/>of<sp/>a<sp/>paragraph<sp/>(typically<sp/>left-aligned),<sp/>the<sp/>previous<sp/>line<sp/>should<sp/>have</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight><highlight class="comment">//<sp/>its<sp/>center<sp/>to<sp/>the<sp/>right<sp/>of<sp/>the<sp/>last<sp/>line<sp/>by<sp/>this<sp/>scaled<sp/>amount.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1ac6a1849ed370a22bb4a2b4a94ca1634c" kindref="member">kParagraphEndingPreviousLineRatio</ref><sp/>=<sp/>1.3;</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight><highlight class="comment">//<sp/>The<sp/>maximum<sp/>amount<sp/>of<sp/>whitespace<sp/>allowed<sp/>left<sp/>of<sp/>a<sp/>paragraph<sp/>ending.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Do<sp/>not<sp/>filter<sp/>a<sp/>ColPartition<sp/>with<sp/>more<sp/>than<sp/>this<sp/>space<sp/>left<sp/>of<sp/>it.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a1b76b5479d00c222f8a17e22d317b770" kindref="member">kMaxParagraphEndingLeftSpaceMultiple</ref><sp/>=<sp/>3.0;</highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Used<sp/>when<sp/>filtering<sp/>false<sp/>positives.<sp/>The<sp/>last<sp/>line<sp/>of<sp/>a<sp/>paragraph</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight><highlight class="comment">//<sp/>should<sp/>be<sp/>preceded<sp/>by<sp/>a<sp/>line<sp/>that<sp/>is<sp/>predominantly<sp/>text.<sp/>This<sp/>is<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight><highlight class="comment">//<sp/>ratio<sp/>of<sp/>text<sp/>to<sp/>whitespace<sp/>(to<sp/>the<sp/>right<sp/>of<sp/>the<sp/>text)<sp/>that<sp/>is<sp/>required</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"></highlight><highlight class="comment">//<sp/>for<sp/>the<sp/>previous<sp/>line<sp/>to<sp/>be<sp/>a<sp/>text.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a59fff4582ea32f8a8661fbc20a3ab947" kindref="member">kMinParagraphEndingTextToWhitespaceRatio</ref><sp/>=<sp/>3.0;</highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight><highlight class="comment">//<sp/>When<sp/>counting<sp/>table<sp/>columns,<sp/>this<sp/>is<sp/>the<sp/>required<sp/>gap<sp/>between<sp/>two<sp/>columns</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight><highlight class="comment">//<sp/>(it<sp/>is<sp/>multiplied<sp/>by<sp/>global_median_xheight_).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1af950654bba3a03e1ba3f1df8177cdd73" kindref="member">kMaxXProjectionGapFactor</ref><sp/>=<sp/>2.0;</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Used<sp/>for<sp/>similarity<sp/>in<sp/>partitions<sp/>using<sp/>stroke<sp/>width.<sp/>Values<sp/>copied</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight><highlight class="comment">//<sp/>from<sp/>ColFind.cpp<sp/>in<sp/>Ray&apos;s<sp/>CL.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a477fb9ba9844da49a285692762b117d9" kindref="member">kStrokeWidthFractionalTolerance</ref><sp/>=<sp/>0.25;</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a7dc74940f73222c81918e8701c301516" kindref="member">kStrokeWidthConstantTolerance</ref><sp/>=<sp/>2.0;</highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><ref refid="namespacetesseract_1a4209fb24514046ff3fdf7b9b3f06f69a" kindref="member">BOOL_VAR</ref>(textord_dump_table_images,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Paint<sp/>table<sp/>detection<sp/>output&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><ref refid="namespacetesseract_1a4209fb24514046ff3fdf7b9b3f06f69a" kindref="member">BOOL_VAR</ref>(textord_show_tables,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Show<sp/>table<sp/>regions&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><ref refid="namespacetesseract_1a4209fb24514046ff3fdf7b9b3f06f69a" kindref="member">BOOL_VAR</ref>(textord_tablefind_show_mark,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Debug<sp/>table<sp/>marking<sp/>steps<sp/>in<sp/>detail&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><ref refid="namespacetesseract_1a4209fb24514046ff3fdf7b9b3f06f69a" kindref="member">BOOL_VAR</ref>(textord_tablefind_show_stats,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Show<sp/>page<sp/>stats<sp/>used<sp/>in<sp/>table<sp/>finding&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><ref refid="namespacetesseract_1a4209fb24514046ff3fdf7b9b3f06f69a" kindref="member">BOOL_VAR</ref>(textord_tablefind_recognize_tables,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Enables<sp/>the<sp/>table<sp/>recognizer<sp/>for<sp/>table<sp/>layout<sp/>and<sp/>filtering.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><ref refid="namespacetesseract_1a3b71ccfcd667bca92d2e6435845a4c9b" kindref="member">ELISTIZE</ref>(ColSegment)</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><ref refid="clst_8h_1a721c1e0acc4a882f9ea934613aee64be" kindref="member">CLISTIZE</ref>(ColSegment)</highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Templated<sp/>helper<sp/>function<sp/>used<sp/>to<sp/>create<sp/>destructor<sp/>callbacks<sp/>for<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight><highlight class="comment">//<sp/>BBGrid::ClearGridData()<sp/>method.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal">template<sp/>&lt;typename<sp/>T&gt;<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a67d9dc6d03fb77b0f23aafd42bb3c835" kindref="member">DeleteObject</ref>(T<sp/>*</highlight><highlight class="keywordtype">object</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>object;</highlight></codeline>
<codeline lineno="166"><highlight class="normal">}</highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><ref refid="classtesseract_1_1_table_finder_1a4df3eb2b591c4b8777339e2a300316cf" kindref="member">TableFinder::TableFinder</ref>()</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/>:<sp/>resolution_(0),</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>global_median_xheight_(0),</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>global_median_blob_width_(0),</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>global_median_ledding_(0),</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>left_to_right_language_(true)<sp/>{</highlight></codeline>
<codeline lineno="174"><highlight class="normal">}</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><ref refid="classtesseract_1_1_table_finder_1af785f06b1353645cece6b8873a6b78af" kindref="member">TableFinder::~TableFinder</ref>()<sp/>{</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>ColPartitions<sp/>and<sp/>ColSegments<sp/>created<sp/>by<sp/>this<sp/>class<sp/>for<sp/>storage<sp/>in<sp/>grids</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>need<sp/>to<sp/>be<sp/>deleted<sp/>explicitly.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1aa3f84b8f684c71394335a5a4f17c90be" kindref="member">ClearGridData</ref>(&amp;DeleteObject&lt;ColPartition&gt;);</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1aa3f84b8f684c71394335a5a4f17c90be" kindref="member">ClearGridData</ref>(&amp;DeleteObject&lt;ColPartition&gt;);</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1ad2da282ac5f2a2d4efbc463d80c7113c" kindref="member">fragmented_text_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1aa3f84b8f684c71394335a5a4f17c90be" kindref="member">ClearGridData</ref>(&amp;DeleteObject&lt;ColPartition&gt;);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a94f0570afcc478097685ccdb59928903" kindref="member">col_seg_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1aa3f84b8f684c71394335a5a4f17c90be" kindref="member">ClearGridData</ref>(&amp;DeleteObject&lt;ColSegment&gt;);</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1aa3f84b8f684c71394335a5a4f17c90be" kindref="member">ClearGridData</ref>(&amp;DeleteObject&lt;ColSegment&gt;);</highlight></codeline>
<codeline lineno="184"><highlight class="normal">}</highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aacc9d09ee5545c6ba681a73ddfff139b" kindref="member">TableFinder::set_left_to_right_language</ref>(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>order)<sp/>{</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a528595d792a34a2a361670aced196165" kindref="member">left_to_right_language_</ref><sp/>=<sp/>order;</highlight></codeline>
<codeline lineno="188"><highlight class="normal">}</highlight></codeline>
<codeline lineno="189"><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a2addcdf6528f3a69fa25c94940cdc428" kindref="member">TableFinder::Init</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>grid_size,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref>&amp;<sp/>bottom_left,</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref>&amp;<sp/>top_right)<sp/>{</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Initialize<sp/>clean<sp/>partitions<sp/>list<sp/>and<sp/>grid</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a1d2990adf323d7910fbf87b6fc3a7415" kindref="member">Init</ref>(grid_size,<sp/>bottom_left,<sp/>top_right);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a1d2990adf323d7910fbf87b6fc3a7415" kindref="member">Init</ref>(grid_size,<sp/>bottom_left,<sp/>top_right);</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1ad2da282ac5f2a2d4efbc463d80c7113c" kindref="member">fragmented_text_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a1d2990adf323d7910fbf87b6fc3a7415" kindref="member">Init</ref>(grid_size,<sp/>bottom_left,<sp/>top_right);</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a94f0570afcc478097685ccdb59928903" kindref="member">col_seg_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a1d2990adf323d7910fbf87b6fc3a7415" kindref="member">Init</ref>(grid_size,<sp/>bottom_left,<sp/>top_right);</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a1d2990adf323d7910fbf87b6fc3a7415" kindref="member">Init</ref>(grid_size,<sp/>bottom_left,<sp/>top_right);</highlight></codeline>
<codeline lineno="198"><highlight class="normal">}</highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Copy<sp/>cleaned<sp/>partitions<sp/>from<sp/>part_grid_<sp/>to<sp/>clean_part_grid_<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight><highlight class="comment">//<sp/>insert<sp/>leaders<sp/>and<sp/>rulers<sp/>into<sp/>the<sp/>leader_and_ruling_grid_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a9f4115ada3be71a1106527aa59f31b43" kindref="member">TableFinder::InsertCleanPartitions</ref>(ColPartitionGrid*<sp/>grid,</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref>*<sp/>block)<sp/>{</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Calculate<sp/>stats.<sp/>This<sp/>lets<sp/>us<sp/>filter<sp/>partitions<sp/>in<sp/>AllowTextPartition()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>and<sp/>filter<sp/>blobs<sp/>in<sp/>AllowBlob().</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a51c670936d76fcdf3ed1a0e2730a54c4" kindref="member">SetGlobalSpacings</ref>(grid);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>the<sp/>ColPartitions<sp/>in<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><ref refid="namespacetesseract_1a990e3f25988f7d70c40a13225e645492" kindref="member">ColPartitionGridSearch</ref><sp/>gsearch(grid);</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/>gsearch.SetUniqueMode(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Reject<sp/>partitions<sp/>with<sp/>nothing<sp/>useful<sp/>inside<sp/>of<sp/>them.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;blob_type()<sp/>==<sp/><ref refid="blobbox_8h_1aebfaf711760a99b60c297d1d619df575ae09c6f7e99c3a3885c3469d52d0292d2" kindref="member">BRT_NOISE</ref><sp/>||<sp/>part-&gt;bounding_box().area()<sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>clean_part<sp/>=<sp/>part-&gt;ShallowCopy();</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>leader_part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;IsLineType())<sp/>{</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aa7a21d1842c6592372eb69b49b2010a2" kindref="member">InsertRulingPartition</ref>(clean_part);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Insert<sp/>all<sp/>non-text<sp/>partitions<sp/>to<sp/>clean_parts</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!part-&gt;IsTextType())<sp/>{</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1af310b33b86e951125b49e4ac1df2bb68" kindref="member">InsertImagePartition</ref>(clean_part);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Insert<sp/>text<sp/>colpartitions<sp/>after<sp/>removing<sp/>noisy<sp/>components<sp/>from<sp/>them</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>leaders<sp/>are<sp/>split<sp/>into<sp/>a<sp/>separate<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/>BLOBNBOX_CLIST*<sp/>part_boxes<sp/>=<sp/>part-&gt;boxes();</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>BLOBNBOX_C_IT<sp/>pit(part_boxes);</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(pit.mark_cycle_pt();<sp/>!pit.cycled_list();<sp/>pit.forward())<sp/>{</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>*pblob<sp/>=<sp/>pit.data();</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Bad<sp/>blobs...<sp/>happens<sp/>in<sp/>UNLV<sp/>set.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>news.3G1,<sp/>page<sp/>17<sp/>(around<sp/>x=6)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classtesseract_1_1_table_finder_1aec9b60ffceb19f3f82186b60c29b7f51" kindref="member">AllowBlob</ref>(*pblob))</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1afafe7113396a8cc27b882d622db46f05" kindref="member">flow</ref>()<sp/>==<sp/><ref refid="blobbox_8h_1aa72f1499398e9694bf46752e1cc895e1a64e3e70c4fac4d4e3facdb4638307d7f" kindref="member">BTFT_LEADER</ref>)<sp/>{</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(leader_part<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>leader_part<sp/>=<sp/>part-&gt;ShallowCopy();</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>leader_part-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a75340334988feba52ce36ba596750a35" kindref="member">set_flow</ref>(<ref refid="blobbox_8h_1aa72f1499398e9694bf46752e1cc895e1a64e3e70c4fac4d4e3facdb4638307d7f" kindref="member">BTFT_LEADER</ref>);</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>leader_part-&gt;AddBox(pblob);</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a9e7100e6d08c78cca5f9c0453e11565d" kindref="member">region_type</ref>()<sp/>!=<sp/><ref refid="blobbox_8h_1aebfaf711760a99b60c297d1d619df575ae09c6f7e99c3a3885c3469d52d0292d2" kindref="member">BRT_NOISE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clean_part-&gt;AddBox(pblob);</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/>clean_part-&gt;ComputeLimits();</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>fragmented<sp/>=<sp/>clean_part-&gt;CopyButDontOwnBlobs();</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1ad312e62064f4964ac0eb6010d002b9cd" kindref="member">InsertTextPartition</ref>(clean_part);</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a34950c2f035a25bb75f29a5ab51fe191" kindref="member">SplitAndInsertFragmentedTextPartition</ref>(fragmented);</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(leader_part<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>Note<sp/>that<sp/>ComputeLimits<sp/>does<sp/>not<sp/>update<sp/>the<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>information.<sp/>So<sp/>the<sp/>leader<sp/>may<sp/>appear<sp/>to<sp/>span<sp/>more<sp/>columns<sp/>than<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>really<sp/>does<sp/>later<sp/>on<sp/>when<sp/>IsInSameColumnAs<sp/>gets<sp/>called<sp/>to<sp/>test</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>for<sp/>adjacent<sp/>leaders.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>leader_part-&gt;ComputeLimits();</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a818a95d0b0bdb619e0170dac27426942" kindref="member">InsertLeaderPartition</ref>(leader_part);</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Make<sp/>the<sp/>partition<sp/>partners<sp/>better<sp/>for<sp/>upper<sp/>and<sp/>lower<sp/>neighbors.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>.<ref refid="classtesseract_1_1_col_partition_grid_1a7ed32c7b4717fc000dd55796f6bf86d7" kindref="member">FindPartitionPartners</ref>();</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>.<ref refid="classtesseract_1_1_col_partition_grid_1a4781167f958ee8cc47549d8b39b9f1b5" kindref="member">RefinePartitionPartners</ref>(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="265"><highlight class="normal">}</highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight><highlight class="comment">//<sp/>High<sp/>level<sp/>function<sp/>to<sp/>perform<sp/>table<sp/>detection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a31d3976698617bc729409e1e0ff0c4ca" kindref="member">TableFinder::LocateTables</ref>(ColPartitionGrid*<sp/>grid,</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ColPartitionSet**<sp/>all_columns,</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacetesseract_1add06f170e88dcbac90a80ff20c42cc0a" kindref="member">WidthCallback</ref>*<sp/>width_cb,</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref>&amp;<sp/>reskew)<sp/>{</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>initialize<sp/>spacing,<sp/>neighbors,<sp/>and<sp/>columns</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a5dfc53ecb81ee804476fd04f32434e6c" kindref="member">InitializePartitions</ref>(all_columns);</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_tables)<sp/>{</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>table_win<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1a1d45a058db096f6040af24af402b2042" kindref="member">MakeWindow</ref>(0,<sp/>300,<sp/></highlight><highlight class="stringliteral">&quot;Column<sp/>Partitions<sp/>&amp;<sp/>Neighbors&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>,</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0ae903faf0b9c434a6cff979e51620f8" kindref="member">ScrollView::AQUAMARINE</ref>);</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1ae38774700a97b1690f1530d77432a762" kindref="member">DisplayColPartitionConnections</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>,</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0691e22f5da865103a497f9503269a61" kindref="member">ScrollView::ORANGE</ref>);</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/>table_win<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1a1d45a058db096f6040af24af402b2042" kindref="member">MakeWindow</ref>(100,<sp/>300,<sp/></highlight><highlight class="stringliteral">&quot;Fragmented<sp/>Text&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1ad2da282ac5f2a2d4efbc463d80c7113c" kindref="member">fragmented_text_grid_</ref>,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>mark,<sp/>filter,<sp/>and<sp/>smooth<sp/>candidate<sp/>table<sp/>partitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a7f29dd0a40d57b00d4868ff1c656dd6a" kindref="member">MarkTablePartitions</ref>();</highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Make<sp/>single-column<sp/>blocks<sp/>from<sp/>good_columns_<sp/>partitions.<sp/>col_segments<sp/>are</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>moved<sp/>to<sp/>a<sp/>grid<sp/>later<sp/>which<sp/>takes<sp/>the<sp/>ownership</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/>ColSegment_LIST<sp/>column_blocks;</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a7869fe256b237ad13171f13c8a6cc449" kindref="member">GetColumnBlocks</ref>(all_columns,<sp/>&amp;column_blocks);</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Set<sp/>the<sp/>ratio<sp/>of<sp/>candidate<sp/>table<sp/>partitions<sp/>in<sp/>each<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1ac3e8a6d03fcaf027677919f284af6500" kindref="member">SetColumnsType</ref>(&amp;column_blocks);</highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Move<sp/>column<sp/>segments<sp/>to<sp/>col_seg_grid_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a81003bea37eced8d746035bd565b9c56" kindref="member">MoveColSegmentsToGrid</ref>(&amp;column_blocks,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1a94f0570afcc478097685ccdb59928903" kindref="member">col_seg_grid_</ref>);</highlight></codeline>
<codeline lineno="297"><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Detect<sp/>split<sp/>in<sp/>column<sp/>layout<sp/>that<sp/>might<sp/>have<sp/>occurred<sp/>due<sp/>to<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>presence<sp/>of<sp/>a<sp/>table.<sp/>In<sp/>such<sp/>a<sp/>case,<sp/>merge<sp/>the<sp/>corresponding<sp/>columns.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a7a3319f9a1eab06ef83a6e3f2df7e8d2" kindref="member">GridMergeColumnBlocks</ref>();</highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Group<sp/>horizontally<sp/>overlapping<sp/>table<sp/>partitions<sp/>into<sp/>table<sp/>columns.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>table_columns<sp/>created<sp/>here<sp/>get<sp/>deleted<sp/>at<sp/>the<sp/>end<sp/>of<sp/>this<sp/>method.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/>ColSegment_LIST<sp/>table_columns;</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a30f071829b47f7bd9afdd4ef819f582d" kindref="member">GetTableColumns</ref>(&amp;table_columns);</highlight></codeline>
<codeline lineno="306"><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Within<sp/>each<sp/>column,<sp/>mark<sp/>the<sp/>range<sp/>table<sp/>regions<sp/>occupy<sp/>based<sp/>on<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>table<sp/>columns<sp/>detected.<sp/>table_regions<sp/>are<sp/>moved<sp/>to<sp/>a<sp/>grid<sp/>later<sp/>which</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>takes<sp/>the<sp/>ownership</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/>ColSegment_LIST<sp/>table_regions;</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a581a66fbdfdd0da5c3679a31f8d7944e" kindref="member">GetTableRegions</ref>(&amp;table_columns,<sp/>&amp;table_regions);</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_tablefind_show_mark)<sp/>{</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>table_win<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1a1d45a058db096f6040af24af402b2042" kindref="member">MakeWindow</ref>(1200,<sp/>300,<sp/></highlight><highlight class="stringliteral">&quot;Table<sp/>Columns<sp/>and<sp/>Regions&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a0778d0e3d6bc52330704d1143a73f90a" kindref="member">DisplayColSegments</ref>(table_win,<sp/>&amp;table_columns,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a46dc68c065ac8c61e1213f2449479f8c" kindref="member">ScrollView::DARK_TURQUOISE</ref>);</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a0778d0e3d6bc52330704d1143a73f90a" kindref="member">DisplayColSegments</ref>(table_win,<sp/>&amp;table_regions,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a61dec9bc0aaf1d527a731b2a6ce055c8" kindref="member">ScrollView::YELLOW</ref>);</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Merge<sp/>table<sp/>regions<sp/>across<sp/>columns<sp/>for<sp/>tables<sp/>spanning<sp/>multiple</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>columns</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a81003bea37eced8d746035bd565b9c56" kindref="member">MoveColSegmentsToGrid</ref>(&amp;table_regions,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>);</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a9298cd74b3e81315195a547a890752e0" kindref="member">GridMergeTableRegions</ref>();</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Adjust<sp/>table<sp/>boundaries<sp/>by<sp/>including<sp/>nearby<sp/>horizontal<sp/>lines<sp/>and<sp/>left</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>out<sp/>column<sp/>headers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a2af79bdd1c4edbf03f4d2a15ee203be8" kindref="member">AdjustTableBoundaries</ref>();</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a9298cd74b3e81315195a547a890752e0" kindref="member">GridMergeTableRegions</ref>();</highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_tablefind_recognize_tables)<sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Remove<sp/>false<sp/>alarms<sp/>consiting<sp/>of<sp/>a<sp/>single<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1ad1d77425898bfe8808255b9a472663ab" kindref="member">DeleteSingleColumnTables</ref>();</highlight></codeline>
<codeline lineno="332"><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_tables)<sp/>{</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>table_win<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1a1d45a058db096f6040af24af402b2042" kindref="member">MakeWindow</ref>(1200,<sp/>300,<sp/></highlight><highlight class="stringliteral">&quot;Detected<sp/>Table<sp/>Locations&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>);</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a0778d0e3d6bc52330704d1143a73f90a" kindref="member">DisplayColSegments</ref>(table_win,<sp/>&amp;table_columns,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8afcf7a70cd729b6f0a668f762ec8a5820" kindref="member">ScrollView::KHAKI</ref>);</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a01e56b692125ef3220a23695e2c4821f" kindref="member">DisplayBoxes</ref>(table_win);</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Find<sp/>table<sp/>grid<sp/>structure<sp/>and<sp/>reject<sp/>tables<sp/>that<sp/>are<sp/>malformed.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a647fe056ae6bb33cc8989f08aac5172f" kindref="member">RecognizeTables</ref>();</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a9298cd74b3e81315195a547a890752e0" kindref="member">GridMergeTableRegions</ref>();</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a647fe056ae6bb33cc8989f08aac5172f" kindref="member">RecognizeTables</ref>();</highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_tables)<sp/>{</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>table_win<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1a1d45a058db096f6040af24af402b2042" kindref="member">MakeWindow</ref>(1400,<sp/>600,<sp/></highlight><highlight class="stringliteral">&quot;Recognized<sp/>Tables&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>,</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>);</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a01e56b692125ef3220a23695e2c4821f" kindref="member">DisplayBoxes</ref>(table_win);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Remove<sp/>false<sp/>alarms<sp/>consiting<sp/>of<sp/>a<sp/>single<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>verify<sp/>this<sp/>is<sp/>a<sp/>NOP<sp/>after<sp/>structured<sp/>table<sp/>rejection.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Right<sp/>now<sp/>it<sp/>isn&apos;t.<sp/>If<sp/>the<sp/>recognize<sp/>function<sp/>is<sp/>doing<sp/>what<sp/>it<sp/>is</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>supposed<sp/>to<sp/>do,<sp/>this<sp/>function<sp/>is<sp/>obsolete.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1ad1d77425898bfe8808255b9a472663ab" kindref="member">DeleteSingleColumnTables</ref>();</highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_tables)<sp/>{</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>table_win<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1a1d45a058db096f6040af24af402b2042" kindref="member">MakeWindow</ref>(1500,<sp/>300,<sp/></highlight><highlight class="stringliteral">&quot;Detected<sp/>Tables&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>,</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>);</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a01e56b692125ef3220a23695e2c4821f" kindref="member">DisplayBoxes</ref>(table_win);</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_dump_table_images)</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1abbd932c16cdfa0cf35f9ef93e2e87f49" kindref="member">WriteToPix</ref>(reskew);</highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Merge<sp/>all<sp/>colpartitions<sp/>in<sp/>table<sp/>regions<sp/>to<sp/>make<sp/>them<sp/>a<sp/>single</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>colpartition<sp/>and<sp/>revert<sp/>types<sp/>of<sp/>isolated<sp/>table<sp/>cells<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>assigned<sp/>to<sp/>any<sp/>table<sp/>to<sp/>their<sp/>original<sp/>types.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a1856836a1386196d5784244b4a1aa2d0" kindref="member">MakeTableBlocks</ref>(grid,<sp/>all_columns,<sp/>width_cb);</highlight></codeline>
<codeline lineno="373"><highlight class="normal">}</highlight></codeline>
<codeline lineno="374"><highlight class="normal"></highlight><highlight class="comment">//<sp/>All<sp/>grids<sp/>have<sp/>the<sp/>same<sp/>dimensions.<sp/>The<sp/>clean_part_grid_<sp/>sizes<sp/>are<sp/>set<sp/>from</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"></highlight><highlight class="comment">//<sp/>the<sp/>part_grid_<sp/>that<sp/>is<sp/>passed<sp/>to<sp/>InsertCleanPartitions,<sp/>which<sp/>was<sp/>the<sp/>same<sp/>as</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"></highlight><highlight class="comment">//<sp/>the<sp/>grid<sp/>that<sp/>is<sp/>the<sp/>base<sp/>of<sp/>ColumnFinder.<sp/>Just<sp/>return<sp/>the<sp/>clean_part_grid_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"></highlight><highlight class="comment">//<sp/>dimensions<sp/>instead<sp/>of<sp/>duplicated<sp/>memory.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aecbfe718794e99b2f15a43a7f7350848" kindref="member">TableFinder::gridsize</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>.<ref refid="classtesseract_1_1_grid_base_1afff2cee730084711205977b5fcb4901e" kindref="member">gridsize</ref>();</highlight></codeline>
<codeline lineno="380"><highlight class="normal">}</highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a9234ae10ef078a56d67d6ceb91050b2e" kindref="member">TableFinder::gridwidth</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>.<ref refid="classtesseract_1_1_grid_base_1a0a38ea995b9d65f8b67d66d5501a5b80" kindref="member">gridwidth</ref>();</highlight></codeline>
<codeline lineno="383"><highlight class="normal">}</highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a704fbe9cb0edeaa969bb0cc2bd1f9dbd" kindref="member">TableFinder::gridheight</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>.<ref refid="classtesseract_1_1_grid_base_1a07e6b230c150180d009ef1f317e642f2" kindref="member">gridheight</ref>();</highlight></codeline>
<codeline lineno="386"><highlight class="normal">}</highlight></codeline>
<codeline lineno="387"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref>&amp;<sp/><ref refid="classtesseract_1_1_table_finder_1afaa3f28f4a9e645ded90e9f74016b217" kindref="member">TableFinder::bleft</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>.<ref refid="classtesseract_1_1_grid_base_1ad20b2cb8eb2bf52871d5260c04949cce" kindref="member">bleft</ref>();</highlight></codeline>
<codeline lineno="389"><highlight class="normal">}</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref>&amp;<sp/><ref refid="classtesseract_1_1_table_finder_1af994bc64825f51944fa63a0fc61b4e13" kindref="member">TableFinder::tright</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>.<ref refid="classtesseract_1_1_grid_base_1aa94e147841b6a4fae0b28e7e872685a5" kindref="member">tright</ref>();</highlight></codeline>
<codeline lineno="392"><highlight class="normal">}</highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1ad312e62064f4964ac0eb6010d002b9cd" kindref="member">TableFinder::InsertTextPartition</ref>(ColPartition*<sp/>part)<sp/>{</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref>(part<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>);</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classtesseract_1_1_table_finder_1a534bca2a3fa57718c0bdf18b6af69af6" kindref="member">AllowTextPartition</ref>(*part))<sp/>{</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a7b379525e3d60c68e583352ae4b8a750" kindref="member">InsertBBox</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>part);</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>part;</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="401"><highlight class="normal">}</highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a216c040efc8dff584076cc324240c524" kindref="member">TableFinder::InsertFragmentedTextPartition</ref>(ColPartition*<sp/>part)<sp/>{</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref>(part<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>);</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classtesseract_1_1_table_finder_1a534bca2a3fa57718c0bdf18b6af69af6" kindref="member">AllowTextPartition</ref>(*part))<sp/>{</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1ad2da282ac5f2a2d4efbc463d80c7113c" kindref="member">fragmented_text_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a7b379525e3d60c68e583352ae4b8a750" kindref="member">InsertBBox</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>part);</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>part;</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="409"><highlight class="normal">}</highlight></codeline>
<codeline lineno="410"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a818a95d0b0bdb619e0170dac27426942" kindref="member">TableFinder::InsertLeaderPartition</ref>(ColPartition*<sp/>part)<sp/>{</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref>(part<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>);</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!part-&gt;IsEmpty()<sp/>&amp;&amp;<sp/>part-&gt;bounding_box().area()<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a7b379525e3d60c68e583352ae4b8a750" kindref="member">InsertBBox</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>part);</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>part;</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="417"><highlight class="normal">}</highlight></codeline>
<codeline lineno="418"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aa7a21d1842c6592372eb69b49b2010a2" kindref="member">TableFinder::InsertRulingPartition</ref>(ColPartition*<sp/>part)<sp/>{</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a7b379525e3d60c68e583352ae4b8a750" kindref="member">InsertBBox</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>part);</highlight></codeline>
<codeline lineno="420"><highlight class="normal">}</highlight></codeline>
<codeline lineno="421"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1af310b33b86e951125b49e4ac1df2bb68" kindref="member">TableFinder::InsertImagePartition</ref>(ColPartition*<sp/>part)<sp/>{</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>NOTE:<sp/>If<sp/>images<sp/>are<sp/>placed<sp/>into<sp/>a<sp/>different<sp/>grid<sp/>in<sp/>the<sp/>future,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>function<sp/>SetPartitionSpacings<sp/>needs<sp/>to<sp/>be<sp/>updated.<sp/>It<sp/>should</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>be<sp/>the<sp/>only<sp/>thing<sp/>that<sp/>cares<sp/>about<sp/>image<sp/>partitions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a7b379525e3d60c68e583352ae4b8a750" kindref="member">InsertBBox</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>part);</highlight></codeline>
<codeline lineno="426"><highlight class="normal">}</highlight></codeline>
<codeline lineno="427"><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Splits<sp/>a<sp/>partition<sp/>into<sp/>its<sp/>&quot;words&quot;.<sp/>The<sp/>splits<sp/>happen</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"></highlight><highlight class="comment">//<sp/>at<sp/>locations<sp/>with<sp/>wide<sp/>inter-blob<sp/>spacing.<sp/>This<sp/>is<sp/>useful</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"></highlight><highlight class="comment">//<sp/>because<sp/>it<sp/>allows<sp/>the<sp/>table<sp/>recognize<sp/>to<sp/>&quot;cut<sp/>through&quot;<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="431"><highlight class="normal"></highlight><highlight class="comment">//<sp/>text<sp/>lines<sp/>on<sp/>the<sp/>page.<sp/>The<sp/>assumption<sp/>is<sp/>that<sp/>a<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"></highlight><highlight class="comment">//<sp/>will<sp/>have<sp/>several<sp/>lines<sp/>with<sp/>similar<sp/>overlapping<sp/>whitespace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"></highlight><highlight class="comment">//<sp/>whereas<sp/>text<sp/>will<sp/>not<sp/>have<sp/>this<sp/>type<sp/>of<sp/>property.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Note:<sp/>The<sp/>code<sp/>Assumes<sp/>that<sp/>blobs<sp/>are<sp/>sorted<sp/>by<sp/>the<sp/>left<sp/>side<sp/>x!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="435"><highlight class="normal"></highlight><highlight class="comment">//<sp/>This<sp/>will<sp/>not<sp/>work<sp/>(as<sp/>well)<sp/>if<sp/>the<sp/>blobs<sp/>are<sp/>sorted<sp/>by<sp/>center/right.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a34950c2f035a25bb75f29a5ab51fe191" kindref="member">TableFinder::SplitAndInsertFragmentedTextPartition</ref>(ColPartition*<sp/>part)<sp/>{</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref>(part<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>);</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Bye<sp/>bye<sp/>empty<sp/>partitions!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;boxes()-&gt;empty())<sp/>{</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>part;</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="443"><highlight class="normal"></highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>AllowBlob<sp/>function<sp/>prevents<sp/>this.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref>(part-&gt;median_width()<sp/>&gt;<sp/>0);</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>kThreshold<sp/>=<sp/>part-&gt;median_width()<sp/>*<sp/><ref refid="namespacetesseract_1aeecbc7f84d79acc5731cfdcccc164bde" kindref="member">kSplitPartitionSize</ref>;</highlight></codeline>
<codeline lineno="447"><highlight class="normal"></highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>right_part<sp/>=<sp/>part;</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>found_split<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(found_split)<sp/>{</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/>found_split<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/>BLOBNBOX_C_IT<sp/>box_it(right_part-&gt;boxes());</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Blobs<sp/>are<sp/>sorted<sp/>left<sp/>side<sp/>first.<sp/>If<sp/>blobs<sp/>overlap,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>previous<sp/>blob<sp/>may<sp/>have<sp/>a<sp/>&quot;more<sp/>right&quot;<sp/>right<sp/>side.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Account<sp/>for<sp/>this<sp/>by<sp/>always<sp/>keeping<sp/>the<sp/>largest<sp/>&quot;right&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>so<sp/>far.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>previous_right<sp/>=<sp/><ref refid="host_8h_1ae6f88d5bb15e97510f484289f2fc89fd" kindref="member">MIN_INT32</ref>;</highlight></codeline>
<codeline lineno="458"><highlight class="normal"></highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Look<sp/>for<sp/>the<sp/>next<sp/>split<sp/>in<sp/>the<sp/>partition.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(box_it.mark_cycle_pt();<sp/>!box_it.cycled_list();<sp/>box_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box<sp/>=<sp/>box_it.data()-&gt;bounding_box();</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(previous_right<sp/>!=<sp/><ref refid="host_8h_1ae6f88d5bb15e97510f484289f2fc89fd" kindref="member">MIN_INT32</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>-<sp/>previous_right<sp/>&gt;<sp/>kThreshold)<sp/>{</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>We<sp/>have<sp/>a<sp/>split<sp/>position.<sp/>Split<sp/>the<sp/>partition<sp/>in<sp/>two<sp/>pieces.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Insert<sp/>the<sp/>left<sp/>piece<sp/>in<sp/>the<sp/>grid<sp/>and<sp/>keep<sp/>processing<sp/>the<sp/>right.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mid_x<sp/>=<sp/>(box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>+<sp/>previous_right)<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ColPartition*<sp/>left_part<sp/>=<sp/>right_part;</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_part<sp/>=<sp/>left_part-&gt;SplitAt(mid_x);</highlight></codeline>
<codeline lineno="469"><highlight class="normal"></highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a216c040efc8dff584076cc324240c524" kindref="member">InsertFragmentedTextPartition</ref>(left_part);</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>found_split<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="474"><highlight class="normal"></highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>right<sp/>side<sp/>of<sp/>the<sp/>previous<sp/>blobs.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>previous_right<sp/>=<sp/><ref refid="ndminx_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(previous_right,<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>());</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>When<sp/>a<sp/>split<sp/>is<sp/>not<sp/>found,<sp/>the<sp/>right<sp/>part<sp/>is<sp/>minimized</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>as<sp/>much<sp/>as<sp/>possible,<sp/>so<sp/>process<sp/>it.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a216c040efc8dff584076cc324240c524" kindref="member">InsertFragmentedTextPartition</ref>(right_part);</highlight></codeline>
<codeline lineno="482"><highlight class="normal">}</highlight></codeline>
<codeline lineno="483"><highlight class="normal"></highlight></codeline>
<codeline lineno="484"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Some<sp/>simple<sp/>criteria<sp/>to<sp/>filter<sp/>out<sp/>now.<sp/>We<sp/>want<sp/>to<sp/>make<sp/>sure<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"></highlight><highlight class="comment">//<sp/>average<sp/>blob<sp/>size<sp/>in<sp/>the<sp/>partition<sp/>is<sp/>consistent<sp/>with<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight><highlight class="comment">//<sp/>global<sp/>page<sp/>stats.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"></highlight><highlight class="comment">//<sp/>The<sp/>area<sp/>metric<sp/>will<sp/>almost<sp/>always<sp/>pass<sp/>for<sp/>multi-blob<sp/>partitions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight><highlight class="comment">//<sp/>It<sp/>is<sp/>useful<sp/>when<sp/>filtering<sp/>out<sp/>noise<sp/>caused<sp/>by<sp/>an<sp/>isolated<sp/>blob.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a534bca2a3fa57718c0bdf18b6af69af6" kindref="member">TableFinder::AllowTextPartition</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>ColPartition&amp;<sp/>part)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>kHeightRequired<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1ab66e5e7382edbd8bc260fd5bca4f2914" kindref="member">global_median_xheight_</ref><sp/>*<sp/><ref refid="namespacetesseract_1a9b013c09ae4bd53f0b147f3945ae9c8c" kindref="member">kAllowTextHeight</ref>;</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>kWidthRequired<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1a761fd57460670c531131bd2a77227911" kindref="member">global_median_blob_width_</ref><sp/>*<sp/><ref refid="namespacetesseract_1a92f436872c90049797ee7b1356f50133" kindref="member">kAllowTextWidth</ref>;</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>median_area<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1ab66e5e7382edbd8bc260fd5bca4f2914" kindref="member">global_median_xheight_</ref><sp/>*<sp/><ref refid="classtesseract_1_1_table_finder_1a761fd57460670c531131bd2a77227911" kindref="member">global_median_blob_width_</ref>;</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>kAreaPerBlobRequired<sp/>=<sp/>median_area<sp/>*<sp/><ref refid="namespacetesseract_1a744c12bd96933e697e5afff35c492dc0" kindref="member">kAllowTextArea</ref>;</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Keep<sp/>comparisons<sp/>strictly<sp/>greater<sp/>to<sp/>disallow<sp/>0!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>part.median_size()<sp/>&gt;<sp/>kHeightRequired<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part.median_width()<sp/>&gt;<sp/>kWidthRequired<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part.bounding_box().area()<sp/>&gt;<sp/>kAreaPerBlobRequired<sp/>*<sp/>part.boxes_count();</highlight></codeline>
<codeline lineno="498"><highlight class="normal">}</highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Same<sp/>as<sp/>above,<sp/>applied<sp/>to<sp/>blobs.<sp/>Keep<sp/>in<sp/>mind<sp/>that</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"></highlight><highlight class="comment">//<sp/>leaders,<sp/>commas,<sp/>and<sp/>periods<sp/>are<sp/>important<sp/>in<sp/>tables.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aec9b60ffceb19f3f82186b60c29b7f51" kindref="member">TableFinder::AllowBlob</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>&amp;<sp/>blob)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box<sp/>=<sp/>blob.<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>();</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>kHeightRequired<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1ab66e5e7382edbd8bc260fd5bca4f2914" kindref="member">global_median_xheight_</ref><sp/>*<sp/><ref refid="namespacetesseract_1a0de56cf05a1e8a1aee7e6bcd81e34742" kindref="member">kAllowBlobHeight</ref>;</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>kWidthRequired<sp/>=<sp/>global_median_blob_width_<sp/>*<sp/><ref refid="namespacetesseract_1aa86b1f68578cb7c0b834b2a137376ed7" kindref="member">kAllowBlobWidth</ref>;</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>median_area<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1ab66e5e7382edbd8bc260fd5bca4f2914" kindref="member">global_median_xheight_</ref><sp/>*<sp/><ref refid="classtesseract_1_1_table_finder_1a761fd57460670c531131bd2a77227911" kindref="member">global_median_blob_width_</ref>;</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>kAreaRequired<sp/>=<sp/>median_area<sp/>*<sp/><ref refid="namespacetesseract_1a714f54e357a15f2578470c0430a9ec5f" kindref="member">kAllowBlobArea</ref>;</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Keep<sp/>comparisons<sp/>strictly<sp/>greater<sp/>to<sp/>disallow<sp/>0!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>box.<ref refid="class_t_b_o_x_1a8379d4bbc72bdbb1f069fc14790e632d" kindref="member">height</ref>()<sp/>&gt;<sp/>kHeightRequired<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>box.<ref refid="class_t_b_o_x_1af95494a2ccacc70cc2b83820b2948619" kindref="member">width</ref>()<sp/>&gt;<sp/>kWidthRequired<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>box.<ref refid="class_t_b_o_x_1a46fca3df91dc271b30b69531e9d8178a" kindref="member">area</ref>()<sp/>&gt;<sp/>kAreaRequired;</highlight></codeline>
<codeline lineno="512"><highlight class="normal">}</highlight></codeline>
<codeline lineno="513"><highlight class="normal"></highlight></codeline>
<codeline lineno="514"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>The<sp/>grid<sp/>that<sp/>makes<sp/>the<sp/>window<sp/>doesn&apos;t<sp/>seem<sp/>to<sp/>matter.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="515"><highlight class="normal"></highlight><highlight class="comment">//<sp/>The<sp/>only<sp/>downside<sp/>is<sp/>that<sp/>window<sp/>messages<sp/>will<sp/>be<sp/>caught<sp/>by</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="516"><highlight class="normal"></highlight><highlight class="comment">//<sp/>clean_part_grid_<sp/>instead<sp/>of<sp/>a<sp/>useful<sp/>object.<sp/>This<sp/>is<sp/>a<sp/>temporary<sp/>solution</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal"></highlight><highlight class="comment">//<sp/>for<sp/>the<sp/>debug<sp/>windows<sp/>created<sp/>by<sp/>the<sp/>TableFinder.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="518"><highlight class="normal"><ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/><ref refid="classtesseract_1_1_table_finder_1a1d45a058db096f6040af24af402b2042" kindref="member">TableFinder::MakeWindow</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>window_name)<sp/>{</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1aa716f76c7f04f7112abfc10a3f8c63e0" kindref="member">MakeWindow</ref>(x,<sp/>y,<sp/>window_name);</highlight></codeline>
<codeline lineno="520"><highlight class="normal">}</highlight></codeline>
<codeline lineno="521"><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Make<sp/>single-column<sp/>blocks<sp/>from<sp/>good_columns_<sp/>partitions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="523"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a7869fe256b237ad13171f13c8a6cc449" kindref="member">TableFinder::GetColumnBlocks</ref>(ColPartitionSet**<sp/>all_columns,</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ColSegment_LIST*<sp/>column_blocks)<sp/>{</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="classtesseract_1_1_table_finder_1a704fbe9cb0edeaa969bb0cc2bd1f9dbd" kindref="member">gridheight</ref>();<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartitionSet*<sp/>columns<sp/>=<sp/>all_columns[i];</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(columns<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ColSegment_LIST<sp/>new_blocks;</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>boxes<sp/>from<sp/>the<sp/>current<sp/>vertical<sp/>position<sp/>on<sp/>the<sp/>grid</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>columns-&gt;GetColumnBoxes(i<sp/>*<sp/><ref refid="classtesseract_1_1_table_finder_1aecbfe718794e99b2f15a43a7f7350848" kindref="member">gridsize</ref>(),<sp/>(i+1)<sp/>*<sp/><ref refid="classtesseract_1_1_table_finder_1aecbfe718794e99b2f15a43a7f7350848" kindref="member">gridsize</ref>(),<sp/>&amp;new_blocks);</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Merge<sp/>the<sp/>new_blocks<sp/>boxes<sp/>into<sp/>column_blocks<sp/>if<sp/>they<sp/>are<sp/>well-aligned</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a41bef91f2096c4a3bbe486b4d304bddb" kindref="member">GroupColumnBlocks</ref>(&amp;new_blocks,<sp/>column_blocks);</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="535"><highlight class="normal">}</highlight></codeline>
<codeline lineno="536"><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Merge<sp/>column<sp/>segments<sp/>into<sp/>the<sp/>current<sp/>list<sp/>if<sp/>they<sp/>are<sp/>well<sp/>aligned.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a41bef91f2096c4a3bbe486b4d304bddb" kindref="member">TableFinder::GroupColumnBlocks</ref>(ColSegment_LIST*<sp/>new_blocks,</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ColSegment_LIST*<sp/>column_blocks)<sp/>{</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/>ColSegment_IT<sp/>src_it(new_blocks);</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/>ColSegment_IT<sp/>dest_it(column_blocks);</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>iterate<sp/>through<sp/>the<sp/>source<sp/>list</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(src_it.mark_cycle_pt();<sp/>!src_it.cycled_list();<sp/>src_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/>ColSegment*<sp/>src_seg<sp/>=<sp/>src_it.data();</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>src_box<sp/>=<sp/>src_seg-&gt;bounding_box();</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>match_found<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>iterate<sp/>through<sp/>the<sp/>destination<sp/>list<sp/>to<sp/>find<sp/>a<sp/>matching<sp/>column<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(dest_it.mark_cycle_pt();<sp/>!dest_it.cycled_list();<sp/>dest_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ColSegment*<sp/>dest_seg<sp/>=<sp/>dest_it.data();</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>dest_box<sp/>=<sp/>dest_seg-&gt;bounding_box();</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classtesseract_1_1_table_finder_1a4caabd9ca4346514d60c7dce8400a909" kindref="member">ConsecutiveBoxes</ref>(src_box,<sp/>dest_box))<sp/>{</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>matching<sp/>block<sp/>is<sp/>found,<sp/>insert<sp/>the<sp/>current<sp/>block<sp/>into<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>and<sp/>delete<sp/>the<sp/>soure<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dest_seg-&gt;InsertBox(src_box);</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>match_found<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>src_it.extract();</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>no<sp/>match<sp/>is<sp/>found,<sp/>just<sp/>append<sp/>the<sp/>source<sp/>block<sp/>to<sp/>column_blocks</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!match_found)<sp/>{</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>dest_it.add_after_then_move(src_it.extract());</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="565"><highlight class="normal">}</highlight></codeline>
<codeline lineno="566"><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"></highlight><highlight class="comment">//<sp/>are<sp/>the<sp/>two<sp/>boxes<sp/>immediate<sp/>neighbors<sp/>along<sp/>the<sp/>vertical<sp/>direction</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="568"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a4caabd9ca4346514d60c7dce8400a909" kindref="member">TableFinder::ConsecutiveBoxes</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>&amp;b1,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>&amp;b2)<sp/>{</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x_margin<sp/>=<sp/>20;</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y_margin<sp/>=<sp/>5;</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(abs(b1.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>-<sp/>b2.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>())<sp/>&lt;<sp/>x_margin)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(abs(b1.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>()<sp/>-<sp/>b2.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>())<sp/>&lt;<sp/>x_margin)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(abs(b1.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>()-b2.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>())<sp/>&lt;<sp/>y_margin<sp/>||</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>abs(b2.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>()-b1.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>())<sp/>&lt;<sp/>y_margin);</highlight></codeline>
<codeline lineno="575"><highlight class="normal">}</highlight></codeline>
<codeline lineno="576"><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Set<sp/>up<sp/>info<sp/>for<sp/>clean_part_grid_<sp/>partitions<sp/>to<sp/>be<sp/>valid<sp/>during<sp/>detection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="578"><highlight class="normal"></highlight><highlight class="comment">//<sp/>code.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="579"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a5dfc53ecb81ee804476fd04f32434e6c" kindref="member">TableFinder::InitializePartitions</ref>(ColPartitionSet**<sp/>all_columns)<sp/>{</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1acfb82ae105ee34d1360dd0c5dc8487ff" kindref="member">FindNeighbors</ref>();</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aa4b52f48d63d4881da34b7d84932e84d" kindref="member">SetPartitionSpacings</ref>(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>,<sp/>all_columns);</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a51c670936d76fcdf3ed1a0e2730a54c4" kindref="member">SetGlobalSpacings</ref>(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="583"><highlight class="normal">}</highlight></codeline>
<codeline lineno="584"><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Set<sp/>left,<sp/>right<sp/>and<sp/>top,<sp/>bottom<sp/>spacings<sp/>of<sp/>each<sp/>colpartition.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aa4b52f48d63d4881da34b7d84932e84d" kindref="member">TableFinder::SetPartitionSpacings</ref>(ColPartitionGrid*<sp/>grid,</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ColPartitionSet**<sp/>all_columns)<sp/>{</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>the<sp/>ColPartitions<sp/>in<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><ref refid="namespacetesseract_1a990e3f25988f7d70c40a13225e645492" kindref="member">ColPartitionGridSearch</ref><sp/>gsearch(grid);</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartitionSet*<sp/>columns<sp/>=<sp/>all_columns[gsearch.GridY()];</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>box<sp/>=<sp/>part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y<sp/>=<sp/>part-&gt;MidY();</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>left_column<sp/>=<sp/>columns-&gt;ColumnContaining(box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>(),<sp/>y);</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>right_column<sp/>=<sp/>columns-&gt;ColumnContaining(box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>(),<sp/>y);</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>distance<sp/>from<sp/>left<sp/>column<sp/>as<sp/>space<sp/>to<sp/>the<sp/>left</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(left_column)<sp/>{</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>left_space<sp/>=<sp/><ref refid="ndminx_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(0,<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>-<sp/>left_column-&gt;LeftAtY(y));</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;set_space_to_left(left_space);</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>distance<sp/>from<sp/>right<sp/>column<sp/>as<sp/>space<sp/>to<sp/>the<sp/>right</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(right_column)<sp/>{</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>right_space<sp/>=<sp/><ref refid="ndminx_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(0,<sp/>right_column-&gt;RightAtY(y)<sp/>-<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>());</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;set_space_to_right(right_space);</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="608"><highlight class="normal"></highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Look<sp/>for<sp/>images<sp/>that<sp/>may<sp/>be<sp/>closer.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NOTE:<sp/>used<sp/>to<sp/>be<sp/>part_grid_,<sp/>might<sp/>cause<sp/>issues<sp/>now</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespacetesseract_1a990e3f25988f7d70c40a13225e645492" kindref="member">ColPartitionGridSearch</ref><sp/>hsearch(grid);</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/>hsearch.StartSideSearch(box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>(),<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>(),<sp/>box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>());</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>neighbor<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((neighbor<sp/>=<sp/>hsearch.NextSideSearch(</highlight><highlight class="keyword">true</highlight><highlight class="normal">))<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa88dcd7f4800095eb2f18b8a9bd521001" kindref="member">PT_PULLOUT_IMAGE</ref><sp/>||</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>neighbor-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fae4dd1e076e7d8354de8123bbdfb9e6b0" kindref="member">PT_FLOWING_IMAGE</ref><sp/>||</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>neighbor-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa919711bca6bed2e6a9846e4dc91f3900" kindref="member">PT_HEADING_IMAGE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>right<sp/>=<sp/>neighbor-&gt;bounding_box().right();</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(right<sp/>&lt;<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>())<sp/>{</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>space<sp/>=<sp/><ref refid="ndminx_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>-<sp/>right,<sp/>part-&gt;space_to_left());</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;set_space_to_left(space);</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/>hsearch.StartSideSearch(box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>(),<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>(),<sp/>box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>());</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/>neighbor<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((neighbor<sp/>=<sp/>hsearch.NextSideSearch(</highlight><highlight class="keyword">false</highlight><highlight class="normal">))<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa88dcd7f4800095eb2f18b8a9bd521001" kindref="member">PT_PULLOUT_IMAGE</ref><sp/>||</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>neighbor-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fae4dd1e076e7d8354de8123bbdfb9e6b0" kindref="member">PT_FLOWING_IMAGE</ref><sp/>||</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>neighbor-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa919711bca6bed2e6a9846e4dc91f3900" kindref="member">PT_HEADING_IMAGE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>left<sp/>=<sp/>neighbor-&gt;bounding_box().left();</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(left<sp/>&gt;<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>())<sp/>{</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>space<sp/>=<sp/><ref refid="ndminx_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(left<sp/>-<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>(),<sp/>part-&gt;space_to_right());</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;set_space_to_right(space);</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="638"><highlight class="normal"></highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>upper_part<sp/>=<sp/>part-&gt;SingletonPartner(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(upper_part)<sp/>{</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>space<sp/>=<sp/><ref refid="ndminx_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(0,<sp/>upper_part-&gt;bounding_box().bottom()<sp/>-</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;bounding_box().bottom());</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;set_space_above(space);</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>What<sp/>constitutes<sp/>a<sp/>good<sp/>value?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>0<sp/>is<sp/>the<sp/>default<sp/>value<sp/>when<sp/>not<sp/>set,<sp/>explicitly<sp/>noting<sp/>it<sp/>needs<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>be<sp/>something<sp/>else.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;set_space_above(<ref refid="host_8h_1aac62d87844689a18b6f5339a89ed6e7f" kindref="member">MAX_INT32</ref>);</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="650"><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>lower_part<sp/>=<sp/>part-&gt;SingletonPartner(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lower_part)<sp/>{</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>space<sp/>=<sp/><ref refid="ndminx_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(0,<sp/>part-&gt;bounding_box().bottom()<sp/>-</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lower_part-&gt;bounding_box().bottom());</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;set_space_below(space);</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>What<sp/>constitutes<sp/>a<sp/>good<sp/>value?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>0<sp/>is<sp/>the<sp/>default<sp/>value<sp/>when<sp/>not<sp/>set,<sp/>explicitly<sp/>noting<sp/>it<sp/>needs<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>be<sp/>something<sp/>else.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;set_space_below(<ref refid="host_8h_1aac62d87844689a18b6f5339a89ed6e7f" kindref="member">MAX_INT32</ref>);</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="663"><highlight class="normal">}</highlight></codeline>
<codeline lineno="664"><highlight class="normal"></highlight></codeline>
<codeline lineno="665"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Set<sp/>spacing<sp/>and<sp/>closest<sp/>neighbors<sp/>above<sp/>and<sp/>below<sp/>a<sp/>given<sp/>colpartition.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="666"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1ad6c2c9a0fdec2c14ef0ddc63a5d0217d" kindref="member">TableFinder::SetVerticalSpacing</ref>(ColPartition*<sp/>part)<sp/>{</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>box<sp/>=<sp/>part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>top_range<sp/>=<sp/><ref refid="ndminx_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>()<sp/>+<sp/><ref refid="namespacetesseract_1a00d83d0f6a701860dcf421bbbe283fef" kindref="member">kMaxVerticalSpacing</ref>,<sp/><ref refid="classtesseract_1_1_table_finder_1af994bc64825f51944fa63a0fc61b4e13" kindref="member">tright</ref>().<ref refid="class_i_c_o_o_r_d_1a66bba6ff8a5f060775e1c2ca511f7f29" kindref="member" tooltip="access_function ">y</ref>());</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bottom_range<sp/>=<sp/><ref refid="ndminx_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>()<sp/>-<sp/><ref refid="namespacetesseract_1a00d83d0f6a701860dcf421bbbe283fef" kindref="member">kMaxVerticalSpacing</ref>,<sp/><ref refid="classtesseract_1_1_table_finder_1afaa3f28f4a9e645ded90e9f74016b217" kindref="member">bleft</ref>().<ref refid="class_i_c_o_o_r_d_1a66bba6ff8a5f060775e1c2ca511f7f29" kindref="member" tooltip="access_function ">y</ref>());</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/>box.<ref refid="class_t_b_o_x_1a7f40dfd290a907200bdc98c196f63f45" kindref="member">set_top</ref>(top_range);</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/>box.<ref refid="class_t_b_o_x_1a6f803b24b046883cb0f3882dc3d92302" kindref="member">set_bottom</ref>(bottom_range);</highlight></codeline>
<codeline lineno="672"><highlight class="normal"></highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>part_box<sp/>=<sp/>part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Start<sp/>a<sp/>rect<sp/>search</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColPartition,<sp/>ColPartition_CLIST,<sp/>ColPartition_C_IT&gt;</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rectsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/>rectsearch.StartRectSearch(box);</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>neighbor;</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>min_space_above<sp/>=<sp/><ref refid="namespacetesseract_1a00d83d0f6a701860dcf421bbbe283fef" kindref="member">kMaxVerticalSpacing</ref>;</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>min_space_below<sp/>=<sp/><ref refid="namespacetesseract_1a00d83d0f6a701860dcf421bbbe283fef" kindref="member">kMaxVerticalSpacing</ref>;</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>above_neighbor<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>below_neighbor<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((neighbor<sp/>=<sp/>rectsearch.NextRectSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor<sp/>==<sp/>part)</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>neighbor_box<sp/>=<sp/>neighbor-&gt;bounding_box();</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor_box.<ref refid="class_t_b_o_x_1a9f7e4e20bdfeee0d82db2f8d24aa72dc" kindref="member">major_x_overlap</ref>(part_box))<sp/>{</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>gap<sp/>=<sp/>abs(part-&gt;median_bottom()<sp/>-<sp/>neighbor-&gt;median_bottom());</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>neighbor<sp/>is<sp/>below<sp/>current<sp/>partition</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor_box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>()<sp/>&lt;<sp/>part_box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>()<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gap<sp/>&lt;<sp/>min_space_below)<sp/>{</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_space_below<sp/>=<sp/>gap;</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>below_neighbor<sp/>=<sp/>neighbor;</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>neighbor<sp/>is<sp/>above<sp/>current<sp/>partition</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part_box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>()<sp/>&lt;<sp/>neighbor_box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>()<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gap<sp/>&lt;<sp/>min_space_above)<sp/>{</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_space_above<sp/>=<sp/>gap;</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>above_neighbor<sp/>=<sp/>neighbor;</highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/>part-&gt;set_space_above(min_space_above);</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/>part-&gt;set_space_below(min_space_below);</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/>part-&gt;set_nearest_neighbor_above(above_neighbor);</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/>part-&gt;set_nearest_neighbor_below(below_neighbor);</highlight></codeline>
<codeline lineno="706"><highlight class="normal">}</highlight></codeline>
<codeline lineno="707"><highlight class="normal"></highlight></codeline>
<codeline lineno="708"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Set<sp/>global<sp/>spacing<sp/>and<sp/>x-height<sp/>estimates</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="709"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a51c670936d76fcdf3ed1a0e2730a54c4" kindref="member">TableFinder::SetGlobalSpacings</ref>(ColPartitionGrid*<sp/>grid)<sp/>{</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>xheight_stats(0,<sp/><ref refid="namespacetesseract_1a00d83d0f6a701860dcf421bbbe283fef" kindref="member">kMaxVerticalSpacing</ref><sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>width_stats(0,<sp/><ref refid="namespacetesseract_1a83ac44e5e0c7348fd8591b3cba175dff" kindref="member">kMaxBlobWidth</ref><sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>ledding_stats(0,<sp/><ref refid="namespacetesseract_1a00d83d0f6a701860dcf421bbbe283fef" kindref="member">kMaxVerticalSpacing</ref><sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>the<sp/>ColPartitions<sp/>in<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><ref refid="namespacetesseract_1a990e3f25988f7d70c40a13225e645492" kindref="member">ColPartitionGridSearch</ref><sp/>gsearch(grid);</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/>gsearch.SetUniqueMode(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>HACK<sp/>HACK<sp/>HACK!<sp/>medians<sp/>are<sp/>equal<sp/>to<sp/>partition<sp/>length.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ComputeLimits<sp/>needs<sp/>to<sp/>get<sp/>called<sp/>somewhere<sp/>outside<sp/>of<sp/>TableFinder</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>to<sp/>make<sp/>sure<sp/>the<sp/>partitions<sp/>are<sp/>properly<sp/>initialized.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>When<sp/>this<sp/>is<sp/>called,<sp/>SmoothPartitionPartners<sp/>dies<sp/>in<sp/>an<sp/>assert<sp/>after</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>table<sp/>find<sp/>runs.<sp/>Alternative<sp/>solution.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>part-&gt;ComputeLimits();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;IsTextType())<sp/>{</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>xheight_stats.add(part-&gt;median_size(),<sp/>part-&gt;boxes_count());</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>width_stats.add(part-&gt;median_width(),<sp/>part-&gt;boxes_count());</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="728"><highlight class="normal"></highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>This<sp/>loop<sp/>can<sp/>be<sp/>removed<sp/>when<sp/>above<sp/>issues<sp/>are<sp/>fixed.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Replace<sp/>it<sp/>with<sp/>the<sp/>2<sp/>lines<sp/>commented<sp/>out<sp/>above.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>BLOBNBOX_C_IT<sp/>it(part-&gt;boxes());</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(it.mark_cycle_pt();<sp/>!it.cycled_list();<sp/>it.forward())<sp/>{</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xheight_stats.add(it.data()-&gt;bounding_box().height(),<sp/>1);</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>width_stats.add(it.data()-&gt;bounding_box().width(),<sp/>1);</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="736"><highlight class="normal"></highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ledding_stats.add(part-&gt;space_above(),<sp/>1);</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ledding_stats.add(part-&gt;space_below(),<sp/>1);</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Set<sp/>estimates<sp/>based<sp/>on<sp/>median<sp/>of<sp/>statistics<sp/>obtained</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a8be2bff4c272c65c0c4e896037620381" kindref="member">set_global_median_xheight</ref>(static_cast&lt;int&gt;(xheight_stats.median()<sp/>+<sp/>0.5));</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a793bbaf0945bb838b9c934899c4de87a" kindref="member">set_global_median_blob_width</ref>(static_cast&lt;int&gt;(width_stats.median()<sp/>+<sp/>0.5));</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aa5644866b8727722deec53b73c4d7831" kindref="member">set_global_median_ledding</ref>(static_cast&lt;int&gt;(ledding_stats.median()<sp/>+<sp/>0.5));</highlight></codeline>
<codeline lineno="745"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/>#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="746"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_tablefind_show_stats)<sp/>{</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>kWindowName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;X-height<sp/>(R),<sp/>X-width<sp/>(G),<sp/>and<sp/>ledding<sp/>(B)&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>stats_win<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1a1d45a058db096f6040af24af402b2042" kindref="member">MakeWindow</ref>(500,<sp/>10,<sp/>kWindowName);</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/>xheight_stats.plot(stats_win,<sp/>10,<sp/>200,<sp/>2,<sp/>15,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0959f7470b08ae1a38aa7e38fba29402" kindref="member">ScrollView::RED</ref>);</highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/>width_stats.plot(stats_win,<sp/>10,<sp/>200,<sp/>2,<sp/>15,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a9d8c87be486dead41d198d6b97a22174" kindref="member">ScrollView::GREEN</ref>);</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/>ledding_stats.plot(stats_win,<sp/>10,<sp/>200,<sp/>2,<sp/>15,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>);</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="753"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/>#endif<sp/><sp/>//<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="754"><highlight class="preprocessor"></highlight><highlight class="normal">}</highlight></codeline>
<codeline lineno="755"><highlight class="normal"></highlight></codeline>
<codeline lineno="756"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a8be2bff4c272c65c0c4e896037620381" kindref="member">TableFinder::set_global_median_xheight</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>xheight)<sp/>{</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1ab66e5e7382edbd8bc260fd5bca4f2914" kindref="member">global_median_xheight_</ref><sp/>=<sp/>xheight;</highlight></codeline>
<codeline lineno="758"><highlight class="normal">}</highlight></codeline>
<codeline lineno="759"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a793bbaf0945bb838b9c934899c4de87a" kindref="member">TableFinder::set_global_median_blob_width</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>width)<sp/>{</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/>global_median_blob_width_<sp/>=<sp/>width;</highlight></codeline>
<codeline lineno="761"><highlight class="normal">}</highlight></codeline>
<codeline lineno="762"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aa5644866b8727722deec53b73c4d7831" kindref="member">TableFinder::set_global_median_ledding</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>ledding)<sp/>{</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a1d5828695e17f10f2d4140476c9f34fd" kindref="member">global_median_ledding_</ref><sp/>=<sp/>ledding;</highlight></codeline>
<codeline lineno="764"><highlight class="normal">}</highlight></codeline>
<codeline lineno="765"><highlight class="normal"></highlight></codeline>
<codeline lineno="766"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1acfb82ae105ee34d1360dd0c5dc8487ff" kindref="member">TableFinder::FindNeighbors</ref>()<sp/>{</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><ref refid="namespacetesseract_1a990e3f25988f7d70c40a13225e645492" kindref="member">ColPartitionGridSearch</ref><sp/>gsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>Rename<sp/>this<sp/>function,<sp/>meaning<sp/>is<sp/>different<sp/>now.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>IT<sp/>is<sp/>finding<sp/>nearest<sp/>neighbors<sp/>its<sp/>own<sp/>way</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//SetVerticalSpacing(part);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="774"><highlight class="normal"></highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>upper<sp/>=<sp/>part-&gt;SingletonPartner(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(upper)</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;set_nearest_neighbor_above(upper);</highlight></codeline>
<codeline lineno="778"><highlight class="normal"></highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>lower<sp/>=<sp/>part-&gt;SingletonPartner(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lower)</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;set_nearest_neighbor_below(lower);</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="783"><highlight class="normal">}</highlight></codeline>
<codeline lineno="784"><highlight class="normal"></highlight></codeline>
<codeline lineno="785"><highlight class="normal"></highlight><highlight class="comment">//<sp/>High<sp/>level<sp/>interface.<sp/>Input<sp/>is<sp/>an<sp/>unmarked<sp/>ColPartitionGrid</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="786"><highlight class="normal"></highlight><highlight class="comment">//<sp/>(namely,<sp/>clean_part_grid_).<sp/>Partitions<sp/>are<sp/>identified<sp/>using<sp/>local</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="787"><highlight class="normal"></highlight><highlight class="comment">//<sp/>information<sp/>and<sp/>filter/smoothed.<sp/>The<sp/>function<sp/>exit<sp/>should<sp/>contain</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="788"><highlight class="normal"></highlight><highlight class="comment">//<sp/>a<sp/>good<sp/>sampling<sp/>of<sp/>the<sp/>table<sp/>partitions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="789"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a7f29dd0a40d57b00d4868ff1c656dd6a" kindref="member">TableFinder::MarkTablePartitions</ref>()<sp/>{</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aeb0fc1badeb2def5cf69aca53392c89c" kindref="member">MarkPartitionsUsingLocalInformation</ref>();</highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_tablefind_show_mark)<sp/>{</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>table_win<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1a1d45a058db096f6040af24af402b2042" kindref="member">MakeWindow</ref>(300,<sp/>300,<sp/></highlight><highlight class="stringliteral">&quot;Initial<sp/>Table<sp/>Partitions&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>);</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>,</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0ae903faf0b9c434a6cff979e51620f8" kindref="member">ScrollView::AQUAMARINE</ref>);</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a34734ff8fb23f8bfb88dc60e06cb2c17" kindref="member">FilterFalseAlarms</ref>();</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_tablefind_show_mark)<sp/>{</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>table_win<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1a1d45a058db096f6040af24af402b2042" kindref="member">MakeWindow</ref>(600,<sp/>300,<sp/></highlight><highlight class="stringliteral">&quot;Filtered<sp/>Table<sp/>Partitions&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>);</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>,</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0ae903faf0b9c434a6cff979e51620f8" kindref="member">ScrollView::AQUAMARINE</ref>);</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1ae3d5e2e4c894d4514717d0593792226d" kindref="member">SmoothTablePartitionRuns</ref>();</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_tablefind_show_mark)<sp/>{</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>table_win<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1a1d45a058db096f6040af24af402b2042" kindref="member">MakeWindow</ref>(900,<sp/>300,<sp/></highlight><highlight class="stringliteral">&quot;Smoothed<sp/>Table<sp/>Partitions&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>);</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>,</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0ae903faf0b9c434a6cff979e51620f8" kindref="member">ScrollView::AQUAMARINE</ref>);</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a34734ff8fb23f8bfb88dc60e06cb2c17" kindref="member">FilterFalseAlarms</ref>();</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_tablefind_show_mark<sp/>||<sp/>textord_show_tables)<sp/>{</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>table_win<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1a1d45a058db096f6040af24af402b2042" kindref="member">MakeWindow</ref>(900,<sp/>300,<sp/></highlight><highlight class="stringliteral">&quot;Final<sp/>Table<sp/>Partitions&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>);</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>,</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0ae903faf0b9c434a6cff979e51620f8" kindref="member">ScrollView::AQUAMARINE</ref>);</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="818"><highlight class="normal">}</highlight></codeline>
<codeline lineno="819"><highlight class="normal"></highlight></codeline>
<codeline lineno="820"><highlight class="normal"></highlight><highlight class="comment">//<sp/>These<sp/>types<sp/>of<sp/>partitions<sp/>are<sp/>marked<sp/>as<sp/>table<sp/>partitions:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="821"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>1-<sp/>Partitions<sp/>that<sp/>have<sp/>at<sp/>lease<sp/>one<sp/>large<sp/>gap<sp/>between<sp/>words</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="822"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>2-<sp/>Partitions<sp/>that<sp/>consist<sp/>of<sp/>only<sp/>one<sp/>word<sp/>(no<sp/>significant<sp/>gap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="823"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>between<sp/>components)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="824"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>3-<sp/>Partitions<sp/>that<sp/>vertically<sp/>overlap<sp/>with<sp/>other<sp/>partitions<sp/>within<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="825"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>same<sp/>column.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="826"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>4-<sp/>Partitions<sp/>with<sp/>leaders<sp/>before/after<sp/>them.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="827"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aeb0fc1badeb2def5cf69aca53392c89c" kindref="member">TableFinder::MarkPartitionsUsingLocalInformation</ref>()<sp/>{</highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>the<sp/>ColPartitions<sp/>in<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColPartition,<sp/>ColPartition_CLIST,<sp/>ColPartition_C_IT&gt;</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/>gsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!part-&gt;IsTextType())<sp/><sp/></highlight><highlight class="comment">//<sp/>Only<sp/>consider<sp/>text<sp/>partitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Only<sp/>consider<sp/>partitions<sp/>in<sp/>dominant<sp/>font<sp/>size<sp/>or<sp/>smaller</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;median_size()<sp/>&gt;<sp/><ref refid="namespacetesseract_1a12f077d41b2f5c668c1b25912b9b6244" kindref="member">kMaxTableCellXheight</ref><sp/>*<sp/><ref refid="classtesseract_1_1_table_finder_1ab66e5e7382edbd8bc260fd5bca4f2914" kindref="member">global_median_xheight_</ref>)</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Mark<sp/>partitions<sp/>with<sp/>a<sp/>large<sp/>gap,<sp/>or<sp/>no<sp/>significant<sp/>gap<sp/>as</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>table<sp/>partitions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Comments:<sp/>It<sp/>produces<sp/>several<sp/>false<sp/>alarms<sp/>at:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>last<sp/>line<sp/>of<sp/>a<sp/>paragraph<sp/>(fixed)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>single<sp/>word<sp/>section<sp/>headings</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>page<sp/>headers<sp/>and<sp/>footers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>numbered<sp/>equations</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/>-<sp/>line<sp/>drawing<sp/>regions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(faisal):<sp/>detect<sp/>and<sp/>fix<sp/>above-mentioned<sp/>cases</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classtesseract_1_1_table_finder_1a298f9f253a3fd3109133e6ea40842bc0" kindref="member">HasWideOrNoInterWordGap</ref>(part)<sp/>||</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a6436ad4194a19a38669a89b603c27801" kindref="member">HasLeaderAdjacent</ref>(*part))<sp/>{</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;set_table_type();</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="853"><highlight class="normal">}</highlight></codeline>
<codeline lineno="854"><highlight class="normal"></highlight></codeline>
<codeline lineno="855"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Check<sp/>if<sp/>the<sp/>partition<sp/>has<sp/>at<sp/>least<sp/>one<sp/>large<sp/>gap<sp/>between<sp/>words<sp/>or<sp/>no</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="856"><highlight class="normal"></highlight><highlight class="comment">//<sp/>significant<sp/>gap<sp/>at<sp/>all</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="857"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a298f9f253a3fd3109133e6ea40842bc0" kindref="member">TableFinder::HasWideOrNoInterWordGap</ref>(ColPartition*<sp/>part)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Should<sp/>only<sp/>get<sp/>text<sp/>partitions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref>(part-&gt;IsTextType());</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Blob<sp/>access</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/>BLOBNBOX_CLIST*<sp/>part_boxes<sp/>=<sp/>part-&gt;boxes();</highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/>BLOBNBOX_C_IT<sp/>it(part_boxes);</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Check<sp/>if<sp/>this<sp/>is<sp/>a<sp/>relatively<sp/>small<sp/>partition<sp/>(such<sp/>as<sp/>a<sp/>single<sp/>word)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;bounding_box().width()<sp/>&lt;</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacetesseract_1a3fe030812946d2ca16b873bde30d5431" kindref="member">kMinBoxesInTextPartition</ref><sp/>*<sp/>part-&gt;median_size()<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part_boxes-&gt;length()<sp/>&lt;<sp/><ref refid="namespacetesseract_1a3fe030812946d2ca16b873bde30d5431" kindref="member">kMinBoxesInTextPartition</ref>)</highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="868"><highlight class="normal"></highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Variables<sp/>used<sp/>to<sp/>compute<sp/>inter-blob<sp/>spacing.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>current_x0<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>current_x1<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>previous_x1<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Stores<sp/>the<sp/>maximum<sp/>gap<sp/>detected.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>largest_partition_gap_found<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Text<sp/>partition<sp/>gap<sp/>limits.<sp/>If<sp/>this<sp/>is<sp/>text<sp/>(and<sp/>not<sp/>a<sp/>table),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>there<sp/>should<sp/>be<sp/>at<sp/>least<sp/>one<sp/>gap<sp/>larger<sp/>than<sp/>min_gap<sp/>and<sp/>no<sp/>gap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>larger<sp/>than<sp/>max_gap.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>max_gap<sp/>=<sp/><ref refid="namespacetesseract_1a632cb2dd79696389be8feb970de28e3e" kindref="member">kMaxGapInTextPartition</ref><sp/>*<sp/>part-&gt;median_size();</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>min_gap<sp/>=<sp/><ref refid="namespacetesseract_1a25dab2777976176c8de47ef2fb5b74a5" kindref="member">kMinMaxGapInTextPartition</ref><sp/>*<sp/>part-&gt;median_size();</highlight></codeline>
<codeline lineno="880"><highlight class="normal"></highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(it.mark_cycle_pt();<sp/>!it.cycled_list();<sp/>it.forward())<sp/>{</highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>*<sp/>blob<sp/>=<sp/>it.data();</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/>current_x0<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>();</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/>current_x1<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>();</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(previous_x1<sp/>!=<sp/>-1)<sp/>{</highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>gap<sp/>=<sp/>current_x0<sp/>-<sp/>previous_x1;</highlight></codeline>
<codeline lineno="887"><highlight class="normal"></highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>Boxes<sp/>may<sp/>overlap?<sp/>Huh?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>For<sp/>example,<sp/>mag.3B<sp/>8003_033.3B.tif<sp/>in<sp/>UNLV<sp/>data.<sp/>The<sp/>titles/authors</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>on<sp/>the<sp/>top<sp/>right<sp/>of<sp/>the<sp/>page<sp/>are<sp/>filtered<sp/>out<sp/>with<sp/>this<sp/>line.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Note<sp/>2:<sp/>Iterating<sp/>over<sp/>blobs<sp/>in<sp/>a<sp/>partition,<sp/>so<sp/>we<sp/>are<sp/>looking<sp/>for</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>spacing<sp/>between<sp/>the<sp/>words.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(gap<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>More<sp/>likely<sp/>case,<sp/>the<sp/>blobs<sp/>slightly<sp/>overlap.<sp/>This<sp/>can<sp/>happen</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>with<sp/>diacritics<sp/>(accents)<sp/>or<sp/>broken<sp/>alphabet<sp/>symbols<sp/>(characters).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Merge<sp/>boxes<sp/>together<sp/>by<sp/>taking<sp/>max<sp/>of<sp/>right<sp/>sides.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(-gap<sp/>&lt;<sp/>part-&gt;median_size()<sp/>*<sp/><ref refid="namespacetesseract_1af7577bf68e7e1466e0d58eb91ad999c6" kindref="member">kMaxBlobOverlapFactor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>previous_x1<sp/>=<sp/><ref refid="ndminx_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(previous_x1,<sp/>current_x1);</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Extreme<sp/>case,<sp/>blobs<sp/>overlap<sp/>significantly<sp/>in<sp/>the<sp/>same<sp/>partition...</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>This<sp/>should<sp/>not<sp/>happen<sp/>often<sp/>(if<sp/>at<sp/>all),<sp/>but<sp/>it<sp/>does.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>investigate<sp/>cases<sp/>when<sp/>this<sp/>happens.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>behavior<sp/>before<sp/>was<sp/>to<sp/>completely<sp/>ignore<sp/>this<sp/>case.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="908"><highlight class="normal"></highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>a<sp/>large<sp/>enough<sp/>gap<sp/>is<sp/>found,<sp/>mark<sp/>it<sp/>as<sp/>a<sp/>table<sp/>cell<sp/>(return<sp/>true)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(gap<sp/>&gt;<sp/>max_gap)</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(gap<sp/>&gt;<sp/>largest_partition_gap_found)</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>largest_partition_gap_found<sp/>=<sp/>gap;</highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/>previous_x1<sp/>=<sp/>current_x1;</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Since<sp/>no<sp/>large<sp/>gap<sp/>was<sp/>found,<sp/>return<sp/>false<sp/>if<sp/>the<sp/>partition<sp/>is<sp/>too</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>long<sp/>to<sp/>be<sp/>a<sp/>data<sp/>cell</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;bounding_box().width()<sp/>&gt;</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacetesseract_1ac2d16b5be5214a804964b939c8111bc7" kindref="member">kMaxBoxesInDataPartition</ref><sp/>*<sp/>part-&gt;median_size()<sp/>||</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part_boxes-&gt;length()<sp/>&gt;<sp/><ref refid="namespacetesseract_1ac2d16b5be5214a804964b939c8111bc7" kindref="member">kMaxBoxesInDataPartition</ref>)</highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="923"><highlight class="normal"></highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>A<sp/>partition<sp/>may<sp/>be<sp/>a<sp/>single<sp/>blob.<sp/>In<sp/>this<sp/>case,<sp/>it&apos;s<sp/>an<sp/>isolated<sp/>symbol</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>or<sp/>non-text<sp/>(such<sp/>as<sp/>a<sp/>ruling<sp/>or<sp/>image).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Detect<sp/>these<sp/>as<sp/>table<sp/>partitions?<sp/>Shouldn&apos;t<sp/>this<sp/>be<sp/>case<sp/>by<sp/>case?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>behavior<sp/>before<sp/>was<sp/>to<sp/>ignore<sp/>this,<sp/>making<sp/>max_partition_gap<sp/>&lt;<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>and<sp/>implicitly<sp/>return<sp/>true.<sp/>Just<sp/>making<sp/>it<sp/>explicit.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(largest_partition_gap_found<sp/>==<sp/>-1)</highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="931"><highlight class="normal"></highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>return<sp/>true<sp/>if<sp/>the<sp/>maximum<sp/>gap<sp/>found<sp/>is<sp/>smaller<sp/>than<sp/>the<sp/>minimum<sp/>allowed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>max_gap<sp/>in<sp/>a<sp/>text<sp/>partition.<sp/>This<sp/>indicates<sp/>that<sp/>there<sp/>is<sp/>no<sp/>signficant</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>space<sp/>in<sp/>the<sp/>partition,<sp/>hence<sp/>it<sp/>is<sp/>likely<sp/>a<sp/>single<sp/>word.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>largest_partition_gap_found<sp/>&lt;<sp/>min_gap;</highlight></codeline>
<codeline lineno="936"><highlight class="normal">}</highlight></codeline>
<codeline lineno="937"><highlight class="normal"></highlight></codeline>
<codeline lineno="938"><highlight class="normal"></highlight><highlight class="comment">//<sp/>A<sp/>criteria<sp/>for<sp/>possible<sp/>tables<sp/>is<sp/>that<sp/>a<sp/>table<sp/>may<sp/>have<sp/>leaders</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="939"><highlight class="normal"></highlight><highlight class="comment">//<sp/>between<sp/>data<sp/>cells.<sp/>An<sp/>aggressive<sp/>solution<sp/>to<sp/>find<sp/>such<sp/>tables<sp/>is<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="940"><highlight class="normal"></highlight><highlight class="comment">//<sp/>explicitly<sp/>mark<sp/>partitions<sp/>that<sp/>have<sp/>adjacent<sp/>leaders.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="941"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Note<sp/>that<sp/>this<sp/>includes<sp/>overlapping<sp/>leaders.<sp/>However,<sp/>it<sp/>does<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="942"><highlight class="normal"></highlight><highlight class="comment">//<sp/>include<sp/>leaders<sp/>in<sp/>different<sp/>columns<sp/>on<sp/>the<sp/>page.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="943"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Possible<sp/>false-positive<sp/>will<sp/>include<sp/>lists,<sp/>such<sp/>as<sp/>a<sp/>table<sp/>of<sp/>contents.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="944"><highlight class="normal"></highlight><highlight class="comment">//<sp/>As<sp/>these<sp/>arise,<sp/>the<sp/>agressive<sp/>nature<sp/>of<sp/>this<sp/>search<sp/>may<sp/>need<sp/>to<sp/>be</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="945"><highlight class="normal"></highlight><highlight class="comment">//<sp/>trimmed<sp/>down.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="946"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a6436ad4194a19a38669a89b603c27801" kindref="member">TableFinder::HasLeaderAdjacent</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>ColPartition&amp;<sp/>part)<sp/>{</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part.flow()<sp/>==<sp/><ref refid="blobbox_8h_1aa72f1499398e9694bf46752e1cc895e1a64e3e70c4fac4d4e3facdb4638307d7f" kindref="member">BTFT_LEADER</ref>)</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Search<sp/>range<sp/>is<sp/>left<sp/>and<sp/>right<sp/>bounded<sp/>by<sp/>an<sp/>offset<sp/>of<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>median<sp/>xheight.<sp/>This<sp/>offset<sp/>is<sp/>to<sp/>allow<sp/>some<sp/>tolerance<sp/>to<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>leaders<sp/>on<sp/>the<sp/>page<sp/>in<sp/>the<sp/>event<sp/>that<sp/>the<sp/>alignment<sp/>is<sp/>still</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>a<sp/>bit<sp/>off.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box<sp/>=<sp/>part.bounding_box();</highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>search_size<sp/>=<sp/><ref refid="namespacetesseract_1a7c23a9af9374381d1a961227ce653ea6" kindref="member">kAdjacentLeaderSearchPadding</ref><sp/>*<sp/><ref refid="classtesseract_1_1_table_finder_1ab66e5e7382edbd8bc260fd5bca4f2914" kindref="member">global_median_xheight_</ref>;</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>top<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>()<sp/>+<sp/>search_size;</highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bottom<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>()<sp/>-<sp/>search_size;</highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><ref refid="namespacetesseract_1a990e3f25988f7d70c40a13225e645492" kindref="member">ColPartitionGridSearch</ref><sp/>hsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>);</highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="vecfuncs_8cpp_1a57d4a186a22b01e2110793bc22a5d8f0" kindref="member">direction</ref><sp/>=<sp/>0;<sp/><ref refid="vecfuncs_8cpp_1a57d4a186a22b01e2110793bc22a5d8f0" kindref="member">direction</ref><sp/>&lt;<sp/>2;<sp/>++<ref refid="vecfuncs_8cpp_1a57d4a186a22b01e2110793bc22a5d8f0" kindref="member">direction</ref>)<sp/>{</highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>right_to_left<sp/>=<sp/>(<ref refid="vecfuncs_8cpp_1a57d4a186a22b01e2110793bc22a5d8f0" kindref="member">direction</ref><sp/>==<sp/>0);</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x<sp/>=<sp/>right_to_left<sp/>?<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>()<sp/>:<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>();</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/>hsearch.StartSideSearch(x,<sp/>bottom,<sp/>top);</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>leader<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((leader<sp/>=<sp/>hsearch.NextSideSearch(right_to_left))<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>This<sp/>should<sp/>not<sp/>happen,<sp/>they<sp/>are<sp/>in<sp/>different<sp/>grids.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref>(&amp;part<sp/>!=<sp/>leader);</highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>leader<sp/>could<sp/>be<sp/>a<sp/>horizontal<sp/>ruling<sp/>in<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Make<sp/>sure<sp/>it<sp/>is<sp/>actually<sp/>a<sp/>leader.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(leader-&gt;flow()<sp/>!=<sp/><ref refid="blobbox_8h_1aa72f1499398e9694bf46752e1cc895e1a64e3e70c4fac4d4e3facdb4638307d7f" kindref="member">BTFT_LEADER</ref>)</highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Make<sp/>sure<sp/>the<sp/>leader<sp/>shares<sp/>a<sp/>page<sp/>column<sp/>with<sp/>the<sp/>partition,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>otherwise<sp/>we<sp/>are<sp/>spreading<sp/>across<sp/>columns.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!part.IsInSameColumnAs(*leader))</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>There<sp/>should<sp/>be<sp/>a<sp/>significant<sp/>vertical<sp/>overlap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!leader-&gt;VSignificantCoreOverlap(part))</highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Leader<sp/>passed<sp/>all<sp/>tests,<sp/>so<sp/>it<sp/>is<sp/>adjacent.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>No<sp/>leaders<sp/>are<sp/>adjacent<sp/>to<sp/>the<sp/>given<sp/>partition.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="983"><highlight class="normal">}</highlight></codeline>
<codeline lineno="984"><highlight class="normal"></highlight></codeline>
<codeline lineno="985"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Filter<sp/>individual<sp/>text<sp/>partitions<sp/>marked<sp/>as<sp/>table<sp/>partitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="986"><highlight class="normal"></highlight><highlight class="comment">//<sp/>consisting<sp/>of<sp/>paragraph<sp/>endings,<sp/>small<sp/>section<sp/>headings,<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="987"><highlight class="normal"></highlight><highlight class="comment">//<sp/>headers<sp/>and<sp/>footers.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="988"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a34734ff8fb23f8bfb88dc60e06cb2c17" kindref="member">TableFinder::FilterFalseAlarms</ref>()<sp/>{</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a5c5163764f1df032be42c7cf953c2ade" kindref="member">FilterParagraphEndings</ref>();</highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a28ab83ed3531ee5fd7c5608c2ec22de4" kindref="member">FilterHeaderAndFooter</ref>();</highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>Fully<sp/>justified<sp/>text<sp/>as<sp/>non-table?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="992"><highlight class="normal">}</highlight></codeline>
<codeline lineno="993"><highlight class="normal"></highlight></codeline>
<codeline lineno="994"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a5c5163764f1df032be42c7cf953c2ade" kindref="member">TableFinder::FilterParagraphEndings</ref>()<sp/>{</highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Detect<sp/>last<sp/>line<sp/>of<sp/>paragraph</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>the<sp/>ColPartitions<sp/>in<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><ref refid="namespacetesseract_1a990e3f25988f7d70c40a13225e645492" kindref="member">ColPartitionGridSearch</ref><sp/>gsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;type()<sp/>!=<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref>)</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Consider<sp/>only<sp/>table<sp/>partitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1003"><highlight class="normal"></highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Paragraph<sp/>ending<sp/>should<sp/>have<sp/>flowing<sp/>text<sp/>above<sp/>it.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>upper_part<sp/>=<sp/>part-&gt;nearest_neighbor_above();</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!upper_part)</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(upper_part-&gt;type()<sp/>!=<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677faaa63d8d8a99ddc2b3957f8e8787b4eca" kindref="member">PT_FLOWING_TEXT</ref>)</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(upper_part-&gt;bounding_box().width()<sp/>&lt;</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2<sp/>*<sp/>part-&gt;bounding_box().width())</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Check<sp/>if<sp/>its<sp/>the<sp/>last<sp/>line<sp/>of<sp/>a<sp/>paragraph.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>In<sp/>most<sp/>cases,<sp/>a<sp/>paragraph<sp/>ending<sp/>should<sp/>be<sp/>left-aligned<sp/>to<sp/>text<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>above<sp/>it.<sp/>Sometimes,<sp/>it<sp/>could<sp/>be<sp/>a<sp/>2<sp/>line<sp/>paragraph,<sp/>in<sp/>which<sp/>case</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>line<sp/>above<sp/>it<sp/>is<sp/>indented.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>To<sp/>account<sp/>for<sp/>that,<sp/>check<sp/>if<sp/>the<sp/>partition<sp/>center<sp/>is<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>left<sp/>of<sp/>the<sp/>one<sp/>above<sp/>it.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mid<sp/>=<sp/>(part-&gt;bounding_box().left()<sp/>+<sp/>part-&gt;bounding_box().right())<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>upper_mid<sp/>=<sp/>(upper_part-&gt;bounding_box().left()<sp/>+</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upper_part-&gt;bounding_box().right())<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>current_spacing<sp/>=<sp/>0;<sp/><sp/></highlight><highlight class="comment">//<sp/>spacing<sp/>of<sp/>the<sp/>current<sp/>line<sp/>to<sp/>margin</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>upper_spacing<sp/>=<sp/>0;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>spacing<sp/>of<sp/>the<sp/>previous<sp/>line<sp/>to<sp/>the<sp/>margin</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classtesseract_1_1_table_finder_1a528595d792a34a2a361670aced196165" kindref="member">left_to_right_language_</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Left<sp/>to<sp/>right<sp/>languages,<sp/>use<sp/>mid<sp/>-<sp/>left<sp/>to<sp/>figure<sp/>out<sp/>the<sp/>distance</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>middle<sp/>is<sp/>from<sp/>the<sp/>left<sp/>margin.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>left<sp/>=<sp/><ref refid="ndminx_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(part-&gt;bounding_box().left(),</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upper_part-&gt;bounding_box().left());</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>current_spacing<sp/>=<sp/>mid<sp/>-<sp/>left;</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>upper_spacing<sp/>=<sp/>upper_mid<sp/>-<sp/>left;</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Right<sp/>to<sp/>left<sp/>languages,<sp/>use<sp/>right<sp/>-<sp/>mid<sp/>to<sp/>figure<sp/>out<sp/>the<sp/>distance</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>middle<sp/>is<sp/>from<sp/>the<sp/>right<sp/>margin.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>right<sp/>=<sp/><ref refid="ndminx_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(part-&gt;bounding_box().right(),</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upper_part-&gt;bounding_box().right());</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>current_spacing<sp/>=<sp/>right<sp/>-<sp/>mid;</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>upper_spacing<sp/>=<sp/>right<sp/>-<sp/>upper_mid;</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(current_spacing<sp/>*<sp/><ref refid="namespacetesseract_1ac6a1849ed370a22bb4a2b4a94ca1634c" kindref="member">kParagraphEndingPreviousLineRatio</ref><sp/>&gt;<sp/>upper_spacing)</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"></highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Paragraphs<sp/>should<sp/>have<sp/>similar<sp/>fonts.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!part-&gt;MatchingSizes(*upper_part)<sp/>||</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!part-&gt;MatchingStrokeWidth(*upper_part,<sp/><ref refid="namespacetesseract_1a477fb9ba9844da49a285692762b117d9" kindref="member">kStrokeWidthFractionalTolerance</ref>,</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacetesseract_1a7dc74940f73222c81918e8701c301516" kindref="member">kStrokeWidthConstantTolerance</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1048"><highlight class="normal"></highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>last<sp/>line<sp/>of<sp/>a<sp/>paragraph<sp/>should<sp/>be<sp/>left<sp/>aligned.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>This<sp/>would<sp/>be<sp/>untrue<sp/>if<sp/>the<sp/>text<sp/>was<sp/>right<sp/>aligned.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>How<sp/>often<sp/>is<sp/>that?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;space_to_left()<sp/>&gt;</highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacetesseract_1a1b76b5479d00c222f8a17e22d317b770" kindref="member">kMaxParagraphEndingLeftSpaceMultiple</ref><sp/>*<sp/>part-&gt;median_size())</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>line<sp/>above<sp/>it<sp/>should<sp/>be<sp/>right<sp/>aligned<sp/>(assuming<sp/>justified<sp/>format).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Since<sp/>we<sp/>can&apos;t<sp/>assume<sp/>justified<sp/>text,<sp/>we<sp/>compare<sp/>whitespace<sp/>to<sp/>text.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>above<sp/>line<sp/>should<sp/>have<sp/>majority<sp/>spanning<sp/>text<sp/>(or<sp/>the<sp/>current</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>line<sp/>could<sp/>have<sp/>fit<sp/>on<sp/>the<sp/>previous<sp/>line).<sp/>So<sp/>compare</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1059"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>whitespace<sp/>to<sp/>text.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(upper_part-&gt;bounding_box().width()<sp/>&lt;</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacetesseract_1a59fff4582ea32f8a8661fbc20a3ab947" kindref="member">kMinParagraphEndingTextToWhitespaceRatio</ref><sp/>*<sp/>upper_part-&gt;space_to_right())</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"></highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Ledding<sp/>above<sp/>the<sp/>line<sp/>should<sp/>be<sp/>less<sp/>than<sp/>ledding<sp/>below</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;space_above()<sp/>&gt;=<sp/>part-&gt;space_below()<sp/>||</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;space_above()<sp/>&gt;<sp/>2<sp/>*<sp/><ref refid="classtesseract_1_1_table_finder_1a1d5828695e17f10f2d4140476c9f34fd" kindref="member">global_median_ledding_</ref>)</highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1068"><highlight class="normal"></highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>all<sp/>checks<sp/>failed,<sp/>it<sp/>is<sp/>probably<sp/>text.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/>part-&gt;clear_table_type();</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1072"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"></highlight></codeline>
<codeline lineno="1074"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a28ab83ed3531ee5fd7c5608c2ec22de4" kindref="member">TableFinder::FilterHeaderAndFooter</ref>()<sp/>{</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Consider<sp/>top-most<sp/>text<sp/>colpartition<sp/>as<sp/>header<sp/>and<sp/>bottom<sp/>most<sp/>as<sp/>footer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>header<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>footer<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>max_top<sp/>=<sp/><ref refid="host_8h_1ae6f88d5bb15e97510f484289f2fc89fd" kindref="member">MIN_INT32</ref>;</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>min_bottom<sp/>=<sp/><ref refid="host_8h_1aac62d87844689a18b6f5339a89ed6e7f" kindref="member">MAX_INT32</ref>;</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><ref refid="namespacetesseract_1a990e3f25988f7d70c40a13225e645492" kindref="member">ColPartitionGridSearch</ref><sp/>gsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!part-&gt;IsTextType())</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Consider<sp/>only<sp/>text<sp/>partitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>top<sp/>=<sp/>part-&gt;bounding_box().top();</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bottom<sp/>=<sp/>part-&gt;bounding_box().bottom();</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(top<sp/>&gt;<sp/>max_top)<sp/>{</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>max_top<sp/>=<sp/>top;</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>header<sp/>=<sp/>part;</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bottom<sp/>&lt;<sp/>min_bottom)<sp/>{</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>min_bottom<sp/>=<sp/>bottom;</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>footer<sp/>=<sp/>part;</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(header)</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/>header-&gt;clear_table_type();</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(footer)</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/>footer-&gt;clear_table_type();</highlight></codeline>
<codeline lineno="1101"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"></highlight></codeline>
<codeline lineno="1103"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Mark<sp/>all<sp/>ColPartitions<sp/>as<sp/>table<sp/>cells<sp/>that<sp/>have<sp/>a<sp/>table<sp/>cell<sp/>above</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1104"><highlight class="normal"></highlight><highlight class="comment">//<sp/>and<sp/>below<sp/>them</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1105"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO(faisal):<sp/>This<sp/>is<sp/>too<sp/>aggressive<sp/>at<sp/>the<sp/>moment.<sp/>The<sp/>method<sp/>needs<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1106"><highlight class="normal"></highlight><highlight class="comment">//<sp/>consider<sp/>spacing<sp/>and<sp/>alignment<sp/>as<sp/>well.<sp/>Detection<sp/>of<sp/>false<sp/>alarm<sp/>table<sp/>cells</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1107"><highlight class="normal"></highlight><highlight class="comment">//<sp/>should<sp/>also<sp/>be<sp/>done<sp/>as<sp/>part<sp/>of<sp/>it.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1108"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1ae3d5e2e4c894d4514717d0593792226d" kindref="member">TableFinder::SmoothTablePartitionRuns</ref>()<sp/>{</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>the<sp/>ColPartitions<sp/>in<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><ref refid="namespacetesseract_1a990e3f25988f7d70c40a13225e645492" kindref="member">ColPartitionGridSearch</ref><sp/>gsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;type()<sp/>&gt;=<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref><sp/>||<sp/>part-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fac0b3cd1b4592e1a3c609ff4273fb505b" kindref="member">PT_UNKNOWN</ref>)</highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Consider<sp/>only<sp/>text<sp/>partitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>upper_part<sp/>=<sp/>part-&gt;nearest_neighbor_above();</highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>lower_part<sp/>=<sp/>part-&gt;nearest_neighbor_below();</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!upper_part<sp/>||<sp/>!lower_part)</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(upper_part-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref><sp/>&amp;&amp;<sp/>lower_part-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref>)</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;set_table_type();</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"></highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Pass<sp/>2,<sp/>do<sp/>the<sp/>opposite.<sp/>If<sp/>both<sp/>the<sp/>upper<sp/>and<sp/>lower<sp/>neighbors</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>exist<sp/>and<sp/>are<sp/>not<sp/>tables,<sp/>this<sp/>probably<sp/>shouldn&apos;t<sp/>be<sp/>a<sp/>table.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;type()<sp/>!=<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref>)</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Consider<sp/>only<sp/>text<sp/>partitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>upper_part<sp/>=<sp/>part-&gt;nearest_neighbor_above();</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>lower_part<sp/>=<sp/>part-&gt;nearest_neighbor_below();</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"></highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>table<sp/>can&apos;t<sp/>be<sp/>by<sp/>itself</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((upper_part<sp/>&amp;&amp;<sp/>upper_part-&gt;type()<sp/>!=<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref>)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(lower_part<sp/>&amp;&amp;<sp/>lower_part-&gt;type()<sp/>!=<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;clear_table_type();</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1140"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1141"><highlight class="normal"></highlight></codeline>
<codeline lineno="1142"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Set<sp/>the<sp/>type<sp/>of<sp/>a<sp/>column<sp/>segment<sp/>based<sp/>on<sp/>the<sp/>ratio<sp/>of<sp/>table<sp/>to<sp/>text<sp/>cells</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1143"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1ac3e8a6d03fcaf027677919f284af6500" kindref="member">TableFinder::SetColumnsType</ref>(ColSegment_LIST*<sp/>column_blocks)<sp/>{</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/>ColSegment_IT<sp/>it(column_blocks);</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(it.mark_cycle_pt();<sp/>!it.cycled_list();<sp/>it.forward())<sp/>{</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/>ColSegment*<sp/>seg<sp/>=<sp/>it.data();</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>box<sp/>=<sp/>seg-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_table_cells<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_text_cells<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/>GridSearch&lt;ColPartition,<sp/>ColPartition_CLIST,<sp/>ColPartition_C_IT&gt;</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/>rsearch.SetUniqueMode(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/>rsearch.StartRectSearch(box);</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>rsearch.NextRectSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>num_table_cells++;</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677faaa63d8d8a99ddc2b3957f8e8787b4eca" kindref="member">PT_FLOWING_TEXT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>num_text_cells++;</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>a<sp/>column<sp/>block<sp/>has<sp/>no<sp/>text<sp/>or<sp/>table<sp/>partition<sp/>in<sp/>it,<sp/>it<sp/>is<sp/>not<sp/>needed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>for<sp/>table<sp/>detection.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!num_table_cells<sp/>&amp;&amp;<sp/>!num_text_cells)<sp/>{</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>it.extract();</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;set_num_table_cells(num_table_cells);</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;set_num_text_cells(num_text_cells);</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>column<sp/>type<sp/>based<sp/>on<sp/>the<sp/>ratio<sp/>of<sp/>table<sp/>to<sp/>text<sp/>cells</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;set_type();</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1173"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"></highlight></codeline>
<codeline lineno="1175"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Move<sp/>column<sp/>blocks<sp/>to<sp/>grid</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1176"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a81003bea37eced8d746035bd565b9c56" kindref="member">TableFinder::MoveColSegmentsToGrid</ref>(ColSegment_LIST<sp/>*segments,</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacetesseract_1a80cfbd9a83df02629e2afd48c16880f0" kindref="member">ColSegmentGrid</ref><sp/>*col_seg_grid)<sp/>{</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/>ColSegment_IT<sp/>it(segments);</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(it.mark_cycle_pt();<sp/>!it.cycled_list();<sp/>it.forward())<sp/>{</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/>ColSegment*<sp/>seg<sp/>=<sp/>it.extract();</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/>col_seg_grid-&gt;InsertBBox(</highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>seg);</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1183"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"></highlight></codeline>
<codeline lineno="1185"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Merge<sp/>column<sp/>blocks<sp/>if<sp/>a<sp/>split<sp/>is<sp/>detected<sp/>due<sp/>to<sp/>the<sp/>presence<sp/>of<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1186"><highlight class="normal"></highlight><highlight class="comment">//<sp/>table.<sp/>A<sp/>text<sp/>block<sp/>is<sp/>considered<sp/>split<sp/>if<sp/>it<sp/>has<sp/>multiple</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1187"><highlight class="normal"></highlight><highlight class="comment">//<sp/>neighboring<sp/>blocks<sp/>above/below<sp/>it,<sp/>and<sp/>at<sp/>least<sp/>one<sp/>of<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1188"><highlight class="normal"></highlight><highlight class="comment">//<sp/>neighboring<sp/>blocks<sp/>is<sp/>of<sp/>table<sp/>type<sp/>(has<sp/>a<sp/>high<sp/>density<sp/>of<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1189"><highlight class="normal"></highlight><highlight class="comment">//<sp/>partitions).<sp/>In<sp/>this<sp/>case<sp/>neighboring<sp/>blocks<sp/>in<sp/>the<sp/>direction</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1190"><highlight class="normal"></highlight><highlight class="comment">//<sp/>(above/below)<sp/>of<sp/>the<sp/>table<sp/>block<sp/>are<sp/>merged<sp/>with<sp/>the<sp/>text<sp/>block.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1191"><highlight class="normal"></highlight></codeline>
<codeline lineno="1192"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Comment:<sp/>This<sp/>method<sp/>does<sp/>not<sp/>handle<sp/>split<sp/>due<sp/>to<sp/>a<sp/>full<sp/>page<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1193"><highlight class="normal"></highlight><highlight class="comment">//<sp/>since<sp/>table<sp/>columns<sp/>in<sp/>this<sp/>case<sp/>do<sp/>not<sp/>have<sp/>a<sp/>text<sp/>column<sp/>on<sp/>which</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1194"><highlight class="normal"></highlight><highlight class="comment">//<sp/>split<sp/>decision<sp/>can<sp/>be<sp/>based.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1195"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a7a3319f9a1eab06ef83a6e3f2df7e8d2" kindref="member">TableFinder::GridMergeColumnBlocks</ref>()<sp/>{</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>margin<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1aecbfe718794e99b2f15a43a7f7350848" kindref="member">gridsize</ref>();</highlight></codeline>
<codeline lineno="1197"><highlight class="normal"></highlight></codeline>
<codeline lineno="1198"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>the<sp/>Column<sp/>Blocks<sp/>in<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1199"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColSegment,<sp/>ColSegment_CLIST,<sp/>ColSegment_C_IT&gt;</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/>gsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1a94f0570afcc478097685ccdb59928903" kindref="member">col_seg_grid_</ref>);</highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/>ColSegment*<sp/>seg;</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((seg<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(seg-&gt;type()<sp/>!=<sp/><ref refid="namespacetesseract_1a25254b3df45454565d58a62480d3a6cba05d5fe5bf814b3e82827a3a321d5b2ec" kindref="member">COL_TEXT</ref>)</highlight></codeline>
<codeline lineno="1205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>only<sp/>consider<sp/>text<sp/>blocks<sp/>for<sp/>split<sp/>detection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>neighbor_found<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>modified<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Modified<sp/>at<sp/>least<sp/>once</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>keep<sp/>expanding<sp/>current<sp/>box<sp/>as<sp/>long<sp/>as<sp/>neighboring<sp/>table<sp/>columns</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>are<sp/>found<sp/>above<sp/>or<sp/>below<sp/>it.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>box<sp/>=<sp/>seg-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>slightly<sp/>expand<sp/>the<sp/>search<sp/>region<sp/>vertically</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>top_range<sp/>=<sp/><ref refid="ndminx_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>()<sp/>+<sp/>margin,<sp/><ref refid="classtesseract_1_1_table_finder_1af994bc64825f51944fa63a0fc61b4e13" kindref="member">tright</ref>().<ref refid="class_i_c_o_o_r_d_1a66bba6ff8a5f060775e1c2ca511f7f29" kindref="member" tooltip="access_function ">y</ref>());</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bottom_range<sp/>=<sp/><ref refid="ndminx_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>()<sp/>-<sp/>margin,<sp/><ref refid="classtesseract_1_1_table_finder_1afaa3f28f4a9e645ded90e9f74016b217" kindref="member">bleft</ref>().<ref refid="class_i_c_o_o_r_d_1a66bba6ff8a5f060775e1c2ca511f7f29" kindref="member" tooltip="access_function ">y</ref>());</highlight></codeline>
<codeline lineno="1215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>box.<ref refid="class_t_b_o_x_1a7f40dfd290a907200bdc98c196f63f45" kindref="member">set_top</ref>(top_range);</highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>box.<ref refid="class_t_b_o_x_1a6f803b24b046883cb0f3882dc3d92302" kindref="member">set_bottom</ref>(bottom_range);</highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>neighbor_found<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>GridSearch&lt;ColSegment,<sp/>ColSegment_CLIST,<sp/>ColSegment_C_IT&gt;</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rectsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1a94f0570afcc478097685ccdb59928903" kindref="member">col_seg_grid_</ref>);</highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rectsearch.StartRectSearch(box);</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ColSegment*<sp/>neighbor<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((neighbor<sp/>=<sp/>rectsearch.NextRectSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor<sp/>==<sp/>seg)</highlight></codeline>
<codeline lineno="1224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>neighbor_box<sp/>=<sp/>neighbor-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>the<sp/>neighbor<sp/>box<sp/>significantly<sp/>overlaps<sp/>with<sp/>the<sp/>current</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>box<sp/>(due<sp/>to<sp/>the<sp/>expansion<sp/>of<sp/>the<sp/>current<sp/>box<sp/>in<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>previous<sp/>iteration<sp/>of<sp/>this<sp/>loop),<sp/>remove<sp/>the<sp/>neighbor<sp/>box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>and<sp/>expand<sp/>the<sp/>current<sp/>box<sp/>to<sp/>include<sp/>it.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor_box.<ref refid="class_t_b_o_x_1a9e8d88530048135be86afb906ff9dd74" kindref="member">overlap_fraction</ref>(box)<sp/>&gt;=<sp/>0.9)<sp/>{</highlight></codeline>
<codeline lineno="1231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;InsertBox(neighbor_box);</highlight></codeline>
<codeline lineno="1232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modified<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rectsearch.RemoveBBox();</highlight></codeline>
<codeline lineno="1234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gsearch.RepositionIterator();</highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>neighbor;</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Only<sp/>expand<sp/>if<sp/>the<sp/>neighbor<sp/>box<sp/>is<sp/>of<sp/>table<sp/>type</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor-&gt;type()<sp/>!=<sp/><ref refid="namespacetesseract_1a25254b3df45454565d58a62480d3a6cba8943a61e53229e72f0f896ec8e415316" kindref="member">COL_TABLE</ref>)</highlight></codeline>
<codeline lineno="1240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Insert<sp/>the<sp/>neighbor<sp/>box<sp/>into<sp/>the<sp/>current<sp/>column<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor_box.<ref refid="class_t_b_o_x_1a9f7e4e20bdfeee0d82db2f8d24aa72dc" kindref="member">major_x_overlap</ref>(box)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!box.<ref refid="class_t_b_o_x_1a5d4e2c5f91b791e94d4c94e513180632" kindref="member">contains</ref>(neighbor_box))<sp/>{</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;InsertBox(neighbor_box);</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>neighbor_found<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modified<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rectsearch.RemoveBBox();</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gsearch.RepositionIterator();</highlight></codeline>
<codeline lineno="1249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>neighbor;</highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(neighbor_found);</highlight></codeline>
<codeline lineno="1253"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(modified)<sp/>{</highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Because<sp/>the<sp/>box<sp/>has<sp/>changed,<sp/>it<sp/>has<sp/>to<sp/>be<sp/>removed<sp/>first.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>gsearch.RemoveBBox();</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a94f0570afcc478097685ccdb59928903" kindref="member">col_seg_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a7b379525e3d60c68e583352ae4b8a750" kindref="member">InsertBBox</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>seg);</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>gsearch.RepositionIterator();</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1260"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1261"><highlight class="normal"></highlight></codeline>
<codeline lineno="1262"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Group<sp/>horizontally<sp/>overlapping<sp/>table<sp/>partitions<sp/>into<sp/>table<sp/>columns.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1263"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO(faisal):<sp/>This<sp/>is<sp/>too<sp/>aggressive<sp/>at<sp/>the<sp/>moment.<sp/>The<sp/>method<sp/>should</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1264"><highlight class="normal"></highlight><highlight class="comment">//<sp/>consider<sp/>more<sp/>attributes<sp/>to<sp/>group<sp/>table<sp/>partitions<sp/>together.<sp/>Some<sp/>common</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1265"><highlight class="normal"></highlight><highlight class="comment">//<sp/>errors<sp/>are:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1266"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>1-<sp/>page<sp/>number<sp/>is<sp/>merged<sp/>with<sp/>a<sp/>table<sp/>column<sp/>above<sp/>it<sp/>even</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1267"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>there<sp/>is<sp/>a<sp/>large<sp/>vertical<sp/>gap<sp/>between<sp/>them.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1268"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>2-<sp/>column<sp/>headers<sp/>go<sp/>on<sp/>to<sp/>catch<sp/>one<sp/>of<sp/>the<sp/>columns<sp/>arbitrarily</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1269"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>3-<sp/>an<sp/>isolated<sp/>noise<sp/>blob<sp/>near<sp/>page<sp/>top<sp/>or<sp/>bottom<sp/>merges<sp/>with<sp/>the<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1270"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>column<sp/>below/above<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1271"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>4-<sp/>cells<sp/>from<sp/>two<sp/>vertically<sp/>adjacent<sp/>tables<sp/>merge<sp/>together<sp/>to<sp/>make<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1272"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>single<sp/>column<sp/>resulting<sp/>in<sp/>merging<sp/>of<sp/>the<sp/>two<sp/>tables</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1273"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a30f071829b47f7bd9afdd4ef819f582d" kindref="member">TableFinder::GetTableColumns</ref>(ColSegment_LIST<sp/>*table_columns)<sp/>{</highlight></codeline>
<codeline lineno="1274"><highlight class="normal"><sp/><sp/>ColSegment_IT<sp/>it(table_columns);</highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>the<sp/>ColPartitions<sp/>in<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColPartition,<sp/>ColPartition_CLIST,<sp/>ColPartition_C_IT&gt;</highlight></codeline>
<codeline lineno="1277"><highlight class="normal"><sp/><sp/><sp/><sp/>gsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part;</highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;inside_table_column()<sp/>||<sp/>part-&gt;type()<sp/>!=<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref>)</highlight></codeline>
<codeline lineno="1282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>prevent<sp/>a<sp/>partition<sp/>to<sp/>be<sp/>assigned<sp/>to<sp/>multiple<sp/>columns</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1283"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box<sp/>=<sp/>part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/><sp/><sp/>ColSegment*<sp/>col<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>ColSegment();</highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/>col-&gt;InsertBox(box);</highlight></codeline>
<codeline lineno="1286"><highlight class="normal"><sp/><sp/><sp/><sp/>part-&gt;set_inside_table_column(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Start<sp/>a<sp/>search<sp/>below<sp/>the<sp/>current<sp/>cell<sp/>to<sp/>find<sp/>bottom<sp/>neighbours</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Note:<sp/>a<sp/>full<sp/>search<sp/>will<sp/>always<sp/>process<sp/>things<sp/>above<sp/>it<sp/>first,<sp/>so</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>this<sp/>should<sp/>be<sp/>starting<sp/>at<sp/>the<sp/>highest<sp/>cell<sp/>and<sp/>working<sp/>its<sp/>way<sp/>down.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/><sp/><sp/>GridSearch&lt;ColPartition,<sp/>ColPartition_CLIST,<sp/>ColPartition_C_IT&gt;</highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/>vsearch.StartVerticalSearch(box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>(),<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>(),<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>());</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>neighbor<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>found_neighbours<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((neighbor<sp/>=<sp/>vsearch.NextVerticalSearch(</highlight><highlight class="keyword">true</highlight><highlight class="normal">))<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>only<sp/>consider<sp/>neighbors<sp/>not<sp/>assigned<sp/>to<sp/>any<sp/>column<sp/>yet</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor-&gt;inside_table_column())</highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Horizontal<sp/>lines<sp/>should<sp/>not<sp/>break<sp/>the<sp/>flow</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor-&gt;IsHorizontalLine())</highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>presence<sp/>of<sp/>a<sp/>non-table<sp/>neighbor<sp/>marks<sp/>the<sp/>end<sp/>of<sp/>current</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>table<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor-&gt;type()<sp/>!=<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref>)</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>add<sp/>the<sp/>neighbor<sp/>partition<sp/>to<sp/>the<sp/>table<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>neighbor_box<sp/>=<sp/>neighbor-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>col-&gt;InsertBox(neighbor_box);</highlight></codeline>
<codeline lineno="1309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>neighbor-&gt;set_inside_table_column(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>found_neighbours<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1311"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(found_neighbours)<sp/>{</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>it.add_after_then_move(col);</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;set_inside_table_column(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>col;</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1319"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"></highlight></codeline>
<codeline lineno="1321"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Mark<sp/>regions<sp/>in<sp/>a<sp/>column<sp/>that<sp/>are<sp/>x-bounded<sp/>by<sp/>the<sp/>column<sp/>boundaries<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1322"><highlight class="normal"></highlight><highlight class="comment">//<sp/>y-bounded<sp/>by<sp/>the<sp/>table<sp/>columns&apos;<sp/>projection<sp/>on<sp/>the<sp/>y-axis<sp/>as<sp/>table<sp/>regions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1323"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a581a66fbdfdd0da5c3679a31f8d7944e" kindref="member">TableFinder::GetTableRegions</ref>(ColSegment_LIST*<sp/>table_columns,</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ColSegment_LIST*<sp/>table_regions)<sp/>{</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/>ColSegment_IT<sp/>cit(table_columns);</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/>ColSegment_IT<sp/>rit(table_regions);</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>through<sp/>column<sp/>blocks</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColSegment,<sp/>ColSegment_CLIST,<sp/>ColSegment_C_IT&gt;</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>gsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1a94f0570afcc478097685ccdb59928903" kindref="member">col_seg_grid_</ref>);</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/>ColSegment*<sp/>part;</highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>page_height<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1af994bc64825f51944fa63a0fc61b4e13" kindref="member">tright</ref>().<ref refid="class_i_c_o_o_r_d_1a66bba6ff8a5f060775e1c2ca511f7f29" kindref="member" tooltip="access_function ">y</ref>()<sp/>-<sp/><ref refid="classtesseract_1_1_table_finder_1afaa3f28f4a9e645ded90e9f74016b217" kindref="member">bleft</ref>().<ref refid="class_i_c_o_o_r_d_1a66bba6ff8a5f060775e1c2ca511f7f29" kindref="member" tooltip="access_function ">y</ref>();</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref>(page_height<sp/>&gt;<sp/>0);</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>a<sp/>bool<sp/>array<sp/>to<sp/>hold<sp/>projection<sp/>on<sp/>y-axis</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal">*<sp/>table_region<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal">[page_height];</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1337"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>part_box<sp/>=<sp/>part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>reset<sp/>the<sp/>projection<sp/>array</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>page_height;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>table_region[i]<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1341"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>iterate<sp/>through<sp/>all<sp/>table<sp/>columns<sp/>to<sp/>find<sp/>regions<sp/>in<sp/>the<sp/>current</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>page<sp/>column<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/>cit.move_to_first();</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(cit.mark_cycle_pt();<sp/>!cit.cycled_list();<sp/>cit.forward())<sp/>{</highlight></codeline>
<codeline lineno="1346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>col_box<sp/>=<sp/>cit.data()-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>find<sp/>intersection<sp/>region<sp/>of<sp/>table<sp/>column<sp/>and<sp/>page<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>intersection_box<sp/>=<sp/>col_box.<ref refid="class_t_b_o_x_1a33e45c7389737cdf1a908bca0af315c4" kindref="member">intersection</ref>(part_box);</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>project<sp/>table<sp/>column<sp/>on<sp/>the<sp/>y-axis</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>intersection_box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>();<sp/>i<sp/>&lt;<sp/>intersection_box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_region[i<sp/>-<sp/><ref refid="classtesseract_1_1_table_finder_1afaa3f28f4a9e645ded90e9f74016b217" kindref="member">bleft</ref>().<ref refid="class_i_c_o_o_r_d_1a66bba6ff8a5f060775e1c2ca511f7f29" kindref="member" tooltip="access_function ">y</ref>()]<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1353"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>x-limits<sp/>of<sp/>table<sp/>regions<sp/>to<sp/>page<sp/>column<sp/>width</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>current_table_box;</highlight></codeline>
<codeline lineno="1356"><highlight class="normal"><sp/><sp/><sp/><sp/>current_table_box.<ref refid="class_t_b_o_x_1ae6151cd794841e100d8a346a0c4a46e6" kindref="member">set_left</ref>(part_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>());</highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/>current_table_box.<ref refid="class_t_b_o_x_1a2246293d3667b28c52a52353a2d5caea" kindref="member">set_right</ref>(part_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>());</highlight></codeline>
<codeline lineno="1358"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>go<sp/>through<sp/>the<sp/>y-axis<sp/>projection<sp/>to<sp/>find<sp/>runs<sp/>of<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1359"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>regions.<sp/>Each<sp/>run<sp/>makes<sp/>one<sp/>table<sp/>region.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>1;<sp/>i<sp/>&lt;<sp/>page_height;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>detect<sp/>start<sp/>of<sp/>a<sp/>table<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!table_region[i<sp/>-<sp/>1]<sp/>&amp;&amp;<sp/>table_region[i])<sp/>{</highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current_table_box.<ref refid="class_t_b_o_x_1a6f803b24b046883cb0f3882dc3d92302" kindref="member">set_bottom</ref>(i<sp/>+<sp/><ref refid="classtesseract_1_1_table_finder_1afaa3f28f4a9e645ded90e9f74016b217" kindref="member">bleft</ref>().y());</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>Is<sp/>it<sp/>guaranteed<sp/>that<sp/>the<sp/>last<sp/>row<sp/>is<sp/>not<sp/>a<sp/>table<sp/>region?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>detect<sp/>end<sp/>of<sp/>a<sp/>table<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(table_region[i<sp/>-<sp/>1]<sp/>&amp;&amp;<sp/>!table_region[i])<sp/>{</highlight></codeline>
<codeline lineno="1368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current_table_box.<ref refid="class_t_b_o_x_1a7f40dfd290a907200bdc98c196f63f45" kindref="member">set_top</ref>(i<sp/>+<sp/><ref refid="classtesseract_1_1_table_finder_1afaa3f28f4a9e645ded90e9f74016b217" kindref="member">bleft</ref>().y());</highlight></codeline>
<codeline lineno="1369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!current_table_box.<ref refid="class_t_b_o_x_1a7c6996aea1eb6be07b1d6634bf36cfd6" kindref="member">null_box</ref>())<sp/>{</highlight></codeline>
<codeline lineno="1370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ColSegment*<sp/>seg<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>ColSegment();</highlight></codeline>
<codeline lineno="1371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;InsertBox(current_table_box);</highlight></codeline>
<codeline lineno="1372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rit.add_after_then_move(seg);</highlight></codeline>
<codeline lineno="1373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal">[]<sp/>table_region;</highlight></codeline>
<codeline lineno="1378"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"></highlight></codeline>
<codeline lineno="1380"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Merge<sp/>table<sp/>regions<sp/>corresponding<sp/>to<sp/>tables<sp/>spanning<sp/>multiple<sp/>columns<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1381"><highlight class="normal"></highlight><highlight class="comment">//<sp/>there<sp/>is<sp/>a<sp/>colpartition<sp/>(horizontal<sp/>ruling<sp/>line<sp/>or<sp/>normal<sp/>text)<sp/>that</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1382"><highlight class="normal"></highlight><highlight class="comment">//<sp/>touches<sp/>both<sp/>regions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1383"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO(faisal):<sp/>A<sp/>rare<sp/>error<sp/>occurs<sp/>if<sp/>there<sp/>are<sp/>two<sp/>horizontally<sp/>adjacent</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1384"><highlight class="normal"></highlight><highlight class="comment">//<sp/>tables<sp/>with<sp/>aligned<sp/>ruling<sp/>lines.<sp/>In<sp/>this<sp/>case,<sp/>line<sp/>finder<sp/>returns<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1385"><highlight class="normal"></highlight><highlight class="comment">//<sp/>single<sp/>line<sp/>and<sp/>hence<sp/>the<sp/>tables<sp/>get<sp/>merged<sp/>together</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1386"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a9298cd74b3e81315195a547a890752e0" kindref="member">TableFinder::GridMergeTableRegions</ref>()<sp/>{</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>the<sp/>table<sp/>regions<sp/>in<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColSegment,<sp/>ColSegment_CLIST,<sp/>ColSegment_C_IT&gt;</highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>gsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>);</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/>ColSegment*<sp/>seg<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1392"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((seg<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1393"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>neighbor_found<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>modified<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Modified<sp/>at<sp/>least<sp/>once</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Start<sp/>a<sp/>rectangle<sp/>search<sp/>x-bounded<sp/>by<sp/>the<sp/>image<sp/>and<sp/>y<sp/>by<sp/>the<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box<sp/>=<sp/>seg-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>search_region(box);</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>search_region.set_left(<ref refid="classtesseract_1_1_table_finder_1afaa3f28f4a9e645ded90e9f74016b217" kindref="member">bleft</ref>().x());</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>search_region.set_right(<ref refid="classtesseract_1_1_table_finder_1af994bc64825f51944fa63a0fc61b4e13" kindref="member">tright</ref>().x());</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>neighbor_found<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>GridSearch&lt;ColSegment,<sp/>ColSegment_CLIST,<sp/>ColSegment_C_IT&gt;</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rectsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>);</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rectsearch.StartRectSearch(search_region);</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ColSegment*<sp/>neighbor<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((neighbor<sp/>=<sp/>rectsearch.NextRectSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor<sp/>==<sp/>seg)</highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>neighbor_box<sp/>=<sp/>neighbor-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Check<sp/>if<sp/>a<sp/>neighbor<sp/>box<sp/>has<sp/>a<sp/>large<sp/>overlap<sp/>with<sp/>the<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>region.<sp/><sp/>This<sp/>may<sp/>happen<sp/>as<sp/>a<sp/>result<sp/>of<sp/>merging<sp/>two<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>regions<sp/>in<sp/>the<sp/>previous<sp/>iteration.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor_box.<ref refid="class_t_b_o_x_1a9e8d88530048135be86afb906ff9dd74" kindref="member">overlap_fraction</ref>(box)<sp/>&gt;=<sp/>0.9)<sp/>{</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;InsertBox(neighbor_box);</highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rectsearch.RemoveBBox();</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gsearch.RepositionIterator();</highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>neighbor;</highlight></codeline>
<codeline lineno="1418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modified<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Check<sp/>if<sp/>two<sp/>table<sp/>regions<sp/>belong<sp/>together<sp/>based<sp/>on<sp/>a<sp/>common</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>horizontal<sp/>ruling<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classtesseract_1_1_table_finder_1a0fdb92fd4cf6c71db61a8bf17f793226" kindref="member">BelongToOneTable</ref>(box,<sp/>neighbor_box))<sp/>{</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;InsertBox(neighbor_box);</highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>neighbor_found<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modified<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rectsearch.RemoveBBox();</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gsearch.RepositionIterator();</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>neighbor;</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(neighbor_found);</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(modified)<sp/>{</highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Because<sp/>the<sp/>box<sp/>has<sp/>changed,<sp/>it<sp/>has<sp/>to<sp/>be<sp/>removed<sp/>first.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>gsearch.RemoveBBox();</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a7b379525e3d60c68e583352ae4b8a750" kindref="member">InsertBBox</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>seg);</highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>gsearch.RepositionIterator();</highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1440"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1441"><highlight class="normal"></highlight></codeline>
<codeline lineno="1442"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Decide<sp/>if<sp/>two<sp/>table<sp/>regions<sp/>belong<sp/>to<sp/>one<sp/>table<sp/>based<sp/>on<sp/>a<sp/>common</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1443"><highlight class="normal"></highlight><highlight class="comment">//<sp/>horizontal<sp/>ruling<sp/>line<sp/>or<sp/>another<sp/>colpartition</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1444"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a0fdb92fd4cf6c71db61a8bf17f793226" kindref="member">TableFinder::BelongToOneTable</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>&amp;box1,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>&amp;box2)<sp/>{</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Check<sp/>the<sp/>obvious<sp/>case.<sp/>Most<sp/>likely<sp/>not<sp/>true<sp/>because<sp/>overlapping<sp/>boxes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>should<sp/>already<sp/>be<sp/>merged,<sp/>but<sp/>seems<sp/>like<sp/>a<sp/>good<sp/>thing<sp/>to<sp/>do<sp/>in<sp/>case<sp/>things</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>change.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1448"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(box1.<ref refid="class_t_b_o_x_1adcc7d2858ccb61cd715dbcff32bd5582" kindref="member">overlap</ref>(box2))</highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Check<sp/>for<sp/>ColPartitions<sp/>spanning<sp/>both<sp/>table<sp/>regions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>bbox<sp/>=<sp/>box1.<ref refid="class_t_b_o_x_1ab8ae7b66782fa1802f78ff034da16089" kindref="member">bounding_union</ref>(box2);</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Start<sp/>a<sp/>rect<sp/>search<sp/>on<sp/>bbox</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColPartition,<sp/>ColPartition_CLIST,<sp/>ColPartition_C_IT&gt;</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rectsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/>rectsearch.StartRectSearch(bbox);</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1457"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>rectsearch.NextRectSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>part_box<sp/>=<sp/>part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>return<sp/>true<sp/>if<sp/>a<sp/>colpartition<sp/>spanning<sp/>both<sp/>table<sp/>regions<sp/>is<sp/>found</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part_box.<ref refid="class_t_b_o_x_1adcc7d2858ccb61cd715dbcff32bd5582" kindref="member">overlap</ref>(box1)<sp/>&amp;&amp;<sp/>part_box.<ref refid="class_t_b_o_x_1adcc7d2858ccb61cd715dbcff32bd5582" kindref="member">overlap</ref>(box2)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!part-&gt;IsImageType())</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1465"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1466"><highlight class="normal"></highlight></codeline>
<codeline lineno="1467"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Adjust<sp/>table<sp/>boundaries<sp/>by:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1468"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>-<sp/>building<sp/>a<sp/>tight<sp/>bounding<sp/>box<sp/>around<sp/>all<sp/>ColPartitions<sp/>contained<sp/>in<sp/>it.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1469"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>-<sp/>expanding<sp/>table<sp/>boundaries<sp/>to<sp/>include<sp/>all<sp/>colpartitions<sp/>that<sp/>overlap<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1470"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>table<sp/>by<sp/>more<sp/>than<sp/>half<sp/>of<sp/>their<sp/>area</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1471"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>-<sp/>expanding<sp/>table<sp/>boundaries<sp/>to<sp/>include<sp/>nearby<sp/>horizontal<sp/>rule<sp/>lines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1472"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>-<sp/>expanding<sp/>table<sp/>vertically<sp/>to<sp/>include<sp/>left<sp/>out<sp/>column<sp/>headers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1473"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO(faisal):<sp/>Expansion<sp/>of<sp/>table<sp/>boundaries<sp/>is<sp/>quite<sp/>aggressive.<sp/>It<sp/>usually</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1474"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>makes<sp/>following<sp/>errors:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1475"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>1-<sp/>horizontal<sp/>lines<sp/>consisting<sp/>of<sp/>underlines<sp/>are<sp/>included<sp/>in<sp/>the<sp/>table<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1476"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>they<sp/>are<sp/>close<sp/>enough</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1477"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>2-<sp/>horizontal<sp/>lines<sp/>originating<sp/>from<sp/>noise<sp/>tend<sp/>to<sp/>get<sp/>merged<sp/>with<sp/>a<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1478"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>near<sp/>the<sp/>top<sp/>of<sp/>the<sp/>page</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1479"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>3-<sp/>the<sp/>criteria<sp/>for<sp/>including<sp/>horizontal<sp/>lines<sp/>is<sp/>very<sp/>generous.<sp/>Many<sp/>times</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1480"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>horizontal<sp/>lines<sp/>separating<sp/>headers<sp/>and<sp/>footers<sp/>get<sp/>merged<sp/>with<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1481"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>single-column<sp/>table<sp/>in<sp/>a<sp/>multi-column<sp/>page<sp/>thereby<sp/>including<sp/>text</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1482"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>from<sp/>the<sp/>neighboring<sp/>column<sp/>inside<sp/>the<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1483"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/>4-<sp/>the<sp/>criteria<sp/>for<sp/>including<sp/>left<sp/>out<sp/>column<sp/>headers<sp/>also<sp/>tends<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1484"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>occasionally<sp/>include<sp/>text-lines<sp/>above<sp/>the<sp/>tables,<sp/>typically<sp/>from</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1485"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>table<sp/>caption</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1486"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a2af79bdd1c4edbf03f4d2a15ee203be8" kindref="member">TableFinder::AdjustTableBoundaries</ref>()<sp/>{</highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>the<sp/>table<sp/>regions<sp/>in<sp/>the<sp/>grid</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/>ColSegment_CLIST<sp/>adjusted_tables;</highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/>ColSegment_C_IT<sp/>it(&amp;adjusted_tables);</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/><ref refid="namespacetesseract_1ac7f2f25bfb4914e691db80a6b523c703" kindref="member">ColSegmentGridSearch</ref><sp/>gsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>);</highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/>ColSegment*<sp/>table<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((table<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>table_box<sp/>=<sp/>table-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>grown_box<sp/>=<sp/>table_box;</highlight></codeline>
<codeline lineno="1496"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a11d07831ff21f641f54e51b42a446a26" kindref="member">GrowTableBox</ref>(table_box,<sp/>&amp;grown_box);</highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>To<sp/>prevent<sp/>a<sp/>table<sp/>from<sp/>expanding<sp/>again,<sp/>do<sp/>not<sp/>insert<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>modified<sp/>box<sp/>back<sp/>to<sp/>the<sp/>grid.<sp/>Instead<sp/>move<sp/>it<sp/>to<sp/>a<sp/>list<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>and<sp/>remove<sp/>it<sp/>from<sp/>the<sp/>grid.<sp/>The<sp/>list<sp/>is<sp/>moved<sp/>later<sp/>back<sp/>to<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!grown_box.<ref refid="class_t_b_o_x_1a7c6996aea1eb6be07b1d6634bf36cfd6" kindref="member">null_box</ref>())<sp/>{</highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ColSegment*<sp/>col<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>ColSegment();</highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>col-&gt;InsertBox(grown_box);</highlight></codeline>
<codeline lineno="1503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>it.add_after_then_move(col);</highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/>gsearch.RemoveBBox();</highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>table;</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>clear<sp/>table<sp/>grid<sp/>to<sp/>move<sp/>final<sp/>tables<sp/>in<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1509"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>table_grid_<sp/>should<sp/>already<sp/>be<sp/>empty.<sp/>The<sp/>above<sp/>loop</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>removed<sp/>everything.<sp/>Maybe<sp/>just<sp/>assert<sp/>it<sp/>is<sp/>empty?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a0b373075bdfda41719d6fb9a64bcfee0" kindref="member">Clear</ref>();</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"><sp/><sp/>it.move_to_first();</highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>move<sp/>back<sp/>final<sp/>tables<sp/>to<sp/>table_grid_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1514"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(it.mark_cycle_pt();<sp/>!it.cycled_list();<sp/>it.forward())<sp/>{</highlight></codeline>
<codeline lineno="1515"><highlight class="normal"><sp/><sp/><sp/><sp/>ColSegment*<sp/>seg<sp/>=<sp/>it.extract();</highlight></codeline>
<codeline lineno="1516"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a7b379525e3d60c68e583352ae4b8a750" kindref="member">InsertBBox</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>seg);</highlight></codeline>
<codeline lineno="1517"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1518"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1519"><highlight class="normal"></highlight></codeline>
<codeline lineno="1520"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a11d07831ff21f641f54e51b42a446a26" kindref="member">TableFinder::GrowTableBox</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>table_box,<sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>*<sp/>result_box)<sp/>{</highlight></codeline>
<codeline lineno="1521"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>The<sp/>growing<sp/>code<sp/>is<sp/>a<sp/>bit<sp/>excessive<sp/>right<sp/>now.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1522"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>By<sp/>removing<sp/>these<sp/>lines,<sp/>the<sp/>partitions<sp/>considered<sp/>need</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1523"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>to<sp/>have<sp/>some<sp/>overlap<sp/>or<sp/>be<sp/>special<sp/>cases.<sp/>These<sp/>lines<sp/>could</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1524"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>be<sp/>added<sp/>again<sp/>once<sp/>a<sp/>check<sp/>is<sp/>put<sp/>in<sp/>place<sp/>to<sp/>make<sp/>sure<sp/>that</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1525"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>growing<sp/>tables<sp/>don&apos;t<sp/>stomp<sp/>on<sp/>a<sp/>lot<sp/>of<sp/>non-table<sp/>partitions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1526"><highlight class="normal"></highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>search<sp/>for<sp/>horizontal<sp/>ruling<sp/>lines<sp/>within<sp/>the<sp/>vertical<sp/>margin</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>int<sp/>vertical_margin<sp/>=<sp/>kRulingVerticalMargin<sp/>*<sp/>gridsize();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1529"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>search_box<sp/>=<sp/>table_box;</highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>int<sp/>top<sp/>=<sp/>MIN(search_box.top()<sp/>+<sp/>vertical_margin,<sp/>tright().y());</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1531"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>int<sp/>bottom<sp/>=<sp/>MAX(search_box.bottom()<sp/>-<sp/>vertical_margin,<sp/>bleft().y());</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1532"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>search_box.set_top(top);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1533"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>search_box.set_bottom(bottom);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1534"><highlight class="normal"></highlight></codeline>
<codeline lineno="1535"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1ac694dfdfaa119c35c337dd342073debf" kindref="member">GrowTableToIncludePartials</ref>(table_box,<sp/>search_box,<sp/>result_box);</highlight></codeline>
<codeline lineno="1536"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a2f2d85d386d90f680f518bf9e6496411" kindref="member">GrowTableToIncludeLines</ref>(table_box,<sp/>search_box,<sp/>result_box);</highlight></codeline>
<codeline lineno="1537"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1a265d046f7651f73362a3aa5f3c9453fd" kindref="member">IncludeLeftOutColumnHeaders</ref>(result_box);</highlight></codeline>
<codeline lineno="1538"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1539"><highlight class="normal"></highlight></codeline>
<codeline lineno="1540"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Grow<sp/>a<sp/>table<sp/>by<sp/>increasing<sp/>the<sp/>size<sp/>of<sp/>the<sp/>box<sp/>to<sp/>include</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1541"><highlight class="normal"></highlight><highlight class="comment">//<sp/>partitions<sp/>with<sp/>significant<sp/>overlap<sp/>with<sp/>the<sp/>table.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1542"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1ac694dfdfaa119c35c337dd342073debf" kindref="member">TableFinder::GrowTableToIncludePartials</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>table_box,</highlight></codeline>
<codeline lineno="1543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>search_range,</highlight></codeline>
<codeline lineno="1544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>*<sp/>result_box)<sp/>{</highlight></codeline>
<codeline lineno="1545"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Rulings<sp/>are<sp/>in<sp/>a<sp/>different<sp/>grid,<sp/>so<sp/>search<sp/>2<sp/>grids<sp/>for<sp/>rulings,<sp/>text,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1546"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>and<sp/>table<sp/>partitions<sp/>that<sp/>are<sp/>not<sp/>entirely<sp/>within<sp/>the<sp/>new<sp/>box.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1547"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>2;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="1548"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartitionGrid*<sp/>grid<sp/>=<sp/>(i<sp/>==<sp/>0)<sp/>?<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1ad2da282ac5f2a2d4efbc463d80c7113c" kindref="member">fragmented_text_grid_</ref><sp/>:</highlight></codeline>
<codeline lineno="1549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>;</highlight></codeline>
<codeline lineno="1550"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespacetesseract_1a990e3f25988f7d70c40a13225e645492" kindref="member">ColPartitionGridSearch</ref><sp/>rectsearch(grid);</highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/><sp/><sp/>rectsearch.StartRectSearch(search_range);</highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1553"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>rectsearch.NextRectSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Only<sp/>include<sp/>text<sp/>and<sp/>table<sp/>types.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;IsImageType())</highlight></codeline>
<codeline lineno="1556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>part_box<sp/>=<sp/>part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Include<sp/>partition<sp/>in<sp/>the<sp/>table<sp/>if<sp/>more<sp/>than<sp/>half<sp/>of<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>is<sp/>covered<sp/>by<sp/>the<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part_box.<ref refid="class_t_b_o_x_1a9e8d88530048135be86afb906ff9dd74" kindref="member">overlap_fraction</ref>(table_box)<sp/>&gt;<sp/><ref refid="namespacetesseract_1a0f2ae212b6b475efca7981fd1dc51e29" kindref="member">kMinOverlapWithTable</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*result_box<sp/>=<sp/>result_box-&gt;<ref refid="class_t_b_o_x_1ab8ae7b66782fa1802f78ff034da16089" kindref="member">bounding_union</ref>(part_box);</highlight></codeline>
<codeline lineno="1562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1564"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1565"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1566"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1567"><highlight class="normal"></highlight></codeline>
<codeline lineno="1568"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Grow<sp/>a<sp/>table<sp/>by<sp/>expanding<sp/>to<sp/>the<sp/>extents<sp/>of<sp/>significantly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1569"><highlight class="normal"></highlight><highlight class="comment">//<sp/>overlapping<sp/>lines.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1570"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a2f2d85d386d90f680f518bf9e6496411" kindref="member">TableFinder::GrowTableToIncludeLines</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>table_box,</highlight></codeline>
<codeline lineno="1571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>search_range,</highlight></codeline>
<codeline lineno="1572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>*<sp/>result_box)<sp/>{</highlight></codeline>
<codeline lineno="1573"><highlight class="normal"><sp/><sp/><ref refid="namespacetesseract_1a990e3f25988f7d70c40a13225e645492" kindref="member">ColPartitionGridSearch</ref><sp/>rsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>);</highlight></codeline>
<codeline lineno="1574"><highlight class="normal"><sp/><sp/>rsearch.SetUniqueMode(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1575"><highlight class="normal"><sp/><sp/>rsearch.StartRectSearch(search_range);</highlight></codeline>
<codeline lineno="1576"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1577"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>rsearch.NextRectSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1578"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato)<sp/>This<sp/>should<sp/>also<sp/>do<sp/>vertical,<sp/>but<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1579"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>boundaries<sp/>are<sp/>breaking<sp/>things.<sp/>This<sp/>function<sp/>needs<sp/>to<sp/>be</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1580"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>updated<sp/>to<sp/>allow<sp/>vertical<sp/>lines<sp/>as<sp/>well.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1581"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!part-&gt;IsLineType())</highlight></codeline>
<codeline lineno="1582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1583"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Avoid<sp/>the<sp/>following<sp/>function<sp/>call<sp/>if<sp/>the<sp/>result<sp/>of<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1584"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>function<sp/>is<sp/>irrelevant.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1585"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>part_box<sp/>=<sp/>part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result_box-&gt;<ref refid="class_t_b_o_x_1a5d4e2c5f91b791e94d4c94e513180632" kindref="member">contains</ref>(part_box))</highlight></codeline>
<codeline lineno="1587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1588"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Include<sp/>a<sp/>partially<sp/>overlapping<sp/>horizontal<sp/>line<sp/>only<sp/>if<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>extra<sp/>ColPartitions<sp/>that<sp/>will<sp/>be<sp/>included<sp/>due<sp/>to<sp/>expansion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1590"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>have<sp/>large<sp/>side<sp/>spacing<sp/>w.r.t.<sp/>columns<sp/>containing<sp/>them.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1591"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classtesseract_1_1_table_finder_1a6fcf84582f86676bf93e6e49d08dc64a" kindref="member">HLineBelongsToTable</ref>(*part,<sp/>table_box))</highlight></codeline>
<codeline lineno="1592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>*result_box<sp/>=<sp/>result_box-&gt;<ref refid="class_t_b_o_x_1ab8ae7b66782fa1802f78ff034da16089" kindref="member">bounding_union</ref>(part_box);</highlight></codeline>
<codeline lineno="1593"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>Vertical</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1594"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1595"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1596"><highlight class="normal"></highlight></codeline>
<codeline lineno="1597"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Checks<sp/>whether<sp/>the<sp/>horizontal<sp/>line<sp/>belong<sp/>to<sp/>the<sp/>table<sp/>by<sp/>looking<sp/>at<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1598"><highlight class="normal"></highlight><highlight class="comment">//<sp/>side<sp/>spacing<sp/>of<sp/>extra<sp/>ColParitions<sp/>that<sp/>will<sp/>be<sp/>included<sp/>in<sp/>the<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1599"><highlight class="normal"></highlight><highlight class="comment">//<sp/>due<sp/>to<sp/>expansion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1600"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a6fcf84582f86676bf93e6e49d08dc64a" kindref="member">TableFinder::HLineBelongsToTable</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>ColPartition&amp;<sp/>part,</highlight></codeline>
<codeline lineno="1601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>table_box)<sp/>{</highlight></codeline>
<codeline lineno="1602"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!part.IsHorizontalLine())</highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>part_box<sp/>=<sp/>part.bounding_box();</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!part_box.<ref refid="class_t_b_o_x_1a9f7e4e20bdfeee0d82db2f8d24aa72dc" kindref="member">major_x_overlap</ref>(table_box))</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Do<sp/>not<sp/>consider<sp/>top-most<sp/>horizontal<sp/>line<sp/>since<sp/>it<sp/>usually</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1608"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>originates<sp/>from<sp/>noise.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1609"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>I<sp/>had<sp/>to<sp/>comment<sp/>this<sp/>out<sp/>because<sp/>the<sp/>ruling<sp/>grid<sp/>doesn&apos;t</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1610"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>have<sp/>neighbors<sp/>solved.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1611"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>(!part.nearest_neighbor_above())</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1612"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/>return<sp/>false;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1613"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>bbox<sp/>=<sp/>part_box.<ref refid="class_t_b_o_x_1ab8ae7b66782fa1802f78ff034da16089" kindref="member">bounding_union</ref>(table_box);</highlight></codeline>
<codeline lineno="1614"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>In<sp/>the<sp/>&quot;unioned<sp/>table&quot;<sp/>box<sp/>(the<sp/>table<sp/>extents<sp/>expanded<sp/>by<sp/>the<sp/>line),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1615"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>keep<sp/>track<sp/>of<sp/>how<sp/>many<sp/>partitions<sp/>have<sp/>significant<sp/>padding<sp/>to<sp/>the<sp/>left</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1616"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>and<sp/>right.<sp/>If<sp/>more<sp/>than<sp/>half<sp/>of<sp/>the<sp/>partitions<sp/>covered<sp/>by<sp/>the<sp/>new<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1617"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>have<sp/>significant<sp/>spacing,<sp/>the<sp/>line<sp/>belongs<sp/>to<sp/>the<sp/>table<sp/>and<sp/>the<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1618"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>grows<sp/>to<sp/>include<sp/>all<sp/>of<sp/>the<sp/>partitions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1619"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_extra_partitions<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1620"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>extra_space_to_right<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>extra_space_to_left<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Rulings<sp/>are<sp/>in<sp/>a<sp/>different<sp/>grid,<sp/>so<sp/>search<sp/>2<sp/>grids<sp/>for<sp/>rulings,<sp/>text,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1623"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>and<sp/>table<sp/>partitions<sp/>that<sp/>are<sp/>introduced<sp/>by<sp/>the<sp/>new<sp/>box.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>2;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="1625"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartitionGrid*<sp/>grid<sp/>=<sp/>(i<sp/>==<sp/>0)<sp/>?<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref><sp/>:</highlight></codeline>
<codeline lineno="1626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>;</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Start<sp/>a<sp/>rect<sp/>search<sp/>on<sp/>bbox</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1628"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespacetesseract_1a990e3f25988f7d70c40a13225e645492" kindref="member">ColPartitionGridSearch</ref><sp/>rectsearch(grid);</highlight></codeline>
<codeline lineno="1629"><highlight class="normal"><sp/><sp/><sp/><sp/>rectsearch.SetUniqueMode(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1630"><highlight class="normal"><sp/><sp/><sp/><sp/>rectsearch.StartRectSearch(bbox);</highlight></codeline>
<codeline lineno="1631"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>extra_part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1632"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((extra_part<sp/>=<sp/>rectsearch.NextRectSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ColPartition<sp/>already<sp/>in<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>extra_part_box<sp/>=<sp/>extra_part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(extra_part_box.<ref refid="class_t_b_o_x_1a9e8d88530048135be86afb906ff9dd74" kindref="member">overlap_fraction</ref>(table_box)<sp/>&gt;<sp/><ref refid="namespacetesseract_1a0f2ae212b6b475efca7981fd1dc51e29" kindref="member">kMinOverlapWithTable</ref>)</highlight></codeline>
<codeline lineno="1636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Non-text<sp/>ColPartitions<sp/>do<sp/>not<sp/>contribute</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(extra_part-&gt;IsImageType())</highlight></codeline>
<codeline lineno="1639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Consider<sp/>this<sp/>partition.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>num_extra_partitions++;</highlight></codeline>
<codeline lineno="1642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>presence<sp/>of<sp/>a<sp/>table<sp/>cell<sp/>is<sp/>a<sp/>strong<sp/>hint,<sp/>so<sp/>just<sp/>increment<sp/>the<sp/>scores</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>without<sp/>looking<sp/>at<sp/>the<sp/>spacing.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(extra_part-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref><sp/>||<sp/>extra_part-&gt;IsLineType())<sp/>{</highlight></codeline>
<codeline lineno="1645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_space_to_right++;</highlight></codeline>
<codeline lineno="1646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_space_to_left++;</highlight></codeline>
<codeline lineno="1647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>space_threshold<sp/>=<sp/><ref refid="namespacetesseract_1aee32ef58150f63a980c7b4f736c4a22a" kindref="member">kSideSpaceMargin</ref><sp/>*<sp/>part.median_size();</highlight></codeline>
<codeline lineno="1650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(extra_part-&gt;space_to_right()<sp/>&gt;<sp/>space_threshold)</highlight></codeline>
<codeline lineno="1651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_space_to_right++;</highlight></codeline>
<codeline lineno="1652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(extra_part-&gt;space_to_left()<sp/>&gt;<sp/>space_threshold)</highlight></codeline>
<codeline lineno="1653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_space_to_left++;</highlight></codeline>
<codeline lineno="1654"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1655"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1656"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>tprintf(&quot;%d<sp/>%d<sp/>%d\n&quot;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1657"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>num_extra_partitions,extra_space_to_right,extra_space_to_left);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1658"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(extra_space_to_right<sp/>&gt;<sp/>num_extra_partitions<sp/>/<sp/>2)<sp/>||</highlight></codeline>
<codeline lineno="1659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(extra_space_to_left<sp/>&gt;<sp/>num_extra_partitions<sp/>/<sp/>2);</highlight></codeline>
<codeline lineno="1660"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1661"><highlight class="normal"></highlight></codeline>
<codeline lineno="1662"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Look<sp/>for<sp/>isolated<sp/>column<sp/>headers<sp/>above<sp/>the<sp/>given<sp/>table<sp/>box<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1663"><highlight class="normal"></highlight><highlight class="comment">//<sp/>include<sp/>them<sp/>in<sp/>the<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1664"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a265d046f7651f73362a3aa5f3c9453fd" kindref="member">TableFinder::IncludeLeftOutColumnHeaders</ref>(<ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>*<sp/>table_box)<sp/>{</highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Start<sp/>a<sp/>search<sp/>above<sp/>the<sp/>current<sp/>table<sp/>to<sp/>look<sp/>for<sp/>column<sp/>headers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/><ref refid="namespacetesseract_1a990e3f25988f7d70c40a13225e645492" kindref="member">ColPartitionGridSearch</ref><sp/>vsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="1667"><highlight class="normal"><sp/><sp/>vsearch.StartVerticalSearch(table_box-&gt;<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>(),<sp/>table_box-&gt;<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>(),</highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_box-&gt;<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>());</highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>neighbor<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>previous_neighbor<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1671"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((neighbor<sp/>=<sp/>vsearch.NextVerticalSearch(</highlight><highlight class="keyword">false</highlight><highlight class="normal">))<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1672"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Max<sp/>distance<sp/>to<sp/>find<sp/>a<sp/>table<sp/>heading.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1673"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>max_distance<sp/>=<sp/><ref refid="namespacetesseract_1aae5eb999d710e50055ba3096b2f54c38" kindref="member">kMaxColumnHeaderDistance</ref><sp/>*</highlight></codeline>
<codeline lineno="1674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>neighbor-&gt;median_size();</highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>table_top<sp/>=<sp/>table_box-&gt;<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>();</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box<sp/>=<sp/>neighbor-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1677"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Do<sp/>not<sp/>continue<sp/>if<sp/>the<sp/>next<sp/>box<sp/>is<sp/>way<sp/>above</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1678"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>()<sp/>-<sp/>table_top<sp/>&gt;<sp/>max_distance)</highlight></codeline>
<codeline lineno="1679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1680"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Unconditionally<sp/>include<sp/>partitions<sp/>of<sp/>type<sp/>TABLE<sp/>or<sp/>LINE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1681"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(faisal):<sp/>add<sp/>some<sp/>reasonable<sp/>conditions<sp/>here</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1682"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(neighbor-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref><sp/>||<sp/>neighbor-&gt;IsLineType())<sp/>{</highlight></codeline>
<codeline lineno="1683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>table_box-&gt;<ref refid="class_t_b_o_x_1a7f40dfd290a907200bdc98c196f63f45" kindref="member">set_top</ref>(box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>());</highlight></codeline>
<codeline lineno="1684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>previous_neighbor<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1686"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>there<sp/>are<sp/>two<sp/>text<sp/>partitions,<sp/>one<sp/>above<sp/>the<sp/>other,<sp/>without<sp/>a<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1688"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>cell<sp/>on<sp/>their<sp/>left<sp/>or<sp/>right<sp/>side,<sp/>consider<sp/>them<sp/>a<sp/>barrier<sp/>and<sp/>quit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1689"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(previous_neighbor<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>previous_neighbor<sp/>=<sp/>neighbor;</highlight></codeline>
<codeline lineno="1691"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>previous_box<sp/>=<sp/>previous_neighbor-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!box.<ref refid="class_t_b_o_x_1a6b8b3bf99ea363303e11c26866335f23" kindref="member">major_y_overlap</ref>(previous_box))</highlight></codeline>
<codeline lineno="1694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1695"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1696"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1697"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1698"><highlight class="normal"></highlight></codeline>
<codeline lineno="1699"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Remove<sp/>false<sp/>alarms<sp/>consiting<sp/>of<sp/>a<sp/>single<sp/>column<sp/>based<sp/>on<sp/>their</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1700"><highlight class="normal"></highlight><highlight class="comment">//<sp/>projection<sp/>on<sp/>the<sp/>x-axis.<sp/>Projection<sp/>of<sp/>a<sp/>real<sp/>table<sp/>on<sp/>the<sp/>x-axis</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1701"><highlight class="normal"></highlight><highlight class="comment">//<sp/>should<sp/>have<sp/>at<sp/>least<sp/>one<sp/>zero-valley<sp/>larger<sp/>than<sp/>the<sp/>global<sp/>median</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1702"><highlight class="normal"></highlight><highlight class="comment">//<sp/>x-height<sp/>of<sp/>the<sp/>page.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1703"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1ad1d77425898bfe8808255b9a472663ab" kindref="member">TableFinder::DeleteSingleColumnTables</ref>()<sp/>{</highlight></codeline>
<codeline lineno="1704"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>page_width<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1af994bc64825f51944fa63a0fc61b4e13" kindref="member">tright</ref>().<ref refid="class_i_c_o_o_r_d_1a59722a47c540007c58a539f0e35b3f33" kindref="member" tooltip="access function ">x</ref>()<sp/>-<sp/><ref refid="classtesseract_1_1_table_finder_1afaa3f28f4a9e645ded90e9f74016b217" kindref="member">bleft</ref>().<ref refid="class_i_c_o_o_r_d_1a59722a47c540007c58a539f0e35b3f33" kindref="member" tooltip="access function ">x</ref>();</highlight></codeline>
<codeline lineno="1705"><highlight class="normal"><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref>(page_width<sp/>&gt;<sp/>0);</highlight></codeline>
<codeline lineno="1706"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>an<sp/>integer<sp/>array<sp/>to<sp/>hold<sp/>projection<sp/>on<sp/>x-axis</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1707"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*<sp/>table_xprojection<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">[page_width];</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>through<sp/>all<sp/>tables<sp/>in<sp/>the<sp/>table<sp/>grid</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1709"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColSegment,<sp/>ColSegment_CLIST,<sp/>ColSegment_C_IT&gt;</highlight></codeline>
<codeline lineno="1710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>table_search(&amp;<ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>);</highlight></codeline>
<codeline lineno="1711"><highlight class="normal"><sp/><sp/>table_search.StartFullSearch();</highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/>ColSegment*<sp/>table;</highlight></codeline>
<codeline lineno="1713"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((table<sp/>=<sp/>table_search.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1714"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>table_box<sp/>=<sp/>table-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1715"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>reset<sp/>the<sp/>projection<sp/>array</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1716"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>page_width;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>table_xprojection[i]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1718"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1719"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Start<sp/>a<sp/>rect<sp/>search<sp/>on<sp/>table_box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1720"><highlight class="normal"><sp/><sp/><sp/><sp/>GridSearch&lt;ColPartition,<sp/>ColPartition_CLIST,<sp/>ColPartition_C_IT&gt;</highlight></codeline>
<codeline lineno="1721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rectsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="1722"><highlight class="normal"><sp/><sp/><sp/><sp/>rectsearch.SetUniqueMode(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/><sp/><sp/>rectsearch.StartRectSearch(table_box);</highlight></codeline>
<codeline lineno="1724"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>part;</highlight></codeline>
<codeline lineno="1725"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>rectsearch.NextRectSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!part-&gt;IsTextType())</highlight></codeline>
<codeline lineno="1727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Do<sp/>not<sp/>consider<sp/>non-text<sp/>partitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;flow()<sp/>==<sp/><ref refid="blobbox_8h_1aa72f1499398e9694bf46752e1cc895e1a64e3e70c4fac4d4e3facdb4638307d7f" kindref="member">BTFT_LEADER</ref>)</highlight></codeline>
<codeline lineno="1729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Assume<sp/>leaders<sp/>are<sp/>in<sp/>tables</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>part_box<sp/>=<sp/>part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Do<sp/>not<sp/>consider<sp/>partitions<sp/>partially<sp/>covered<sp/>by<sp/>the<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part_box.<ref refid="class_t_b_o_x_1a9e8d88530048135be86afb906ff9dd74" kindref="member">overlap_fraction</ref>(table_box)<sp/>&lt;<sp/><ref refid="namespacetesseract_1a0f2ae212b6b475efca7981fd1dc51e29" kindref="member">kMinOverlapWithTable</ref>)</highlight></codeline>
<codeline lineno="1733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>BLOBNBOX_CLIST*<sp/>part_boxes<sp/>=<sp/>part-&gt;boxes();</highlight></codeline>
<codeline lineno="1735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>BLOBNBOX_C_IT<sp/>pit(part_boxes);</highlight></codeline>
<codeline lineno="1736"><highlight class="normal"></highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Make<sp/>sure<sp/>overlapping<sp/>blobs<sp/>don&apos;t<sp/>artificially<sp/>inflate<sp/>the<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>of<sp/>rows<sp/>in<sp/>the<sp/>table.<sp/>This<sp/>happens<sp/>frequently<sp/>with<sp/>things<sp/>such<sp/>as</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>decimals<sp/>and<sp/>split<sp/>characters.<sp/>Do<sp/>this<sp/>by<sp/>assuming<sp/>the<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>partition<sp/>is<sp/>sorted<sp/>mostly<sp/>left<sp/>to<sp/>right<sp/>and<sp/>just<sp/>clip</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>bounding<sp/>boxes<sp/>by<sp/>the<sp/>previous<sp/>box&apos;s<sp/>extent.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>next_position_to_write<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1743"><highlight class="normal"></highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(pit.mark_cycle_pt();<sp/>!pit.cycled_list();<sp/>pit.forward())<sp/>{</highlight></codeline>
<codeline lineno="1745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>*pblob<sp/>=<sp/>pit.data();</highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ignore<sp/>blob<sp/>height<sp/>for<sp/>the<sp/>purpose<sp/>of<sp/>projection<sp/>since<sp/>we</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>are<sp/>only<sp/>interested<sp/>in<sp/>finding<sp/>valleys</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>xstart<sp/>=<sp/>pblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>();</highlight></codeline>
<codeline lineno="1749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>xend<sp/>=<sp/>pblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>();</highlight></codeline>
<codeline lineno="1750"><highlight class="normal"></highlight></codeline>
<codeline lineno="1751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xstart<sp/>=<sp/><ref refid="ndminx_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(xstart,<sp/>next_position_to_write);</highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>xstart;<sp/>i<sp/>&lt;<sp/>xend;<sp/>i++)</highlight></codeline>
<codeline lineno="1753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_xprojection[i<sp/>-<sp/><ref refid="classtesseract_1_1_table_finder_1afaa3f28f4a9e645ded90e9f74016b217" kindref="member">bleft</ref>().<ref refid="class_i_c_o_o_r_d_1a59722a47c540007c58a539f0e35b3f33" kindref="member" tooltip="access function ">x</ref>()]++;</highlight></codeline>
<codeline lineno="1754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next_position_to_write<sp/>=<sp/>xend;</highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1756"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1757"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Find<sp/>largest<sp/>valley<sp/>between<sp/>two<sp/>reasonable<sp/>peaks<sp/>in<sp/>the<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1758"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="classtesseract_1_1_table_finder_1a89d4134c1260f74cd0b0f6cbecfc2545" kindref="member">GapInXProjection</ref>(table_xprojection,<sp/>page_width))<sp/>{</highlight></codeline>
<codeline lineno="1759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>table_search.RemoveBBox();</highlight></codeline>
<codeline lineno="1760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>table;</highlight></codeline>
<codeline lineno="1761"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1762"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1763"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal">[]<sp/>table_xprojection;</highlight></codeline>
<codeline lineno="1764"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1765"><highlight class="normal"></highlight></codeline>
<codeline lineno="1766"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Return<sp/>true<sp/>if<sp/>at<sp/>least<sp/>one<sp/>gap<sp/>larger<sp/>than<sp/>the<sp/>global<sp/>x-height</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1767"><highlight class="normal"></highlight><highlight class="comment">//<sp/>exists<sp/>in<sp/>the<sp/>horizontal<sp/>projection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1768"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a89d4134c1260f74cd0b0f6cbecfc2545" kindref="member">TableFinder::GapInXProjection</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">*<sp/>xprojection,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>length)<sp/>{</highlight></codeline>
<codeline lineno="1769"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Find<sp/>peak<sp/>value<sp/>of<sp/>the<sp/>histogram</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1770"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>peak_value<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1771"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>length;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1772"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(xprojection[i]<sp/>&gt;<sp/>peak_value)<sp/>{</highlight></codeline>
<codeline lineno="1773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>peak_value<sp/>=<sp/>xprojection[i];</highlight></codeline>
<codeline lineno="1774"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1775"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1776"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Peak<sp/>value<sp/>represents<sp/>the<sp/>maximum<sp/>number<sp/>of<sp/>horizontally</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1777"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>overlapping<sp/>colpartitions,<sp/>so<sp/>this<sp/>can<sp/>be<sp/>considered<sp/>as<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1778"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>number<sp/>of<sp/>rows<sp/>in<sp/>the<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1779"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(peak_value<sp/>&lt;<sp/><ref refid="namespacetesseract_1a4947294f7e711f5f1713df9de000b1b8" kindref="member">kMinRowsInTable</ref>)</highlight></codeline>
<codeline lineno="1780"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1781"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>projection_threshold<sp/>=<sp/><ref refid="namespacetesseract_1ae12e73878098046ae28b0d54408359f7" kindref="member">kSmallTableProjectionThreshold</ref><sp/>*<sp/>peak_value;</highlight></codeline>
<codeline lineno="1782"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(peak_value<sp/>&gt;=<sp/><ref refid="namespacetesseract_1adf7c67274b1cdc63e4afeb2500796de7" kindref="member">kLargeTableRowCount</ref>)</highlight></codeline>
<codeline lineno="1783"><highlight class="normal"><sp/><sp/><sp/><sp/>projection_threshold<sp/>=<sp/><ref refid="namespacetesseract_1a39b11305adc922233ab775b31d94b6bb" kindref="member">kLargeTableProjectionThreshold</ref><sp/>*<sp/>peak_value;</highlight></codeline>
<codeline lineno="1784"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Threshold<sp/>the<sp/>histogram</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1785"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>length;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1786"><highlight class="normal"><sp/><sp/><sp/><sp/>xprojection[i]<sp/>=<sp/>(xprojection[i]<sp/>&gt;=<sp/>projection_threshold)<sp/>?<sp/>1<sp/>:<sp/>0;</highlight></codeline>
<codeline lineno="1787"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1788"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Find<sp/>the<sp/>largest<sp/>run<sp/>of<sp/>zeros<sp/>between<sp/>two<sp/>ones</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1789"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>largest_gap<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1790"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>run_start<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="1791"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>1;<sp/>i<sp/>&lt;<sp/>length;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1792"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>detect<sp/>start<sp/>of<sp/>a<sp/>run<sp/>of<sp/>zeros</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1793"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(xprojection[i<sp/>-<sp/>1]<sp/>&amp;&amp;<sp/>!xprojection[i])<sp/>{</highlight></codeline>
<codeline lineno="1794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>run_start<sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="1795"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1796"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>detect<sp/>end<sp/>of<sp/>a<sp/>run<sp/>of<sp/>zeros<sp/>and<sp/>update<sp/>the<sp/>value<sp/>of<sp/>largest<sp/>gap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1797"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(run_start<sp/>!=<sp/>-1<sp/>&amp;&amp;<sp/>!xprojection[i<sp/>-<sp/>1]<sp/>&amp;&amp;<sp/>xprojection[i])<sp/>{</highlight></codeline>
<codeline lineno="1798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>gap<sp/>=<sp/>i<sp/>-<sp/>run_start;</highlight></codeline>
<codeline lineno="1799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(gap<sp/>&gt;<sp/>largest_gap)</highlight></codeline>
<codeline lineno="1800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>largest_gap<sp/>=<sp/>gap;</highlight></codeline>
<codeline lineno="1801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>run_start<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="1802"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1803"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1804"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>largest_gap<sp/>&gt;<sp/><ref refid="namespacetesseract_1af950654bba3a03e1ba3f1df8177cdd73" kindref="member">kMaxXProjectionGapFactor</ref><sp/>*<sp/><ref refid="classtesseract_1_1_table_finder_1ab66e5e7382edbd8bc260fd5bca4f2914" kindref="member">global_median_xheight_</ref>;</highlight></codeline>
<codeline lineno="1805"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1806"><highlight class="normal"></highlight></codeline>
<codeline lineno="1807"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Given<sp/>the<sp/>location<sp/>of<sp/>a<sp/>table<sp/>&quot;guess&quot;,<sp/>try<sp/>to<sp/>overlay<sp/>a<sp/>cellular</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1808"><highlight class="normal"></highlight><highlight class="comment">//<sp/>grid<sp/>in<sp/>the<sp/>location,<sp/>adjusting<sp/>the<sp/>boundaries.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1809"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>Falsely<sp/>introduces:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1810"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>-headers/footers<sp/>(not<sp/>any<sp/>worse,<sp/>too<sp/>much<sp/>overlap<sp/>destroys<sp/>cells)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1811"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>-page<sp/>numbers<sp/>(not<sp/>worse,<sp/>included<sp/>because<sp/>maximize<sp/>margins)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1812"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>-equations<sp/>(nicely<sp/>fit<sp/>into<sp/>a<sp/>celluar<sp/>grid,<sp/>but<sp/>more<sp/>sparsely)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1813"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>-figures<sp/>(random<sp/>text<sp/>box,<sp/>also<sp/>sparse)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1814"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>-small<sp/>left-aligned<sp/>text<sp/>areas<sp/>with<sp/>overlapping<sp/>positioned<sp/>whitespace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1815"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>(rejected<sp/>before)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1816"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Overall,<sp/>this<sp/>just<sp/>needs<sp/>some<sp/>more<sp/>work.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1817"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a647fe056ae6bb33cc8989f08aac5172f" kindref="member">TableFinder::RecognizeTables</ref>()<sp/>{</highlight></codeline>
<codeline lineno="1818"><highlight class="normal"><sp/><sp/><ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>table_win<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1819"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_tables)<sp/>{</highlight></codeline>
<codeline lineno="1820"><highlight class="normal"><sp/><sp/><sp/><sp/>table_win<sp/>=<sp/><ref refid="classtesseract_1_1_table_finder_1a1d45a058db096f6040af24af402b2042" kindref="member">MakeWindow</ref>(0,<sp/>0,<sp/></highlight><highlight class="stringliteral">&quot;Table<sp/>Structure&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1821"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(table_win,<sp/>&amp;<ref refid="classtesseract_1_1_table_finder_1ad2da282ac5f2a2d4efbc463d80c7113c" kindref="member">fragmented_text_grid_</ref>,</highlight></codeline>
<codeline lineno="1822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a93aaf384b4a674f176e3dd1655c1ad95" kindref="member">ScrollView::LIGHT_BLUE</ref>);</highlight></codeline>
<codeline lineno="1823"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>table_grid_.DisplayBoxes(table_win);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1824"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1825"><highlight class="normal"></highlight></codeline>
<codeline lineno="1826"><highlight class="normal"></highlight></codeline>
<codeline lineno="1827"><highlight class="normal"><sp/><sp/>TableRecognizer<sp/>recognizer;</highlight></codeline>
<codeline lineno="1828"><highlight class="normal"><sp/><sp/>recognizer.Init();</highlight></codeline>
<codeline lineno="1829"><highlight class="normal"><sp/><sp/>recognizer.set_line_grid(&amp;<ref refid="classtesseract_1_1_table_finder_1a7fddea88c90c15d996f36963481b81cf" kindref="member">leader_and_ruling_grid_</ref>);</highlight></codeline>
<codeline lineno="1830"><highlight class="normal"><sp/><sp/>recognizer.set_text_grid(&amp;<ref refid="classtesseract_1_1_table_finder_1ad2da282ac5f2a2d4efbc463d80c7113c" kindref="member">fragmented_text_grid_</ref>);</highlight></codeline>
<codeline lineno="1831"><highlight class="normal"><sp/><sp/>recognizer.set_max_text_height(global_median_xheight_<sp/>*<sp/>2.0);</highlight></codeline>
<codeline lineno="1832"><highlight class="normal"><sp/><sp/>recognizer.set_min_height(1.5<sp/>*<sp/><ref refid="classtesseract_1_1_table_finder_1a704fbe9cb0edeaa969bb0cc2bd1f9dbd" kindref="member">gridheight</ref>());</highlight></codeline>
<codeline lineno="1833"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Loop<sp/>over<sp/>all<sp/>of<sp/>the<sp/>tables<sp/>and<sp/>try<sp/>to<sp/>fit<sp/>them.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1834"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Store<sp/>the<sp/>good<sp/>tables<sp/>here.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1835"><highlight class="normal"><sp/><sp/>ColSegment_CLIST<sp/>good_tables;</highlight></codeline>
<codeline lineno="1836"><highlight class="normal"><sp/><sp/>ColSegment_C_IT<sp/>good_it(&amp;good_tables);</highlight></codeline>
<codeline lineno="1837"><highlight class="normal"></highlight></codeline>
<codeline lineno="1838"><highlight class="normal"><sp/><sp/><ref refid="namespacetesseract_1ac7f2f25bfb4914e691db80a6b523c703" kindref="member">ColSegmentGridSearch</ref><sp/>gsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>);</highlight></codeline>
<codeline lineno="1839"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="1840"><highlight class="normal"><sp/><sp/>ColSegment*<sp/>found_table<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1841"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((found_table<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1842"><highlight class="normal"><sp/><sp/><sp/><sp/>gsearch.RemoveBBox();</highlight></codeline>
<codeline lineno="1843"><highlight class="normal"></highlight></codeline>
<codeline lineno="1844"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>goal<sp/>is<sp/>to<sp/>make<sp/>the<sp/>tables<sp/>persistent<sp/>in<sp/>a<sp/>list.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1845"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>When<sp/>that<sp/>happens,<sp/>this<sp/>will<sp/>move<sp/>into<sp/>the<sp/>search<sp/>loop.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1846"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>found_box<sp/>=<sp/>found_table-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1847"><highlight class="normal"><sp/><sp/><sp/><sp/>StructuredTable*<sp/>table_structure<sp/>=<sp/>recognizer.RecognizeTable(found_box);</highlight></codeline>
<codeline lineno="1848"><highlight class="normal"></highlight></codeline>
<codeline lineno="1849"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Process<sp/>a<sp/>table.<sp/>Good<sp/>tables<sp/>are<sp/>inserted<sp/>into<sp/>the<sp/>grid<sp/>again<sp/>later<sp/>on</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1850"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>We<sp/>can&apos;t<sp/>change<sp/>boxes<sp/>in<sp/>the<sp/>grid<sp/>while<sp/>it<sp/>is<sp/>running<sp/>a<sp/>search.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1851"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(table_structure<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_tables)<sp/>{</highlight></codeline>
<codeline lineno="1853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_structure-&gt;Display(table_win,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a3312de9754e4e61d9a699f23528a059a" kindref="member">ScrollView::LIME_GREEN</ref>);</highlight></codeline>
<codeline lineno="1854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>found_table-&gt;set_bounding_box(table_structure-&gt;bounding_box());</highlight></codeline>
<codeline lineno="1856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>table_structure;</highlight></codeline>
<codeline lineno="1857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>good_it.add_after_then_move(found_table);</highlight></codeline>
<codeline lineno="1858"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>found_table;</highlight></codeline>
<codeline lineno="1860"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1861"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1862"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(nbeato):<sp/>MERGE!!<sp/>There<sp/>is<sp/>awesome<sp/>info<sp/>now<sp/>available<sp/>for<sp/>merging.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1863"><highlight class="normal"></highlight></codeline>
<codeline lineno="1864"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>At<sp/>this<sp/>point,<sp/>the<sp/>grid<sp/>is<sp/>empty.<sp/>We<sp/>can<sp/>safely<sp/>insert<sp/>the<sp/>good<sp/>tables</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1865"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>back<sp/>into<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1866"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(good_it.mark_cycle_pt();<sp/>!good_it.cycled_list();<sp/>good_it.forward())</highlight></codeline>
<codeline lineno="1867"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>.<ref refid="classtesseract_1_1_b_b_grid_1a7b379525e3d60c68e583352ae4b8a750" kindref="member">InsertBBox</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>good_it.extract());</highlight></codeline>
<codeline lineno="1868"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1869"><highlight class="normal"></highlight></codeline>
<codeline lineno="1870"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Displays<sp/>the<sp/>column<sp/>segments<sp/>in<sp/>some<sp/>window.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1871"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a0778d0e3d6bc52330704d1143a73f90a" kindref="member">TableFinder::DisplayColSegments</ref>(<ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>win,</highlight></codeline>
<codeline lineno="1872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ColSegment_LIST<sp/>*segments,</highlight></codeline>
<codeline lineno="1873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/>color)<sp/>{</highlight></codeline>
<codeline lineno="1874"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="1875"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1a79855c525ec660b452382e9813d2edb5" kindref="member">Pen</ref>(color);</highlight></codeline>
<codeline lineno="1876"><highlight class="normal"><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1ad5f03af259325c42eaaffa843cd1fdde" kindref="member">Brush</ref>(<ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a77673d8f27617bcfe50a6ebdd81e8c79" kindref="member">ScrollView::NONE</ref>);</highlight></codeline>
<codeline lineno="1877"><highlight class="normal"><sp/><sp/>ColSegment_IT<sp/>it(segments);</highlight></codeline>
<codeline lineno="1878"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(it.mark_cycle_pt();<sp/>!it.cycled_list();<sp/>it.forward())<sp/>{</highlight></codeline>
<codeline lineno="1879"><highlight class="normal"><sp/><sp/><sp/><sp/>ColSegment*<sp/>col<sp/>=<sp/>it.data();</highlight></codeline>
<codeline lineno="1880"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box<sp/>=<sp/>col-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1881"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>left_x<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>();</highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>right_x<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>();</highlight></codeline>
<codeline lineno="1883"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>top_y<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>();</highlight></codeline>
<codeline lineno="1884"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bottom_y<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>();</highlight></codeline>
<codeline lineno="1885"><highlight class="normal"><sp/><sp/><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1ac2a8fdf5d37967ea4a298dc092b6ed0e" kindref="member">Rectangle</ref>(left_x,<sp/>bottom_y,<sp/>right_x,<sp/>top_y);</highlight></codeline>
<codeline lineno="1886"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1887"><highlight class="normal"><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1a609e2f95d6421deb558244f5d45cf25a" kindref="member">UpdateWindow</ref>();</highlight></codeline>
<codeline lineno="1888"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="1889"><highlight class="preprocessor"></highlight><highlight class="normal">}</highlight></codeline>
<codeline lineno="1890"><highlight class="normal"></highlight></codeline>
<codeline lineno="1891"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a7a179e84686323b5fd0d93cbb159bb6d" kindref="member">TableFinder::DisplayColSegmentGrid</ref>(<ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>win,<sp/><ref refid="namespacetesseract_1a80cfbd9a83df02629e2afd48c16880f0" kindref="member">ColSegmentGrid</ref>*<sp/>grid,</highlight></codeline>
<codeline lineno="1892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/>color)<sp/>{</highlight></codeline>
<codeline lineno="1893"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="1894"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>the<sp/>ColPartitions<sp/>in<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1895"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColSegment,<sp/>ColSegment_CLIST,<sp/>ColSegment_C_IT&gt;</highlight></codeline>
<codeline lineno="1896"><highlight class="normal"><sp/><sp/><sp/><sp/>gsearch(grid);</highlight></codeline>
<codeline lineno="1897"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="1898"><highlight class="normal"><sp/><sp/>ColSegment*<sp/>seg<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1899"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((seg<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1900"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box<sp/>=<sp/>seg-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1901"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>left_x<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>();</highlight></codeline>
<codeline lineno="1902"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>right_x<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>();</highlight></codeline>
<codeline lineno="1903"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>top_y<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>();</highlight></codeline>
<codeline lineno="1904"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bottom_y<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>();</highlight></codeline>
<codeline lineno="1905"><highlight class="normal"><sp/><sp/><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1ad5f03af259325c42eaaffa843cd1fdde" kindref="member">Brush</ref>(<ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a77673d8f27617bcfe50a6ebdd81e8c79" kindref="member">ScrollView::NONE</ref>);</highlight></codeline>
<codeline lineno="1906"><highlight class="normal"><sp/><sp/><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1a79855c525ec660b452382e9813d2edb5" kindref="member">Pen</ref>(color);</highlight></codeline>
<codeline lineno="1907"><highlight class="normal"><sp/><sp/><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1ac2a8fdf5d37967ea4a298dc092b6ed0e" kindref="member">Rectangle</ref>(left_x,<sp/>bottom_y,<sp/>right_x,<sp/>top_y);</highlight></codeline>
<codeline lineno="1908"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1909"><highlight class="normal"><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1a609e2f95d6421deb558244f5d45cf25a" kindref="member">UpdateWindow</ref>();</highlight></codeline>
<codeline lineno="1910"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="1911"><highlight class="preprocessor"></highlight><highlight class="normal">}</highlight></codeline>
<codeline lineno="1912"><highlight class="normal"></highlight></codeline>
<codeline lineno="1913"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Displays<sp/>the<sp/>colpartitions<sp/>using<sp/>a<sp/>new<sp/>coloring<sp/>on<sp/>an<sp/>existing<sp/>window.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1914"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Note:<sp/>This<sp/>method<sp/>is<sp/>only<sp/>for<sp/>debug<sp/>purpose<sp/>during<sp/>development<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1915"><highlight class="normal"></highlight><highlight class="comment">//<sp/>would<sp/>not<sp/>be<sp/>part<sp/>of<sp/>checked<sp/>in<sp/>code</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1916"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">TableFinder::DisplayColPartitions</ref>(<ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>win,</highlight></codeline>
<codeline lineno="1917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ColPartitionGrid*<sp/>grid,</highlight></codeline>
<codeline lineno="1918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/>default_color,</highlight></codeline>
<codeline lineno="1919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/>table_color)<sp/>{</highlight></codeline>
<codeline lineno="1920"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="1921"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/>color<sp/>=<sp/>default_color;</highlight></codeline>
<codeline lineno="1922"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>the<sp/>ColPartitions<sp/>in<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1923"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColPartition,<sp/>ColPartition_CLIST,<sp/>ColPartition_C_IT&gt;</highlight></codeline>
<codeline lineno="1924"><highlight class="normal"><sp/><sp/><sp/><sp/>gsearch(grid);</highlight></codeline>
<codeline lineno="1925"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="1926"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1927"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1928"><highlight class="normal"><sp/><sp/><sp/><sp/>color<sp/>=<sp/>default_color;</highlight></codeline>
<codeline lineno="1929"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref>)</highlight></codeline>
<codeline lineno="1930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>color<sp/>=<sp/>table_color;</highlight></codeline>
<codeline lineno="1931"><highlight class="normal"></highlight></codeline>
<codeline lineno="1932"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box<sp/>=<sp/>part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1933"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>left_x<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>();</highlight></codeline>
<codeline lineno="1934"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>right_x<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>();</highlight></codeline>
<codeline lineno="1935"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>top_y<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>();</highlight></codeline>
<codeline lineno="1936"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bottom_y<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>();</highlight></codeline>
<codeline lineno="1937"><highlight class="normal"><sp/><sp/><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1ad5f03af259325c42eaaffa843cd1fdde" kindref="member">Brush</ref>(<ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a77673d8f27617bcfe50a6ebdd81e8c79" kindref="member">ScrollView::NONE</ref>);</highlight></codeline>
<codeline lineno="1938"><highlight class="normal"><sp/><sp/><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1a79855c525ec660b452382e9813d2edb5" kindref="member">Pen</ref>(color);</highlight></codeline>
<codeline lineno="1939"><highlight class="normal"><sp/><sp/><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1ac2a8fdf5d37967ea4a298dc092b6ed0e" kindref="member">Rectangle</ref>(left_x,<sp/>bottom_y,<sp/>right_x,<sp/>top_y);</highlight></codeline>
<codeline lineno="1940"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1941"><highlight class="normal"><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1a609e2f95d6421deb558244f5d45cf25a" kindref="member">UpdateWindow</ref>();</highlight></codeline>
<codeline lineno="1942"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="1943"><highlight class="preprocessor"></highlight><highlight class="normal">}</highlight></codeline>
<codeline lineno="1944"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">TableFinder::DisplayColPartitions</ref>(<ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>win,</highlight></codeline>
<codeline lineno="1945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ColPartitionGrid*<sp/>grid,</highlight></codeline>
<codeline lineno="1946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/>default_color)<sp/>{</highlight></codeline>
<codeline lineno="1947"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_table_finder_1aea205753ca3f6e11043801843025e59e" kindref="member">DisplayColPartitions</ref>(win,<sp/>grid,<sp/>default_color,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a61dec9bc0aaf1d527a731b2a6ce055c8" kindref="member">ScrollView::YELLOW</ref>);</highlight></codeline>
<codeline lineno="1948"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1949"><highlight class="normal"></highlight></codeline>
<codeline lineno="1950"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1ae38774700a97b1690f1530d77432a762" kindref="member">TableFinder::DisplayColPartitionConnections</ref>(</highlight></codeline>
<codeline lineno="1951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view" kindref="compound">ScrollView</ref>*<sp/>win,</highlight></codeline>
<codeline lineno="1952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ColPartitionGrid*<sp/>grid,</highlight></codeline>
<codeline lineno="1953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/>color)<sp/>{</highlight></codeline>
<codeline lineno="1954"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="1955"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterate<sp/>the<sp/>ColPartitions<sp/>in<sp/>the<sp/>grid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1956"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColPartition,<sp/>ColPartition_CLIST,<sp/>ColPartition_C_IT&gt;</highlight></codeline>
<codeline lineno="1957"><highlight class="normal"><sp/><sp/><sp/><sp/>gsearch(grid);</highlight></codeline>
<codeline lineno="1958"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="1959"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1960"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1961"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box<sp/>=<sp/>part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1962"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>left_x<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>();</highlight></codeline>
<codeline lineno="1963"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>right_x<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>();</highlight></codeline>
<codeline lineno="1964"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>top_y<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>();</highlight></codeline>
<codeline lineno="1965"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bottom_y<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>();</highlight></codeline>
<codeline lineno="1966"><highlight class="normal"></highlight></codeline>
<codeline lineno="1967"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>upper_part<sp/>=<sp/>part-&gt;nearest_neighbor_above();</highlight></codeline>
<codeline lineno="1968"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(upper_part)<sp/>{</highlight></codeline>
<codeline lineno="1969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>upper_box<sp/>=<sp/>upper_part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mid_x<sp/>=<sp/>(left_x<sp/>+<sp/>right_x)<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mid_y<sp/>=<sp/>(top_y<sp/>+<sp/>bottom_y)<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>other_x<sp/>=<sp/>(upper_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>+<sp/>upper_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>())<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>other_y<sp/>=<sp/>(upper_box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>()<sp/>+<sp/>upper_box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>())<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1ad5f03af259325c42eaaffa843cd1fdde" kindref="member">Brush</ref>(<ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a77673d8f27617bcfe50a6ebdd81e8c79" kindref="member">ScrollView::NONE</ref>);</highlight></codeline>
<codeline lineno="1975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1a79855c525ec660b452382e9813d2edb5" kindref="member">Pen</ref>(color);</highlight></codeline>
<codeline lineno="1976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1a2ba16f17fc401bb28be1a08160207e45" kindref="member">Line</ref>(mid_x,<sp/>mid_y,<sp/>other_x,<sp/>other_y);</highlight></codeline>
<codeline lineno="1977"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1978"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>lower_part<sp/>=<sp/>part-&gt;nearest_neighbor_below();</highlight></codeline>
<codeline lineno="1979"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lower_part)<sp/>{</highlight></codeline>
<codeline lineno="1980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>lower_box<sp/>=<sp/>lower_part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="1981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mid_x<sp/>=<sp/>(left_x<sp/>+<sp/>right_x)<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mid_y<sp/>=<sp/>(top_y<sp/>+<sp/>bottom_y)<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>other_x<sp/>=<sp/>(lower_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>+<sp/>lower_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>())<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>other_y<sp/>=<sp/>(lower_box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>()<sp/>+<sp/>lower_box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>())<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1ad5f03af259325c42eaaffa843cd1fdde" kindref="member">Brush</ref>(<ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a77673d8f27617bcfe50a6ebdd81e8c79" kindref="member">ScrollView::NONE</ref>);</highlight></codeline>
<codeline lineno="1986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1a79855c525ec660b452382e9813d2edb5" kindref="member">Pen</ref>(color);</highlight></codeline>
<codeline lineno="1987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1a2ba16f17fc401bb28be1a08160207e45" kindref="member">Line</ref>(mid_x,<sp/>mid_y,<sp/>other_x,<sp/>other_y);</highlight></codeline>
<codeline lineno="1988"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1989"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1990"><highlight class="normal"><sp/><sp/>win-&gt;<ref refid="class_scroll_view_1a609e2f95d6421deb558244f5d45cf25a" kindref="member">UpdateWindow</ref>();</highlight></codeline>
<codeline lineno="1991"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="1992"><highlight class="preprocessor"></highlight><highlight class="normal">}</highlight></codeline>
<codeline lineno="1993"><highlight class="normal"></highlight></codeline>
<codeline lineno="1994"><highlight class="normal"></highlight></codeline>
<codeline lineno="1995"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Write<sp/>debug<sp/>image<sp/>and<sp/>text<sp/>file.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1996"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Note:<sp/>This<sp/>method<sp/>is<sp/>only<sp/>for<sp/>debug<sp/>purpose<sp/>during<sp/>development<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1997"><highlight class="normal"></highlight><highlight class="comment">//<sp/>would<sp/>not<sp/>be<sp/>part<sp/>of<sp/>checked<sp/>in<sp/>code</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1998"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1abbd932c16cdfa0cf35f9ef93e2e87f49" kindref="member">TableFinder::WriteToPix</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref>&amp;<sp/>reskew)<sp/>{</highlight></codeline>
<codeline lineno="1999"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Input<sp/>file<sp/>must<sp/>be<sp/>named<sp/>test1.tif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2000"><highlight class="normal"><sp/><sp/>PIX*<sp/>pix<sp/>=<sp/>pixRead(</highlight><highlight class="stringliteral">&quot;test1.tif&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2001"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pix)<sp/>{</highlight></codeline>
<codeline lineno="2002"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Input<sp/>file<sp/>test1.tif<sp/>not<sp/>found.\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2003"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2004"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2005"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>img_height<sp/>=<sp/>pixGetHeight(pix);</highlight></codeline>
<codeline lineno="2006"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>img_width<sp/>=<sp/>pixGetWidth(pix);</highlight></codeline>
<codeline lineno="2007"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Maximum<sp/>number<sp/>of<sp/>text<sp/>or<sp/>table<sp/>partitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2008"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_boxes<sp/>=<sp/>10;</highlight></codeline>
<codeline lineno="2009"><highlight class="normal"><sp/><sp/>BOXA*<sp/>text_box_array<sp/>=<sp/>boxaCreate(num_boxes);</highlight></codeline>
<codeline lineno="2010"><highlight class="normal"><sp/><sp/>BOXA*<sp/>table_box_array<sp/>=<sp/>boxaCreate(num_boxes);</highlight></codeline>
<codeline lineno="2011"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColPartition,<sp/>ColPartition_CLIST,<sp/>ColPartition_C_IT&gt;</highlight></codeline>
<codeline lineno="2012"><highlight class="normal"><sp/><sp/><sp/><sp/>gsearch(&amp;<ref refid="classtesseract_1_1_table_finder_1aec2f605cdeff11cb17d4cb9aba585b1b" kindref="member">clean_part_grid_</ref>);</highlight></codeline>
<codeline lineno="2013"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="2014"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part;</highlight></codeline>
<codeline lineno="2015"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>load<sp/>colpartitions<sp/>into<sp/>text_box_array<sp/>and<sp/>table_box_array</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2016"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2017"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>box<sp/>=<sp/>part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="2018"><highlight class="normal"><sp/><sp/><sp/><sp/>box.<ref refid="class_t_b_o_x_1a56b4e1cc91e8abcb9f97622da7468e98" kindref="member">rotate_large</ref>(reskew);</highlight></codeline>
<codeline lineno="2019"><highlight class="normal"><sp/><sp/><sp/><sp/>BOX*<sp/>lept_box<sp/>=<sp/>boxCreate(box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>(),<sp/>img_height<sp/>-<sp/>box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>(),</highlight></codeline>
<codeline lineno="2020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>()<sp/>-<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>(),</highlight></codeline>
<codeline lineno="2021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>()<sp/>-<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>());</highlight></codeline>
<codeline lineno="2022"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref>)</highlight></codeline>
<codeline lineno="2023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>boxaAddBox(table_box_array,<sp/>lept_box,<sp/>L_INSERT);</highlight></codeline>
<codeline lineno="2024"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>boxaAddBox(text_box_array,<sp/>lept_box,<sp/>L_INSERT);</highlight></codeline>
<codeline lineno="2026"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2027"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>draw<sp/>colpartitions<sp/>on<sp/>the<sp/>output<sp/>image</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2028"><highlight class="normal"><sp/><sp/>PIX*<sp/>out<sp/>=<sp/>pixDrawBoxa(pix,<sp/>text_box_array,<sp/>3,<sp/>0xff000000);</highlight></codeline>
<codeline lineno="2029"><highlight class="normal"><sp/><sp/>out<sp/>=<sp/>pixDrawBoxa(out,<sp/>table_box_array,<sp/>3,<sp/>0x0000ff00);</highlight></codeline>
<codeline lineno="2030"><highlight class="normal"></highlight></codeline>
<codeline lineno="2031"><highlight class="normal"><sp/><sp/>BOXA*<sp/>table_array<sp/>=<sp/>boxaCreate(num_boxes);</highlight></codeline>
<codeline lineno="2032"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>text<sp/>file<sp/>containing<sp/>detected<sp/>table<sp/>bounding<sp/>boxes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2033"><highlight class="normal"><sp/><sp/>FILE*<sp/>fptr<sp/>=<sp/>fopen(</highlight><highlight class="stringliteral">&quot;tess-table.txt&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;wb&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2034"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColSegment,<sp/>ColSegment_CLIST,<sp/>ColSegment_C_IT&gt;</highlight></codeline>
<codeline lineno="2035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>table_search(&amp;<ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>);</highlight></codeline>
<codeline lineno="2036"><highlight class="normal"><sp/><sp/>table_search.StartFullSearch();</highlight></codeline>
<codeline lineno="2037"><highlight class="normal"><sp/><sp/>ColSegment*<sp/>table;</highlight></codeline>
<codeline lineno="2038"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>load<sp/>table<sp/>boxes<sp/>to<sp/>table_array<sp/>and<sp/>write<sp/>them<sp/>to<sp/>text<sp/>file<sp/>as<sp/>well</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2039"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((table<sp/>=<sp/>table_search.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2040"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>box<sp/>=<sp/>table-&gt;bounding_box();</highlight></codeline>
<codeline lineno="2041"><highlight class="normal"><sp/><sp/><sp/><sp/>box.<ref refid="class_t_b_o_x_1a56b4e1cc91e8abcb9f97622da7468e98" kindref="member">rotate_large</ref>(reskew);</highlight></codeline>
<codeline lineno="2042"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Since<sp/>deskewing<sp/>introduces<sp/>negative<sp/>coordinates,<sp/>reskewing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2043"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>might<sp/>not<sp/>completely<sp/>recover<sp/>from<sp/>that<sp/>since<sp/>both<sp/>steps<sp/>enlarge</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2044"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>actual<sp/>box.<sp/>Hence<sp/>a<sp/>box<sp/>that<sp/>undergoes<sp/>deskewing/reskewing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2045"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>may<sp/>go<sp/>out<sp/>of<sp/>image<sp/>boundaries.<sp/>Crop<sp/>a<sp/>table<sp/>box<sp/>if<sp/>needed<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2046"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>contain<sp/>it<sp/>inside<sp/>the<sp/>image<sp/>dimensions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2047"><highlight class="normal"><sp/><sp/><sp/><sp/>box<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a33e45c7389737cdf1a908bca0af315c4" kindref="member">intersection</ref>(<ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>(0,<sp/>0,<sp/>img_width<sp/>-<sp/>1,<sp/>img_height<sp/>-<sp/>1));</highlight></codeline>
<codeline lineno="2048"><highlight class="normal"><sp/><sp/><sp/><sp/>BOX*<sp/>lept_box<sp/>=<sp/>boxCreate(box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>(),<sp/>img_height<sp/>-<sp/>box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>(),</highlight></codeline>
<codeline lineno="2049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>()<sp/>-<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>(),</highlight></codeline>
<codeline lineno="2050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>()<sp/>-<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>());</highlight></codeline>
<codeline lineno="2051"><highlight class="normal"><sp/><sp/><sp/><sp/>boxaAddBox(table_array,<sp/>lept_box,<sp/>L_INSERT);</highlight></codeline>
<codeline lineno="2052"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fptr,<sp/></highlight><highlight class="stringliteral">&quot;%d<sp/>%d<sp/>%d<sp/>%d<sp/>TABLE\n&quot;</highlight><highlight class="normal">,<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>(),</highlight></codeline>
<codeline lineno="2053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>img_height<sp/>-<sp/>box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>(),<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>(),<sp/>img_height<sp/>-<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>());</highlight></codeline>
<codeline lineno="2054"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2055"><highlight class="normal"><sp/><sp/>fclose(fptr);</highlight></codeline>
<codeline lineno="2056"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>paint<sp/>table<sp/>boxes<sp/>on<sp/>the<sp/>debug<sp/>image</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2057"><highlight class="normal"><sp/><sp/>out<sp/>=<sp/>pixDrawBoxa(out,<sp/>table_array,<sp/>5,<sp/>0x7fff0000);</highlight></codeline>
<codeline lineno="2058"><highlight class="normal"></highlight></codeline>
<codeline lineno="2059"><highlight class="normal"><sp/><sp/>pixWrite(</highlight><highlight class="stringliteral">&quot;out.png&quot;</highlight><highlight class="normal">,<sp/>out,<sp/>IFF_PNG);</highlight></codeline>
<codeline lineno="2060"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>memory<sp/>cleanup</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2061"><highlight class="normal"><sp/><sp/>boxaDestroy(&amp;text_box_array);</highlight></codeline>
<codeline lineno="2062"><highlight class="normal"><sp/><sp/>boxaDestroy(&amp;table_box_array);</highlight></codeline>
<codeline lineno="2063"><highlight class="normal"><sp/><sp/>boxaDestroy(&amp;table_array);</highlight></codeline>
<codeline lineno="2064"><highlight class="normal"><sp/><sp/>pixDestroy(&amp;pix);</highlight></codeline>
<codeline lineno="2065"><highlight class="normal"><sp/><sp/>pixDestroy(&amp;out);</highlight></codeline>
<codeline lineno="2066"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2067"><highlight class="normal"></highlight></codeline>
<codeline lineno="2068"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Merge<sp/>all<sp/>colpartitions<sp/>in<sp/>table<sp/>regions<sp/>to<sp/>make<sp/>them<sp/>a<sp/>single</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2069"><highlight class="normal"></highlight><highlight class="comment">//<sp/>colpartition<sp/>and<sp/>revert<sp/>types<sp/>of<sp/>isolated<sp/>table<sp/>cells<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2070"><highlight class="normal"></highlight><highlight class="comment">//<sp/>assigned<sp/>to<sp/>any<sp/>table<sp/>to<sp/>their<sp/>original<sp/>types.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2071"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_table_finder_1a1856836a1386196d5784244b4a1aa2d0" kindref="member">TableFinder::MakeTableBlocks</ref>(ColPartitionGrid*<sp/>grid,</highlight></codeline>
<codeline lineno="2072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ColPartitionSet**<sp/>all_columns,</highlight></codeline>
<codeline lineno="2073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacetesseract_1add06f170e88dcbac90a80ff20c42cc0a" kindref="member">WidthCallback</ref>*<sp/>width_cb)<sp/>{</highlight></codeline>
<codeline lineno="2074"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Since<sp/>we<sp/>have<sp/>table<sp/>blocks<sp/>already,<sp/>remove<sp/>table<sp/>tags<sp/>from<sp/>all</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2075"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>colpartitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2076"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColPartition,<sp/>ColPartition_CLIST,<sp/>ColPartition_C_IT&gt;</highlight></codeline>
<codeline lineno="2077"><highlight class="normal"><sp/><sp/><sp/><sp/>gsearch(grid);</highlight></codeline>
<codeline lineno="2078"><highlight class="normal"><sp/><sp/>gsearch.StartFullSearch();</highlight></codeline>
<codeline lineno="2079"><highlight class="normal"><sp/><sp/>ColPartition*<sp/>part<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="2080"><highlight class="normal"></highlight></codeline>
<codeline lineno="2081"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>gsearch.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2082"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part-&gt;type()<sp/>==<sp/><ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa5f41d3730899e22bf30c977bef2bcfa3" kindref="member">PT_TABLE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>part-&gt;clear_table_type();</highlight></codeline>
<codeline lineno="2084"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2085"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2086"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Now<sp/>make<sp/>a<sp/>single<sp/>colpartition<sp/>out<sp/>of<sp/>each<sp/>table<sp/>block<sp/>and<sp/>remove</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2087"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>all<sp/>colpartitions<sp/>contained<sp/>within<sp/>a<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2088"><highlight class="normal"><sp/><sp/>GridSearch&lt;ColSegment,<sp/>ColSegment_CLIST,<sp/>ColSegment_C_IT&gt;</highlight></codeline>
<codeline lineno="2089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>table_search(&amp;<ref refid="classtesseract_1_1_table_finder_1aba8f5765a3c7bbe13bee05b94308fec1" kindref="member">table_grid_</ref>);</highlight></codeline>
<codeline lineno="2090"><highlight class="normal"><sp/><sp/>table_search.StartFullSearch();</highlight></codeline>
<codeline lineno="2091"><highlight class="normal"><sp/><sp/>ColSegment*<sp/>table;</highlight></codeline>
<codeline lineno="2092"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((table<sp/>=<sp/>table_search.NextFullSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2093"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>table_box<sp/>=<sp/>table-&gt;bounding_box();</highlight></codeline>
<codeline lineno="2094"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Start<sp/>a<sp/>rect<sp/>search<sp/>on<sp/>table_box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2095"><highlight class="normal"><sp/><sp/><sp/><sp/>GridSearch&lt;ColPartition,<sp/>ColPartition_CLIST,<sp/>ColPartition_C_IT&gt;</highlight></codeline>
<codeline lineno="2096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rectsearch(grid);</highlight></codeline>
<codeline lineno="2097"><highlight class="normal"><sp/><sp/><sp/><sp/>rectsearch.StartRectSearch(table_box);</highlight></codeline>
<codeline lineno="2098"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>part;</highlight></codeline>
<codeline lineno="2099"><highlight class="normal"><sp/><sp/><sp/><sp/>ColPartition*<sp/>table_partition<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="2100"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((part<sp/>=<sp/>rectsearch.NextRectSearch())<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Do<sp/>not<sp/>consider<sp/>image<sp/>partitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!part-&gt;IsTextType())</highlight></codeline>
<codeline lineno="2103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>part_box<sp/>=<sp/>part-&gt;bounding_box();</highlight></codeline>
<codeline lineno="2105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Include<sp/>partition<sp/>in<sp/>the<sp/>table<sp/>if<sp/>more<sp/>than<sp/>half<sp/>of<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>is<sp/>covered<sp/>by<sp/>the<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(part_box.<ref refid="class_t_b_o_x_1a9e8d88530048135be86afb906ff9dd74" kindref="member">overlap_fraction</ref>(table_box)<sp/>&gt;<sp/><ref refid="namespacetesseract_1a0f2ae212b6b475efca7981fd1dc51e29" kindref="member">kMinOverlapWithTable</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rectsearch.RemoveBBox();</highlight></codeline>
<codeline lineno="2109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(table_partition)<sp/>{</highlight></codeline>
<codeline lineno="2110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_partition-&gt;Absorb(part,<sp/>width_cb);</highlight></codeline>
<codeline lineno="2111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_partition<sp/>=<sp/>part;</highlight></codeline>
<codeline lineno="2113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2115"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Insert<sp/>table<sp/>colpartition<sp/>back<sp/>to<sp/>part_grid_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(table_partition)<sp/>{</highlight></codeline>
<codeline lineno="2118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>To<sp/>match<sp/>the<sp/>columns<sp/>used<sp/>when<sp/>transforming<sp/>to<sp/>blocks,<sp/>the<sp/>new<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>partition<sp/>must<sp/>have<sp/>its<sp/>first<sp/>and<sp/>last<sp/>column<sp/>set<sp/>at<sp/>the<sp/>grid<sp/>y<sp/>that</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>corresponds<sp/>to<sp/>its<sp/>bottom.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>table_box<sp/>=<sp/>table_partition-&gt;bounding_box();</highlight></codeline>
<codeline lineno="2122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>grid_x,<sp/>grid_y;</highlight></codeline>
<codeline lineno="2123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>grid-&gt;GridCoords(table_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>(),<sp/>table_box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>(),<sp/>&amp;grid_x,<sp/>&amp;grid_y);</highlight></codeline>
<codeline lineno="2124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>table_partition-&gt;SetPartitionType(<ref refid="classtesseract_1_1_table_finder_1a945f735c68a1f3fe672e759828f36f71" kindref="member">resolution_</ref>,<sp/>all_columns[grid_y]);</highlight></codeline>
<codeline lineno="2125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>table_partition-&gt;set_table_type();</highlight></codeline>
<codeline lineno="2126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>table_partition-&gt;set_blob_type(<ref refid="blobbox_8h_1aebfaf711760a99b60c297d1d619df575a4f0b1431532d0e838187df32f2e822d7" kindref="member">BRT_TEXT</ref>);</highlight></codeline>
<codeline lineno="2127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>table_partition-&gt;set_flow(<ref refid="blobbox_8h_1aa72f1499398e9694bf46752e1cc895e1a8fa903eb3c633ef681659563769a8007" kindref="member">BTFT_CHAIN</ref>);</highlight></codeline>
<codeline lineno="2128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>table_partition-&gt;SetBlobTypes();</highlight></codeline>
<codeline lineno="2129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>grid-&gt;InsertBBox(</highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>table_partition);</highlight></codeline>
<codeline lineno="2130"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2131"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2132"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2133"><highlight class="normal"></highlight></codeline>
<codeline lineno="2136"><highlight class="normal"><ref refid="classtesseract_1_1_col_segment_1a874cf2f3d78f2feb57b0527b3edb9f82" kindref="member">ColSegment::ColSegment</ref>()</highlight></codeline>
<codeline lineno="2137"><highlight class="normal"><sp/><sp/><sp/><sp/>:<sp/><ref refid="class_e_l_i_s_t___l_i_n_k" kindref="compound">ELIST_LINK</ref>(),</highlight></codeline>
<codeline lineno="2138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>num_table_cells_(0),</highlight></codeline>
<codeline lineno="2139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>num_text_cells_(0),</highlight></codeline>
<codeline lineno="2140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>type_(<ref refid="namespacetesseract_1a25254b3df45454565d58a62480d3a6cbaee1976dbb59fbd65d366f0424759c729" kindref="member">COL_UNKNOWN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2141"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2142"><highlight class="normal"><ref refid="classtesseract_1_1_col_segment_1a69ec7d6f06f5a6794817f000d778bfb3" kindref="member">ColSegment::~ColSegment</ref>()<sp/>{</highlight></codeline>
<codeline lineno="2143"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2144"><highlight class="normal"></highlight></codeline>
<codeline lineno="2145"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Provides<sp/>a<sp/>color<sp/>for<sp/>BBGrid<sp/>to<sp/>draw<sp/>the<sp/>rectangle.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2146"><highlight class="normal"><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/><sp/><ref refid="classtesseract_1_1_col_segment_1ac93fb3f8a7db9ad2364fc5850fd959e8" kindref="member">ColSegment::BoxColor</ref>()</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="2147"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/>kBoxColors[<ref refid="capi_8h_1a02cfd8369d5ad8c70a8b90c0f40d677fa1cfce41c30bf1aefe403aaa66d271da1" kindref="member">PT_COUNT</ref>]<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="2148"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a61dec9bc0aaf1d527a731b2a6ce055c8" kindref="member">ScrollView::YELLOW</ref>,</highlight></codeline>
<codeline lineno="2149"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a66e5117e4930fdd9a43bdb674d57a719" kindref="member">ScrollView::BLUE</ref>,</highlight></codeline>
<codeline lineno="2150"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a61dec9bc0aaf1d527a731b2a6ce055c8" kindref="member">ScrollView::YELLOW</ref>,</highlight></codeline>
<codeline lineno="2151"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8aebeaaeee353c6f04b4498b1fef94bbb3" kindref="member">ScrollView::MAGENTA</ref>,</highlight></codeline>
<codeline lineno="2152"><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline lineno="2153"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>kBoxColors[type_];</highlight></codeline>
<codeline lineno="2154"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2155"><highlight class="normal"></highlight></codeline>
<codeline lineno="2156"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Insert<sp/>a<sp/>box<sp/>into<sp/>this<sp/>column<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2157"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_col_segment_1a2d9a6fbd449a9201bdda5b9ffc5a5cb9" kindref="member">ColSegment::InsertBox</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>other)<sp/>{</highlight></codeline>
<codeline lineno="2158"><highlight class="normal"><sp/><sp/>bounding_box_<sp/>=<sp/>bounding_box_.<ref refid="class_t_b_o_x_1ab8ae7b66782fa1802f78ff034da16089" kindref="member">bounding_union</ref>(other);</highlight></codeline>
<codeline lineno="2159"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2160"><highlight class="normal"></highlight></codeline>
<codeline lineno="2161"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Set<sp/>column<sp/>segment<sp/>type<sp/>based<sp/>on<sp/>the<sp/>ratio<sp/>of<sp/>text<sp/>and<sp/>table<sp/>partitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2162"><highlight class="normal"></highlight><highlight class="comment">//<sp/>in<sp/>it.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2163"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_col_segment_1a789e1edd90789444e3b420291969b196" kindref="member">ColSegment::set_type</ref>()<sp/>{</highlight></codeline>
<codeline lineno="2164"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(num_table_cells_<sp/>&gt;<sp/><ref refid="namespacetesseract_1a6a040ffaa830485299daa5c344ebe039" kindref="member">kTableColumnThreshold</ref><sp/>*<sp/>num_text_cells_)</highlight></codeline>
<codeline lineno="2165"><highlight class="normal"><sp/><sp/><sp/><sp/>type_<sp/>=<sp/><ref refid="namespacetesseract_1a25254b3df45454565d58a62480d3a6cba8943a61e53229e72f0f896ec8e415316" kindref="member">COL_TABLE</ref>;</highlight></codeline>
<codeline lineno="2166"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(num_text_cells_<sp/>&gt;<sp/>num_table_cells_)</highlight></codeline>
<codeline lineno="2167"><highlight class="normal"><sp/><sp/><sp/><sp/>type_<sp/>=<sp/><ref refid="namespacetesseract_1a25254b3df45454565d58a62480d3a6cba05d5fe5bf814b3e82827a3a321d5b2ec" kindref="member">COL_TEXT</ref>;</highlight></codeline>
<codeline lineno="2168"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2169"><highlight class="normal"><sp/><sp/><sp/><sp/>type_<sp/>=<sp/><ref refid="namespacetesseract_1a25254b3df45454565d58a62480d3a6cba794ff16294744099e9bab9ecf2cabc11" kindref="member">COL_MIXED</ref>;</highlight></codeline>
<codeline lineno="2170"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2171"><highlight class="normal"></highlight></codeline>
<codeline lineno="2172"><highlight class="normal">}<sp/><sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>tesseract.</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="/Users/makoto/Desktop/trunk/textord/tablefind.cpp"/>
  </compounddef>
</doxygen>
