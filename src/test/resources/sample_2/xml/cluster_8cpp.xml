<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.4">
  <compounddef id="cluster_8cpp" kind="file">
    <compoundname>cluster.cpp</compoundname>
    <includes refid="oldheap_8h" local="yes">oldheap.h</includes>
    <includes refid="const_8h" local="yes">const.h</includes>
    <includes refid="cluster_8h" local="yes">cluster.h</includes>
    <includes refid="emalloc_8h" local="yes">emalloc.h</includes>
    <includes refid="helpers_8h" local="yes">helpers.h</includes>
    <includes refid="matrix_8h" local="yes">matrix.h</includes>
    <includes refid="tprintf_8h" local="yes">tprintf.h</includes>
    <includes refid="danerror_8h" local="yes">danerror.h</includes>
    <includes refid="freelist_8h" local="yes">freelist.h</includes>
    <includes local="no">math.h</includes>
    <incdepgraph>
      <node id="23611">
        <label>cutil_class.h</label>
        <link refid="cutil__class_8h"/>
        <childnode refid="23612" relation="include">
        </childnode>
        <childnode refid="23625" relation="include">
        </childnode>
        <childnode refid="23608" relation="include">
        </childnode>
      </node>
      <node id="23640">
        <label>assert.h</label>
      </node>
      <node id="23607">
        <label>ndminx.h</label>
        <link refid="ndminx_8h"/>
      </node>
      <node id="23625">
        <label>const.h</label>
        <link refid="const_8h"/>
      </node>
      <node id="23600">
        <label>stdlib.h</label>
      </node>
      <node id="23595">
        <label>platform.h</label>
        <link refid="platform_8h"/>
        <childnode refid="23596" relation="include">
        </childnode>
      </node>
      <node id="23626">
        <label>cluster.h</label>
        <link refid="cluster_8h"/>
        <childnode refid="23627" relation="include">
        </childnode>
        <childnode refid="23637" relation="include">
        </childnode>
      </node>
      <node id="23647">
        <label>blckerr.h</label>
        <link refid="blckerr_8h"/>
        <childnode refid="23605" relation="include">
        </childnode>
      </node>
      <node id="23612">
        <label>ccutil.h</label>
        <link refid="ccutil_8h"/>
        <childnode refid="23613" relation="include">
        </childnode>
        <childnode refid="23605" relation="include">
        </childnode>
        <childnode refid="23608" relation="include">
        </childnode>
        <childnode refid="23622" relation="include">
        </childnode>
        <childnode refid="23602" relation="include">
        </childnode>
        <childnode refid="23620" relation="include">
        </childnode>
        <childnode refid="23623" relation="include">
        </childnode>
        <childnode refid="23624" relation="include">
        </childnode>
      </node>
      <node id="23635">
        <label>scrollview.h</label>
        <link refid="scrollview_8h"/>
        <childnode refid="23598" relation="include">
        </childnode>
      </node>
      <node id="23615">
        <label>serialis.h</label>
        <link refid="serialis_8h"/>
        <childnode refid="23600" relation="include">
        </childnode>
        <childnode refid="23599" relation="include">
        </childnode>
        <childnode refid="23598" relation="include">
        </childnode>
        <childnode refid="23609" relation="include">
        </childnode>
        <childnode refid="23605" relation="include">
        </childnode>
        <childnode refid="23616" relation="include">
        </childnode>
      </node>
      <node id="23630">
        <label>clst.h</label>
        <link refid="clst_8h"/>
        <childnode refid="23598" relation="include">
        </childnode>
        <childnode refid="23594" relation="include">
        </childnode>
        <childnode refid="23615" relation="include">
        </childnode>
        <childnode refid="23617" relation="include">
        </childnode>
      </node>
      <node id="23648">
        <label>stepblob.h</label>
        <link refid="stepblob_8h"/>
        <childnode refid="23649" relation="include">
        </childnode>
        <childnode refid="23631" relation="include">
        </childnode>
      </node>
      <node id="23642">
        <label>ratngs.h</label>
        <link refid="ratngs_8h"/>
        <childnode refid="23640" relation="include">
        </childnode>
        <childnode refid="23630" relation="include">
        </childnode>
        <childnode refid="23603" relation="include">
        </childnode>
        <childnode refid="23643" relation="include">
        </childnode>
        <childnode refid="23618" relation="include">
        </childnode>
        <childnode refid="23620" relation="include">
        </childnode>
        <childnode refid="23644" relation="include">
        </childnode>
      </node>
      <node id="23610">
        <label>stddef.h</label>
      </node>
      <node id="23619">
        <label>memory.h</label>
      </node>
      <node id="23639">
        <label>callcpp.h</label>
        <link refid="callcpp_8h"/>
        <childnode refid="23640" relation="include">
        </childnode>
        <childnode refid="23594" relation="include">
        </childnode>
        <childnode refid="23602" relation="include">
        </childnode>
        <childnode refid="23618" relation="include">
        </childnode>
      </node>
      <node id="23605">
        <label>errcode.h</label>
        <link refid="errcode_8h"/>
        <childnode refid="23594" relation="include">
        </childnode>
      </node>
      <node id="23596">
        <label>limits.h</label>
      </node>
      <node id="23627">
        <label>kdtree.h</label>
        <link refid="kdtree_8h"/>
        <childnode refid="23594" relation="include">
        </childnode>
        <childnode refid="23597" relation="include">
        </childnode>
        <childnode refid="23628" relation="include">
        </childnode>
      </node>
      <node id="23634">
        <label>ipoints.h</label>
        <link refid="ipoints_8h"/>
        <childnode refid="23632" relation="include">
        </childnode>
      </node>
      <node id="23651">
        <label>mod128.h</label>
        <link refid="mod128_8h"/>
        <childnode refid="23633" relation="include">
        </childnode>
      </node>
      <node id="23646">
        <label>elst2.h</label>
        <link refid="elst2_8h"/>
        <childnode refid="23598" relation="include">
        </childnode>
        <childnode refid="23594" relation="include">
        </childnode>
        <childnode refid="23615" relation="include">
        </childnode>
        <childnode refid="23617" relation="include">
        </childnode>
      </node>
      <node id="23623">
        <label>pthread.h</label>
      </node>
      <node id="23599">
        <label>string.h</label>
      </node>
      <node id="23621">
        <label>unicharmap.h</label>
        <link refid="unicharmap_8h"/>
        <childnode refid="23618" relation="include">
        </childnode>
      </node>
      <node id="23618">
        <label>unichar.h</label>
        <link refid="unichar_8h"/>
        <childnode refid="23619" relation="include">
        </childnode>
        <childnode refid="23599" relation="include">
        </childnode>
      </node>
      <node id="23597">
        <label>cutil.h</label>
        <link refid="cutil_8h"/>
        <childnode refid="23598" relation="include">
        </childnode>
        <childnode refid="23599" relation="include">
        </childnode>
        <childnode refid="23600" relation="include">
        </childnode>
        <childnode refid="23594" relation="include">
        </childnode>
        <childnode refid="23601" relation="include">
        </childnode>
        <childnode refid="23611" relation="include">
        </childnode>
      </node>
      <node id="23631">
        <label>rect.h</label>
        <link refid="rect_8h"/>
        <childnode refid="23632" relation="include">
        </childnode>
        <childnode refid="23633" relation="include">
        </childnode>
        <childnode refid="23607" relation="include">
        </childnode>
        <childnode refid="23635" relation="include">
        </childnode>
        <childnode refid="23601" relation="include">
        </childnode>
      </node>
      <node id="23645">
        <label>bits16.h</label>
        <link refid="bits16_8h"/>
        <childnode refid="23594" relation="include">
        </childnode>
      </node>
      <node id="23604">
        <label>tesscallback.h</label>
        <link refid="tesscallback_8h"/>
        <childnode refid="23594" relation="include">
        </childnode>
      </node>
      <node id="23624">
        <label>semaphore.h</label>
      </node>
      <node id="23649">
        <label>coutln.h</label>
        <link refid="coutln_8h"/>
        <childnode refid="23650" relation="include">
        </childnode>
        <childnode refid="23651" relation="include">
        </childnode>
        <childnode refid="23645" relation="include">
        </childnode>
        <childnode refid="23631" relation="include">
        </childnode>
        <childnode refid="23647" relation="include">
        </childnode>
        <childnode refid="23635" relation="include">
        </childnode>
      </node>
      <node id="23644">
        <label>werd.h</label>
        <link refid="werd_8h"/>
        <childnode refid="23602" relation="include">
        </childnode>
        <childnode refid="23645" relation="include">
        </childnode>
        <childnode refid="23646" relation="include">
        </childnode>
        <childnode refid="23608" relation="include">
        </childnode>
        <childnode refid="23647" relation="include">
        </childnode>
        <childnode refid="23648" relation="include">
        </childnode>
        <childnode refid="23652" relation="include">
        </childnode>
      </node>
      <node id="23655">
        <label>danerror.h</label>
        <link refid="danerror_8h"/>
      </node>
      <node id="23652">
        <label>ocrrow.h</label>
        <link refid="ocrrow_8h"/>
        <childnode refid="23598" relation="include">
        </childnode>
        <childnode refid="23653" relation="include">
        </childnode>
        <childnode refid="23644" relation="include">
        </childnode>
      </node>
      <node id="23616">
        <label>fileerr.h</label>
        <link refid="fileerr_8h"/>
        <childnode refid="23605" relation="include">
        </childnode>
      </node>
      <node id="23613">
        <label>ambigs.h</label>
        <link refid="ambigs_8h"/>
        <childnode refid="23614" relation="include">
        </childnode>
        <childnode refid="23601" relation="include">
        </childnode>
        <childnode refid="23618" relation="include">
        </childnode>
        <childnode refid="23620" relation="include">
        </childnode>
        <childnode refid="23603" relation="include">
        </childnode>
      </node>
      <node id="23650">
        <label>crakedge.h</label>
        <link refid="crakedge_8h"/>
        <childnode refid="23633" relation="include">
        </childnode>
        <childnode refid="23651" relation="include">
        </childnode>
      </node>
      <node id="23632">
        <label>math.h</label>
      </node>
      <node id="23617">
        <label>lsterr.h</label>
        <link refid="lsterr_8h"/>
        <childnode refid="23605" relation="include">
        </childnode>
      </node>
      <node id="23654">
        <label>quadratc.h</label>
        <link refid="quadratc_8h"/>
        <childnode refid="23633" relation="include">
        </childnode>
      </node>
      <node id="23638">
        <label>emalloc.h</label>
        <link refid="emalloc_8h"/>
        <childnode refid="23594" relation="include">
        </childnode>
        <childnode refid="23639" relation="include">
        </childnode>
      </node>
      <node id="23636">
        <label>vecfuncs.h</label>
        <link refid="vecfuncs_8h"/>
        <childnode refid="23632" relation="include">
        </childnode>
        <childnode refid="23629" relation="include">
        </childnode>
      </node>
      <node id="23637">
        <label>oldlist.h</label>
        <link refid="oldlist_8h"/>
        <childnode refid="23597" relation="include">
        </childnode>
        <childnode refid="23604" relation="include">
        </childnode>
      </node>
      <node id="23628">
        <label>ocrfeatures.h</label>
        <link refid="ocrfeatures_8h"/>
        <childnode refid="23629" relation="include">
        </childnode>
        <childnode refid="23598" relation="include">
        </childnode>
      </node>
      <node id="23602">
        <label>params.h</label>
        <link refid="params_8h"/>
        <childnode refid="23598" relation="include">
        </childnode>
        <childnode refid="23603" relation="include">
        </childnode>
        <childnode refid="23608" relation="include">
        </childnode>
      </node>
      <node id="23603">
        <label>genericvector.h</label>
        <link refid="genericvector_8h"/>
        <childnode refid="23598" relation="include">
        </childnode>
        <childnode refid="23600" relation="include">
        </childnode>
        <childnode refid="23604" relation="include">
        </childnode>
        <childnode refid="23605" relation="include">
        </childnode>
        <childnode refid="23606" relation="include">
        </childnode>
        <childnode refid="23607" relation="include">
        </childnode>
      </node>
      <node id="23609">
        <label>memry.h</label>
        <link refid="memry_8h"/>
        <childnode refid="23610" relation="include">
        </childnode>
        <childnode refid="23594" relation="include">
        </childnode>
      </node>
      <node id="23656">
        <label>freelist.h</label>
        <link refid="freelist_8h"/>
        <childnode refid="23598" relation="include">
        </childnode>
      </node>
      <node id="23614">
        <label>elst.h</label>
        <link refid="elst_8h"/>
        <childnode refid="23598" relation="include">
        </childnode>
        <childnode refid="23594" relation="include">
        </childnode>
        <childnode refid="23615" relation="include">
        </childnode>
        <childnode refid="23617" relation="include">
        </childnode>
      </node>
      <node id="23620">
        <label>unicharset.h</label>
        <link refid="unicharset_8h"/>
        <childnode refid="23605" relation="include">
        </childnode>
        <childnode refid="23606" relation="include">
        </childnode>
        <childnode refid="23608" relation="include">
        </childnode>
        <childnode refid="23604" relation="include">
        </childnode>
        <childnode refid="23618" relation="include">
        </childnode>
        <childnode refid="23621" relation="include">
        </childnode>
      </node>
      <node id="23593">
        <label>oldheap.h</label>
        <link refid="oldheap_8h"/>
        <childnode refid="23594" relation="include">
        </childnode>
        <childnode refid="23597" relation="include">
        </childnode>
      </node>
      <node id="23633">
        <label>points.h</label>
        <link refid="points_8h"/>
        <childnode refid="23598" relation="include">
        </childnode>
        <childnode refid="23632" relation="include">
        </childnode>
        <childnode refid="23614" relation="include">
        </childnode>
        <childnode refid="23634" relation="include">
        </childnode>
      </node>
      <node id="23643">
        <label>notdll.h</label>
        <link refid="notdll_8h"/>
      </node>
      <node id="23601">
        <label>tprintf.h</label>
        <link refid="tprintf_8h"/>
        <childnode refid="23602" relation="include">
        </childnode>
      </node>
      <node id="23594">
        <label>host.h</label>
        <link refid="host_8h"/>
        <childnode refid="23595" relation="include">
        </childnode>
      </node>
      <node id="23592">
        <label>classify/cluster.cpp</label>
        <link refid="cluster.cpp"/>
        <childnode refid="23593" relation="include">
        </childnode>
        <childnode refid="23625" relation="include">
        </childnode>
        <childnode refid="23626" relation="include">
        </childnode>
        <childnode refid="23638" relation="include">
        </childnode>
        <childnode refid="23606" relation="include">
        </childnode>
        <childnode refid="23641" relation="include">
        </childnode>
        <childnode refid="23601" relation="include">
        </childnode>
        <childnode refid="23655" relation="include">
        </childnode>
        <childnode refid="23656" relation="include">
        </childnode>
        <childnode refid="23632" relation="include">
        </childnode>
      </node>
      <node id="23598">
        <label>stdio.h</label>
      </node>
      <node id="23641">
        <label>matrix.h</label>
        <link refid="matrix_8h"/>
        <childnode refid="23642" relation="include">
        </childnode>
        <childnode refid="23620" relation="include">
        </childnode>
      </node>
      <node id="23622">
        <label>tessdatamanager.h</label>
        <link refid="tessdatamanager_8h"/>
        <childnode refid="23598" relation="include">
        </childnode>
        <childnode refid="23594" relation="include">
        </childnode>
        <childnode refid="23601" relation="include">
        </childnode>
      </node>
      <node id="23608">
        <label>strngs.h</label>
        <link refid="strngs_8h"/>
        <childnode refid="23598" relation="include">
        </childnode>
        <childnode refid="23599" relation="include">
        </childnode>
        <childnode refid="23595" relation="include">
        </childnode>
        <childnode refid="23609" relation="include">
        </childnode>
      </node>
      <node id="23629">
        <label>blobs.h</label>
        <link refid="blobs_8h"/>
        <childnode refid="23630" relation="include">
        </childnode>
        <childnode refid="23631" relation="include">
        </childnode>
        <childnode refid="23636" relation="include">
        </childnode>
      </node>
      <node id="23606">
        <label>helpers.h</label>
        <link refid="helpers_8h"/>
        <childnode refid="23598" relation="include">
        </childnode>
        <childnode refid="23599" relation="include">
        </childnode>
      </node>
      <node id="23653">
        <label>quspline.h</label>
        <link refid="quspline_8h"/>
        <childnode refid="23654" relation="include">
        </childnode>
        <childnode refid="23615" relation="include">
        </childnode>
        <childnode refid="23609" relation="include">
        </childnode>
        <childnode refid="23631" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <innerclass refid="struct_t_e_m_p_c_l_u_s_t_e_r" prot="public">TEMPCLUSTER</innerclass>
    <innerclass refid="struct_s_t_a_t_i_s_t_i_c_s" prot="public">STATISTICS</innerclass>
    <innerclass refid="struct_b_u_c_k_e_t_s" prot="public">BUCKETS</innerclass>
    <innerclass refid="struct_c_h_i_s_t_r_u_c_t" prot="public">CHISTRUCT</innerclass>
    <innerclass refid="struct_clustering_context" prot="public">ClusteringContext</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="cluster_8cpp_1a6c16d1564de65f394e737811e5389042" prot="public" static="no">
        <name>HOTELLING</name>
        <initializer>1</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="29" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="29" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a1f0a56d752a245eeeabb4514e8b22cf8" prot="public" static="no">
        <name>FTABLE_X</name>
        <initializer>10</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="30" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="30" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1acd517e6d49c3394f0b9fe04fdb970699" prot="public" static="no">
        <name>FTABLE_Y</name>
        <initializer>100</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="31" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="31" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1ab070d4fc08948b5047625cb799a9ac89" prot="public" static="no">
        <name>MINVARIANCE</name>
        <initializer>0.0004</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="141" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="141" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1aef647ca436686ede9c7bb5a9fb203372" prot="public" static="no">
        <name>MINSAMPLESPERBUCKET</name>
        <initializer>5</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="149" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="149" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a47c31dab77cf79b225315601107dfd67" prot="public" static="no">
        <name>MINSAMPLES</name>
        <initializer>(<ref refid="cluster_8h_1a759b3b99f54d92a0c6c5471a4c87c42b" kindref="member">MINBUCKETS</ref> * <ref refid="cluster_8cpp_1aef647ca436686ede9c7bb5a9fb203372" kindref="member">MINSAMPLESPERBUCKET</ref>)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="150" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="150" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a6b4ec5de41f65e6f0f69b57db368bd54" prot="public" static="no">
        <name>MINSAMPLESNEEDED</name>
        <initializer>1</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="151" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="151" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a0b0900161a8584a70a474237621ce953" prot="public" static="no">
        <name>BUCKETTABLESIZE</name>
        <initializer>1024</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="159" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="159" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1ad3f8e9aec305987f3daa2d431da4cac3" prot="public" static="no">
        <name>NORMALEXTENT</name>
        <initializer>3.0</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="160" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="160" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a0662f2b2f6ae8b7ed59d9da773c0da35" prot="public" static="no">
        <name>Odd</name>
        <param><defname>N</defname></param>
        <initializer>((N)%2)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="202" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="202" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a42e41a23d64c7e8a69fbfd802e72c239" prot="public" static="no">
        <name>Mirror</name>
        <param><defname>N</defname></param>
        <param><defname>R</defname></param>
        <initializer>((R) - (N) - 1)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="203" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="203" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a060002a5aeab470cb24c8343daa1db08" prot="public" static="no">
        <name>Abs</name>
        <param><defname>N</defname></param>
        <initializer>( ( (N) &lt; 0 ) ? ( -(N) ) : (N) )</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="204" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="204" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a5b63c74defa53affeb3825bec1aa894d" prot="public" static="no">
        <name>SqrtOf2Pi</name>
        <initializer>2.506628275</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="214" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="214" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a4342455851ae586637e6a0abaf3b3f14" prot="public" static="no">
        <name>LOOKUPTABLESIZE</name>
        <initializer>8</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="224" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="224" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a1d372c446071a329984f36c50a4e6a8f" prot="public" static="no">
        <name>MAXDEGREESOFFREEDOM</name>
        <initializer><ref refid="cluster_8h_1a17645698964d2a3c89b72281594c58a3" kindref="member">MAXBUCKETS</ref></initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="225" column="9" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="225" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a8bfc8221d16b9c34781f2bf8753bd380" prot="public" static="no">
        <name>MAXNEIGHBORS</name>
        <initializer>2</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="799" column="9"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a010fa716ced1170c05d8fc9da46a5d34" prot="public" static="no">
        <name>MAXDISTANCE</name>
        <initializer><ref refid="host_8h_1a9adcee815220ec9db98062213806ed04" kindref="member">MAX_FLOAT32</ref></initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="800" column="9"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1aafca5fbbdd94e29a7a3b9ed7b41c1a4b" prot="public" static="no">
        <name>CHIACCURACY</name>
        <initializer>0.01</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="1901" column="9"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a01e04cb3a03fa1080646bfbcc45728d2" prot="public" static="no">
        <name>MINALPHA</name>
        <initializer>(1e-200)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="1902" column="9"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a3ac44273f534b72f12afd0d6560bbbed" prot="public" static="no">
        <name>INITIALDELTA</name>
        <initializer>0.1</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="2475" column="9"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a4a4390b86d05eddc0eb81787727debf8" prot="public" static="no">
        <name>DELTARATIO</name>
        <initializer>0.1</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="2476" column="10"/>
      </memberdef>
      <memberdef kind="define" id="cluster_8cpp_1a9d9bc16d6dee64280de6063de97939c1" prot="public" static="no">
        <name>ILLEGAL_CHAR</name>
        <initializer>2</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="2595" column="9"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="typedef">
      <memberdef kind="typedef" id="cluster_8cpp_1a32b61dc3b9e8987cc1a63db31c99c6e9" prot="public" static="no">
        <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>(*</type>
        <definition>typedef FLOAT64(* DENSITYFUNC)(inT32)</definition>
        <argsstring>)(inT32)</argsstring>
        <name>DENSITYFUNC</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="199" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="199" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="cluster_8cpp_1a170fa76dec6514a98bb069c4b9652f2d" prot="public" static="no">
        <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>(*</type>
        <definition>typedef FLOAT64(* SOLVEFUNC)(CHISTRUCT *, double)</definition>
        <argsstring>)(CHISTRUCT *, double)</argsstring>
        <name>SOLVEFUNC</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="200" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="200" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="cluster_8cpp_1a45a2c0c1c4ffd4de9723ccedf5727119" prot="public" static="no" mutable="no">
        <type>const double</type>
        <definition>const double FTable[100][10]</definition>
        <argsstring>[100][10]</argsstring>
        <name>FTable</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="34" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="34" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="cluster_8cpp_1aab4b049ee58256611189c495b5fe390f" prot="public" static="yes" mutable="no">
        <type>const <ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
        <definition>const FLOAT64 kNormalStdDev</definition>
        <argsstring></argsstring>
        <name>kNormalStdDev</name>
        <initializer>=  1024  / (2.0 *  3.0 )</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="215" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="215" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="cluster_8cpp_1a3fbe786751e07a69fdc678df4a4a9d59" prot="public" static="yes" mutable="no">
        <type>const <ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
        <definition>const FLOAT64 kNormalVariance</definition>
        <argsstring></argsstring>
        <name>kNormalVariance</name>
        <initializer>=
    ( 1024  *  1024 ) / (4.0 *  3.0  *  3.0 )</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="216" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="216" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="cluster_8cpp_1a20f707ffb2950777685b424f5ac1f502" prot="public" static="yes" mutable="no">
        <type>const <ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
        <definition>const FLOAT64 kNormalMagnitude</definition>
        <argsstring></argsstring>
        <name>kNormalMagnitude</name>
        <initializer>=
    (2.0 *  3.0 ) / ( 2.506628275  *  1024 )</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="218" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="218" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="cluster_8cpp_1aff71cee565c0b7118b68fabcd8ea3b9f" prot="public" static="yes" mutable="no">
        <type>const <ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
        <definition>const FLOAT64 kNormalMean</definition>
        <argsstring></argsstring>
        <name>kNormalMean</name>
        <initializer>=  1024  / 2</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="220" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="220" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="cluster_8cpp_1a0fe3fe490fd72edd3ac16a58f398b4c5" prot="public" static="yes" mutable="no">
        <type>const <ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref></type>
        <definition>const uinT32 kCountTable[8]</definition>
        <argsstring>[8]</argsstring>
        <name>kCountTable</name>
        <initializer>= {
   ( 5  *  5 ) , 200, 400, 600, 800, 1000, 1500, 2000
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="227" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="227" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="cluster_8cpp_1aa9b8f8aef74f13860eb2ae1c187c2bdf" prot="public" static="yes" mutable="no">
        <type>const <ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
        <definition>const uinT16 kBucketsTable[8]</definition>
        <argsstring>[8]</argsstring>
        <name>kBucketsTable</name>
        <initializer>= {
   5 , 16, 20, 24, 27, 30, 35,  39 
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="231" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="231" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="cluster_8cpp_1a4c81bc8616b0a41fc46726affcda9728" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void CreateClusterTree</definition>
        <argsstring>(CLUSTERER *Clusterer)</argsstring>
        <name>CreateClusterTree</name>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
          <declname>Clusterer</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>CreateClusterTree *******************************************************
</verbatim> Parameters: Clusterer data structure holdings samples to be clustered Operation: This routine performs a bottoms-up clustering on the samples held in the kd-tree of the Clusterer data structure. The result is a cluster tree. Each node in the tree represents a cluster which conceptually contains a subset of the samples. More precisely, the cluster contains all of the samples which are contained in its two sub-clusters. The leaves of the tree are the individual samples themselves; they have no sub-clusters. The root node of the tree conceptually contains all of the samples. Return: None (the Clusterer data structure is changed) Exceptions: None History: 5/29/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="238" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="694" bodyend="750"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1ae250df46fa1538fb7932e11d5a6aa98a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void MakePotentialClusters</definition>
        <argsstring>(ClusteringContext *context, CLUSTER *Cluster, inT32 Level)</argsstring>
        <name>MakePotentialClusters</name>
        <param>
          <type><ref refid="struct_clustering_context" kindref="compound">ClusteringContext</ref> *</type>
          <declname>context</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>Level</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>MakePotentialClusters ************************************************** Parameters: context <ref refid="struct_clustering_context" kindref="compound">ClusteringContext</ref> (see definition above) Cluster current cluster being visited in kd-tree walk Level level of this cluster in the kd-tree Operation: This routine is designed to be used in concert with the KDWalk routine. It will create a potential cluster for each sample in the kd-tree that is being walked. This potential cluster will then be pushed on the heap. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="240" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="764" bodyend="778"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a45fae84caf7ba68e1a77fdffe9f0d112" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
        <definition>CLUSTER * FindNearestNeighbor</definition>
        <argsstring>(KDTREE *Tree, CLUSTER *Cluster, FLOAT32 *Distance)</argsstring>
        <name>FindNearestNeighbor</name>
        <param>
          <type><ref refid="struct_k_d_t_r_e_e" kindref="compound">KDTREE</ref> *</type>
          <declname>Tree</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref> *</type>
          <declname>Distance</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>FindNearestNeighbor *********************************************************
</verbatim> Parameters: Tree kd-tree to search in for nearest neighbor Cluster cluster whose nearest neighbor is to be found Distance ptr to variable to report distance found Operation: This routine searches the specified kd-tree for the nearest neighbor of the specified cluster. It actually uses the kd routines to find the 2 nearest neighbors since one of them will be the original cluster. A pointer to the nearest neighbor is returned, if it can be found, otherwise NULL is returned. The distance between the 2 nodes is placed in the specified variable. Return: Pointer to the nearest neighbor of Cluster, or NULL Exceptions: none History: 5/29/89, DSJ, Created. 7/13/89, DSJ, Removed visibility of kd-tree node data struct </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="243" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="798" bodyend="822"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1ab73b69de28e8bb2f1332524a02f6f475" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
        <definition>CLUSTER * MakeNewCluster</definition>
        <argsstring>(CLUSTERER *Clusterer, TEMPCLUSTER *TempCluster)</argsstring>
        <name>MakeNewCluster</name>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
          <declname>Clusterer</declname>
        </param>
        <param>
          <type><ref refid="struct_t_e_m_p_c_l_u_s_t_e_r" kindref="compound">TEMPCLUSTER</ref> *</type>
          <declname>TempCluster</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>MakeNewCluster *************************************************************
</verbatim> Parameters: Clusterer current clustering environment TempCluster potential cluster to make permanent Operation: This routine creates a new permanent cluster from the clusters specified in TempCluster. The 2 clusters in TempCluster are marked as &quot;clustered&quot; and deleted from the kd-tree. The new cluster is then added to the kd-tree. Return: Pointer to the new permanent cluster Exceptions: none History: 5/29/89, DSJ, Created. 7/13/89, DSJ, Removed visibility of kd-tree node data struct </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="247" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="837" bodyend="864"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a13004a2cbbcf26c3d95fd207274823c9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
        <definition>inT32 MergeClusters</definition>
        <argsstring>(inT16 N, register PARAM_DESC ParamDesc[], register inT32 n1, register inT32 n2, register FLOAT32 m[], register FLOAT32 m1[], register FLOAT32 m2[])</argsstring>
        <name>MergeClusters</name>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>N</declname>
        </param>
        <param>
          <type>register <ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref></type>
          <declname>ParamDesc</declname>
          <array>[]</array>
        </param>
        <param>
          <type>register <ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>n1</declname>
        </param>
        <param>
          <type>register <ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>n2</declname>
        </param>
        <param>
          <type>register <ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>m</declname>
          <array>[]</array>
        </param>
        <param>
          <type>register <ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>m1</declname>
          <array>[]</array>
        </param>
        <param>
          <type>register <ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>m2</declname>
          <array>[]</array>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="249" column="1"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a85e813bae86e0c290ceb0f99d83ae9bf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ComputePrototypes</definition>
        <argsstring>(CLUSTERER *Clusterer, CLUSTERCONFIG *Config)</argsstring>
        <name>ComputePrototypes</name>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
          <declname>Clusterer</declname>
        </param>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g" kindref="compound">CLUSTERCONFIG</ref> *</type>
          <declname>Config</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>ComputePrototypes *******************************************************
</verbatim> Parameters: Clusterer data structure holding cluster tree Config parameters used to control prototype generation Operation: This routine decides which clusters in the cluster tree should be represented by prototypes, forms a list of these prototypes, and places the list in the Clusterer data structure. Return: None Exceptions: None History: 5/30/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="256" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="927" bodyend="953"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1aa37ac7f48ca91b0afb78f8408e8b9b6f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
        <definition>PROTOTYPE * MakePrototype</definition>
        <argsstring>(CLUSTERER *Clusterer, CLUSTERCONFIG *Config, CLUSTER *Cluster)</argsstring>
        <name>MakePrototype</name>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
          <declname>Clusterer</declname>
        </param>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g" kindref="compound">CLUSTERCONFIG</ref> *</type>
          <declname>Config</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>MakePrototype ***********************************************************
</verbatim> Parameters: Clusterer data structure holding cluster tree Config parameters used to control prototype generation Cluster cluster to be made into a prototype Operation: This routine attempts to create a prototype from the specified cluster that conforms to the distribution specified in Config. If there are too few samples in the cluster to perform a statistical analysis, then a prototype is generated but labelled as insignificant. If the dimensions of the cluster are not independent, no prototype is generated and NULL is returned. If a prototype can be found that matches the desired distribution then a pointer to it is returned, otherwise NULL is returned. Return: Pointer to new prototype or NULL Exceptions: None History: 6/19/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="258" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="974" bodyend="1043"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1abd55a5befb4eda77f5d0abbd460cc501" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
        <definition>PROTOTYPE * MakeDegenerateProto</definition>
        <argsstring>(uinT16 N, CLUSTER *Cluster, STATISTICS *Statistics, PROTOSTYLE Style, inT32 MinSamples)</argsstring>
        <name>MakeDegenerateProto</name>
        <param>
          <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
          <declname>N</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <param>
          <type><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref> *</type>
          <declname>Statistics</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9ea" kindref="member">PROTOSTYLE</ref></type>
          <declname>Style</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>MinSamples</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>MakeDegenerateProto ******************************************************
</verbatim> Parameters: N number of dimensions Cluster cluster being analyzed Statistics statistical info about cluster Style type of prototype to be generated MinSamples minimum number of samples in a cluster Operation: This routine checks for clusters which are degenerate and therefore cannot be analyzed in a statistically valid way. A cluster is defined as degenerate if it does not have at least MINSAMPLESNEEDED samples in it. If the cluster is found to be degenerate, a prototype of the specified style is generated and marked as insignificant. A cluster is also degenerate if it does not have at least MinSamples samples in it. If the cluster is not degenerate, NULL is returned. Return: Pointer to degenerate prototype or NULL. Exceptions: None History: 6/20/89, DSJ, Created. 7/12/89, DSJ, Changed name and added check for 0 stddev. 8/8/89, DSJ, Removed check for 0 stddev (handled elsewhere). </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="262" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1067" bodyend="1094"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a52963d24aa278bff9a1de24806954d61" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
        <definition>PROTOTYPE * TestEllipticalProto</definition>
        <argsstring>(CLUSTERER *Clusterer, CLUSTERCONFIG *Config, CLUSTER *Cluster, STATISTICS *Statistics)</argsstring>
        <name>TestEllipticalProto</name>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
          <declname>Clusterer</declname>
        </param>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g" kindref="compound">CLUSTERCONFIG</ref> *</type>
          <declname>Config</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <param>
          <type><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref> *</type>
          <declname>Statistics</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>TestEllipticalProto ****************************************************
</verbatim> Parameters: Clusterer data struct containing samples being clustered Config provides the magic number of samples that make a good cluster Cluster cluster to be made into an elliptical prototype Statistics statistical info about cluster Operation: This routine tests the specified cluster to see if ** there is a statistically significant difference between the sub-clusters that would be made if the cluster were to be split. If not, then a new prototype is formed and returned to the caller. If there is, then NULL is returned to the caller. Return: Pointer to new elliptical prototype or NULL. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="268" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1109" bodyend="1201"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1ad04d25bb39e413b1cd7064534b98f9a4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
        <definition>PROTOTYPE * MakeSphericalProto</definition>
        <argsstring>(CLUSTERER *Clusterer, CLUSTER *Cluster, STATISTICS *Statistics, BUCKETS *Buckets)</argsstring>
        <name>MakeSphericalProto</name>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
          <declname>Clusterer</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <param>
          <type><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref> *</type>
          <declname>Statistics</declname>
        </param>
        <param>
          <type><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref> *</type>
          <declname>Buckets</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="273" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1216" bodyend="1238"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a076b9ff3e723f44987211c9bf5f77523" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
        <definition>PROTOTYPE * MakeEllipticalProto</definition>
        <argsstring>(CLUSTERER *Clusterer, CLUSTER *Cluster, STATISTICS *Statistics, BUCKETS *Buckets)</argsstring>
        <name>MakeEllipticalProto</name>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
          <declname>Clusterer</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <param>
          <type><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref> *</type>
          <declname>Statistics</declname>
        </param>
        <param>
          <type><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref> *</type>
          <declname>Buckets</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>MakeEllipticalProto ****************************************************
</verbatim> Parameters: Clusterer data struct containing samples being clustered Cluster cluster to be made into an elliptical prototype Statistics statistical info about cluster Buckets histogram struct used to analyze distribution Operation: This routine tests the specified cluster to see if it can be approximated by an elliptical normal distribution. If it can be, then a new prototype is formed and returned to the caller. If it can&apos;t be, then NULL is returned to the caller. Return: Pointer to new elliptical prototype or NULL. Exceptions: None History: 6/12/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="278" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1254" bodyend="1277"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a2ebb51aa33fe2a99f5326366ed86b42e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
        <definition>PROTOTYPE * MakeMixedProto</definition>
        <argsstring>(CLUSTERER *Clusterer, CLUSTER *Cluster, STATISTICS *Statistics, BUCKETS *NormalBuckets, FLOAT64 Confidence)</argsstring>
        <name>MakeMixedProto</name>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
          <declname>Clusterer</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <param>
          <type><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref> *</type>
          <declname>Statistics</declname>
        </param>
        <param>
          <type><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref> *</type>
          <declname>NormalBuckets</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
          <declname>Confidence</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>MakeMixedProto ***********************************************************
</verbatim> Parameters: Clusterer data struct containing samples being clustered Cluster cluster to be made into a prototype Statistics statistical info about cluster NormalBuckets histogram struct used to analyze distribution Confidence confidence level for alternate distributions Operation: This routine tests each dimension of the specified cluster to see what distribution would best approximate that dimension. Each dimension is compared to the following distributions in order: normal, random, uniform. If each dimension can be represented by one of these distributions, then a new prototype is formed and returned to the caller. If it can&apos;t be, then NULL is returned to the caller. Return: Pointer to new mixed prototype or NULL. Exceptions: None History: 6/12/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="283" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1298" bodyend="1347"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1ae018c99abb6b7f691f2e4b711485b45b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void MakeDimRandom</definition>
        <argsstring>(uinT16 i, PROTOTYPE *Proto, PARAM_DESC *ParamDesc)</argsstring>
        <name>MakeDimRandom</name>
        <param>
          <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
          <declname>i</declname>
        </param>
        <param>
          <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
          <declname>Proto</declname>
        </param>
        <param>
          <type><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref> *</type>
          <declname>ParamDesc</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="289" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1360" bodyend="1372"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a12a01c4bc8f83968f4b64600bfff82de" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void MakeDimUniform</definition>
        <argsstring>(uinT16 i, PROTOTYPE *Proto, STATISTICS *Statistics)</argsstring>
        <name>MakeDimUniform</name>
        <param>
          <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
          <declname>i</declname>
        </param>
        <param>
          <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
          <declname>Proto</declname>
        </param>
        <param>
          <type><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref> *</type>
          <declname>Statistics</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>MakeDimUniform ***********************************************************
</verbatim> Parameters: i index of dimension to be changed Proto prototype whose dimension is to be altered Statistics statistical info about prototype Operation: This routine alters the ith dimension of the specified mixed prototype to be uniform. Return: None Exceptions: None History: 6/20/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="291" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1385" bodyend="1402"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1aa60411f531ca1f230d001973299d1c09" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref> *</type>
        <definition>STATISTICS * ComputeStatistics</definition>
        <argsstring>(inT16 N, PARAM_DESC ParamDesc[], CLUSTER *Cluster)</argsstring>
        <name>ComputeStatistics</name>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>N</declname>
        </param>
        <param>
          <type><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref></type>
          <declname>ParamDesc</declname>
          <array>[]</array>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>ComputeStatistics *********************************************************
</verbatim> Parameters: N number of dimensions ParamDesc array of dimension descriptions Cluster cluster whose stats are to be computed Operation: This routine searches the cluster tree for all leaf nodes which are samples in the specified cluster. It computes a full covariance matrix for these samples as well as keeping track of the ranges (min and max) for each dimension. A special data structure is allocated to return this information to the caller. An incremental algorithm for computing statistics is not used because it will not work with circular dimensions. Return: Pointer to new data structure containing statistics Exceptions: None History: 6/2/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="293" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1422" bodyend="1494"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a96019ee068587b2d17ddb6f43ded872b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
        <definition>PROTOTYPE * NewSphericalProto</definition>
        <argsstring>(uinT16 N, CLUSTER *Cluster, STATISTICS *Statistics)</argsstring>
        <name>NewSphericalProto</name>
        <param>
          <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
          <declname>N</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <param>
          <type><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref> *</type>
          <declname>Statistics</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>NewSpericalProto *********************************************************
</verbatim> Parameters: N number of dimensions Cluster cluster to be made into a spherical prototype Statistics statistical info about samples in cluster Operation: This routine creates a spherical prototype data structure to approximate the samples in the specified cluster. Spherical prototypes have a single variance which is common across all dimensions. All dimensions are normally distributed and independent. Return: Pointer to a new spherical prototype data structure Exceptions: None History: 6/19/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="296" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1510" bodyend="1529"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a1453a157e92261f5331f8624dfc4d3c0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
        <definition>PROTOTYPE * NewEllipticalProto</definition>
        <argsstring>(inT16 N, CLUSTER *Cluster, STATISTICS *Statistics)</argsstring>
        <name>NewEllipticalProto</name>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>N</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <param>
          <type><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref> *</type>
          <declname>Statistics</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>NewEllipticalProto *******************************************************
</verbatim> Parameters: N number of dimensions Cluster cluster to be made into an elliptical prototype Statistics statistical info about samples in cluster Operation: This routine creates an elliptical prototype data structure to approximate the samples in the specified cluster. Elliptical prototypes have a variance for each dimension. All dimensions are normally distributed and independent. Return: Pointer to a new elliptical prototype data structure Exceptions: None History: 6/19/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="300" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1544" bodyend="1571"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1accc05d5eedc4d765148eaa99c1927a79" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
        <definition>PROTOTYPE * NewMixedProto</definition>
        <argsstring>(inT16 N, CLUSTER *Cluster, STATISTICS *Statistics)</argsstring>
        <name>NewMixedProto</name>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>N</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <param>
          <type><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref> *</type>
          <declname>Statistics</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>MewMixedProto ************************************************************
</verbatim> Parameters: N number of dimensions Cluster cluster to be made into a mixed prototype Statistics statistical info about samples in cluster Operation: This routine creates a mixed prototype data structure to approximate the samples in the specified cluster. Mixed prototypes can have different distributions for each dimension. All dimensions are independent. The structure is initially filled in as though it were an elliptical prototype. The actual distributions of the dimensions can be altered by other routines. Return: Pointer to a new mixed prototype data structure Exceptions: None History: 6/19/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="304" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1589" bodyend="1601"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1adf2445f2aae1e1e03f06eefb85c95b8d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
        <definition>PROTOTYPE * NewSimpleProto</definition>
        <argsstring>(inT16 N, CLUSTER *Cluster)</argsstring>
        <name>NewSimpleProto</name>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>N</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>NewSimpleProto ***********************************************************
</verbatim> Parameters: N number of dimensions Cluster cluster to be made into a prototype Operation: This routine allocates memory to hold a simple prototype data structure, i.e. one without independent distributions and variances for each dimension. Return: Pointer to new simple prototype Exceptions: None History: 6/19/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="306" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1614" bodyend="1632"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a0a6fea38a06375666937701fb21e6a05" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
        <definition>BOOL8 Independent</definition>
        <argsstring>(PARAM_DESC ParamDesc[], inT16 N, FLOAT32 *CoVariance, FLOAT32 Independence)</argsstring>
        <name>Independent</name>
        <param>
          <type><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref></type>
          <declname>ParamDesc</declname>
          <array>[]</array>
        </param>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>N</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref> *</type>
          <declname>CoVariance</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>Independence</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Independent ***************************************************************
</verbatim> Parameters: ParamDesc descriptions of each feature space dimension N number of dimensions CoVariance ptr to a covariance matrix Independence max off-diagonal correlation coefficient Operation: This routine returns TRUE if the specified covariance matrix indicates that all N dimensions are independent of one another. One dimension is judged to be independent of another when the magnitude of the corresponding correlation coefficient is less than the specified Independence factor. The correlation coefficient is calculated as: (see Duda and Hart, pg. 247) coeff[ij] = stddev[ij] / sqrt (stddev[ii] * stddev[jj]) The covariance matrix is assumed to be symmetric (which should always be true). Return: TRUE if dimensions are independent, FALSE otherwise Exceptions: None History: 6/4/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="308" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1656" bodyend="1684"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a0924b73d8bc3cd1269aa64f5a41b633f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref> *</type>
        <definition>BUCKETS * GetBuckets</definition>
        <argsstring>(CLUSTERER *clusterer, DISTRIBUTION Distribution, uinT32 SampleCount, FLOAT64 Confidence)</argsstring>
        <name>GetBuckets</name>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
          <declname>clusterer</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0" kindref="member">DISTRIBUTION</ref></type>
          <declname>Distribution</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref></type>
          <declname>SampleCount</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
          <declname>Confidence</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>GetBuckets **************************************************************
</verbatim> Parameters: Clusterer which keeps a bucket_cache for us. Distribution type of probability distribution to test for SampleCount number of samples that are available Confidence probability of a Type I error Operation: This routine returns a histogram data structure which can be used by other routines to place samples into histogram buckets, and then apply a goodness of fit test to the histogram data to determine if the samples belong to the specified probability distribution. The routine keeps a list of bucket data structures which have already been created so that it minimizes the computation time needed to create a new bucket. Return: Bucket data structure Exceptions: none History: Thu Aug 3 12:58:10 1989, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="311" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1705" bodyend="1732"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a93a38445707d2a943e60fafebe0c2b4d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref> *</type>
        <definition>BUCKETS * MakeBuckets</definition>
        <argsstring>(DISTRIBUTION Distribution, uinT32 SampleCount, FLOAT64 Confidence)</argsstring>
        <name>MakeBuckets</name>
        <param>
          <type><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0" kindref="member">DISTRIBUTION</ref></type>
          <declname>Distribution</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref></type>
          <declname>SampleCount</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
          <declname>Confidence</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Makebuckets *************************************************************
</verbatim> Parameters: Distribution type of probability distribution to test for SampleCount number of samples that are available Confidence probability of a Type I error Operation: This routine creates a histogram data structure which can be used by other routines to place samples into histogram buckets, and then apply a goodness of fit test to the histogram data to determine if the samples belong to the specified probability distribution. The buckets are allocated in such a way that the expected frequency of samples in each bucket is approximately the same. In order to make this possible, a mapping table is computed which maps &quot;normalized&quot; samples into the appropriate bucket. Return: Pointer to new histogram data structure Exceptions: None History: 6/4/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="316" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1755" bodyend="1835"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1ab182ad32f9100ae8e29e72db623c70dd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
        <definition>uinT16 OptimumNumberOfBuckets</definition>
        <argsstring>(uinT32 SampleCount)</argsstring>
        <name>OptimumNumberOfBuckets</name>
        <param>
          <type><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref></type>
          <declname>SampleCount</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="320" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1839" bodyend="1875"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a952909dfb237bce2b90d33204b3efe3e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
        <definition>FLOAT64 ComputeChiSquared</definition>
        <argsstring>(uinT16 DegreesOfFreedom, FLOAT64 Alpha)</argsstring>
        <name>ComputeChiSquared</name>
        <param>
          <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
          <declname>DegreesOfFreedom</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
          <declname>Alpha</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="322" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1880" bodyend="1936"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a46fa6d94ca57427d93d1f306c4bbcf46" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
        <definition>FLOAT64 NormalDensity</definition>
        <argsstring>(inT32 x)</argsstring>
        <name>NormalDensity</name>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>x</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="324" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1940" bodyend="1965"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a5abc8ec5703c3d471dc0dd172cb22168" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
        <definition>FLOAT64 UniformDensity</definition>
        <argsstring>(inT32 x)</argsstring>
        <name>UniformDensity</name>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>x</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="326" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1969" bodyend="1990"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1af0eb798915396ae610f1701708a7b816" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
        <definition>FLOAT64 Integral</definition>
        <argsstring>(FLOAT64 f1, FLOAT64 f2, FLOAT64 Dx)</argsstring>
        <name>Integral</name>
        <param>
          <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
          <declname>f1</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
          <declname>f2</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
          <declname>Dx</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="328" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="1994" bodyend="2011"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a54c75ac15de9474adc1387dc0c809c0b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void FillBuckets</definition>
        <argsstring>(BUCKETS *Buckets, CLUSTER *Cluster, uinT16 Dim, PARAM_DESC *ParamDesc, FLOAT32 Mean, FLOAT32 StdDev)</argsstring>
        <name>FillBuckets</name>
        <param>
          <type><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref> *</type>
          <declname>Buckets</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
          <declname>Dim</declname>
        </param>
        <param>
          <type><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref> *</type>
          <declname>ParamDesc</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>Mean</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>StdDev</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="330" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2015" bodyend="2099"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a8e988f373e1dc7d9a55043f3db047d09" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
        <definition>uinT16 NormalBucket</definition>
        <argsstring>(PARAM_DESC *ParamDesc, FLOAT32 x, FLOAT32 Mean, FLOAT32 StdDev)</argsstring>
        <name>NormalBucket</name>
        <param>
          <type><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref> *</type>
          <declname>ParamDesc</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>x</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>Mean</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>StdDev</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="337" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2103" bodyend="2141"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a43e2cce8f045a700cd6fb0684761cc0c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
        <definition>uinT16 UniformBucket</definition>
        <argsstring>(PARAM_DESC *ParamDesc, FLOAT32 x, FLOAT32 Mean, FLOAT32 StdDev)</argsstring>
        <name>UniformBucket</name>
        <param>
          <type><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref> *</type>
          <declname>ParamDesc</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>x</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>Mean</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>StdDev</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="342" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2145" bodyend="2183"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a4c5b32330cf58e89e2352deb84394332" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
        <definition>BOOL8 DistributionOK</definition>
        <argsstring>(BUCKETS *Buckets)</argsstring>
        <name>DistributionOK</name>
        <param>
          <type><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref> *</type>
          <declname>Buckets</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="347" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2187" bodyend="2222"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1aef1b69ed626e557bf84c9c0b18db6b95" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void FreeStatistics</definition>
        <argsstring>(STATISTICS *Statistics)</argsstring>
        <name>FreeStatistics</name>
        <param>
          <type><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref> *</type>
          <declname>Statistics</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="349" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2226" bodyend="2244"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a1afe8a387c2e426eea3e152bb1cdd3e9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void FreeBuckets</definition>
        <argsstring>(BUCKETS *Buckets)</argsstring>
        <name>FreeBuckets</name>
        <param>
          <type><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref> *</type>
          <declname>Buckets</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="351" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2248" bodyend="2258"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1ac66b8beb503d71773eba9bc47d386ae8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void FreeCluster</definition>
        <argsstring>(CLUSTER *Cluster)</argsstring>
        <name>FreeCluster</name>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="353" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2262" bodyend="2282"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1acfe8f1657aa1e2a4de798d80ab637756" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
        <definition>uinT16 DegreesOfFreedom</definition>
        <argsstring>(DISTRIBUTION Distribution, uinT16 HistogramBuckets)</argsstring>
        <name>DegreesOfFreedom</name>
        <param>
          <type><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0" kindref="member">DISTRIBUTION</ref></type>
          <declname>Distribution</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
          <declname>HistogramBuckets</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="355" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2286" bodyend="2312"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1af8d341c60c044ac30867d767c6b9b091" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int NumBucketsMatch</definition>
        <argsstring>(void *arg1, void *arg2)</argsstring>
        <name>NumBucketsMatch</name>
        <param>
          <type>void *</type>
          <declname>arg1</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>arg2</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="357" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2316" bodyend="2335"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a7f39be063580c1c7c5566faf0398dfb0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int ListEntryMatch</definition>
        <argsstring>(void *arg1, void *arg2)</argsstring>
        <name>ListEntryMatch</name>
        <param>
          <type>void *</type>
          <declname>arg1</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>arg2</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="360" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2339" bodyend="2353"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a02e72bde5b9d967258769d4a75f07e46" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AdjustBuckets</definition>
        <argsstring>(BUCKETS *Buckets, uinT32 NewSampleCount)</argsstring>
        <name>AdjustBuckets</name>
        <param>
          <type><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref> *</type>
          <declname>Buckets</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref></type>
          <declname>NewSampleCount</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="362" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2357" bodyend="2382"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a0f9ec282a0fa768a4b5bd0d5efaca7d2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void InitBuckets</definition>
        <argsstring>(BUCKETS *Buckets)</argsstring>
        <name>InitBuckets</name>
        <param>
          <type><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref> *</type>
          <declname>Buckets</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="364" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2386" bodyend="2403"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1ad39bd07ace019e3862769098fae02f93" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int AlphaMatch</definition>
        <argsstring>(void *arg1, void *arg2)</argsstring>
        <name>AlphaMatch</name>
        <param>
          <type>void *</type>
          <declname>arg1</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>arg2</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="366" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2407" bodyend="2428"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1ac16f25cf71bcb2632f695f55fb9a5980" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref> *</type>
        <definition>CHISTRUCT * NewChiStruct</definition>
        <argsstring>(uinT16 DegreesOfFreedom, FLOAT64 Alpha)</argsstring>
        <name>NewChiStruct</name>
        <param>
          <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
          <declname>DegreesOfFreedom</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
          <declname>Alpha</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="369" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2432" bodyend="2452"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a8098e057438e6f07276dd005f28ef13c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
        <definition>FLOAT64 Solve</definition>
        <argsstring>(SOLVEFUNC Function, void *FunctionParams, FLOAT64 InitialGuess, FLOAT64 Accuracy)</argsstring>
        <name>Solve</name>
        <param>
          <type><ref refid="cluster_8cpp_1a170fa76dec6514a98bb069c4b9652f2d" kindref="member">SOLVEFUNC</ref></type>
          <declname>Function</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>FunctionParams</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
          <declname>InitialGuess</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
          <declname>Accuracy</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="371" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2457" bodyend="2517"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a444724ad6aa7b59e010c1089af12b0b0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
        <definition>FLOAT64 ChiArea</definition>
        <argsstring>(CHISTRUCT *ChiParams, FLOAT64 x)</argsstring>
        <name>ChiArea</name>
        <param>
          <type><ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref> *</type>
          <declname>ChiParams</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></type>
          <declname>x</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="376" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2521" bodyend="2560"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a39583ff2f6db38f0c2e26f7ad87f2c0c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
        <definition>BOOL8 MultipleCharSamples</definition>
        <argsstring>(CLUSTERER *Clusterer, CLUSTER *Cluster, FLOAT32 MaxIllegal)</argsstring>
        <name>MultipleCharSamples</name>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
          <declname>Clusterer</declname>
        </param>
        <param>
          <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
          <declname>Cluster</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>MaxIllegal</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="378" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2565" bodyend="2643"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a40c47f6785ad5d50a9b113761e16ab9d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double InvertMatrix</definition>
        <argsstring>(const float *input, int size, float *inv)</argsstring>
        <name>InvertMatrix</name>
        <param>
          <type>const float *</type>
          <declname>input</declname>
        </param>
        <param>
          <type>int</type>
          <declname>size</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>inv</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="382" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="2648" bodyend="2733"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a93e53684b74358b68adf48b2ee32b042" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
        <definition>CLUSTERER* MakeClusterer</definition>
        <argsstring>(inT16 SampleSize, const PARAM_DESC ParamDesc[])</argsstring>
        <name>MakeClusterer</name>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>SampleSize</declname>
        </param>
        <param>
          <type>const <ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref></type>
          <declname>ParamDesc</declname>
          <array>[]</array>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>MakeClusterer **********************************************************
</verbatim> Parameters: SampleSize number of dimensions in feature space ParamDesc description of each dimension Operation: This routine creates a new clusterer data structure, initializes it, and returns a pointer to it. Return: pointer to the new clusterer data structure Exceptions: None History: 5/29/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="395" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="395" bodyend="433"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1ab3cc5ee277d4a2cf4000668b1ffbcf4a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="cluster_8h_1acb9fa31a4d774b3e8a3091c21486fa7a" kindref="member">SAMPLE</ref> *</type>
        <definition>SAMPLE* MakeSample</definition>
        <argsstring>(CLUSTERER *Clusterer, const FLOAT32 *Feature, inT32 CharID)</argsstring>
        <name>MakeSample</name>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
          <declname>Clusterer</declname>
        </param>
        <param>
          <type>const <ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref> *</type>
          <declname>Feature</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>CharID</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>MakeSample ***********************************************************
</verbatim> Parameters: Clusterer clusterer data structure to add sample to Feature feature to be added to clusterer CharID unique ident. of char that sample came from Operation: This routine creates a new sample data structure to hold the specified feature. This sample is added to the clusterer data structure (so that it knows which samples are to be clustered later), and a pointer to the sample is returned to the caller. Return: Pointer to the new sample data structure Exceptions: ALREADYCLUSTERED MakeSample can&apos;t be called after ClusterSamples has been called History: 5/29/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="450" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="450" bodyend="484"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1ac7c6943d214b9c60e0f37cbb1a2111b4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="baseapi_8h_1aa200acf94add0e61783bfcd5965bb645" kindref="member">LIST</ref></type>
        <definition>LIST ClusterSamples</definition>
        <argsstring>(CLUSTERER *Clusterer, CLUSTERCONFIG *Config)</argsstring>
        <name>ClusterSamples</name>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
          <declname>Clusterer</declname>
        </param>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g" kindref="compound">CLUSTERCONFIG</ref> *</type>
          <declname>Config</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>ClusterSamples ***********************************************************
</verbatim> Parameters: Clusterer data struct containing samples to be clustered Config parameters which control clustering process Operation: This routine first checks to see if the samples in this clusterer have already been clustered before; if so, it does not bother to recreate the cluster tree. It simply recomputes the prototypes based on the new Config info. If the samples have not been clustered before, the samples in the KD tree are formed into a cluster tree and then the prototypes are computed from the cluster tree. In either case this routine returns a pointer to a list of prototypes that best represent the samples given the constraints specified in Config. Return: Pointer to a list of prototypes Exceptions: None History: 5/29/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="504" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="504" bodyend="516"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1aa5b6309260cd2d1acac25bd9cc9e9a66" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void FreeClusterer</definition>
        <argsstring>(CLUSTERER *Clusterer)</argsstring>
        <name>FreeClusterer</name>
        <param>
          <type><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref> *</type>
          <declname>Clusterer</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>FreeClusterer *************************************************************
</verbatim> Parameters: Clusterer pointer to data structure to be freed Operation: This routine frees all of the memory allocated to the specified data structure. It will not, however, free the memory used by the prototype list. The pointers to the clusters for each prototype in the list will be set to NULL to indicate that the cluster data structures no longer exist. Any sample lists that have been obtained via calls to GetSamples are no longer valid. Return: None Exceptions: None History: 6/6/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="532" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="532" bodyend="548"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a7e5357920f0bded023b15d29ddf15ebf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void FreeProtoList</definition>
        <argsstring>(LIST *ProtoList)</argsstring>
        <name>FreeProtoList</name>
        <param>
          <type><ref refid="baseapi_8h_1aa200acf94add0e61783bfcd5965bb645" kindref="member">LIST</ref> *</type>
          <declname>ProtoList</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>FreeProtoList ************************************************************
</verbatim> Parameters: ProtoList pointer to list of prototypes to be freed Operation: This routine frees all of the memory allocated to the specified list of prototypes. The clusters which are pointed to by the prototypes are not freed. Return: None Exceptions: None History: 6/6/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="560" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="560" bodyend="562"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1aa5d7083be183c7a4e2b2fa746a560a7b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void FreePrototype</definition>
        <argsstring>(void *arg)</argsstring>
        <name>FreePrototype</name>
        <param>
          <type>void *</type>
          <declname>arg</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>FreePrototype ************************************************************
</verbatim> Parameters: Prototype prototype data structure to be deallocated Operation: This routine deallocates the memory consumed by the specified prototype and modifies the corresponding cluster so that it is no longer marked as a prototype. The cluster is NOT deallocated by this routine. Return: None Exceptions: None History: 5/30/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="575" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="575" bodyend="596"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1abf5d9e3b151ac51b27bd9dc797ac261c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="cluster_8h_1a883b4f4e7113af06f96a7b11492256d1" kindref="member">CLUSTER</ref> *</type>
        <definition>CLUSTER* NextSample</definition>
        <argsstring>(LIST *SearchState)</argsstring>
        <name>NextSample</name>
        <param>
          <type><ref refid="baseapi_8h_1aa200acf94add0e61783bfcd5965bb645" kindref="member">LIST</ref> *</type>
          <declname>SearchState</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>NextSample ************************************************************
</verbatim> Parameters: SearchState ptr to list containing clusters to be searched Operation: This routine is used to find all of the samples which belong to a cluster. It starts by removing the top cluster on the cluster list (SearchState). If this cluster is a leaf it is returned. Otherwise, the right subcluster is pushed on the list and we continue the search in the left subcluster. This continues until a leaf is found. If all samples have been found, NULL is returned. <ref refid="cluster_8h_1af125589eadf8dca87cf904ebcb77c896" kindref="member">InitSampleSearch()</ref> must be called before <ref refid="cluster_8cpp_1abf5d9e3b151ac51b27bd9dc797ac261c" kindref="member">NextSample()</ref> to initialize the search. Return: Pointer to the next leaf cluster (sample) or NULL. Exceptions: None History: 6/16/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="614" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="614" bodyend="627"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1ad99e1235a4e63880ab2f72bfdff26e28" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
        <definition>FLOAT32 Mean</definition>
        <argsstring>(PROTOTYPE *Proto, uinT16 Dimension)</argsstring>
        <name>Mean</name>
        <param>
          <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
          <declname>Proto</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
          <declname>Dimension</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>Mean ***********************************************************
</verbatim> Parameters: Proto prototype to return mean of Dimension dimension whose mean is to be returned Operation: This routine returns the mean of the specified prototype in the indicated dimension. Return: Mean of Prototype in Dimension Exceptions: none History: 7/6/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="639" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="639" bodyend="641"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a8bdd5efd86c814e7f069aa7674cd5178" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
        <definition>FLOAT32 StandardDeviation</definition>
        <argsstring>(PROTOTYPE *Proto, uinT16 Dimension)</argsstring>
        <name>StandardDeviation</name>
        <param>
          <type><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref> *</type>
          <declname>Proto</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref></type>
          <declname>Dimension</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>StandardDeviation *************************************************
</verbatim> Parameters: Proto prototype to return standard deviation of Dimension dimension whose stddev is to be returned Operation: This routine returns the standard deviation of the prototype in the indicated dimension. Return: Standard deviation of Prototype in Dimension Exceptions: none History: 7/6/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="653" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="653" bodyend="673"/>
      </memberdef>
      <memberdef kind="function" id="cluster_8cpp_1a69b09f11067d2b087f4da951934ca556" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
        <definition>inT32 MergeClusters</definition>
        <argsstring>(inT16 N, PARAM_DESC ParamDesc[], inT32 n1, inT32 n2, FLOAT32 m[], FLOAT32 m1[], FLOAT32 m2[])</argsstring>
        <name>MergeClusters</name>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>N</declname>
        </param>
        <param>
          <type><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref></type>
          <declname>ParamDesc</declname>
          <array>[]</array>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>n1</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>n2</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>m</declname>
          <array>[]</array>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>m1</declname>
          <array>[]</array>
        </param>
        <param>
          <type><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref></type>
          <declname>m2</declname>
          <array>[]</array>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><verbatim>MergeClusters ************************************************************
</verbatim> Parameters: N # of dimensions (size of arrays) ParamDesc array of dimension descriptions n1, n2 number of samples in each old cluster m array to hold mean of new cluster m1, m2 arrays containing means of old clusters Operation: This routine merges two clusters into one larger cluster. To do this it computes the number of samples in the new cluster and the mean of the new cluster. The ParamDesc information is used to ensure that circular dimensions are handled correctly. Return: The number of samples in the new cluster. Exceptions: None History: 5/31/89, DSJ, Created. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp" line="882" column="1" bodyfile="/Users/makoto/Desktop/trunk/classify/cluster.cpp" bodystart="882" bodyend="913"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/******************************************************************************</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>**<sp/>Filename:<sp/><sp/><sp/>cluster.c</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>**<sp/>Purpose:<sp/><sp/><sp/><sp/>Routines<sp/>for<sp/>clustering<sp/>points<sp/>in<sp/>N-D<sp/>space</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>**<sp/>Author:<sp/><sp/><sp/><sp/><sp/>Dan<sp/>Johnson</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>**<sp/>History:<sp/><sp/><sp/><sp/>5/29/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>**</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>**<sp/>(c)<sp/>Copyright<sp/>Hewlett-Packard<sp/>Company,<sp/>1988.</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>**<sp/>Licensed<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the<sp/>&quot;License&quot;);</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>**<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance<sp/>with<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>**<sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>**<sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>**<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,<sp/>software</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>**<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>**<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>**<sp/>See<sp/>the<sp/>License<sp/>for<sp/>the<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>**<sp/>limitations<sp/>under<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>******************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="oldheap_8h" kindref="compound">oldheap.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="const_8h" kindref="compound">const.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="cluster_8h" kindref="compound">cluster.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="emalloc_8h" kindref="compound">emalloc.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="helpers_8h" kindref="compound">helpers.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="matrix_8h" kindref="compound">matrix.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="tprintf_8h" kindref="compound">tprintf.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="danerror_8h" kindref="compound">danerror.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="freelist_8h" kindref="compound">freelist.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;math.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>HOTELLING<sp/>1<sp/><sp/>//<sp/>If<sp/>true<sp/>use<sp/>Hotelling&apos;s<sp/>test<sp/>to<sp/>decide<sp/>where<sp/>to<sp/>split.</highlight></codeline>
<codeline lineno="30"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>FTABLE_X<sp/>10<sp/><sp/>//<sp/>Size<sp/>of<sp/>FTable.</highlight></codeline>
<codeline lineno="31"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>FTABLE_Y<sp/>100<sp/><sp/>//<sp/>Size<sp/>of<sp/>FTable.</highlight></codeline>
<codeline lineno="32"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Table<sp/>of<sp/>values<sp/>approximating<sp/>the<sp/>cumulative<sp/>F-distribution<sp/>for<sp/>a<sp/>confidence<sp/>of<sp/>1%.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a45a2c0c1c4ffd4de9723ccedf5727119" kindref="member">FTable</ref>[<ref refid="cluster_8cpp_1acd517e6d49c3394f0b9fe04fdb970699" kindref="member">FTABLE_Y</ref>][<ref refid="cluster_8cpp_1a1f0a56d752a245eeeabb4514e8b22cf8" kindref="member">FTABLE_X</ref>]<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/>{4052.19,<sp/>4999.52,<sp/>5403.34,<sp/>5624.62,<sp/>5763.65,<sp/>5858.97,<sp/>5928.33,<sp/>5981.10,<sp/>6022.50,<sp/>6055.85,},</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/>{98.502,<sp/><sp/>99.000,<sp/><sp/>99.166,<sp/><sp/>99.249,<sp/><sp/>99.300,<sp/><sp/>99.333,<sp/><sp/>99.356,<sp/><sp/>99.374,<sp/><sp/>99.388,<sp/><sp/>99.399,},</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/>{34.116,<sp/><sp/>30.816,<sp/><sp/>29.457,<sp/><sp/>28.710,<sp/><sp/>28.237,<sp/><sp/>27.911,<sp/><sp/>27.672,<sp/><sp/>27.489,<sp/><sp/>27.345,<sp/><sp/>27.229,},</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/>{21.198,<sp/><sp/>18.000,<sp/><sp/>16.694,<sp/><sp/>15.977,<sp/><sp/>15.522,<sp/><sp/>15.207,<sp/><sp/>14.976,<sp/><sp/>14.799,<sp/><sp/>14.659,<sp/><sp/>14.546,},</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/>{16.258,<sp/><sp/>13.274,<sp/><sp/>12.060,<sp/><sp/>11.392,<sp/><sp/>10.967,<sp/><sp/>10.672,<sp/><sp/>10.456,<sp/><sp/>10.289,<sp/><sp/>10.158,<sp/><sp/>10.051,},</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/>{13.745,<sp/><sp/>10.925,<sp/><sp/><sp/>9.780,<sp/><sp/><sp/>9.148,<sp/><sp/><sp/>8.746,<sp/><sp/><sp/>8.466,<sp/><sp/><sp/>8.260,<sp/><sp/><sp/>8.102,<sp/><sp/><sp/>7.976,<sp/><sp/><sp/>7.874,},</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/>{12.246,<sp/><sp/><sp/>9.547,<sp/><sp/><sp/>8.451,<sp/><sp/><sp/>7.847,<sp/><sp/><sp/>7.460,<sp/><sp/><sp/>7.191,<sp/><sp/><sp/>6.993,<sp/><sp/><sp/>6.840,<sp/><sp/><sp/>6.719,<sp/><sp/><sp/>6.620,},</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/>{11.259,<sp/><sp/><sp/>8.649,<sp/><sp/><sp/>7.591,<sp/><sp/><sp/>7.006,<sp/><sp/><sp/>6.632,<sp/><sp/><sp/>6.371,<sp/><sp/><sp/>6.178,<sp/><sp/><sp/>6.029,<sp/><sp/><sp/>5.911,<sp/><sp/><sp/>5.814,},</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/>{10.561,<sp/><sp/><sp/>8.022,<sp/><sp/><sp/>6.992,<sp/><sp/><sp/>6.422,<sp/><sp/><sp/>6.057,<sp/><sp/><sp/>5.802,<sp/><sp/><sp/>5.613,<sp/><sp/><sp/>5.467,<sp/><sp/><sp/>5.351,<sp/><sp/><sp/>5.257,},</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/>{10.044,<sp/><sp/><sp/>7.559,<sp/><sp/><sp/>6.552,<sp/><sp/><sp/>5.994,<sp/><sp/><sp/>5.636,<sp/><sp/><sp/>5.386,<sp/><sp/><sp/>5.200,<sp/><sp/><sp/>5.057,<sp/><sp/><sp/>4.942,<sp/><sp/><sp/>4.849,},</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/>{<sp/>9.646,<sp/><sp/><sp/>7.206,<sp/><sp/><sp/>6.217,<sp/><sp/><sp/>5.668,<sp/><sp/><sp/>5.316,<sp/><sp/><sp/>5.069,<sp/><sp/><sp/>4.886,<sp/><sp/><sp/>4.744,<sp/><sp/><sp/>4.632,<sp/><sp/><sp/>4.539,},</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/>{<sp/>9.330,<sp/><sp/><sp/>6.927,<sp/><sp/><sp/>5.953,<sp/><sp/><sp/>5.412,<sp/><sp/><sp/>5.064,<sp/><sp/><sp/>4.821,<sp/><sp/><sp/>4.640,<sp/><sp/><sp/>4.499,<sp/><sp/><sp/>4.388,<sp/><sp/><sp/>4.296,},</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/>{<sp/>9.074,<sp/><sp/><sp/>6.701,<sp/><sp/><sp/>5.739,<sp/><sp/><sp/>5.205,<sp/><sp/><sp/>4.862,<sp/><sp/><sp/>4.620,<sp/><sp/><sp/>4.441,<sp/><sp/><sp/>4.302,<sp/><sp/><sp/>4.191,<sp/><sp/><sp/>4.100,},</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/>{<sp/>8.862,<sp/><sp/><sp/>6.515,<sp/><sp/><sp/>5.564,<sp/><sp/><sp/>5.035,<sp/><sp/><sp/>4.695,<sp/><sp/><sp/>4.456,<sp/><sp/><sp/>4.278,<sp/><sp/><sp/>4.140,<sp/><sp/><sp/>4.030,<sp/><sp/><sp/>3.939,},</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/>{<sp/>8.683,<sp/><sp/><sp/>6.359,<sp/><sp/><sp/>5.417,<sp/><sp/><sp/>4.893,<sp/><sp/><sp/>4.556,<sp/><sp/><sp/>4.318,<sp/><sp/><sp/>4.142,<sp/><sp/><sp/>4.004,<sp/><sp/><sp/>3.895,<sp/><sp/><sp/>3.805,},</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/>{<sp/>8.531,<sp/><sp/><sp/>6.226,<sp/><sp/><sp/>5.292,<sp/><sp/><sp/>4.773,<sp/><sp/><sp/>4.437,<sp/><sp/><sp/>4.202,<sp/><sp/><sp/>4.026,<sp/><sp/><sp/>3.890,<sp/><sp/><sp/>3.780,<sp/><sp/><sp/>3.691,},</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/>{<sp/>8.400,<sp/><sp/><sp/>6.112,<sp/><sp/><sp/>5.185,<sp/><sp/><sp/>4.669,<sp/><sp/><sp/>4.336,<sp/><sp/><sp/>4.102,<sp/><sp/><sp/>3.927,<sp/><sp/><sp/>3.791,<sp/><sp/><sp/>3.682,<sp/><sp/><sp/>3.593,},</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/>{<sp/>8.285,<sp/><sp/><sp/>6.013,<sp/><sp/><sp/>5.092,<sp/><sp/><sp/>4.579,<sp/><sp/><sp/>4.248,<sp/><sp/><sp/>4.015,<sp/><sp/><sp/>3.841,<sp/><sp/><sp/>3.705,<sp/><sp/><sp/>3.597,<sp/><sp/><sp/>3.508,},</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/>{<sp/>8.185,<sp/><sp/><sp/>5.926,<sp/><sp/><sp/>5.010,<sp/><sp/><sp/>4.500,<sp/><sp/><sp/>4.171,<sp/><sp/><sp/>3.939,<sp/><sp/><sp/>3.765,<sp/><sp/><sp/>3.631,<sp/><sp/><sp/>3.523,<sp/><sp/><sp/>3.434,},</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/>{<sp/>8.096,<sp/><sp/><sp/>5.849,<sp/><sp/><sp/>4.938,<sp/><sp/><sp/>4.431,<sp/><sp/><sp/>4.103,<sp/><sp/><sp/>3.871,<sp/><sp/><sp/>3.699,<sp/><sp/><sp/>3.564,<sp/><sp/><sp/>3.457,<sp/><sp/><sp/>3.368,},</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/>{<sp/>8.017,<sp/><sp/><sp/>5.780,<sp/><sp/><sp/>4.874,<sp/><sp/><sp/>4.369,<sp/><sp/><sp/>4.042,<sp/><sp/><sp/>3.812,<sp/><sp/><sp/>3.640,<sp/><sp/><sp/>3.506,<sp/><sp/><sp/>3.398,<sp/><sp/><sp/>3.310,},</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/>{<sp/>7.945,<sp/><sp/><sp/>5.719,<sp/><sp/><sp/>4.817,<sp/><sp/><sp/>4.313,<sp/><sp/><sp/>3.988,<sp/><sp/><sp/>3.758,<sp/><sp/><sp/>3.587,<sp/><sp/><sp/>3.453,<sp/><sp/><sp/>3.346,<sp/><sp/><sp/>3.258,},</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/>{<sp/>7.881,<sp/><sp/><sp/>5.664,<sp/><sp/><sp/>4.765,<sp/><sp/><sp/>4.264,<sp/><sp/><sp/>3.939,<sp/><sp/><sp/>3.710,<sp/><sp/><sp/>3.539,<sp/><sp/><sp/>3.406,<sp/><sp/><sp/>3.299,<sp/><sp/><sp/>3.211,},</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/>{<sp/>7.823,<sp/><sp/><sp/>5.614,<sp/><sp/><sp/>4.718,<sp/><sp/><sp/>4.218,<sp/><sp/><sp/>3.895,<sp/><sp/><sp/>3.667,<sp/><sp/><sp/>3.496,<sp/><sp/><sp/>3.363,<sp/><sp/><sp/>3.256,<sp/><sp/><sp/>3.168,},</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/>{<sp/>7.770,<sp/><sp/><sp/>5.568,<sp/><sp/><sp/>4.675,<sp/><sp/><sp/>4.177,<sp/><sp/><sp/>3.855,<sp/><sp/><sp/>3.627,<sp/><sp/><sp/>3.457,<sp/><sp/><sp/>3.324,<sp/><sp/><sp/>3.217,<sp/><sp/><sp/>3.129,},</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/>{<sp/>7.721,<sp/><sp/><sp/>5.526,<sp/><sp/><sp/>4.637,<sp/><sp/><sp/>4.140,<sp/><sp/><sp/>3.818,<sp/><sp/><sp/>3.591,<sp/><sp/><sp/>3.421,<sp/><sp/><sp/>3.288,<sp/><sp/><sp/>3.182,<sp/><sp/><sp/>3.094,},</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/>{<sp/>7.677,<sp/><sp/><sp/>5.488,<sp/><sp/><sp/>4.601,<sp/><sp/><sp/>4.106,<sp/><sp/><sp/>3.785,<sp/><sp/><sp/>3.558,<sp/><sp/><sp/>3.388,<sp/><sp/><sp/>3.256,<sp/><sp/><sp/>3.149,<sp/><sp/><sp/>3.062,},</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/>{<sp/>7.636,<sp/><sp/><sp/>5.453,<sp/><sp/><sp/>4.568,<sp/><sp/><sp/>4.074,<sp/><sp/><sp/>3.754,<sp/><sp/><sp/>3.528,<sp/><sp/><sp/>3.358,<sp/><sp/><sp/>3.226,<sp/><sp/><sp/>3.120,<sp/><sp/><sp/>3.032,},</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/>{<sp/>7.598,<sp/><sp/><sp/>5.420,<sp/><sp/><sp/>4.538,<sp/><sp/><sp/>4.045,<sp/><sp/><sp/>3.725,<sp/><sp/><sp/>3.499,<sp/><sp/><sp/>3.330,<sp/><sp/><sp/>3.198,<sp/><sp/><sp/>3.092,<sp/><sp/><sp/>3.005,},</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/>{<sp/>7.562,<sp/><sp/><sp/>5.390,<sp/><sp/><sp/>4.510,<sp/><sp/><sp/>4.018,<sp/><sp/><sp/>3.699,<sp/><sp/><sp/>3.473,<sp/><sp/><sp/>3.305,<sp/><sp/><sp/>3.173,<sp/><sp/><sp/>3.067,<sp/><sp/><sp/>2.979,},</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/>{<sp/>7.530,<sp/><sp/><sp/>5.362,<sp/><sp/><sp/>4.484,<sp/><sp/><sp/>3.993,<sp/><sp/><sp/>3.675,<sp/><sp/><sp/>3.449,<sp/><sp/><sp/>3.281,<sp/><sp/><sp/>3.149,<sp/><sp/><sp/>3.043,<sp/><sp/><sp/>2.955,},</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/>{<sp/>7.499,<sp/><sp/><sp/>5.336,<sp/><sp/><sp/>4.459,<sp/><sp/><sp/>3.969,<sp/><sp/><sp/>3.652,<sp/><sp/><sp/>3.427,<sp/><sp/><sp/>3.258,<sp/><sp/><sp/>3.127,<sp/><sp/><sp/>3.021,<sp/><sp/><sp/>2.934,},</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/>{<sp/>7.471,<sp/><sp/><sp/>5.312,<sp/><sp/><sp/>4.437,<sp/><sp/><sp/>3.948,<sp/><sp/><sp/>3.630,<sp/><sp/><sp/>3.406,<sp/><sp/><sp/>3.238,<sp/><sp/><sp/>3.106,<sp/><sp/><sp/>3.000,<sp/><sp/><sp/>2.913,},</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/>{<sp/>7.444,<sp/><sp/><sp/>5.289,<sp/><sp/><sp/>4.416,<sp/><sp/><sp/>3.927,<sp/><sp/><sp/>3.611,<sp/><sp/><sp/>3.386,<sp/><sp/><sp/>3.218,<sp/><sp/><sp/>3.087,<sp/><sp/><sp/>2.981,<sp/><sp/><sp/>2.894,},</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/>{<sp/>7.419,<sp/><sp/><sp/>5.268,<sp/><sp/><sp/>4.396,<sp/><sp/><sp/>3.908,<sp/><sp/><sp/>3.592,<sp/><sp/><sp/>3.368,<sp/><sp/><sp/>3.200,<sp/><sp/><sp/>3.069,<sp/><sp/><sp/>2.963,<sp/><sp/><sp/>2.876,},</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/>{<sp/>7.396,<sp/><sp/><sp/>5.248,<sp/><sp/><sp/>4.377,<sp/><sp/><sp/>3.890,<sp/><sp/><sp/>3.574,<sp/><sp/><sp/>3.351,<sp/><sp/><sp/>3.183,<sp/><sp/><sp/>3.052,<sp/><sp/><sp/>2.946,<sp/><sp/><sp/>2.859,},</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/>{<sp/>7.373,<sp/><sp/><sp/>5.229,<sp/><sp/><sp/>4.360,<sp/><sp/><sp/>3.873,<sp/><sp/><sp/>3.558,<sp/><sp/><sp/>3.334,<sp/><sp/><sp/>3.167,<sp/><sp/><sp/>3.036,<sp/><sp/><sp/>2.930,<sp/><sp/><sp/>2.843,},</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/>{<sp/>7.353,<sp/><sp/><sp/>5.211,<sp/><sp/><sp/>4.343,<sp/><sp/><sp/>3.858,<sp/><sp/><sp/>3.542,<sp/><sp/><sp/>3.319,<sp/><sp/><sp/>3.152,<sp/><sp/><sp/>3.021,<sp/><sp/><sp/>2.915,<sp/><sp/><sp/>2.828,},</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/>{<sp/>7.333,<sp/><sp/><sp/>5.194,<sp/><sp/><sp/>4.327,<sp/><sp/><sp/>3.843,<sp/><sp/><sp/>3.528,<sp/><sp/><sp/>3.305,<sp/><sp/><sp/>3.137,<sp/><sp/><sp/>3.006,<sp/><sp/><sp/>2.901,<sp/><sp/><sp/>2.814,},</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/>{<sp/>7.314,<sp/><sp/><sp/>5.179,<sp/><sp/><sp/>4.313,<sp/><sp/><sp/>3.828,<sp/><sp/><sp/>3.514,<sp/><sp/><sp/>3.291,<sp/><sp/><sp/>3.124,<sp/><sp/><sp/>2.993,<sp/><sp/><sp/>2.888,<sp/><sp/><sp/>2.801,},</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/>{<sp/>7.296,<sp/><sp/><sp/>5.163,<sp/><sp/><sp/>4.299,<sp/><sp/><sp/>3.815,<sp/><sp/><sp/>3.501,<sp/><sp/><sp/>3.278,<sp/><sp/><sp/>3.111,<sp/><sp/><sp/>2.980,<sp/><sp/><sp/>2.875,<sp/><sp/><sp/>2.788,},</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/>{<sp/>7.280,<sp/><sp/><sp/>5.149,<sp/><sp/><sp/>4.285,<sp/><sp/><sp/>3.802,<sp/><sp/><sp/>3.488,<sp/><sp/><sp/>3.266,<sp/><sp/><sp/>3.099,<sp/><sp/><sp/>2.968,<sp/><sp/><sp/>2.863,<sp/><sp/><sp/>2.776,},</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/>{<sp/>7.264,<sp/><sp/><sp/>5.136,<sp/><sp/><sp/>4.273,<sp/><sp/><sp/>3.790,<sp/><sp/><sp/>3.476,<sp/><sp/><sp/>3.254,<sp/><sp/><sp/>3.087,<sp/><sp/><sp/>2.957,<sp/><sp/><sp/>2.851,<sp/><sp/><sp/>2.764,},</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/>{<sp/>7.248,<sp/><sp/><sp/>5.123,<sp/><sp/><sp/>4.261,<sp/><sp/><sp/>3.778,<sp/><sp/><sp/>3.465,<sp/><sp/><sp/>3.243,<sp/><sp/><sp/>3.076,<sp/><sp/><sp/>2.946,<sp/><sp/><sp/>2.840,<sp/><sp/><sp/>2.754,},</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/>{<sp/>7.234,<sp/><sp/><sp/>5.110,<sp/><sp/><sp/>4.249,<sp/><sp/><sp/>3.767,<sp/><sp/><sp/>3.454,<sp/><sp/><sp/>3.232,<sp/><sp/><sp/>3.066,<sp/><sp/><sp/>2.935,<sp/><sp/><sp/>2.830,<sp/><sp/><sp/>2.743,},</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/>{<sp/>7.220,<sp/><sp/><sp/>5.099,<sp/><sp/><sp/>4.238,<sp/><sp/><sp/>3.757,<sp/><sp/><sp/>3.444,<sp/><sp/><sp/>3.222,<sp/><sp/><sp/>3.056,<sp/><sp/><sp/>2.925,<sp/><sp/><sp/>2.820,<sp/><sp/><sp/>2.733,},</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/>{<sp/>7.207,<sp/><sp/><sp/>5.087,<sp/><sp/><sp/>4.228,<sp/><sp/><sp/>3.747,<sp/><sp/><sp/>3.434,<sp/><sp/><sp/>3.213,<sp/><sp/><sp/>3.046,<sp/><sp/><sp/>2.916,<sp/><sp/><sp/>2.811,<sp/><sp/><sp/>2.724,},</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/>{<sp/>7.194,<sp/><sp/><sp/>5.077,<sp/><sp/><sp/>4.218,<sp/><sp/><sp/>3.737,<sp/><sp/><sp/>3.425,<sp/><sp/><sp/>3.204,<sp/><sp/><sp/>3.037,<sp/><sp/><sp/>2.907,<sp/><sp/><sp/>2.802,<sp/><sp/><sp/>2.715,},</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/>{<sp/>7.182,<sp/><sp/><sp/>5.066,<sp/><sp/><sp/>4.208,<sp/><sp/><sp/>3.728,<sp/><sp/><sp/>3.416,<sp/><sp/><sp/>3.195,<sp/><sp/><sp/>3.028,<sp/><sp/><sp/>2.898,<sp/><sp/><sp/>2.793,<sp/><sp/><sp/>2.706,},</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/>{<sp/>7.171,<sp/><sp/><sp/>5.057,<sp/><sp/><sp/>4.199,<sp/><sp/><sp/>3.720,<sp/><sp/><sp/>3.408,<sp/><sp/><sp/>3.186,<sp/><sp/><sp/>3.020,<sp/><sp/><sp/>2.890,<sp/><sp/><sp/>2.785,<sp/><sp/><sp/>2.698,},</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/>{<sp/>7.159,<sp/><sp/><sp/>5.047,<sp/><sp/><sp/>4.191,<sp/><sp/><sp/>3.711,<sp/><sp/><sp/>3.400,<sp/><sp/><sp/>3.178,<sp/><sp/><sp/>3.012,<sp/><sp/><sp/>2.882,<sp/><sp/><sp/>2.777,<sp/><sp/><sp/>2.690,},</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/>{<sp/>7.149,<sp/><sp/><sp/>5.038,<sp/><sp/><sp/>4.182,<sp/><sp/><sp/>3.703,<sp/><sp/><sp/>3.392,<sp/><sp/><sp/>3.171,<sp/><sp/><sp/>3.005,<sp/><sp/><sp/>2.874,<sp/><sp/><sp/>2.769,<sp/><sp/><sp/>2.683,},</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/>{<sp/>7.139,<sp/><sp/><sp/>5.030,<sp/><sp/><sp/>4.174,<sp/><sp/><sp/>3.695,<sp/><sp/><sp/>3.384,<sp/><sp/><sp/>3.163,<sp/><sp/><sp/>2.997,<sp/><sp/><sp/>2.867,<sp/><sp/><sp/>2.762,<sp/><sp/><sp/>2.675,},</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/>{<sp/>7.129,<sp/><sp/><sp/>5.021,<sp/><sp/><sp/>4.167,<sp/><sp/><sp/>3.688,<sp/><sp/><sp/>3.377,<sp/><sp/><sp/>3.156,<sp/><sp/><sp/>2.990,<sp/><sp/><sp/>2.860,<sp/><sp/><sp/>2.755,<sp/><sp/><sp/>2.668,},</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/>{<sp/>7.119,<sp/><sp/><sp/>5.013,<sp/><sp/><sp/>4.159,<sp/><sp/><sp/>3.681,<sp/><sp/><sp/>3.370,<sp/><sp/><sp/>3.149,<sp/><sp/><sp/>2.983,<sp/><sp/><sp/>2.853,<sp/><sp/><sp/>2.748,<sp/><sp/><sp/>2.662,},</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/>{<sp/>7.110,<sp/><sp/><sp/>5.006,<sp/><sp/><sp/>4.152,<sp/><sp/><sp/>3.674,<sp/><sp/><sp/>3.363,<sp/><sp/><sp/>3.143,<sp/><sp/><sp/>2.977,<sp/><sp/><sp/>2.847,<sp/><sp/><sp/>2.742,<sp/><sp/><sp/>2.655,},</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/>{<sp/>7.102,<sp/><sp/><sp/>4.998,<sp/><sp/><sp/>4.145,<sp/><sp/><sp/>3.667,<sp/><sp/><sp/>3.357,<sp/><sp/><sp/>3.136,<sp/><sp/><sp/>2.971,<sp/><sp/><sp/>2.841,<sp/><sp/><sp/>2.736,<sp/><sp/><sp/>2.649,},</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/>{<sp/>7.093,<sp/><sp/><sp/>4.991,<sp/><sp/><sp/>4.138,<sp/><sp/><sp/>3.661,<sp/><sp/><sp/>3.351,<sp/><sp/><sp/>3.130,<sp/><sp/><sp/>2.965,<sp/><sp/><sp/>2.835,<sp/><sp/><sp/>2.730,<sp/><sp/><sp/>2.643,},</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/>{<sp/>7.085,<sp/><sp/><sp/>4.984,<sp/><sp/><sp/>4.132,<sp/><sp/><sp/>3.655,<sp/><sp/><sp/>3.345,<sp/><sp/><sp/>3.124,<sp/><sp/><sp/>2.959,<sp/><sp/><sp/>2.829,<sp/><sp/><sp/>2.724,<sp/><sp/><sp/>2.637,},</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/>{<sp/>7.077,<sp/><sp/><sp/>4.977,<sp/><sp/><sp/>4.126,<sp/><sp/><sp/>3.649,<sp/><sp/><sp/>3.339,<sp/><sp/><sp/>3.119,<sp/><sp/><sp/>2.953,<sp/><sp/><sp/>2.823,<sp/><sp/><sp/>2.718,<sp/><sp/><sp/>2.632,},</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/>{<sp/>7.070,<sp/><sp/><sp/>4.971,<sp/><sp/><sp/>4.120,<sp/><sp/><sp/>3.643,<sp/><sp/><sp/>3.333,<sp/><sp/><sp/>3.113,<sp/><sp/><sp/>2.948,<sp/><sp/><sp/>2.818,<sp/><sp/><sp/>2.713,<sp/><sp/><sp/>2.626,},</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/>{<sp/>7.062,<sp/><sp/><sp/>4.965,<sp/><sp/><sp/>4.114,<sp/><sp/><sp/>3.638,<sp/><sp/><sp/>3.328,<sp/><sp/><sp/>3.108,<sp/><sp/><sp/>2.942,<sp/><sp/><sp/>2.813,<sp/><sp/><sp/>2.708,<sp/><sp/><sp/>2.621,},</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/>{<sp/>7.055,<sp/><sp/><sp/>4.959,<sp/><sp/><sp/>4.109,<sp/><sp/><sp/>3.632,<sp/><sp/><sp/>3.323,<sp/><sp/><sp/>3.103,<sp/><sp/><sp/>2.937,<sp/><sp/><sp/>2.808,<sp/><sp/><sp/>2.703,<sp/><sp/><sp/>2.616,},</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/>{<sp/>7.048,<sp/><sp/><sp/>4.953,<sp/><sp/><sp/>4.103,<sp/><sp/><sp/>3.627,<sp/><sp/><sp/>3.318,<sp/><sp/><sp/>3.098,<sp/><sp/><sp/>2.932,<sp/><sp/><sp/>2.803,<sp/><sp/><sp/>2.698,<sp/><sp/><sp/>2.611,},</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/>{<sp/>7.042,<sp/><sp/><sp/>4.947,<sp/><sp/><sp/>4.098,<sp/><sp/><sp/>3.622,<sp/><sp/><sp/>3.313,<sp/><sp/><sp/>3.093,<sp/><sp/><sp/>2.928,<sp/><sp/><sp/>2.798,<sp/><sp/><sp/>2.693,<sp/><sp/><sp/>2.607,},</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/>{<sp/>7.035,<sp/><sp/><sp/>4.942,<sp/><sp/><sp/>4.093,<sp/><sp/><sp/>3.618,<sp/><sp/><sp/>3.308,<sp/><sp/><sp/>3.088,<sp/><sp/><sp/>2.923,<sp/><sp/><sp/>2.793,<sp/><sp/><sp/>2.689,<sp/><sp/><sp/>2.602,},</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/>{<sp/>7.029,<sp/><sp/><sp/>4.937,<sp/><sp/><sp/>4.088,<sp/><sp/><sp/>3.613,<sp/><sp/><sp/>3.304,<sp/><sp/><sp/>3.084,<sp/><sp/><sp/>2.919,<sp/><sp/><sp/>2.789,<sp/><sp/><sp/>2.684,<sp/><sp/><sp/>2.598,},</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/>{<sp/>7.023,<sp/><sp/><sp/>4.932,<sp/><sp/><sp/>4.083,<sp/><sp/><sp/>3.608,<sp/><sp/><sp/>3.299,<sp/><sp/><sp/>3.080,<sp/><sp/><sp/>2.914,<sp/><sp/><sp/>2.785,<sp/><sp/><sp/>2.680,<sp/><sp/><sp/>2.593,},</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/>{<sp/>7.017,<sp/><sp/><sp/>4.927,<sp/><sp/><sp/>4.079,<sp/><sp/><sp/>3.604,<sp/><sp/><sp/>3.295,<sp/><sp/><sp/>3.075,<sp/><sp/><sp/>2.910,<sp/><sp/><sp/>2.781,<sp/><sp/><sp/>2.676,<sp/><sp/><sp/>2.589,},</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/>{<sp/>7.011,<sp/><sp/><sp/>4.922,<sp/><sp/><sp/>4.074,<sp/><sp/><sp/>3.600,<sp/><sp/><sp/>3.291,<sp/><sp/><sp/>3.071,<sp/><sp/><sp/>2.906,<sp/><sp/><sp/>2.777,<sp/><sp/><sp/>2.672,<sp/><sp/><sp/>2.585,},</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/>{<sp/>7.006,<sp/><sp/><sp/>4.917,<sp/><sp/><sp/>4.070,<sp/><sp/><sp/>3.596,<sp/><sp/><sp/>3.287,<sp/><sp/><sp/>3.067,<sp/><sp/><sp/>2.902,<sp/><sp/><sp/>2.773,<sp/><sp/><sp/>2.668,<sp/><sp/><sp/>2.581,},</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/>{<sp/>7.001,<sp/><sp/><sp/>4.913,<sp/><sp/><sp/>4.066,<sp/><sp/><sp/>3.591,<sp/><sp/><sp/>3.283,<sp/><sp/><sp/>3.063,<sp/><sp/><sp/>2.898,<sp/><sp/><sp/>2.769,<sp/><sp/><sp/>2.664,<sp/><sp/><sp/>2.578,},</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/>{<sp/>6.995,<sp/><sp/><sp/>4.908,<sp/><sp/><sp/>4.062,<sp/><sp/><sp/>3.588,<sp/><sp/><sp/>3.279,<sp/><sp/><sp/>3.060,<sp/><sp/><sp/>2.895,<sp/><sp/><sp/>2.765,<sp/><sp/><sp/>2.660,<sp/><sp/><sp/>2.574,},</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/>{<sp/>6.990,<sp/><sp/><sp/>4.904,<sp/><sp/><sp/>4.058,<sp/><sp/><sp/>3.584,<sp/><sp/><sp/>3.275,<sp/><sp/><sp/>3.056,<sp/><sp/><sp/>2.891,<sp/><sp/><sp/>2.762,<sp/><sp/><sp/>2.657,<sp/><sp/><sp/>2.570,},</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/>{<sp/>6.985,<sp/><sp/><sp/>4.900,<sp/><sp/><sp/>4.054,<sp/><sp/><sp/>3.580,<sp/><sp/><sp/>3.272,<sp/><sp/><sp/>3.052,<sp/><sp/><sp/>2.887,<sp/><sp/><sp/>2.758,<sp/><sp/><sp/>2.653,<sp/><sp/><sp/>2.567,},</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/>{<sp/>6.981,<sp/><sp/><sp/>4.896,<sp/><sp/><sp/>4.050,<sp/><sp/><sp/>3.577,<sp/><sp/><sp/>3.268,<sp/><sp/><sp/>3.049,<sp/><sp/><sp/>2.884,<sp/><sp/><sp/>2.755,<sp/><sp/><sp/>2.650,<sp/><sp/><sp/>2.563,},</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/>{<sp/>6.976,<sp/><sp/><sp/>4.892,<sp/><sp/><sp/>4.047,<sp/><sp/><sp/>3.573,<sp/><sp/><sp/>3.265,<sp/><sp/><sp/>3.046,<sp/><sp/><sp/>2.881,<sp/><sp/><sp/>2.751,<sp/><sp/><sp/>2.647,<sp/><sp/><sp/>2.560,},</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/>{<sp/>6.971,<sp/><sp/><sp/>4.888,<sp/><sp/><sp/>4.043,<sp/><sp/><sp/>3.570,<sp/><sp/><sp/>3.261,<sp/><sp/><sp/>3.042,<sp/><sp/><sp/>2.877,<sp/><sp/><sp/>2.748,<sp/><sp/><sp/>2.644,<sp/><sp/><sp/>2.557,},</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/>{<sp/>6.967,<sp/><sp/><sp/>4.884,<sp/><sp/><sp/>4.040,<sp/><sp/><sp/>3.566,<sp/><sp/><sp/>3.258,<sp/><sp/><sp/>3.039,<sp/><sp/><sp/>2.874,<sp/><sp/><sp/>2.745,<sp/><sp/><sp/>2.640,<sp/><sp/><sp/>2.554,},</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/>{<sp/>6.963,<sp/><sp/><sp/>4.881,<sp/><sp/><sp/>4.036,<sp/><sp/><sp/>3.563,<sp/><sp/><sp/>3.255,<sp/><sp/><sp/>3.036,<sp/><sp/><sp/>2.871,<sp/><sp/><sp/>2.742,<sp/><sp/><sp/>2.637,<sp/><sp/><sp/>2.551,},</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/>{<sp/>6.958,<sp/><sp/><sp/>4.877,<sp/><sp/><sp/>4.033,<sp/><sp/><sp/>3.560,<sp/><sp/><sp/>3.252,<sp/><sp/><sp/>3.033,<sp/><sp/><sp/>2.868,<sp/><sp/><sp/>2.739,<sp/><sp/><sp/>2.634,<sp/><sp/><sp/>2.548,},</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/>{<sp/>6.954,<sp/><sp/><sp/>4.874,<sp/><sp/><sp/>4.030,<sp/><sp/><sp/>3.557,<sp/><sp/><sp/>3.249,<sp/><sp/><sp/>3.030,<sp/><sp/><sp/>2.865,<sp/><sp/><sp/>2.736,<sp/><sp/><sp/>2.632,<sp/><sp/><sp/>2.545,},</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/>{<sp/>6.950,<sp/><sp/><sp/>4.870,<sp/><sp/><sp/>4.027,<sp/><sp/><sp/>3.554,<sp/><sp/><sp/>3.246,<sp/><sp/><sp/>3.027,<sp/><sp/><sp/>2.863,<sp/><sp/><sp/>2.733,<sp/><sp/><sp/>2.629,<sp/><sp/><sp/>2.542,},</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/>{<sp/>6.947,<sp/><sp/><sp/>4.867,<sp/><sp/><sp/>4.024,<sp/><sp/><sp/>3.551,<sp/><sp/><sp/>3.243,<sp/><sp/><sp/>3.025,<sp/><sp/><sp/>2.860,<sp/><sp/><sp/>2.731,<sp/><sp/><sp/>2.626,<sp/><sp/><sp/>2.539,},</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/>{<sp/>6.943,<sp/><sp/><sp/>4.864,<sp/><sp/><sp/>4.021,<sp/><sp/><sp/>3.548,<sp/><sp/><sp/>3.240,<sp/><sp/><sp/>3.022,<sp/><sp/><sp/>2.857,<sp/><sp/><sp/>2.728,<sp/><sp/><sp/>2.623,<sp/><sp/><sp/>2.537,},</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/>{<sp/>6.939,<sp/><sp/><sp/>4.861,<sp/><sp/><sp/>4.018,<sp/><sp/><sp/>3.545,<sp/><sp/><sp/>3.238,<sp/><sp/><sp/>3.019,<sp/><sp/><sp/>2.854,<sp/><sp/><sp/>2.725,<sp/><sp/><sp/>2.621,<sp/><sp/><sp/>2.534,},</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/>{<sp/>6.935,<sp/><sp/><sp/>4.858,<sp/><sp/><sp/>4.015,<sp/><sp/><sp/>3.543,<sp/><sp/><sp/>3.235,<sp/><sp/><sp/>3.017,<sp/><sp/><sp/>2.852,<sp/><sp/><sp/>2.723,<sp/><sp/><sp/>2.618,<sp/><sp/><sp/>2.532,},</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/>{<sp/>6.932,<sp/><sp/><sp/>4.855,<sp/><sp/><sp/>4.012,<sp/><sp/><sp/>3.540,<sp/><sp/><sp/>3.233,<sp/><sp/><sp/>3.014,<sp/><sp/><sp/>2.849,<sp/><sp/><sp/>2.720,<sp/><sp/><sp/>2.616,<sp/><sp/><sp/>2.529,},</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/>{<sp/>6.928,<sp/><sp/><sp/>4.852,<sp/><sp/><sp/>4.010,<sp/><sp/><sp/>3.538,<sp/><sp/><sp/>3.230,<sp/><sp/><sp/>3.012,<sp/><sp/><sp/>2.847,<sp/><sp/><sp/>2.718,<sp/><sp/><sp/>2.613,<sp/><sp/><sp/>2.527,},</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/>{<sp/>6.925,<sp/><sp/><sp/>4.849,<sp/><sp/><sp/>4.007,<sp/><sp/><sp/>3.535,<sp/><sp/><sp/>3.228,<sp/><sp/><sp/>3.009,<sp/><sp/><sp/>2.845,<sp/><sp/><sp/>2.715,<sp/><sp/><sp/>2.611,<sp/><sp/><sp/>2.524,},</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/>{<sp/>6.922,<sp/><sp/><sp/>4.846,<sp/><sp/><sp/>4.004,<sp/><sp/><sp/>3.533,<sp/><sp/><sp/>3.225,<sp/><sp/><sp/>3.007,<sp/><sp/><sp/>2.842,<sp/><sp/><sp/>2.713,<sp/><sp/><sp/>2.609,<sp/><sp/><sp/>2.522,},</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/>{<sp/>6.919,<sp/><sp/><sp/>4.844,<sp/><sp/><sp/>4.002,<sp/><sp/><sp/>3.530,<sp/><sp/><sp/>3.223,<sp/><sp/><sp/>3.004,<sp/><sp/><sp/>2.840,<sp/><sp/><sp/>2.711,<sp/><sp/><sp/>2.606,<sp/><sp/><sp/>2.520,},</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/>{<sp/>6.915,<sp/><sp/><sp/>4.841,<sp/><sp/><sp/>3.999,<sp/><sp/><sp/>3.528,<sp/><sp/><sp/>3.221,<sp/><sp/><sp/>3.002,<sp/><sp/><sp/>2.838,<sp/><sp/><sp/>2.709,<sp/><sp/><sp/>2.604,<sp/><sp/><sp/>2.518,},</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/>{<sp/>6.912,<sp/><sp/><sp/>4.838,<sp/><sp/><sp/>3.997,<sp/><sp/><sp/>3.525,<sp/><sp/><sp/>3.218,<sp/><sp/><sp/>3.000,<sp/><sp/><sp/>2.835,<sp/><sp/><sp/>2.706,<sp/><sp/><sp/>2.602,<sp/><sp/><sp/>2.515,},</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/>{<sp/>6.909,<sp/><sp/><sp/>4.836,<sp/><sp/><sp/>3.995,<sp/><sp/><sp/>3.523,<sp/><sp/><sp/>3.216,<sp/><sp/><sp/>2.998,<sp/><sp/><sp/>2.833,<sp/><sp/><sp/>2.704,<sp/><sp/><sp/>2.600,<sp/><sp/><sp/>2.513,},</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/>{<sp/>6.906,<sp/><sp/><sp/>4.833,<sp/><sp/><sp/>3.992,<sp/><sp/><sp/>3.521,<sp/><sp/><sp/>3.214,<sp/><sp/><sp/>2.996,<sp/><sp/><sp/>2.831,<sp/><sp/><sp/>2.702,<sp/><sp/><sp/>2.598,<sp/><sp/><sp/>2.511,},</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/>{<sp/>6.904,<sp/><sp/><sp/>4.831,<sp/><sp/><sp/>3.990,<sp/><sp/><sp/>3.519,<sp/><sp/><sp/>3.212,<sp/><sp/><sp/>2.994,<sp/><sp/><sp/>2.829,<sp/><sp/><sp/>2.700,<sp/><sp/><sp/>2.596,<sp/><sp/><sp/>2.509,},</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/>{<sp/>6.901,<sp/><sp/><sp/>4.829,<sp/><sp/><sp/>3.988,<sp/><sp/><sp/>3.517,<sp/><sp/><sp/>3.210,<sp/><sp/><sp/>2.992,<sp/><sp/><sp/>2.827,<sp/><sp/><sp/>2.698,<sp/><sp/><sp/>2.594,<sp/><sp/><sp/>2.507,},</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/>{<sp/>6.898,<sp/><sp/><sp/>4.826,<sp/><sp/><sp/>3.986,<sp/><sp/><sp/>3.515,<sp/><sp/><sp/>3.208,<sp/><sp/><sp/>2.990,<sp/><sp/><sp/>2.825,<sp/><sp/><sp/>2.696,<sp/><sp/><sp/>2.592,<sp/><sp/><sp/>2.505,},</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/>{<sp/>6.895,<sp/><sp/><sp/>4.824,<sp/><sp/><sp/>3.984,<sp/><sp/><sp/>3.513,<sp/><sp/><sp/>3.206,<sp/><sp/><sp/>2.988,<sp/><sp/><sp/>2.823,<sp/><sp/><sp/>2.694,<sp/><sp/><sp/>2.590,<sp/><sp/><sp/>2.503}</highlight></codeline>
<codeline lineno="135"><highlight class="normal">};</highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>define<sp/>the<sp/>variance<sp/>which<sp/>will<sp/>be<sp/>used<sp/>as<sp/>a<sp/>minimum<sp/>variance<sp/>for<sp/>any</highlight></codeline>
<codeline lineno="138"><highlight class="comment"><sp/><sp/>dimension<sp/>of<sp/>any<sp/>feature.<sp/>Since<sp/>most<sp/>features<sp/>are<sp/>calculated<sp/>from<sp/>numbers</highlight></codeline>
<codeline lineno="139"><highlight class="comment"><sp/><sp/>with<sp/>a<sp/>precision<sp/>no<sp/>better<sp/>than<sp/>1<sp/>in<sp/>128,<sp/>the<sp/>variance<sp/>should<sp/>never<sp/>be</highlight></codeline>
<codeline lineno="140"><highlight class="comment"><sp/><sp/>less<sp/>than<sp/>the<sp/>square<sp/>of<sp/>this<sp/>number<sp/>for<sp/>parameters<sp/>whose<sp/>range<sp/>is<sp/>1.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>MINVARIANCE<sp/><sp/><sp/><sp/><sp/>0.0004</highlight></codeline>
<codeline lineno="142"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>define<sp/>the<sp/>absolute<sp/>minimum<sp/>number<sp/>of<sp/>samples<sp/>which<sp/>must<sp/>be<sp/>present<sp/>in</highlight></codeline>
<codeline lineno="144"><highlight class="comment"><sp/><sp/>order<sp/>to<sp/>accurately<sp/>test<sp/>hypotheses<sp/>about<sp/>underlying<sp/>probability</highlight></codeline>
<codeline lineno="145"><highlight class="comment"><sp/><sp/>distributions.<sp/><sp/>Define<sp/>separately<sp/>the<sp/>minimum<sp/>samples<sp/>that<sp/>are<sp/>needed</highlight></codeline>
<codeline lineno="146"><highlight class="comment"><sp/><sp/>before<sp/>a<sp/>statistical<sp/>analysis<sp/>is<sp/>attempted;<sp/>this<sp/>number<sp/>should<sp/>be</highlight></codeline>
<codeline lineno="147"><highlight class="comment"><sp/><sp/>equal<sp/>to<sp/>MINSAMPLES<sp/>but<sp/>can<sp/>be<sp/>set<sp/>to<sp/>a<sp/>lower<sp/>number<sp/>for<sp/>early<sp/>testing</highlight></codeline>
<codeline lineno="148"><highlight class="comment"><sp/><sp/>when<sp/>very<sp/>few<sp/>samples<sp/>are<sp/>available.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>MINSAMPLESPERBUCKET<sp/>5</highlight></codeline>
<codeline lineno="150"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>MINSAMPLES<sp/><sp/><sp/><sp/>(MINBUCKETS<sp/>*<sp/>MINSAMPLESPERBUCKET)</highlight></codeline>
<codeline lineno="151"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>MINSAMPLESNEEDED<sp/><sp/>1</highlight></codeline>
<codeline lineno="152"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>define<sp/>the<sp/>size<sp/>of<sp/>the<sp/>table<sp/>which<sp/>maps<sp/>normalized<sp/>samples<sp/>to</highlight></codeline>
<codeline lineno="154"><highlight class="comment"><sp/><sp/>histogram<sp/>buckets.<sp/><sp/>Also<sp/>define<sp/>the<sp/>number<sp/>of<sp/>standard<sp/>deviations</highlight></codeline>
<codeline lineno="155"><highlight class="comment"><sp/><sp/>in<sp/>a<sp/>normal<sp/>distribution<sp/>which<sp/>are<sp/>considered<sp/>to<sp/>be<sp/>significant.</highlight></codeline>
<codeline lineno="156"><highlight class="comment"><sp/><sp/>The<sp/>mapping<sp/>table<sp/>will<sp/>be<sp/>defined<sp/>in<sp/>such<sp/>a<sp/>way<sp/>that<sp/>it<sp/>covers</highlight></codeline>
<codeline lineno="157"><highlight class="comment"><sp/><sp/>the<sp/>specified<sp/>number<sp/>of<sp/>standard<sp/>deviations<sp/>on<sp/>either<sp/>side<sp/>of</highlight></codeline>
<codeline lineno="158"><highlight class="comment"><sp/><sp/>the<sp/>mean.<sp/><sp/>BUCKETTABLESIZE<sp/>should<sp/>always<sp/>be<sp/>even.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>BUCKETTABLESIZE<sp/><sp/><sp/>1024</highlight></codeline>
<codeline lineno="160"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>NORMALEXTENT<sp/><sp/><sp/><sp/>3.0</highlight></codeline>
<codeline lineno="161"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162" refid="struct_t_e_m_p_c_l_u_s_t_e_r" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="struct_t_e_m_p_c_l_u_s_t_e_r" kindref="compound">TEMPCLUSTER</ref><sp/>{</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1adfa4721271456305d40524737800bb2e" kindref="member">Cluster</ref>;</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1abc9f805357e72eae3febb1dbd4c412ac" kindref="member">Neighbor</ref>;</highlight></codeline>
<codeline lineno="165"><highlight class="normal">};</highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167" refid="struct_s_t_a_t_i_s_t_i_c_s" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>{</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s_1aec33c119c63aad5cd1c4e75c6afe2968" kindref="member">AvgVariance</ref>;</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a1a87c66cfa2a256ff9b13d5858bf9650" kindref="member">CoVariance</ref>;</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1ae03871d16f8d02e97e24401324565ab5" kindref="member">Min</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>largest<sp/>negative<sp/>distance<sp/>from<sp/>the<sp/>mean</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a6f553b49759c072107a7c1c5606bbc72" kindref="member">Max</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>largest<sp/>positive<sp/>distance<sp/>from<sp/>the<sp/>mean</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal">};</highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174" refid="struct_b_u_c_k_e_t_s" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>{</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0" kindref="member">DISTRIBUTION</ref><sp/><ref refid="struct_b_u_c_k_e_t_s_1ad2b1ef5944d42354519db2895a8ca062" kindref="member">Distribution</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>distribution<sp/>being<sp/>tested<sp/>for</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref><sp/><ref refid="struct_b_u_c_k_e_t_s_1a8e352450eb27c8a017a037f71796b402" kindref="member">SampleCount</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>#<sp/>of<sp/>samples<sp/>in<sp/>histogram</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="struct_b_u_c_k_e_t_s_1aeef80a305501f83af63153e6b2e362a8" kindref="member">Confidence</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>confidence<sp/>level<sp/>of<sp/>test</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="struct_b_u_c_k_e_t_s_1a4dedca1b6c939050313aa761b59a0a11" kindref="member">ChiSquared</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>test<sp/>threshold</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>number<sp/>of<sp/>cells<sp/>in<sp/>histogram</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="struct_b_u_c_k_e_t_s_1a087d99bc0da49ff3abcfa664a5effbfa" kindref="member">Bucket</ref>[<ref refid="cluster_8cpp_1a0b0900161a8584a70a474237621ce953" kindref="member">BUCKETTABLESIZE</ref>];</highlight><highlight class="comment">//<sp/>mapping<sp/>to<sp/>histogram<sp/>buckets</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref><sp/>*<ref refid="struct_b_u_c_k_e_t_s_1a0b281b83beb3b9c450eeec5c9f4ec763" kindref="member">Count</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>frequency<sp/>of<sp/>occurence<sp/>histogram</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*<ref refid="struct_b_u_c_k_e_t_s_1a4002c4c85553bc88efee6395fe803026" kindref="member">ExpectedCount</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>expected<sp/>histogram</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal">};</highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185" refid="struct_c_h_i_s_t_r_u_c_t" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref>{</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="struct_c_h_i_s_t_r_u_c_t_1a15a3b870d88bb0fcedd7accc60d195c7" kindref="member">DegreesOfFreedom</ref>;</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="struct_c_h_i_s_t_r_u_c_t_1a58a4707e32861b244d471e6d152fe43a" kindref="member">Alpha</ref>;</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="struct_c_h_i_s_t_r_u_c_t_1ab8ebe43673dcf3e24c6a792c3bed43ea" kindref="member">ChiSquared</ref>;</highlight></codeline>
<codeline lineno="189"><highlight class="normal">};</highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight><highlight class="comment">//<sp/>For<sp/>use<sp/>with<sp/>KDWalk<sp/>/<sp/>MakePotentialClusters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192" refid="struct_clustering_context" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="struct_clustering_context" kindref="compound">ClusteringContext</ref><sp/>{</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><ref refid="struct_h_e_a_p" kindref="compound">HEAP</ref><sp/>*<ref refid="struct_clustering_context_1a411623fe2aa0ed365290e1f0c8ac81a4" kindref="member">heap</ref>;<sp/><sp/></highlight><highlight class="comment">//<sp/>heap<sp/>used<sp/>to<sp/>hold<sp/>temp<sp/>clusters,<sp/>&quot;best&quot;<sp/>on<sp/>top</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><ref refid="struct_t_e_m_p_c_l_u_s_t_e_r" kindref="compound">TEMPCLUSTER</ref><sp/>*<ref refid="struct_clustering_context_1abcdf0ba8732036cb540bb470956186d3" kindref="member">candidates</ref>;<sp/><sp/></highlight><highlight class="comment">//<sp/>array<sp/>of<sp/>potential<sp/>clusters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><ref refid="struct_k_d_t_r_e_e" kindref="compound">KDTREE</ref><sp/>*<ref refid="struct_clustering_context_1a6414b57292a4e25bfe1af8bd47258817" kindref="member">tree</ref>;<sp/><sp/></highlight><highlight class="comment">//<sp/>kd-tree<sp/>to<sp/>be<sp/>searched<sp/>for<sp/>neighbors</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/><ref refid="struct_clustering_context_1a6e7e68c81c4925fb0cc24fa90d1fa358" kindref="member">next</ref>;<sp/><sp/></highlight><highlight class="comment">//<sp/>next<sp/>candidate<sp/>to<sp/>be<sp/>used</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal">};</highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>(*<ref refid="cluster_8cpp_1a32b61dc3b9e8987cc1a63db31c99c6e9" kindref="member">DENSITYFUNC</ref>)<sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>);</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>(*<ref refid="cluster_8cpp_1a170fa76dec6514a98bb069c4b9652f2d" kindref="member">SOLVEFUNC</ref>)<sp/>(<ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*,<sp/>double);</highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>Odd(N)<sp/>((N)%2)</highlight></codeline>
<codeline lineno="203"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>Mirror(N,R)<sp/>((R)<sp/>-<sp/>(N)<sp/>-<sp/>1)</highlight></codeline>
<codeline lineno="204"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>Abs(N)<sp/>(<sp/>(<sp/>(N)<sp/>&lt;<sp/>0<sp/>)<sp/>?<sp/>(<sp/>-(N)<sp/>)<sp/>:<sp/>(N)<sp/>)</highlight></codeline>
<codeline lineno="205"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight><highlight class="comment">//--------------Global<sp/>Data<sp/>Definitions<sp/>and<sp/>Declarations----------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>the<sp/>following<sp/>variables<sp/>describe<sp/>a<sp/>discrete<sp/>normal<sp/>distribution</highlight></codeline>
<codeline lineno="208"><highlight class="comment"><sp/><sp/>which<sp/>is<sp/>used<sp/>by<sp/>NormalDensity()<sp/>and<sp/>NormalBucket().<sp/><sp/>The</highlight></codeline>
<codeline lineno="209"><highlight class="comment"><sp/><sp/>constant<sp/>NORMALEXTENT<sp/>determines<sp/>how<sp/>many<sp/>standard</highlight></codeline>
<codeline lineno="210"><highlight class="comment"><sp/><sp/>deviations<sp/>of<sp/>the<sp/>distribution<sp/>are<sp/>mapped<sp/>onto<sp/>the<sp/>fixed</highlight></codeline>
<codeline lineno="211"><highlight class="comment"><sp/><sp/>discrete<sp/>range<sp/>of<sp/>x.<sp/><sp/>x=0<sp/>is<sp/>mapped<sp/>to<sp/>-NORMALEXTENT<sp/>standard</highlight></codeline>
<codeline lineno="212"><highlight class="comment"><sp/><sp/>deviations<sp/>and<sp/>x=BUCKETTABLESIZE<sp/>is<sp/>mapped<sp/>to</highlight></codeline>
<codeline lineno="213"><highlight class="comment"><sp/><sp/>+NORMALEXTENT<sp/>standard<sp/>deviations.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>SqrtOf2Pi<sp/><sp/><sp/><sp/><sp/>2.506628275</highlight></codeline>
<codeline lineno="215"><highlight class="preprocessor"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>kNormalStdDev<sp/>=<sp/><ref refid="cluster_8cpp_1a0b0900161a8584a70a474237621ce953" kindref="member">BUCKETTABLESIZE</ref><sp/>/<sp/>(2.0<sp/>*<sp/><ref refid="cluster_8cpp_1ad3f8e9aec305987f3daa2d431da4cac3" kindref="member">NORMALEXTENT</ref>);</highlight></codeline>
<codeline lineno="216"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>kNormalVariance<sp/>=</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/>(<ref refid="cluster_8cpp_1a0b0900161a8584a70a474237621ce953" kindref="member">BUCKETTABLESIZE</ref><sp/>*<sp/><ref refid="cluster_8cpp_1a0b0900161a8584a70a474237621ce953" kindref="member">BUCKETTABLESIZE</ref>)<sp/>/<sp/>(4.0<sp/>*<sp/><ref refid="cluster_8cpp_1ad3f8e9aec305987f3daa2d431da4cac3" kindref="member">NORMALEXTENT</ref><sp/>*<sp/><ref refid="cluster_8cpp_1ad3f8e9aec305987f3daa2d431da4cac3" kindref="member">NORMALEXTENT</ref>);</highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>kNormalMagnitude<sp/>=</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/>(2.0<sp/>*<sp/><ref refid="cluster_8cpp_1ad3f8e9aec305987f3daa2d431da4cac3" kindref="member">NORMALEXTENT</ref>)<sp/>/<sp/>(<ref refid="cluster_8cpp_1a5b63c74defa53affeb3825bec1aa894d" kindref="member">SqrtOf2Pi</ref><sp/>*<sp/><ref refid="cluster_8cpp_1a0b0900161a8584a70a474237621ce953" kindref="member">BUCKETTABLESIZE</ref>);</highlight></codeline>
<codeline lineno="220"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>kNormalMean<sp/>=<sp/>BUCKETTABLESIZE<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>define<sp/>lookup<sp/>tables<sp/>used<sp/>to<sp/>compute<sp/>the<sp/>number<sp/>of<sp/>histogram<sp/>buckets</highlight></codeline>
<codeline lineno="223"><highlight class="comment"><sp/><sp/>that<sp/>should<sp/>be<sp/>used<sp/>for<sp/>a<sp/>given<sp/>number<sp/>of<sp/>samples.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>LOOKUPTABLESIZE<sp/><sp/><sp/>8</highlight></codeline>
<codeline lineno="225"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>MAXDEGREESOFFREEDOM<sp/>MAXBUCKETS</highlight></codeline>
<codeline lineno="226"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref><sp/>kCountTable[<ref refid="cluster_8cpp_1a4342455851ae586637e6a0abaf3b3f14" kindref="member">LOOKUPTABLESIZE</ref>]<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><ref refid="cluster_8cpp_1a47c31dab77cf79b225315601107dfd67" kindref="member">MINSAMPLES</ref>,<sp/>200,<sp/>400,<sp/>600,<sp/>800,<sp/>1000,<sp/>1500,<sp/>2000</highlight></codeline>
<codeline lineno="229"><highlight class="normal">};<sp/><sp/></highlight><highlight class="comment">//<sp/>number<sp/>of<sp/>samples</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>kBucketsTable[<ref refid="cluster_8cpp_1a4342455851ae586637e6a0abaf3b3f14" kindref="member">LOOKUPTABLESIZE</ref>]<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><ref refid="cluster_8h_1a759b3b99f54d92a0c6c5471a4c87c42b" kindref="member">MINBUCKETS</ref>,<sp/>16,<sp/>20,<sp/>24,<sp/>27,<sp/>30,<sp/>35,<sp/><ref refid="cluster_8h_1a17645698964d2a3c89b72281594c58a3" kindref="member">MAXBUCKETS</ref></highlight></codeline>
<codeline lineno="233"><highlight class="normal">};<sp/><sp/></highlight><highlight class="comment">//<sp/>number<sp/>of<sp/>buckets</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight><highlight class="comment">/*-------------------------------------------------------------------------</highlight></codeline>
<codeline lineno="236"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Private<sp/>Function<sp/>Prototypes</highlight></codeline>
<codeline lineno="237"><highlight class="comment">--------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a4c81bc8616b0a41fc46726affcda9728" kindref="member">CreateClusterTree</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer);</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1ae250df46fa1538fb7932e11d5a6aa98a" kindref="member">MakePotentialClusters</ref>(<ref refid="struct_clustering_context" kindref="compound">ClusteringContext</ref><sp/>*context,<sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>Level);</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*<ref refid="cluster_8cpp_1a45fae84caf7ba68e1a77fdffe9f0d112" kindref="member">FindNearestNeighbor</ref>(<ref refid="struct_k_d_t_r_e_e" kindref="compound">KDTREE</ref><sp/>*Tree,</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*Distance);</highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*<ref refid="cluster_8cpp_1ab73b69de28e8bb2f1332524a02f6f475" kindref="member">MakeNewCluster</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,<sp/><ref refid="struct_t_e_m_p_c_l_u_s_t_e_r" kindref="compound">TEMPCLUSTER</ref><sp/>*TempCluster);</highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/><ref refid="cluster_8cpp_1a13004a2cbbcf26c3d95fd207274823c9" kindref="member">MergeClusters</ref><sp/>(<ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>N,</highlight></codeline>
<codeline lineno="250"><highlight class="normal"></highlight><highlight class="keyword">register</highlight><highlight class="normal"><sp/><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>ParamDesc[],</highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight><highlight class="keyword">register</highlight><highlight class="normal"><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>n1,</highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight><highlight class="keyword">register</highlight><highlight class="normal"><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>n2,</highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight><highlight class="keyword">register</highlight><highlight class="normal"><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>m[],</highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight><highlight class="keyword">register</highlight><highlight class="normal"><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>m1[],<sp/></highlight><highlight class="keyword">register</highlight><highlight class="normal"><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>m2[]);</highlight></codeline>
<codeline lineno="255"><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a85e813bae86e0c290ceb0f99d83ae9bf" kindref="member">ComputePrototypes</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,<sp/><ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g" kindref="compound">CLUSTERCONFIG</ref><sp/>*<ref refid="commontraining_8cpp_1a1630a3dc82a9a7cef07bb6153df9eb9c" kindref="member">Config</ref>);</highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1aa37ac7f48ca91b0afb78f8408e8b9b6f" kindref="member">MakePrototype</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g" kindref="compound">CLUSTERCONFIG</ref><sp/>*<ref refid="commontraining_8cpp_1a1630a3dc82a9a7cef07bb6153df9eb9c" kindref="member">Config</ref>,</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster);</highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1abd55a5befb4eda77f5d0abbd460cc501" kindref="member">MakeDegenerateProto</ref>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>N,</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics,</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9ea" kindref="member">PROTOSTYLE</ref><sp/>Style,</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>MinSamples);</highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1a52963d24aa278bff9a1de24806954d61" kindref="member">TestEllipticalProto</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g" kindref="compound">CLUSTERCONFIG</ref><sp/>*<ref refid="commontraining_8cpp_1a1630a3dc82a9a7cef07bb6153df9eb9c" kindref="member">Config</ref>,</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics);</highlight></codeline>
<codeline lineno="272"><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1ad04d25bb39e413b1cd7064534b98f9a4" kindref="member">MakeSphericalProto</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics,</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1a076b9ff3e723f44987211c9bf5f77523" kindref="member">MakeEllipticalProto</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics,</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets);</highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1a2ebb51aa33fe2a99f5326366ed86b42e" kindref="member">MakeMixedProto</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics,</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*NormalBuckets,</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Confidence);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1ae018c99abb6b7f691f2e4b711485b45b" kindref="member">MakeDimRandom</ref>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>i,<sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto,<sp/><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>*ParamDesc);</highlight></codeline>
<codeline lineno="290"><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a12a01c4bc8f83968f4b64600bfff82de" kindref="member">MakeDimUniform</ref>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>i,<sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto,<sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics);</highlight></codeline>
<codeline lineno="292"><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*<ref refid="cluster_8cpp_1aa60411f531ca1f230d001973299d1c09" kindref="member">ComputeStatistics</ref><sp/>(<ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>N,</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>ParamDesc[],<sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*<sp/>Cluster);</highlight></codeline>
<codeline lineno="295"><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1a96019ee068587b2d17ddb6f43ded872b" kindref="member">NewSphericalProto</ref>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>N,</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics);</highlight></codeline>
<codeline lineno="299"><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1a1453a157e92261f5331f8624dfc4d3c0" kindref="member">NewEllipticalProto</ref>(<ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>N,</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics);</highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1accc05d5eedc4d765148eaa99c1927a79" kindref="member">NewMixedProto</ref>(<ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>N,<sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,<sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics);</highlight></codeline>
<codeline lineno="305"><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1adf2445f2aae1e1e03f06eefb85c95b8d" kindref="member">NewSimpleProto</ref>(<ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>N,<sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster);</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/><ref refid="cluster_8cpp_1a0a6fea38a06375666937701fb21e6a05" kindref="member">Independent</ref><sp/>(<ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>ParamDesc[],</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>N,<sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*<sp/>CoVariance,<sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>Independence);</highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*<ref refid="cluster_8cpp_1a0924b73d8bc3cd1269aa64f5a41b633f" kindref="member">GetBuckets</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref>*<sp/>clusterer,</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0" kindref="member">DISTRIBUTION</ref><sp/>Distribution,</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref><sp/>SampleCount,</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Confidence);</highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*<ref refid="cluster_8cpp_1a93a38445707d2a943e60fafebe0c2b4d" kindref="member">MakeBuckets</ref>(<ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0" kindref="member">DISTRIBUTION</ref><sp/>Distribution,</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref><sp/>SampleCount,</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Confidence);</highlight></codeline>
<codeline lineno="319"><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="cluster_8cpp_1ab182ad32f9100ae8e29e72db623c70dd" kindref="member">OptimumNumberOfBuckets</ref>(<ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref><sp/>SampleCount);</highlight></codeline>
<codeline lineno="321"><highlight class="normal"></highlight></codeline>
<codeline lineno="322"><highlight class="normal"><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="cluster_8cpp_1a952909dfb237bce2b90d33204b3efe3e" kindref="member">ComputeChiSquared</ref>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="cluster_8cpp_1acfe8f1657aa1e2a4de798d80ab637756" kindref="member">DegreesOfFreedom</ref>,<sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Alpha);</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="cluster_8cpp_1a46fa6d94ca57427d93d1f306c4bbcf46" kindref="member">NormalDensity</ref>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>x);</highlight></codeline>
<codeline lineno="325"><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="cluster_8cpp_1a5abc8ec5703c3d471dc0dd172cb22168" kindref="member">UniformDensity</ref>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>x);</highlight></codeline>
<codeline lineno="327"><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="cluster_8cpp_1af0eb798915396ae610f1701708a7b816" kindref="member">Integral</ref>(<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>f1,<sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>f2,<sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Dx);</highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a54c75ac15de9474adc1387dc0c809c0b" kindref="member">FillBuckets</ref>(<ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets,</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>Dim,</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>*ParamDesc,</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/><ref refid="cluster_8cpp_1ad99e1235a4e63880ab2f72bfdff26e28" kindref="member">Mean</ref>,</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>StdDev);</highlight></codeline>
<codeline lineno="336"><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="cluster_8cpp_1a8e988f373e1dc7d9a55043f3db047d09" kindref="member">NormalBucket</ref>(<ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>*ParamDesc,</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>x,</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/><ref refid="cluster_8cpp_1ad99e1235a4e63880ab2f72bfdff26e28" kindref="member">Mean</ref>,</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>StdDev);</highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="cluster_8cpp_1a43e2cce8f045a700cd6fb0684761cc0c" kindref="member">UniformBucket</ref>(<ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>*ParamDesc,</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>x,</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/><ref refid="cluster_8cpp_1ad99e1235a4e63880ab2f72bfdff26e28" kindref="member">Mean</ref>,</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>StdDev);</highlight></codeline>
<codeline lineno="346"><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/><ref refid="cluster_8cpp_1a4c5b32330cf58e89e2352deb84394332" kindref="member">DistributionOK</ref>(<ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets);</highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1aef1b69ed626e557bf84c9c0b18db6b95" kindref="member">FreeStatistics</ref>(<ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a1afe8a387c2e426eea3e152bb1cdd3e9" kindref="member">FreeBuckets</ref>(<ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets);</highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1ac66b8beb503d71773eba9bc47d386ae8" kindref="member">FreeCluster</ref>(<ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster);</highlight></codeline>
<codeline lineno="354"><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="cluster_8cpp_1acfe8f1657aa1e2a4de798d80ab637756" kindref="member">DegreesOfFreedom</ref>(<ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0" kindref="member">DISTRIBUTION</ref><sp/>Distribution,<sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>HistogramBuckets);</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1af8d341c60c044ac30867d767c6b9b091" kindref="member">NumBucketsMatch</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*arg1,<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>BUCKETS<sp/>*Histogram,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*arg2);<sp/><sp/></highlight><highlight class="comment">//<sp/>uinT16<sp/>*DesiredNumberOfBuckets);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a7f39be063580c1c7c5566faf0398dfb0" kindref="member">ListEntryMatch</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*arg1,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*arg2);</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a02e72bde5b9d967258769d4a75f07e46" kindref="member">AdjustBuckets</ref>(<ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets,<sp/><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref><sp/>NewSampleCount);</highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a0f9ec282a0fa768a4b5bd0d5efaca7d2" kindref="member">InitBuckets</ref>(<ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets);</highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1ad39bd07ace019e3862769098fae02f93" kindref="member">AlphaMatch</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*arg1,<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>CHISTRUCT<sp/>*ChiStruct,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*arg2);<sp/><sp/></highlight><highlight class="comment">//<sp/>CHISTRUCT<sp/>*SearchKey);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*<ref refid="cluster_8cpp_1ac16f25cf71bcb2632f695f55fb9a5980" kindref="member">NewChiStruct</ref>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="cluster_8cpp_1acfe8f1657aa1e2a4de798d80ab637756" kindref="member">DegreesOfFreedom</ref>,<sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Alpha);</highlight></codeline>
<codeline lineno="370"><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="cluster_8cpp_1a8098e057438e6f07276dd005f28ef13c" kindref="member">Solve</ref>(<ref refid="cluster_8cpp_1a170fa76dec6514a98bb069c4b9652f2d" kindref="member">SOLVEFUNC</ref><sp/>Function,</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*FunctionParams,</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>InitialGuess,</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Accuracy);</highlight></codeline>
<codeline lineno="375"><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="cluster_8cpp_1a444724ad6aa7b59e010c1089af12b0b0" kindref="member">ChiArea</ref>(<ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*ChiParams,<sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>x);</highlight></codeline>
<codeline lineno="377"><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/><ref refid="cluster_8cpp_1a39583ff2f6db38f0c2e26f7ad87f2c0c" kindref="member">MultipleCharSamples</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>MaxIllegal);</highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a40c47f6785ad5d50a9b113761e16ab9d" kindref="member">InvertMatrix</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>input,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>size,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>inv);</highlight></codeline>
<codeline lineno="383"><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight><highlight class="comment">//--------------------------Public<sp/>Code--------------------------------------</highlight></codeline>
<codeline lineno="394"><highlight class="comment"></highlight><highlight class="normal"><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><ref refid="cluster_8cpp_1a93e53684b74358b68adf48b2ee32b042" kindref="member">MakeClusterer</ref><sp/>(<ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>SampleSize,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>ParamDesc[])<sp/>{</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer;</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="398"><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>allocate<sp/>main<sp/>clusterer<sp/>data<sp/>structure<sp/>and<sp/>init<sp/>simple<sp/>fields</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/>Clusterer<sp/>=<sp/>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref>));</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref><sp/>=<sp/>SampleSize;</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a04b44b06900e7a0c8d8d4d4e5a00c3aa" kindref="member">NumberOfSamples</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1aa4a7b4654dcb4918ac9a282d976b72d9" kindref="member">NumChar</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>init<sp/>fields<sp/>which<sp/>will<sp/>not<sp/>be<sp/>used<sp/>initially</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a0178d3dfedb397870384f599d809c54d" kindref="member">Root</ref><sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af6bd9758400f9a886e8fde8d009de70f" kindref="member">ProtoList</ref><sp/>=<sp/><ref refid="oldlist_8h_1ae212530ca629c67513698e988c705a5a" kindref="member">NIL_LIST</ref>;</highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>maintain<sp/>a<sp/>copy<sp/>of<sp/>param<sp/>descriptors<sp/>in<sp/>the<sp/>clusterer<sp/>data<sp/>structure</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref><sp/>=</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/>(<ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(SampleSize<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref>));</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>SampleSize;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a55807f1e0be0daba2a33380ea29b2f1d" kindref="member">Circular</ref><sp/>=<sp/>ParamDesc[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a55807f1e0be0daba2a33380ea29b2f1d" kindref="member">Circular</ref>;</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a6b9843466a3ddf33bfab18f85ca06501" kindref="member">NonEssential</ref><sp/>=<sp/>ParamDesc[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a6b9843466a3ddf33bfab18f85ca06501" kindref="member">NonEssential</ref>;</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a6445e8e433a99239e56c3218437f2695" kindref="member">Min</ref><sp/>=<sp/>ParamDesc[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a6445e8e433a99239e56c3218437f2695" kindref="member">Min</ref>;</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a73e76f946bbd324e60914a991d3343d1" kindref="member">Max</ref><sp/>=<sp/>ParamDesc[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a73e76f946bbd324e60914a991d3343d1" kindref="member">Max</ref>;</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a031dddcdc1744e777435f8ceea197448" kindref="member">Range</ref><sp/>=<sp/>ParamDesc[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a73e76f946bbd324e60914a991d3343d1" kindref="member">Max</ref><sp/>-<sp/>ParamDesc[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a6445e8e433a99239e56c3218437f2695" kindref="member">Min</ref>;</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a1df92d879d7ec8ea6662e956d27154b5" kindref="member">HalfRange</ref><sp/>=<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a031dddcdc1744e777435f8ceea197448" kindref="member">Range</ref><sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a7c7bec15766be3633c649a0a9409b512" kindref="member">MidRange</ref><sp/>=</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(ParamDesc[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a73e76f946bbd324e60914a991d3343d1" kindref="member">Max</ref><sp/>+<sp/>ParamDesc[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a6445e8e433a99239e56c3218437f2695" kindref="member">Min</ref>)<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>allocate<sp/>a<sp/>kd<sp/>tree<sp/>to<sp/>hold<sp/>the<sp/>samples</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af2c9040008b80775815320a327f21242" kindref="member">KDTree</ref><sp/>=<sp/><ref refid="kdtree_8cpp_1a92b996eb8120afe351d8e7ee82c96ece" kindref="member">MakeKDTree</ref><sp/>(SampleSize,<sp/>ParamDesc);</highlight></codeline>
<codeline lineno="425"><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Initialize<sp/>cache<sp/>of<sp/>histogram<sp/>buckets<sp/>to<sp/>minimize<sp/>recomputing<sp/>them.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d<sp/>=<sp/>0;<sp/>d<sp/>&lt;<sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0a1223ae56d204b110bd185b7dbdda258e" kindref="member">DISTRIBUTION_COUNT</ref>;<sp/>++d)<sp/>{</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>c<sp/>=<sp/>0;<sp/>c<sp/>&lt;<sp/><ref refid="cluster_8h_1a17645698964d2a3c89b72281594c58a3" kindref="member">MAXBUCKETS</ref><sp/>+<sp/>1<sp/>-<sp/><ref refid="cluster_8h_1a759b3b99f54d92a0c6c5471a4c87c42b" kindref="member">MINBUCKETS</ref>;<sp/>++c)</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a01b03fc9cf75b5bd7d11abde7405a23a" kindref="member">bucket_cache</ref>[d][c]<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="431"><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Clusterer;</highlight></codeline>
<codeline lineno="433"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MakeClusterer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"></highlight></codeline>
<codeline lineno="435"><highlight class="normal"></highlight></codeline>
<codeline lineno="450"><highlight class="normal"><ref refid="structsample" kindref="compound">SAMPLE</ref>*<sp/><ref refid="cluster_8cpp_1ab3cc5ee277d4a2cf4000668b1ffbcf4a" kindref="member">MakeSample</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*<sp/>Clusterer,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>*<sp/>Feature,</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>CharID)<sp/>{</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><ref refid="structsample" kindref="compound">SAMPLE</ref><sp/>*Sample;</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="454"><highlight class="normal"></highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>see<sp/>if<sp/>the<sp/>samples<sp/>have<sp/>already<sp/>been<sp/>clustered<sp/>-<sp/>if<sp/>so<sp/>trap<sp/>an<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a0178d3dfedb397870384f599d809c54d" kindref="member">Root</ref><sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="danerror_8cpp_1a480942fa88232bda23e9809e5afa9f25" kindref="member">DoError</ref><sp/>(<ref refid="cluster_8h_1aa086ccbc1343c3ac99987b23d500adab" kindref="member">ALREADYCLUSTERED</ref>,</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Can&apos;t<sp/>add<sp/>samples<sp/>after<sp/>they<sp/>have<sp/>been<sp/>clustered&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>allocate<sp/>the<sp/>new<sp/>sample<sp/>and<sp/>initialize<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/>Sample<sp/>=<sp/>(<ref refid="structsample" kindref="compound">SAMPLE</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="structsample" kindref="compound">SAMPLE</ref>)<sp/>+</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref><sp/>-</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/>1)<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>));</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/>Sample-&gt;<ref refid="structsample_1aa6b39588394fbede2bdcac083bf3832d" kindref="member">Clustered</ref><sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/>Sample-&gt;<ref refid="structsample_1af0c82e552c662971cf574f9ee8bcb40f" kindref="member">Prototype</ref><sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/>Sample-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/>Sample-&gt;<ref refid="structsample_1ae6abb40063761a77d4275c79c5c0bb49" kindref="member">Left</ref><sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/>Sample-&gt;<ref refid="structsample_1a2d66168da8fd6b92aed011277f54843a" kindref="member">Right</ref><sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/>Sample-&gt;<ref refid="structsample_1a564df9059b85a37e9f4e69843eec3e20" kindref="member">CharID</ref><sp/>=<sp/>CharID;</highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>;<sp/>i++)</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/>Sample-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>[i]<sp/>=<sp/>Feature[i];</highlight></codeline>
<codeline lineno="473"><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>add<sp/>the<sp/>sample<sp/>to<sp/>the<sp/>KD<sp/>tree<sp/>-<sp/>keep<sp/>track<sp/>of<sp/>the<sp/>total<sp/>#<sp/>of<sp/>samples</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a04b44b06900e7a0c8d8d4d4e5a00c3aa" kindref="member">NumberOfSamples</ref>++;</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><ref refid="kdtree_8cpp_1a596422fd837fb6937c12be6b277423a0" kindref="member">KDStore</ref><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af2c9040008b80775815320a327f21242" kindref="member">KDTree</ref>,<sp/>Sample-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>,<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)<sp/>Sample);</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(CharID<sp/>&gt;=<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1aa4a7b4654dcb4918ac9a282d976b72d9" kindref="member">NumChar</ref>)</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1aa4a7b4654dcb4918ac9a282d976b72d9" kindref="member">NumChar</ref><sp/>=<sp/>CharID<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="479"><highlight class="normal"></highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>execute<sp/>hook<sp/>for<sp/>monitoring<sp/>clustering<sp/>operation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>(*SampleCreationHook)(<sp/>Sample<sp/>);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Sample);</highlight></codeline>
<codeline lineno="484"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MakeSample</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight></codeline>
<codeline lineno="504"><highlight class="normal"><ref refid="structlist__rec" kindref="compound">LIST</ref><sp/><ref refid="cluster_8cpp_1ac7c6943d214b9c60e0f37cbb1a2111b4" kindref="member">ClusterSamples</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,<sp/><ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g" kindref="compound">CLUSTERCONFIG</ref><sp/>*<ref refid="commontraining_8cpp_1a1630a3dc82a9a7cef07bb6153df9eb9c" kindref="member">Config</ref>)<sp/>{</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//only<sp/>create<sp/>cluster<sp/>tree<sp/>if<sp/>samples<sp/>have<sp/>never<sp/>been<sp/>clustered<sp/>before</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a0178d3dfedb397870384f599d809c54d" kindref="member">Root</ref><sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a4c81bc8616b0a41fc46726affcda9728" kindref="member">CreateClusterTree</ref>(Clusterer);</highlight></codeline>
<codeline lineno="508"><highlight class="normal"></highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//deallocate<sp/>the<sp/>old<sp/>prototype<sp/>list<sp/>if<sp/>one<sp/>exists</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><ref refid="cluster_8cpp_1a7e5357920f0bded023b15d29ddf15ebf" kindref="member">FreeProtoList</ref><sp/>(&amp;Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af6bd9758400f9a886e8fde8d009de70f" kindref="member">ProtoList</ref>);</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af6bd9758400f9a886e8fde8d009de70f" kindref="member">ProtoList</ref><sp/>=<sp/><ref refid="oldlist_8h_1ae212530ca629c67513698e988c705a5a" kindref="member">NIL_LIST</ref>;</highlight></codeline>
<codeline lineno="512"><highlight class="normal"></highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//compute<sp/>prototypes<sp/>starting<sp/>at<sp/>the<sp/>root<sp/>node<sp/>in<sp/>the<sp/>tree</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><ref refid="cluster_8cpp_1a85e813bae86e0c290ceb0f99d83ae9bf" kindref="member">ComputePrototypes</ref>(Clusterer,<sp/>Config);</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af6bd9758400f9a886e8fde8d009de70f" kindref="member">ProtoList</ref>);</highlight></codeline>
<codeline lineno="516"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ClusterSamples</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal"></highlight></codeline>
<codeline lineno="518"><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1aa5b6309260cd2d1acac25bd9cc9e9a66" kindref="member">FreeClusterer</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer)<sp/>{</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Clusterer<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>);</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af2c9040008b80775815320a327f21242" kindref="member">KDTree</ref><sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="kdtree_8cpp_1a37e4019555a2b5284b17237373913346" kindref="member">FreeKDTree</ref><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af2c9040008b80775815320a327f21242" kindref="member">KDTree</ref>);</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a0178d3dfedb397870384f599d809c54d" kindref="member">Root</ref><sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1ac66b8beb503d71773eba9bc47d386ae8" kindref="member">FreeCluster</ref><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a0178d3dfedb397870384f599d809c54d" kindref="member">Root</ref>);</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Free<sp/>up<sp/>all<sp/>used<sp/>buckets<sp/>structures.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>d<sp/>=<sp/>0;<sp/>d<sp/>&lt;<sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0a1223ae56d204b110bd185b7dbdda258e" kindref="member">DISTRIBUTION_COUNT</ref>;<sp/>++d)<sp/>{</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>c<sp/>=<sp/>0;<sp/>c<sp/>&lt;<sp/><ref refid="cluster_8h_1a17645698964d2a3c89b72281594c58a3" kindref="member">MAXBUCKETS</ref><sp/>+<sp/>1<sp/>-<sp/><ref refid="cluster_8h_1a759b3b99f54d92a0c6c5471a4c87c42b" kindref="member">MINBUCKETS</ref>;<sp/>++c)</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a01b03fc9cf75b5bd7d11abde7405a23a" kindref="member">bucket_cache</ref>[d][c]<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a1afe8a387c2e426eea3e152bb1cdd3e9" kindref="member">FreeBuckets</ref>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a01b03fc9cf75b5bd7d11abde7405a23a" kindref="member">bucket_cache</ref>[d][c]);</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="545"><highlight class="normal"></highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref>(Clusterer);</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="548"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>FreeClusterer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="549"><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"></highlight></codeline>
<codeline lineno="560"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a7e5357920f0bded023b15d29ddf15ebf" kindref="member">FreeProtoList</ref>(<ref refid="structlist__rec" kindref="compound">LIST</ref><sp/>*ProtoList)<sp/>{</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><ref refid="oldlist_8cpp_1a1a1efc1a269e5bb5bf16c1a174363ba4" kindref="member">destroy_nodes</ref>(*ProtoList,<sp/><ref refid="cluster_8cpp_1aa5d7083be183c7a4e2b2fa746a560a7b" kindref="member">FreePrototype</ref>);</highlight></codeline>
<codeline lineno="562"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>FreeProtoList</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"></highlight></codeline>
<codeline lineno="564"><highlight class="normal"></highlight></codeline>
<codeline lineno="575"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1aa5d7083be183c7a4e2b2fa746a560a7b" kindref="member">FreePrototype</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*arg)<sp/>{<sp/><sp/></highlight><highlight class="comment">//PROTOTYPE<sp/><sp/><sp/><sp/><sp/>*Prototype)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Prototype<sp/>=<sp/>(<ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*)<sp/>arg;</highlight></codeline>
<codeline lineno="577"><highlight class="normal"></highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>unmark<sp/>the<sp/>corresponding<sp/>cluster<sp/>(if<sp/>there<sp/>is<sp/>one</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Prototype-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aff59384612de343b799b92a5d80282b7" kindref="member">Cluster</ref><sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/>Prototype-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aff59384612de343b799b92a5d80282b7" kindref="member">Cluster</ref>-&gt;<ref refid="structsample_1af0c82e552c662971cf574f9ee8bcb40f" kindref="member">Prototype</ref><sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="581"><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>deallocate<sp/>the<sp/>prototype<sp/>statistics<sp/>and<sp/>then<sp/>the<sp/>prototype<sp/>itself</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Prototype-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1ae53408c33cdd473a9ed1f028e8172b0b" kindref="member">Distrib</ref><sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref><sp/>(Prototype-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1ae53408c33cdd473a9ed1f028e8172b0b" kindref="member">Distrib</ref>);</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Prototype-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af9c4f61cdbf39f6494b4691799bd4fa6" kindref="member">Mean</ref><sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref><sp/>(Prototype-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af9c4f61cdbf39f6494b4691799bd4fa6" kindref="member">Mean</ref>);</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Prototype-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aad81f08b6e171698866b445c0b3d4b35" kindref="member">Style</ref><sp/>!=<sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaa93d6901f160899d15f69322530595f4f" kindref="member">spherical</ref>)<sp/>{</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Prototype-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref><sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref><sp/>(Prototype-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>);</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Prototype-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a0b016afed9c049598aa41feb3770fc15" kindref="member">Magnitude</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref><sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref><sp/>(Prototype-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a0b016afed9c049598aa41feb3770fc15" kindref="member">Magnitude</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>);</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Prototype-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af202ff952380614068536ea0b504285e" kindref="member">Weight</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref><sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref><sp/>(Prototype-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af202ff952380614068536ea0b504285e" kindref="member">Weight</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>);</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref>(Prototype);</highlight></codeline>
<codeline lineno="596"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>FreePrototype</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="597"><highlight class="normal"></highlight></codeline>
<codeline lineno="598"><highlight class="normal"></highlight></codeline>
<codeline lineno="614"><highlight class="normal"><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*<ref refid="cluster_8cpp_1abf5d9e3b151ac51b27bd9dc797ac261c" kindref="member">NextSample</ref>(<ref refid="structlist__rec" kindref="compound">LIST</ref><sp/>*SearchState)<sp/>{</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster;</highlight></codeline>
<codeline lineno="616"><highlight class="normal"></highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*SearchState<sp/>==<sp/><ref refid="oldlist_8h_1ae212530ca629c67513698e988c705a5a" kindref="member">NIL_LIST</ref>)</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>);</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/>Cluster<sp/>=<sp/>(<ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*)<sp/><ref refid="oldlist_8h_1a69547be764424f18b0be535400747978" kindref="member">first_node</ref><sp/>(*SearchState);</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/>*SearchState<sp/>=<sp/><ref refid="oldlist_8cpp_1a4a16ea0d766f4b3bc697142d5303a62c" kindref="member">pop</ref><sp/>(*SearchState);</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Cluster-&gt;<ref refid="structsample_1ae6abb40063761a77d4275c79c5c0bb49" kindref="member">Left</ref><sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Cluster);</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/>*SearchState<sp/>=<sp/><ref refid="oldlist_8cpp_1a9c4294375af81ab4c133b6b5a3679a16" kindref="member">push</ref><sp/>(*SearchState,<sp/>Cluster-&gt;<ref refid="structsample_1a2d66168da8fd6b92aed011277f54843a" kindref="member">Right</ref>);</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/>Cluster<sp/>=<sp/>Cluster-&gt;<ref refid="structsample_1ae6abb40063761a77d4275c79c5c0bb49" kindref="member">Left</ref>;</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="627"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NextSample</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="628"><highlight class="normal"></highlight></codeline>
<codeline lineno="629"><highlight class="normal"></highlight></codeline>
<codeline lineno="639"><highlight class="normal"><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/><ref refid="cluster_8cpp_1ad99e1235a4e63880ab2f72bfdff26e28" kindref="member">Mean</ref>(<ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto,<sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>Dimension)<sp/>{</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af9c4f61cdbf39f6494b4691799bd4fa6" kindref="member">Mean</ref>[Dimension]);</highlight></codeline>
<codeline lineno="641"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Mean</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="642"><highlight class="normal"></highlight></codeline>
<codeline lineno="643"><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/><ref refid="cluster_8cpp_1a8bdd5efd86c814e7f069aa7674cd5178" kindref="member">StandardDeviation</ref>(<ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto,<sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>Dimension)<sp/>{</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aad81f08b6e171698866b445c0b3d4b35" kindref="member">Style</ref>)<sp/>{</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaa93d6901f160899d15f69322530595f4f" kindref="member">spherical</ref>:</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>)<sp/>sqrt<sp/>((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1ad883f0258d034e4fd77ce450c3e058d2" kindref="member">Spherical</ref>));</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaa39d32ff639641ca169c9729c58614459" kindref="member">elliptical</ref>:</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>)</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sqrt<sp/>((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[Dimension]));</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaab164032fff82a847826b4887d9e7be58" kindref="member">mixed</ref>:</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1ae53408c33cdd473a9ed1f028e8172b0b" kindref="member">Distrib</ref>[Dimension])<sp/>{</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0aebc81705969b8c5ae986b0b2ec08d1d5" kindref="member">normal</ref>:</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>)</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sqrt<sp/>((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[Dimension]));</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0a56013d9ac59a24fb94d9acb932a04b2f" kindref="member">uniform</ref>:</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0a21504929e31ddde091641bb817e32320" kindref="member">D_random</ref>:</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[Dimension]);</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>DISTRIBUTION_COUNT:</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref>(!</highlight><highlight class="stringliteral">&quot;Distribution<sp/>count<sp/>not<sp/>allowed!&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0.0f;</highlight></codeline>
<codeline lineno="673"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>StandardDeviation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="674"><highlight class="normal"></highlight></codeline>
<codeline lineno="675"><highlight class="normal"></highlight></codeline>
<codeline lineno="676"><highlight class="normal"></highlight><highlight class="comment">/*---------------------------------------------------------------------------</highlight></codeline>
<codeline lineno="677"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Private<sp/>Code</highlight></codeline>
<codeline lineno="678"><highlight class="comment">----------------------------------------------------------------------------*/</highlight></codeline>
<codeline lineno="694"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a4c81bc8616b0a41fc46726affcda9728" kindref="member">CreateClusterTree</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer)<sp/>{</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><ref refid="struct_clustering_context" kindref="compound">ClusteringContext</ref><sp/>context;</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><ref refid="struct_h_e_a_p_e_n_t_r_y" kindref="compound">HEAPENTRY</ref><sp/>HeapEntry;</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><ref refid="struct_t_e_m_p_c_l_u_s_t_e_r" kindref="compound">TEMPCLUSTER</ref><sp/>*PotentialCluster;</highlight></codeline>
<codeline lineno="698"><highlight class="normal"></highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>each<sp/>sample<sp/>and<sp/>its<sp/>nearest<sp/>neighbor<sp/>form<sp/>a<sp/>&quot;potential&quot;<sp/>cluster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>save<sp/>these<sp/>in<sp/>a<sp/>heap<sp/>with<sp/>the<sp/>&quot;best&quot;<sp/>potential<sp/>clusters<sp/>on<sp/>top</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/>context.<ref refid="struct_clustering_context_1a6414b57292a4e25bfe1af8bd47258817" kindref="member">tree</ref><sp/>=<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af2c9040008b80775815320a327f21242" kindref="member">KDTree</ref>;</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/>context.<ref refid="struct_clustering_context_1abcdf0ba8732036cb540bb470956186d3" kindref="member">candidates</ref><sp/>=<sp/>(<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r" kindref="compound">TEMPCLUSTER</ref><sp/>*)</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a04b44b06900e7a0c8d8d4d4e5a00c3aa" kindref="member">NumberOfSamples</ref><sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r" kindref="compound">TEMPCLUSTER</ref>));</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/>context.<ref refid="struct_clustering_context_1a6e7e68c81c4925fb0cc24fa90d1fa358" kindref="member">next</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/>context.<ref refid="struct_clustering_context_1a411623fe2aa0ed365290e1f0c8ac81a4" kindref="member">heap</ref><sp/>=<sp/><ref refid="oldheap_8cpp_1a101bee15b825fee78f29c8679cc00595" kindref="member">MakeHeap</ref>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a04b44b06900e7a0c8d8d4d4e5a00c3aa" kindref="member">NumberOfSamples</ref>);</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><ref refid="kdtree_8cpp_1abf3863949061899c45c47ec81c416234" kindref="member">KDWalk</ref>(context.<ref refid="struct_clustering_context_1a6414b57292a4e25bfe1af8bd47258817" kindref="member">tree</ref>,<sp/>(<ref refid="cutil_8h_1adec17f7c242871b5c6efb7bdb4050b9e" kindref="member">void_proc</ref>)<ref refid="cluster_8cpp_1ae250df46fa1538fb7932e11d5a6aa98a" kindref="member">MakePotentialClusters</ref>,<sp/>&amp;context);</highlight></codeline>
<codeline lineno="707"><highlight class="normal"></highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>form<sp/>potential<sp/>clusters<sp/>into<sp/>actual<sp/>clusters<sp/>-<sp/>always<sp/>do<sp/>&quot;best&quot;<sp/>first</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="oldheap_8cpp_1aad11f18baf53c82e65a054ff7552d0d1" kindref="member">GetTopOfHeap</ref>(context.<ref refid="struct_clustering_context_1a411623fe2aa0ed365290e1f0c8ac81a4" kindref="member">heap</ref>,<sp/>&amp;HeapEntry)<sp/>!=<sp/><ref refid="oldheap_8h_1a2b7cf2a3641be7b89138615764d60ba3" kindref="member">EMPTY</ref>)<sp/>{</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/>PotentialCluster<sp/>=<sp/>(<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r" kindref="compound">TEMPCLUSTER</ref><sp/>*)HeapEntry.<ref refid="struct_h_e_a_p_e_n_t_r_y_1ab04a38c2cfaa44594782f052cbe7414d" kindref="member">Data</ref>;</highlight></codeline>
<codeline lineno="711"><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>main<sp/>cluster<sp/>of<sp/>potential<sp/>cluster<sp/>is<sp/>already<sp/>in<sp/>another<sp/>cluster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>then<sp/>we<sp/>don&apos;t<sp/>need<sp/>to<sp/>worry<sp/>about<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(PotentialCluster-&gt;<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1adfa4721271456305d40524737800bb2e" kindref="member">Cluster</ref>-&gt;<ref refid="structsample_1aa6b39588394fbede2bdcac083bf3832d" kindref="member">Clustered</ref>)<sp/>{</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="717"><highlight class="normal"></highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>main<sp/>cluster<sp/>is<sp/>not<sp/>yet<sp/>clustered,<sp/>but<sp/>its<sp/>nearest<sp/>neighbor<sp/>is</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>then<sp/>we<sp/>must<sp/>find<sp/>a<sp/>new<sp/>nearest<sp/>neighbor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(PotentialCluster-&gt;<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1abc9f805357e72eae3febb1dbd4c412ac" kindref="member">Neighbor</ref>-&gt;<ref refid="structsample_1aa6b39588394fbede2bdcac083bf3832d" kindref="member">Clustered</ref>)<sp/>{</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>PotentialCluster-&gt;<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1abc9f805357e72eae3febb1dbd4c412ac" kindref="member">Neighbor</ref><sp/>=</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a45fae84caf7ba68e1a77fdffe9f0d112" kindref="member">FindNearestNeighbor</ref>(context.<ref refid="struct_clustering_context_1a6414b57292a4e25bfe1af8bd47258817" kindref="member">tree</ref>,<sp/>PotentialCluster-&gt;<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1adfa4721271456305d40524737800bb2e" kindref="member">Cluster</ref>,</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;HeapEntry.<ref refid="struct_h_e_a_p_e_n_t_r_y_1aa80cabd8128f5fa5a64e00b2e41e9c54" kindref="member">Key</ref>);</highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(PotentialCluster-&gt;<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1abc9f805357e72eae3febb1dbd4c412ac" kindref="member">Neighbor</ref><sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="oldheap_8cpp_1a21a037334c93e1d0e7ae2059203a9cf3" kindref="member">HeapStore</ref>(context.<ref refid="struct_clustering_context_1a411623fe2aa0ed365290e1f0c8ac81a4" kindref="member">heap</ref>,<sp/>&amp;HeapEntry);</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="728"><highlight class="normal"></highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>neither<sp/>cluster<sp/>is<sp/>already<sp/>clustered,<sp/>form<sp/>permanent<sp/>cluster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>PotentialCluster-&gt;<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1adfa4721271456305d40524737800bb2e" kindref="member">Cluster</ref><sp/>=</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1ab73b69de28e8bb2f1332524a02f6f475" kindref="member">MakeNewCluster</ref>(Clusterer,<sp/>PotentialCluster);</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>PotentialCluster-&gt;<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1abc9f805357e72eae3febb1dbd4c412ac" kindref="member">Neighbor</ref><sp/>=</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a45fae84caf7ba68e1a77fdffe9f0d112" kindref="member">FindNearestNeighbor</ref>(context.<ref refid="struct_clustering_context_1a6414b57292a4e25bfe1af8bd47258817" kindref="member">tree</ref>,<sp/>PotentialCluster-&gt;<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1adfa4721271456305d40524737800bb2e" kindref="member">Cluster</ref>,</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;HeapEntry.<ref refid="struct_h_e_a_p_e_n_t_r_y_1aa80cabd8128f5fa5a64e00b2e41e9c54" kindref="member">Key</ref>);</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(PotentialCluster-&gt;<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1abc9f805357e72eae3febb1dbd4c412ac" kindref="member">Neighbor</ref><sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="oldheap_8cpp_1a21a037334c93e1d0e7ae2059203a9cf3" kindref="member">HeapStore</ref>(context.<ref refid="struct_clustering_context_1a411623fe2aa0ed365290e1f0c8ac81a4" kindref="member">heap</ref>,<sp/>&amp;HeapEntry);</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="741"><highlight class="normal"></highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>root<sp/>node<sp/>in<sp/>the<sp/>cluster<sp/>tree<sp/>is<sp/>now<sp/>the<sp/>only<sp/>node<sp/>in<sp/>the<sp/>kd-tree</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a0178d3dfedb397870384f599d809c54d" kindref="member">Root</ref><sp/>=<sp/>(<ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*)<sp/><ref refid="kdtree_8h_1aa17af5e06853a731f52d4b4a84c3df90" kindref="member">RootOf</ref>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af2c9040008b80775815320a327f21242" kindref="member">KDTree</ref>);</highlight></codeline>
<codeline lineno="744"><highlight class="normal"></highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>free<sp/>up<sp/>the<sp/>memory<sp/>used<sp/>by<sp/>the<sp/>K-D<sp/>tree,<sp/>heap,<sp/>and<sp/>temp<sp/>clusters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><ref refid="kdtree_8cpp_1a37e4019555a2b5284b17237373913346" kindref="member">FreeKDTree</ref>(context.<ref refid="struct_clustering_context_1a6414b57292a4e25bfe1af8bd47258817" kindref="member">tree</ref>);</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af2c9040008b80775815320a327f21242" kindref="member">KDTree</ref><sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><ref refid="oldheap_8h_1a8631cc3f443c4ea3e99195df1ca1dd8d" kindref="member">FreeHeap</ref>(context.<ref refid="struct_clustering_context_1a411623fe2aa0ed365290e1f0c8ac81a4" kindref="member">heap</ref>);</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref>(context.<ref refid="struct_clustering_context_1abcdf0ba8732036cb540bb470956186d3" kindref="member">candidates</ref>);</highlight></codeline>
<codeline lineno="750"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>CreateClusterTree</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="751"><highlight class="normal"></highlight></codeline>
<codeline lineno="752"><highlight class="normal"></highlight></codeline>
<codeline lineno="764"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1ae250df46fa1538fb7932e11d5a6aa98a" kindref="member">MakePotentialClusters</ref>(<ref refid="struct_clustering_context" kindref="compound">ClusteringContext</ref><sp/>*context,</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,<sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>Level)<sp/>{</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><ref refid="struct_h_e_a_p_e_n_t_r_y" kindref="compound">HEAPENTRY</ref><sp/>HeapEntry;</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>next<sp/>=<sp/>context-&gt;<ref refid="struct_clustering_context_1a6e7e68c81c4925fb0cc24fa90d1fa358" kindref="member">next</ref>;</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/>context-&gt;<ref refid="struct_clustering_context_1abcdf0ba8732036cb540bb470956186d3" kindref="member">candidates</ref>[next].<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1adfa4721271456305d40524737800bb2e" kindref="member">Cluster</ref><sp/>=<sp/>Cluster;</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/>HeapEntry.<ref refid="struct_h_e_a_p_e_n_t_r_y_1ab04a38c2cfaa44594782f052cbe7414d" kindref="member">Data</ref><sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)<sp/>&amp;(context-&gt;<ref refid="struct_clustering_context_1abcdf0ba8732036cb540bb470956186d3" kindref="member">candidates</ref>[next]);</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/>context-&gt;<ref refid="struct_clustering_context_1abcdf0ba8732036cb540bb470956186d3" kindref="member">candidates</ref>[next].<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1abc9f805357e72eae3febb1dbd4c412ac" kindref="member">Neighbor</ref><sp/>=</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a45fae84caf7ba68e1a77fdffe9f0d112" kindref="member">FindNearestNeighbor</ref>(context-&gt;<ref refid="struct_clustering_context_1a6414b57292a4e25bfe1af8bd47258817" kindref="member">tree</ref>,</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>context-&gt;<ref refid="struct_clustering_context_1abcdf0ba8732036cb540bb470956186d3" kindref="member">candidates</ref>[next].<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1adfa4721271456305d40524737800bb2e" kindref="member">Cluster</ref>,</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;HeapEntry.<ref refid="struct_h_e_a_p_e_n_t_r_y_1aa80cabd8128f5fa5a64e00b2e41e9c54" kindref="member">Key</ref>);</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(context-&gt;<ref refid="struct_clustering_context_1abcdf0ba8732036cb540bb470956186d3" kindref="member">candidates</ref>[next].<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1abc9f805357e72eae3febb1dbd4c412ac" kindref="member">Neighbor</ref><sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="oldheap_8cpp_1a21a037334c93e1d0e7ae2059203a9cf3" kindref="member">HeapStore</ref>(context-&gt;<ref refid="struct_clustering_context_1a411623fe2aa0ed365290e1f0c8ac81a4" kindref="member">heap</ref>,<sp/>&amp;HeapEntry);</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/>context-&gt;<ref refid="struct_clustering_context_1a6e7e68c81c4925fb0cc24fa90d1fa358" kindref="member">next</ref>++;</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="778"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MakePotentialClusters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="779"><highlight class="normal"></highlight></codeline>
<codeline lineno="780"><highlight class="normal"></highlight></codeline>
<codeline lineno="797"><highlight class="normal"><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><ref refid="cluster_8cpp_1a45fae84caf7ba68e1a77fdffe9f0d112" kindref="member">FindNearestNeighbor</ref>(<ref refid="struct_k_d_t_r_e_e" kindref="compound">KDTREE</ref><sp/>*<sp/>Tree,<sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*<sp/>Cluster,<sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*<sp/>Distance)</highlight></codeline>
<codeline lineno="799"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>MAXNEIGHBORS<sp/><sp/>2</highlight></codeline>
<codeline lineno="800"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>MAXDISTANCE<sp/><sp/><sp/>MAX_FLOAT32</highlight></codeline>
<codeline lineno="801"><highlight class="preprocessor"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Neighbor[<ref refid="cluster_8cpp_1a8bfc8221d16b9c34781f2bf8753bd380" kindref="member">MAXNEIGHBORS</ref>];</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>Dist[<ref refid="cluster_8cpp_1a8bfc8221d16b9c34781f2bf8753bd380" kindref="member">MAXNEIGHBORS</ref>];</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>NumberOfNeighbors;</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>i;</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*BestNeighbor;</highlight></codeline>
<codeline lineno="807"><highlight class="normal"></highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>find<sp/>the<sp/>2<sp/>nearest<sp/>neighbors<sp/>of<sp/>the<sp/>cluster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><ref refid="kdtree_8cpp_1a9a3e49226adc75b00fee5116b401f3e3" kindref="member">KDNearestNeighborSearch</ref>(Tree,<sp/>Cluster-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>,<sp/>MAXNEIGHBORS,<sp/>MAXDISTANCE,</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;NumberOfNeighbors,<sp/>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>**)Neighbor,<sp/>Dist);</highlight></codeline>
<codeline lineno="811"><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>search<sp/>for<sp/>the<sp/>nearest<sp/>neighbor<sp/>that<sp/>is<sp/>not<sp/>the<sp/>cluster<sp/>itself</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/>*Distance<sp/>=<sp/><ref refid="cluster_8cpp_1a010fa716ced1170c05d8fc9da46a5d34" kindref="member">MAXDISTANCE</ref>;</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/>BestNeighbor<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>NumberOfNeighbors;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((Dist[i]<sp/>&lt;<sp/>*Distance)<sp/>&amp;&amp;<sp/>(Neighbor[i]<sp/>!=<sp/>Cluster))<sp/>{</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>*Distance<sp/>=<sp/>Dist[i];</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>BestNeighbor<sp/>=<sp/>Neighbor[i];</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>BestNeighbor;</highlight></codeline>
<codeline lineno="822"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>FindNearestNeighbor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="823"><highlight class="normal"></highlight></codeline>
<codeline lineno="824"><highlight class="normal"></highlight></codeline>
<codeline lineno="837"><highlight class="normal"><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*<ref refid="cluster_8cpp_1ab73b69de28e8bb2f1332524a02f6f475" kindref="member">MakeNewCluster</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,<sp/><ref refid="struct_t_e_m_p_c_l_u_s_t_e_r" kindref="compound">TEMPCLUSTER</ref><sp/>*TempCluster)<sp/>{</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster;</highlight></codeline>
<codeline lineno="839"><highlight class="normal"></highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>allocate<sp/>the<sp/>new<sp/>cluster<sp/>and<sp/>initialize<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/>Cluster<sp/>=<sp/>(<ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref>(</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structsample" kindref="compound">CLUSTER</ref>)<sp/>+<sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref><sp/>-<sp/>1)<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>));</highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/>Cluster-&gt;<ref refid="structsample_1aa6b39588394fbede2bdcac083bf3832d" kindref="member">Clustered</ref><sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/>Cluster-&gt;<ref refid="structsample_1af0c82e552c662971cf574f9ee8bcb40f" kindref="member">Prototype</ref><sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/>Cluster-&gt;<ref refid="structsample_1ae6abb40063761a77d4275c79c5c0bb49" kindref="member">Left</ref><sp/>=<sp/>TempCluster-&gt;<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1adfa4721271456305d40524737800bb2e" kindref="member">Cluster</ref>;</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/>Cluster-&gt;<ref refid="structsample_1a2d66168da8fd6b92aed011277f54843a" kindref="member">Right</ref><sp/>=<sp/>TempCluster-&gt;<ref refid="struct_t_e_m_p_c_l_u_s_t_e_r_1abc9f805357e72eae3febb1dbd4c412ac" kindref="member">Neighbor</ref>;</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/>Cluster-&gt;<ref refid="structsample_1a564df9059b85a37e9f4e69843eec3e20" kindref="member">CharID</ref><sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="848"><highlight class="normal"></highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>mark<sp/>the<sp/>old<sp/>clusters<sp/>as<sp/>&quot;clustered&quot;<sp/>and<sp/>delete<sp/>them<sp/>from<sp/>the<sp/>kd-tree</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/>Cluster-&gt;<ref refid="structsample_1ae6abb40063761a77d4275c79c5c0bb49" kindref="member">Left</ref>-&gt;<ref refid="structsample_1aa6b39588394fbede2bdcac083bf3832d" kindref="member">Clustered</ref><sp/>=<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/>Cluster-&gt;<ref refid="structsample_1a2d66168da8fd6b92aed011277f54843a" kindref="member">Right</ref>-&gt;<ref refid="structsample_1aa6b39588394fbede2bdcac083bf3832d" kindref="member">Clustered</ref><sp/>=<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><ref refid="kdtree_8cpp_1a270d3ef72c3f0097f249ca75c2aafa3c" kindref="member">KDDelete</ref>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af2c9040008b80775815320a327f21242" kindref="member">KDTree</ref>,<sp/>Cluster-&gt;<ref refid="structsample_1ae6abb40063761a77d4275c79c5c0bb49" kindref="member">Left</ref>-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>,<sp/>Cluster-&gt;<ref refid="structsample_1ae6abb40063761a77d4275c79c5c0bb49" kindref="member">Left</ref>);</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><ref refid="kdtree_8cpp_1a270d3ef72c3f0097f249ca75c2aafa3c" kindref="member">KDDelete</ref>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af2c9040008b80775815320a327f21242" kindref="member">KDTree</ref>,<sp/>Cluster-&gt;<ref refid="structsample_1a2d66168da8fd6b92aed011277f54843a" kindref="member">Right</ref>-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>,<sp/>Cluster-&gt;<ref refid="structsample_1a2d66168da8fd6b92aed011277f54843a" kindref="member">Right</ref>);</highlight></codeline>
<codeline lineno="854"><highlight class="normal"></highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>mean<sp/>and<sp/>sample<sp/>count<sp/>for<sp/>the<sp/>new<sp/>cluster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/>Cluster-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref><sp/>=</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a13004a2cbbcf26c3d95fd207274823c9" kindref="member">MergeClusters</ref>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>,<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>,</highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cluster-&gt;<ref refid="structsample_1ae6abb40063761a77d4275c79c5c0bb49" kindref="member">Left</ref>-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref>,<sp/>Cluster-&gt;<ref refid="structsample_1a2d66168da8fd6b92aed011277f54843a" kindref="member">Right</ref>-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref>,</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Cluster-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>,<sp/>Cluster-&gt;<ref refid="structsample_1ae6abb40063761a77d4275c79c5c0bb49" kindref="member">Left</ref>-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>,<sp/>Cluster-&gt;<ref refid="structsample_1a2d66168da8fd6b92aed011277f54843a" kindref="member">Right</ref>-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>);</highlight></codeline>
<codeline lineno="860"><highlight class="normal"></highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>add<sp/>the<sp/>new<sp/>cluster<sp/>to<sp/>the<sp/>KD<sp/>tree</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><ref refid="kdtree_8cpp_1a596422fd837fb6937c12be6b277423a0" kindref="member">KDStore</ref>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af2c9040008b80775815320a327f21242" kindref="member">KDTree</ref>,<sp/>Cluster-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>,<sp/>Cluster);</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Cluster;</highlight></codeline>
<codeline lineno="864"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MakeNewCluster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="865"><highlight class="normal"></highlight></codeline>
<codeline lineno="866"><highlight class="normal"></highlight></codeline>
<codeline lineno="882"><highlight class="normal"><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/><ref refid="cluster_8cpp_1a13004a2cbbcf26c3d95fd207274823c9" kindref="member">MergeClusters</ref>(<ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>N,</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>ParamDesc[],</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>n1,</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>n2,</highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>m[],</highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>m1[],<sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>m2[])<sp/>{</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>i,<sp/>n;</highlight></codeline>
<codeline lineno="889"><highlight class="normal"></highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/>n<sp/>=<sp/>n1<sp/>+<sp/>n2;</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>N;<sp/>i<sp/>&gt;<sp/>0;<sp/>i--,<sp/>ParamDesc++,<sp/>m++,<sp/>m1++,<sp/>m2++)<sp/>{</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ParamDesc-&gt;Circular)<sp/>{</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>distance<sp/>between<sp/>means<sp/>is<sp/>greater<sp/>than<sp/>allowed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>reduce<sp/>upper<sp/>point<sp/>by<sp/>one<sp/>&quot;rotation&quot;<sp/>to<sp/>compute<sp/>mean</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>then<sp/>normalize<sp/>the<sp/>mean<sp/>back<sp/>into<sp/>the<sp/>accepted<sp/>range</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((*m2<sp/>-<sp/>*m1)<sp/>&gt;<sp/>ParamDesc-&gt;HalfRange)<sp/>{</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*m<sp/>=<sp/>(n1<sp/>*<sp/>*m1<sp/>+<sp/>n2<sp/>*<sp/>(*m2<sp/>-<sp/>ParamDesc-&gt;Range))<sp/>/<sp/>n;</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*m<sp/>&lt;<sp/>ParamDesc-&gt;Min)</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*m<sp/>+=<sp/>ParamDesc-&gt;Range;</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((*m1<sp/>-<sp/>*m2)<sp/>&gt;<sp/>ParamDesc-&gt;HalfRange)<sp/>{</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*m<sp/>=<sp/>(n1<sp/>*<sp/>(*m1<sp/>-<sp/>ParamDesc-&gt;Range)<sp/>+<sp/>n2<sp/>*<sp/>*m2)<sp/>/<sp/>n;</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*m<sp/>&lt;<sp/>ParamDesc-&gt;Min)</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*m<sp/>+=<sp/>ParamDesc-&gt;Range;</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*m<sp/>=<sp/>(n1<sp/>*<sp/>*m1<sp/>+<sp/>n2<sp/>*<sp/>*m2)<sp/>/<sp/>n;</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>*m<sp/>=<sp/>(n1<sp/>*<sp/>*m1<sp/>+<sp/>n2<sp/>*<sp/>*m2)<sp/>/<sp/>n;</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>n;</highlight></codeline>
<codeline lineno="913"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MergeClusters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="914"><highlight class="normal"></highlight></codeline>
<codeline lineno="915"><highlight class="normal"></highlight></codeline>
<codeline lineno="927"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a85e813bae86e0c290ceb0f99d83ae9bf" kindref="member">ComputePrototypes</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,<sp/><ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g" kindref="compound">CLUSTERCONFIG</ref><sp/>*Config)<sp/>{</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><ref refid="structlist__rec" kindref="compound">LIST</ref><sp/>ClusterStack<sp/>=<sp/><ref refid="oldlist_8h_1ae212530ca629c67513698e988c705a5a" kindref="member">NIL_LIST</ref>;</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster;</highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Prototype;</highlight></codeline>
<codeline lineno="931"><highlight class="normal"></highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>use<sp/>a<sp/>stack<sp/>to<sp/>keep<sp/>track<sp/>of<sp/>clusters<sp/>waiting<sp/>to<sp/>be<sp/>processed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>initially<sp/>the<sp/>only<sp/>cluster<sp/>on<sp/>the<sp/>stack<sp/>is<sp/>the<sp/>root<sp/>cluster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a0178d3dfedb397870384f599d809c54d" kindref="member">Root</ref><sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/>ClusterStack<sp/>=<sp/><ref refid="oldlist_8cpp_1a9c4294375af81ab4c133b6b5a3679a16" kindref="member">push</ref><sp/>(<ref refid="oldlist_8h_1ae212530ca629c67513698e988c705a5a" kindref="member">NIL_LIST</ref>,<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a0178d3dfedb397870384f599d809c54d" kindref="member">Root</ref>);</highlight></codeline>
<codeline lineno="936"><highlight class="normal"></highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>loop<sp/>until<sp/>we<sp/>have<sp/>analyzed<sp/>all<sp/>clusters<sp/>which<sp/>are<sp/>potential<sp/>prototypes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(ClusterStack<sp/>!=<sp/><ref refid="oldlist_8h_1ae212530ca629c67513698e988c705a5a" kindref="member">NIL_LIST</ref>)<sp/>{</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>remove<sp/>the<sp/>next<sp/>cluster<sp/>to<sp/>be<sp/>analyzed<sp/>from<sp/>the<sp/>stack</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>try<sp/>to<sp/>make<sp/>a<sp/>prototype<sp/>from<sp/>the<sp/>cluster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>successful,<sp/>put<sp/>it<sp/>on<sp/>the<sp/>proto<sp/>list,<sp/>else<sp/>split<sp/>the<sp/>cluster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/>Cluster<sp/>=<sp/>(<ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*)<sp/><ref refid="oldlist_8h_1a69547be764424f18b0be535400747978" kindref="member">first_node</ref><sp/>(ClusterStack);</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/>ClusterStack<sp/>=<sp/><ref refid="oldlist_8cpp_1a4a16ea0d766f4b3bc697142d5303a62c" kindref="member">pop</ref><sp/>(ClusterStack);</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/>Prototype<sp/>=<sp/><ref refid="cluster_8cpp_1aa37ac7f48ca91b0afb78f8408e8b9b6f" kindref="member">MakePrototype</ref>(Clusterer,<sp/>Config,<sp/>Cluster);</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Prototype<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af6bd9758400f9a886e8fde8d009de70f" kindref="member">ProtoList</ref><sp/>=<sp/><ref refid="oldlist_8cpp_1a9c4294375af81ab4c133b6b5a3679a16" kindref="member">push</ref><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af6bd9758400f9a886e8fde8d009de70f" kindref="member">ProtoList</ref>,<sp/>Prototype);</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ClusterStack<sp/>=<sp/><ref refid="oldlist_8cpp_1a9c4294375af81ab4c133b6b5a3679a16" kindref="member">push</ref><sp/>(ClusterStack,<sp/>Cluster-&gt;<ref refid="structsample_1a2d66168da8fd6b92aed011277f54843a" kindref="member">Right</ref>);</highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ClusterStack<sp/>=<sp/><ref refid="oldlist_8cpp_1a9c4294375af81ab4c133b6b5a3679a16" kindref="member">push</ref><sp/>(ClusterStack,<sp/>Cluster-&gt;<ref refid="structsample_1ae6abb40063761a77d4275c79c5c0bb49" kindref="member">Left</ref>);</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="953"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ComputePrototypes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="954"><highlight class="normal"></highlight></codeline>
<codeline lineno="955"><highlight class="normal"></highlight></codeline>
<codeline lineno="974"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1aa37ac7f48ca91b0afb78f8408e8b9b6f" kindref="member">MakePrototype</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,</highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g" kindref="compound">CLUSTERCONFIG</ref><sp/>*Config,</highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster)<sp/>{</highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics;</highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto;</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets;</highlight></codeline>
<codeline lineno="980"><highlight class="normal"></highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>filter<sp/>out<sp/>clusters<sp/>which<sp/>contain<sp/>samples<sp/>from<sp/>the<sp/>same<sp/>character</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="cluster_8cpp_1a39583ff2f6db38f0c2e26f7ad87f2c0c" kindref="member">MultipleCharSamples</ref><sp/>(Clusterer,<sp/>Cluster,<sp/>Config-&gt;<ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g_1aaf0758a0e763d9525d6d7781db8ade14" kindref="member">MaxIllegal</ref>))</highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="984"><highlight class="normal"></highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>covariance<sp/>matrix<sp/>and<sp/>ranges<sp/>for<sp/>the<sp/>cluster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/>Statistics<sp/>=</highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1aa60411f531ca1f230d001973299d1c09" kindref="member">ComputeStatistics</ref>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>,<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>,<sp/>Cluster);</highlight></codeline>
<codeline lineno="988"><highlight class="normal"></highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>for<sp/>degenerate<sp/>clusters<sp/>which<sp/>need<sp/>not<sp/>be<sp/>analyzed<sp/>further</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>note<sp/>that<sp/>the<sp/>MinSamples<sp/>test<sp/>assumes<sp/>that<sp/>all<sp/>clusters<sp/>with<sp/>multiple</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>character<sp/>samples<sp/>have<sp/>been<sp/>removed<sp/>(as<sp/>above)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1abd55a5befb4eda77f5d0abbd460cc501" kindref="member">MakeDegenerateProto</ref>(</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>,<sp/>Cluster,<sp/>Statistics,<sp/>Config-&gt;<ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g_1a53c426e655c701e99f7744a35ecced70" kindref="member">ProtoStyle</ref>,</highlight></codeline>
<codeline lineno="994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>(Config-&gt;<ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g_1a30f3f6f54aa8e9371a0398f04bca0de3" kindref="member">MinSamples</ref><sp/>*<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1aa4a7b4654dcb4918ac9a282d976b72d9" kindref="member">NumChar</ref>));</highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Proto<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1aef1b69ed626e557bf84c9c0b18db6b95" kindref="member">FreeStatistics</ref>(Statistics);</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Proto;</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>to<sp/>ensure<sp/>that<sp/>all<sp/>dimensions<sp/>are<sp/>independent</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="cluster_8cpp_1a0a6fea38a06375666937701fb21e6a05" kindref="member">Independent</ref>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>,<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>,</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a1a87c66cfa2a256ff9b13d5858bf9650" kindref="member">CoVariance</ref>,<sp/>Config-&gt;<ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g_1a77c7d2361e92592098a3287cabc26a6d" kindref="member">Independence</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1aef1b69ed626e557bf84c9c0b18db6b95" kindref="member">FreeStatistics</ref>(Statistics);</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"></highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="cluster_8cpp_1a6c16d1564de65f394e737811e5389042" kindref="member">HOTELLING</ref><sp/>&amp;&amp;<sp/>Config-&gt;<ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g_1a53c426e655c701e99f7744a35ecced70" kindref="member">ProtoStyle</ref><sp/>==<sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaa39d32ff639641ca169c9729c58614459" kindref="member">elliptical</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1a52963d24aa278bff9a1de24806954d61" kindref="member">TestEllipticalProto</ref>(Clusterer,<sp/>Config,<sp/>Cluster,<sp/>Statistics);</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Proto<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1aef1b69ed626e557bf84c9c0b18db6b95" kindref="member">FreeStatistics</ref>(Statistics);</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Proto;</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"></highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>a<sp/>histogram<sp/>data<sp/>structure<sp/>used<sp/>to<sp/>evaluate<sp/>distributions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/>Buckets<sp/>=<sp/><ref refid="cluster_8cpp_1a0924b73d8bc3cd1269aa64f5a41b633f" kindref="member">GetBuckets</ref>(Clusterer,<sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0aebc81705969b8c5ae986b0b2ec08d1d5" kindref="member">normal</ref>,<sp/>Cluster-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref>,</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Config-&gt;<ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g_1a4758d8ddf0644e204132b779a786b6fb" kindref="member">Confidence</ref>);</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"></highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>a<sp/>prototype<sp/>based<sp/>on<sp/>the<sp/>statistics<sp/>and<sp/>test<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(Config-&gt;<ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g_1a53c426e655c701e99f7744a35ecced70" kindref="member">ProtoStyle</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaa93d6901f160899d15f69322530595f4f" kindref="member">spherical</ref>:</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1ad04d25bb39e413b1cd7064534b98f9a4" kindref="member">MakeSphericalProto</ref>(Clusterer,<sp/>Cluster,<sp/>Statistics,<sp/>Buckets);</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaa39d32ff639641ca169c9729c58614459" kindref="member">elliptical</ref>:</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1a076b9ff3e723f44987211c9bf5f77523" kindref="member">MakeEllipticalProto</ref>(Clusterer,<sp/>Cluster,<sp/>Statistics,<sp/>Buckets);</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaab164032fff82a847826b4887d9e7be58" kindref="member">mixed</ref>:</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1a2ebb51aa33fe2a99f5326366ed86b42e" kindref="member">MakeMixedProto</ref>(Clusterer,<sp/>Cluster,<sp/>Statistics,<sp/>Buckets,</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Config-&gt;<ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g_1a4758d8ddf0644e204132b779a786b6fb" kindref="member">Confidence</ref>);</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaa9761086e420b925e438327ad385b304d" kindref="member">automatic</ref>:</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1ad04d25bb39e413b1cd7064534b98f9a4" kindref="member">MakeSphericalProto</ref>(Clusterer,<sp/>Cluster,<sp/>Statistics,<sp/>Buckets);</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Proto<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1a076b9ff3e723f44987211c9bf5f77523" kindref="member">MakeEllipticalProto</ref>(Clusterer,<sp/>Cluster,<sp/>Statistics,<sp/>Buckets);</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Proto<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1a2ebb51aa33fe2a99f5326366ed86b42e" kindref="member">MakeMixedProto</ref>(Clusterer,<sp/>Cluster,<sp/>Statistics,<sp/>Buckets,</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Config-&gt;<ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g_1a4758d8ddf0644e204132b779a786b6fb" kindref="member">Confidence</ref>);</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><ref refid="cluster_8cpp_1aef1b69ed626e557bf84c9c0b18db6b95" kindref="member">FreeStatistics</ref>(Statistics);</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Proto;</highlight></codeline>
<codeline lineno="1043"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MakePrototype</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1044"><highlight class="normal"></highlight></codeline>
<codeline lineno="1045"><highlight class="normal"></highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1abd55a5befb4eda77f5d0abbd460cc501" kindref="member">MakeDegenerateProto</ref>(<sp/><sp/></highlight><highlight class="comment">//this<sp/>was<sp/>MinSample</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>N,</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics,</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9ea" kindref="member">PROTOSTYLE</ref><sp/>Style,</highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>MinSamples)<sp/>{</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1074"><highlight class="normal"></highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(MinSamples<sp/>&lt;<sp/><ref refid="cluster_8cpp_1a6b4ec5de41f65e6f0f69b57db368bd54" kindref="member">MINSAMPLESNEEDED</ref>)</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/>MinSamples<sp/>=<sp/><ref refid="cluster_8cpp_1a6b4ec5de41f65e6f0f69b57db368bd54" kindref="member">MINSAMPLESNEEDED</ref>;</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"></highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Cluster-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref><sp/>&lt;<sp/>MinSamples)<sp/>{</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(Style)<sp/>{</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaa93d6901f160899d15f69322530595f4f" kindref="member">spherical</ref>:</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1a96019ee068587b2d17ddb6f43ded872b" kindref="member">NewSphericalProto</ref><sp/>(N,<sp/>Cluster,<sp/>Statistics);</highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaa39d32ff639641ca169c9729c58614459" kindref="member">elliptical</ref>:</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaa9761086e420b925e438327ad385b304d" kindref="member">automatic</ref>:</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1a1453a157e92261f5331f8624dfc4d3c0" kindref="member">NewEllipticalProto</ref><sp/>(N,<sp/>Cluster,<sp/>Statistics);</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaab164032fff82a847826b4887d9e7be58" kindref="member">mixed</ref>:</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1accc05d5eedc4d765148eaa99c1927a79" kindref="member">NewMixedProto</ref><sp/>(N,<sp/>Cluster,<sp/>Statistics);</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a5d94887aaa0acd7e4a0c04c420af5670" kindref="member">Significant</ref><sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Proto);</highlight></codeline>
<codeline lineno="1094"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MakeDegenerateProto</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1095"><highlight class="normal"></highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1a52963d24aa278bff9a1de24806954d61" kindref="member">TestEllipticalProto</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g" kindref="compound">CLUSTERCONFIG</ref><sp/>*Config,</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics)<sp/>{</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Fraction<sp/>of<sp/>the<sp/>number<sp/>of<sp/>samples<sp/>used<sp/>as<sp/>a<sp/>range<sp/>around<sp/>1<sp/>within</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>which<sp/>a<sp/>cluster<sp/>has<sp/>the<sp/>magic<sp/>size<sp/>that<sp/>allows<sp/>a<sp/>boost<sp/>to<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>FTable<sp/>by<sp/>kFTableBoostMargin,<sp/>thus<sp/>allowing<sp/>clusters<sp/>near<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>magic<sp/>size<sp/>(equal<sp/>to<sp/>the<sp/>number<sp/>of<sp/>sample<sp/>characters)<sp/>to<sp/>be<sp/>more</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>likely<sp/>to<sp/>stay<sp/>together.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>kMagicSampleMargin<sp/>=<sp/>0.0625;</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>kFTableBoostMargin<sp/>=<sp/>2.0;</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"></highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>N<sp/>=<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>;</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref>*<sp/>Left<sp/>=<sp/>Cluster-&gt;<ref refid="structsample_1ae6abb40063761a77d4275c79c5c0bb49" kindref="member">Left</ref>;</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref>*<sp/>Right<sp/>=<sp/>Cluster-&gt;<ref refid="structsample_1a2d66168da8fd6b92aed011277f54843a" kindref="member">Right</ref>;</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Left<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>||<sp/>Right<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>TotalDims<sp/>=<sp/>Left-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref><sp/>+<sp/>Right-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref>;</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(TotalDims<sp/>&lt;<sp/>N<sp/>+<sp/>1<sp/>||<sp/>TotalDims<sp/>&lt;<sp/>2)</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>kMatrixSize<sp/>=<sp/>N<sp/>*<sp/>N<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>);</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>*<sp/>Covariance<sp/>=<sp/></highlight><highlight class="keyword">reinterpret_cast&lt;</highlight><highlight class="normal"><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(<ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref>(kMatrixSize));</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>*<sp/>Inverse<sp/>=<sp/></highlight><highlight class="keyword">reinterpret_cast&lt;</highlight><highlight class="normal"><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(<ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref>(kMatrixSize));</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>*<sp/>Delta<sp/>=<sp/></highlight><highlight class="keyword">reinterpret_cast&lt;</highlight><highlight class="normal"><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>*</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(<ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref>(N<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>)));</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Compute<sp/>a<sp/>new<sp/>covariance<sp/>matrix<sp/>that<sp/>only<sp/>uses<sp/>essential<sp/>features.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>N;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>row_offset<sp/>=<sp/>i<sp/>*<sp/>N;</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a6b9843466a3ddf33bfab18f85ca06501" kindref="member">NonEssential</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>N;<sp/>++j)<sp/>{</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[j].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a6b9843466a3ddf33bfab18f85ca06501" kindref="member">NonEssential</ref>)</highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Covariance[j<sp/>+<sp/>row_offset]<sp/>=<sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a1a87c66cfa2a256ff9b13d5858bf9650" kindref="member">CoVariance</ref>[j<sp/>+<sp/>row_offset];</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Covariance[j<sp/>+<sp/>row_offset]<sp/>=<sp/>0.0f;</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>N;<sp/>++j)<sp/>{</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>==<sp/>j)</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Covariance[j<sp/>+<sp/>row_offset]<sp/>=<sp/>1.0f;</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Covariance[j<sp/>+<sp/>row_offset]<sp/>=<sp/>0.0f;</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>err<sp/>=<sp/><ref refid="cluster_8cpp_1a40c47f6785ad5d50a9b113761e16ab9d" kindref="member">InvertMatrix</ref>(Covariance,<sp/>N,<sp/>Inverse);</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(err<sp/>&gt;<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Clustering<sp/>error:<sp/>Matrix<sp/>inverse<sp/>failed<sp/>with<sp/>error<sp/>%g\n&quot;</highlight><highlight class="normal">,<sp/>err);</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>EssentialN<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dim<sp/>=<sp/>0;<sp/>dim<sp/>&lt;<sp/>N;<sp/>++dim)<sp/>{</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[dim].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a6b9843466a3ddf33bfab18f85ca06501" kindref="member">NonEssential</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Delta[dim]<sp/>=<sp/>Left-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>[dim]<sp/>-<sp/>Right-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>[dim];</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>++EssentialN;</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Delta[dim]<sp/>=<sp/>0.0f;</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Compute<sp/>Hotelling&apos;s<sp/>T-squared.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Tsq<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x<sp/>=<sp/>0;<sp/>x<sp/>&lt;<sp/>N;<sp/>++x)<sp/>{</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>temp<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y<sp/>=<sp/>0;<sp/>y<sp/>&lt;<sp/>N;<sp/>++y)<sp/>{</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>temp<sp/>+=<sp/>Inverse[y<sp/>+<sp/>N*x]<sp/>*<sp/>Delta[y];</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/>Tsq<sp/>+=<sp/>Delta[x]<sp/>*<sp/>temp;</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref>(Covariance);</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref>(Inverse);</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref>(Delta);</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Changed<sp/>this<sp/>function<sp/>to<sp/>match<sp/>the<sp/>formula<sp/>in</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Statistical<sp/>Methods<sp/>in<sp/>Medical<sp/>Research<sp/>p<sp/>473</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>By<sp/>Peter<sp/>Armitage,<sp/>Geoffrey<sp/>Berry,<sp/>J.<sp/>N.<sp/>S.<sp/>Matthews.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Tsq<sp/>*=<sp/>Left-&gt;SampleCount<sp/>*<sp/>Right-&gt;SampleCount<sp/>/<sp/>TotalDims;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>F<sp/>=<sp/>Tsq<sp/>*<sp/>(TotalDims<sp/>-<sp/>EssentialN<sp/>-<sp/>1)<sp/>/<sp/>((TotalDims<sp/>-<sp/>2)*EssentialN);</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>Fx<sp/>=<sp/>EssentialN;</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Fx<sp/>&gt;<sp/><ref refid="cluster_8cpp_1a1f0a56d752a245eeeabb4514e8b22cf8" kindref="member">FTABLE_X</ref>)</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/>Fx<sp/>=<sp/><ref refid="cluster_8cpp_1a1f0a56d752a245eeeabb4514e8b22cf8" kindref="member">FTABLE_X</ref>;</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/>--Fx;</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>Fy<sp/>=<sp/>TotalDims<sp/>-<sp/>EssentialN<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Fy<sp/>&gt;<sp/><ref refid="cluster_8cpp_1acd517e6d49c3394f0b9fe04fdb970699" kindref="member">FTABLE_Y</ref>)</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/>Fy<sp/>=<sp/><ref refid="cluster_8cpp_1acd517e6d49c3394f0b9fe04fdb970699" kindref="member">FTABLE_Y</ref>;</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/>--Fy;</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>FTarget<sp/>=<sp/><ref refid="cluster_8cpp_1a45a2c0c1c4ffd4de9723ccedf5727119" kindref="member">FTable</ref>[Fy][Fx];</highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Config-&gt;<ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g_1a3578d77905f03b8d4321568be8f030c2" kindref="member">MagicSamples</ref><sp/>&gt;<sp/>0<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>TotalDims<sp/>&gt;=<sp/>Config-&gt;<ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g_1a3578d77905f03b8d4321568be8f030c2" kindref="member">MagicSamples</ref><sp/>*<sp/>(1.0<sp/>-<sp/>kMagicSampleMargin)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>TotalDims<sp/>&lt;=<sp/>Config-&gt;<ref refid="struct_c_l_u_s_t_e_r_c_o_n_f_i_g_1a3578d77905f03b8d4321568be8f030c2" kindref="member">MagicSamples</ref><sp/>*<sp/>(1.0<sp/>+<sp/>kMagicSampleMargin))<sp/>{</highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Give<sp/>magic-sized<sp/>clusters<sp/>a<sp/>magic<sp/>FTable<sp/>boost.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/>FTarget<sp/>+=<sp/>kFTableBoostMargin;</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1197"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(F<sp/>&lt;<sp/>FTarget)<sp/>{</highlight></codeline>
<codeline lineno="1198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a1453a157e92261f5331f8624dfc4d3c0" kindref="member">NewEllipticalProto</ref><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>,<sp/>Cluster,<sp/>Statistics);</highlight></codeline>
<codeline lineno="1199"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1201"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"></highlight></codeline>
<codeline lineno="1203"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>MakeSphericalProto<sp/>*******************************************************</highlight></codeline>
<codeline lineno="1204"><highlight class="comment">Parameters:<sp/>Clusterer<sp/><sp/><sp/>data<sp/>struct<sp/>containing<sp/>samples<sp/>being<sp/>clustered</highlight></codeline>
<codeline lineno="1205"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>Cluster<sp/><sp/><sp/><sp/><sp/><sp/><sp/>cluster<sp/>to<sp/>be<sp/>made<sp/>into<sp/>a<sp/>spherical<sp/>prototype</highlight></codeline>
<codeline lineno="1206"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>Statistics<sp/><sp/><sp/><sp/>statistical<sp/>info<sp/>about<sp/>cluster</highlight></codeline>
<codeline lineno="1207"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>Buckets<sp/><sp/><sp/><sp/><sp/><sp/><sp/>histogram<sp/>struct<sp/>used<sp/>to<sp/>analyze<sp/>distribution</highlight></codeline>
<codeline lineno="1208"><highlight class="comment">Operation:<sp/><sp/>This<sp/>routine<sp/>tests<sp/>the<sp/>specified<sp/>cluster<sp/>to<sp/>see<sp/>if<sp/>it<sp/>can</highlight></codeline>
<codeline lineno="1209"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>be<sp/>approximated<sp/>by<sp/>a<sp/>spherical<sp/>normal<sp/>distribution.<sp/><sp/>If<sp/>it</highlight></codeline>
<codeline lineno="1210"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>can<sp/>be,<sp/>then<sp/>a<sp/>new<sp/>prototype<sp/>is<sp/>formed<sp/>and<sp/>returned<sp/>to<sp/>the</highlight></codeline>
<codeline lineno="1211"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>caller.<sp/><sp/>If<sp/>it<sp/>can&apos;t<sp/>be,<sp/>then<sp/>NULL<sp/>is<sp/>returned<sp/>to<sp/>the<sp/>caller.</highlight></codeline>
<codeline lineno="1212"><highlight class="comment">Return:<sp/><sp/><sp/><sp/><sp/>Pointer<sp/>to<sp/>new<sp/>spherical<sp/>prototype<sp/>or<sp/>NULL.</highlight></codeline>
<codeline lineno="1213"><highlight class="comment">Exceptions:<sp/>None</highlight></codeline>
<codeline lineno="1214"><highlight class="comment">History:<sp/><sp/><sp/><sp/>6/1/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="1215"><highlight class="comment">******************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1ad04d25bb39e413b1cd7064534b98f9a4" kindref="member">MakeSphericalProto</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,</highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="1218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics,</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets)<sp/>{</highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="1222"><highlight class="normal"></highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>that<sp/>each<sp/>dimension<sp/>is<sp/>a<sp/>normal<sp/>distribution</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1224"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1225"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a6b9843466a3ddf33bfab18f85ca06501" kindref="member">NonEssential</ref>)</highlight></codeline>
<codeline lineno="1226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1227"><highlight class="normal"></highlight></codeline>
<codeline lineno="1228"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a54c75ac15de9474adc1387dc0c809c0b" kindref="member">FillBuckets</ref><sp/>(Buckets,<sp/>Cluster,<sp/>i,<sp/>&amp;(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i]),</highlight></codeline>
<codeline lineno="1229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cluster-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>[i],</highlight></codeline>
<codeline lineno="1230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>sqrt<sp/>((<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>)<sp/>(Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1aec33c119c63aad5cd1c4e75c6afe2968" kindref="member">AvgVariance</ref>)));</highlight></codeline>
<codeline lineno="1231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="cluster_8cpp_1a4c5b32330cf58e89e2352deb84394332" kindref="member">DistributionOK</ref><sp/>(Buckets))</highlight></codeline>
<codeline lineno="1232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1234"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>all<sp/>dimensions<sp/>matched<sp/>a<sp/>normal<sp/>distribution,<sp/>make<sp/>a<sp/>proto</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;=<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>)</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1a96019ee068587b2d17ddb6f43ded872b" kindref="member">NewSphericalProto</ref><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>,<sp/>Cluster,<sp/>Statistics);</highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Proto);</highlight></codeline>
<codeline lineno="1238"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MakeSphericalProto</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1239"><highlight class="normal"></highlight></codeline>
<codeline lineno="1240"><highlight class="normal"></highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1a076b9ff3e723f44987211c9bf5f77523" kindref="member">MakeEllipticalProto</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics,</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets)<sp/>{</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"></highlight></codeline>
<codeline lineno="1261"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>that<sp/>each<sp/>dimension<sp/>is<sp/>a<sp/>normal<sp/>distribution</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a6b9843466a3ddf33bfab18f85ca06501" kindref="member">NonEssential</ref>)</highlight></codeline>
<codeline lineno="1264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1265"><highlight class="normal"></highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a54c75ac15de9474adc1387dc0c809c0b" kindref="member">FillBuckets</ref><sp/>(Buckets,<sp/>Cluster,<sp/>i,<sp/>&amp;(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i]),</highlight></codeline>
<codeline lineno="1267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Cluster-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>[i],</highlight></codeline>
<codeline lineno="1268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>sqrt<sp/>((<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>)<sp/>Statistics-&gt;</highlight></codeline>
<codeline lineno="1269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CoVariance[i<sp/>*<sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref><sp/>+<sp/>1)]));</highlight></codeline>
<codeline lineno="1270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="cluster_8cpp_1a4c5b32330cf58e89e2352deb84394332" kindref="member">DistributionOK</ref><sp/>(Buckets))</highlight></codeline>
<codeline lineno="1271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1273"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>all<sp/>dimensions<sp/>matched<sp/>a<sp/>normal<sp/>distribution,<sp/>make<sp/>a<sp/>proto</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1274"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;=<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>)</highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1a1453a157e92261f5331f8624dfc4d3c0" kindref="member">NewEllipticalProto</ref><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>,<sp/>Cluster,<sp/>Statistics);</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Proto);</highlight></codeline>
<codeline lineno="1277"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MakeEllipticalProto</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1278"><highlight class="normal"></highlight></codeline>
<codeline lineno="1279"><highlight class="normal"></highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1a2ebb51aa33fe2a99f5326366ed86b42e" kindref="member">MakeMixedProto</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*Clusterer,</highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics,</highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*NormalBuckets,</highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Confidence)<sp/>{</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto;</highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"><sp/><sp/><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*UniformBuckets<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*RandomBuckets<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1307"><highlight class="normal"></highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>a<sp/>mixed<sp/>proto<sp/>to<sp/>work<sp/>on<sp/>-<sp/>initially<sp/>assume<sp/>all<sp/>dimensions<sp/>normal*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1309"><highlight class="normal"><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1accc05d5eedc4d765148eaa99c1927a79" kindref="member">NewMixedProto</ref><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>,<sp/>Cluster,<sp/>Statistics);</highlight></codeline>
<codeline lineno="1310"><highlight class="normal"></highlight></codeline>
<codeline lineno="1311"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>find<sp/>the<sp/>proper<sp/>distribution<sp/>for<sp/>each<sp/>dimension</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1ac78a1d40ce4bac0a156a21e2d987f394" kindref="member">SampleSize</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a6b9843466a3ddf33bfab18f85ca06501" kindref="member">NonEssential</ref>)</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1315"><highlight class="normal"></highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a54c75ac15de9474adc1387dc0c809c0b" kindref="member">FillBuckets</ref><sp/>(NormalBuckets,<sp/>Cluster,<sp/>i,<sp/>&amp;(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i]),</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af9c4f61cdbf39f6494b4691799bd4fa6" kindref="member">Mean</ref>[i],</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>sqrt<sp/>((<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>)<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]));</highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="cluster_8cpp_1a4c5b32330cf58e89e2352deb84394332" kindref="member">DistributionOK</ref><sp/>(NormalBuckets))</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1321"><highlight class="normal"></highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(RandomBuckets<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>RandomBuckets<sp/>=</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a0924b73d8bc3cd1269aa64f5a41b633f" kindref="member">GetBuckets</ref>(Clusterer,<sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0a21504929e31ddde091641bb817e32320" kindref="member">D_random</ref>,<sp/>Cluster-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref>,<sp/>Confidence);</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1ae018c99abb6b7f691f2e4b711485b45b" kindref="member">MakeDimRandom</ref><sp/>(i,<sp/>Proto,<sp/>&amp;(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i]));</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a54c75ac15de9474adc1387dc0c809c0b" kindref="member">FillBuckets</ref><sp/>(RandomBuckets,<sp/>Cluster,<sp/>i,<sp/>&amp;(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i]),</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af9c4f61cdbf39f6494b4691799bd4fa6" kindref="member">Mean</ref>[i],<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]);</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="cluster_8cpp_1a4c5b32330cf58e89e2352deb84394332" kindref="member">DistributionOK</ref><sp/>(RandomBuckets))</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"></highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(UniformBuckets<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>UniformBuckets<sp/>=</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a0924b73d8bc3cd1269aa64f5a41b633f" kindref="member">GetBuckets</ref>(Clusterer,<sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0a56013d9ac59a24fb94d9acb932a04b2f" kindref="member">uniform</ref>,<sp/>Cluster-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref>,<sp/>Confidence);</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a12a01c4bc8f83968f4b64600bfff82de" kindref="member">MakeDimUniform</ref>(i,<sp/>Proto,<sp/>Statistics);</highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a54c75ac15de9474adc1387dc0c809c0b" kindref="member">FillBuckets</ref><sp/>(UniformBuckets,<sp/>Cluster,<sp/>i,<sp/>&amp;(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1af44850047e9f5b3648871d7517c04316" kindref="member">ParamDesc</ref>[i]),</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af9c4f61cdbf39f6494b4691799bd4fa6" kindref="member">Mean</ref>[i],<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]);</highlight></codeline>
<codeline lineno="1337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="cluster_8cpp_1a4c5b32330cf58e89e2352deb84394332" kindref="member">DistributionOK</ref><sp/>(UniformBuckets))</highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1341"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>any<sp/>dimension<sp/>failed<sp/>to<sp/>match<sp/>a<sp/>distribution,<sp/>discard<sp/>the<sp/>proto</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/>Clusterer-&gt;SampleSize)<sp/>{</highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1aa5d7083be183c7a4e2b2fa746a560a7b" kindref="member">FreePrototype</ref>(Proto);</highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/>Proto<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1346"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Proto);</highlight></codeline>
<codeline lineno="1347"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MakeMixedProto</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1348"><highlight class="normal"></highlight></codeline>
<codeline lineno="1349"><highlight class="normal"></highlight></codeline>
<codeline lineno="1350"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>MakeDimRandom<sp/>*************************************************************</highlight></codeline>
<codeline lineno="1351"><highlight class="comment">Parameters:<sp/>i<sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>of<sp/>dimension<sp/>to<sp/>be<sp/>changed</highlight></codeline>
<codeline lineno="1352"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>Proto<sp/><sp/><sp/><sp/><sp/>prototype<sp/>whose<sp/>dimension<sp/>is<sp/>to<sp/>be<sp/>altered</highlight></codeline>
<codeline lineno="1353"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>ParamDesc<sp/>description<sp/>of<sp/>specified<sp/>dimension</highlight></codeline>
<codeline lineno="1354"><highlight class="comment">Operation:<sp/><sp/>This<sp/>routine<sp/>alters<sp/>the<sp/>ith<sp/>dimension<sp/>of<sp/>the<sp/>specified</highlight></codeline>
<codeline lineno="1355"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/>mixed<sp/>prototype<sp/>to<sp/>be<sp/>D_random.</highlight></codeline>
<codeline lineno="1356"><highlight class="comment">Return:<sp/><sp/><sp/><sp/><sp/>None</highlight></codeline>
<codeline lineno="1357"><highlight class="comment">Exceptions:<sp/>None</highlight></codeline>
<codeline lineno="1358"><highlight class="comment">History:<sp/><sp/><sp/><sp/>6/20/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="1359"><highlight class="comment">******************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1360"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1ae018c99abb6b7f691f2e4b711485b45b" kindref="member">MakeDimRandom</ref>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>i,<sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto,<sp/><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>*ParamDesc)<sp/>{</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1ae53408c33cdd473a9ed1f028e8172b0b" kindref="member">Distrib</ref>[i]<sp/>=<sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0a21504929e31ddde091641bb817e32320" kindref="member">D_random</ref>;</highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af9c4f61cdbf39f6494b4691799bd4fa6" kindref="member">Mean</ref>[i]<sp/>=<sp/>ParamDesc-&gt;<ref refid="struct_p_a_r_a_m___d_e_s_c_1a7c7bec15766be3633c649a0a9409b512" kindref="member">MidRange</ref>;</highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]<sp/>=<sp/>ParamDesc-&gt;<ref refid="struct_p_a_r_a_m___d_e_s_c_1a1df92d879d7ec8ea6662e956d27154b5" kindref="member">HalfRange</ref>;</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"></highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>subtract<sp/>out<sp/>the<sp/>previous<sp/>magnitude<sp/>of<sp/>this<sp/>dimension<sp/>from<sp/>the<sp/>total</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a40a4a7e28d83ad5ad3c64e54734104be" kindref="member">TotalMagnitude</ref><sp/>/=<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a0b016afed9c049598aa41feb3770fc15" kindref="member">Magnitude</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i];</highlight></codeline>
<codeline lineno="1367"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a0b016afed9c049598aa41feb3770fc15" kindref="member">Magnitude</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]<sp/>=<sp/>1.0<sp/>/<sp/>ParamDesc-&gt;<ref refid="struct_p_a_r_a_m___d_e_s_c_1a031dddcdc1744e777435f8ceea197448" kindref="member">Range</ref>;</highlight></codeline>
<codeline lineno="1368"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a40a4a7e28d83ad5ad3c64e54734104be" kindref="member">TotalMagnitude</ref><sp/>*=<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a0b016afed9c049598aa41feb3770fc15" kindref="member">Magnitude</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i];</highlight></codeline>
<codeline lineno="1369"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aefd3ba15fc4dd0029aa9cda07092382b" kindref="member">LogMagnitude</ref><sp/>=<sp/>log<sp/>((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a40a4a7e28d83ad5ad3c64e54734104be" kindref="member">TotalMagnitude</ref>);</highlight></codeline>
<codeline lineno="1370"><highlight class="normal"></highlight></codeline>
<codeline lineno="1371"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>note<sp/>that<sp/>the<sp/>proto<sp/>Weight<sp/>is<sp/>irrelevant<sp/>for<sp/>D_random<sp/>protos</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1372"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MakeDimRandom</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1373"><highlight class="normal"></highlight></codeline>
<codeline lineno="1374"><highlight class="normal"></highlight></codeline>
<codeline lineno="1385"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a12a01c4bc8f83968f4b64600bfff82de" kindref="member">MakeDimUniform</ref>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>i,<sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto,<sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics)<sp/>{</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1ae53408c33cdd473a9ed1f028e8172b0b" kindref="member">Distrib</ref>[i]<sp/>=<sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0a56013d9ac59a24fb94d9acb932a04b2f" kindref="member">uniform</ref>;</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af9c4f61cdbf39f6494b4691799bd4fa6" kindref="member">Mean</ref>[i]<sp/>=<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aff59384612de343b799b92a5d80282b7" kindref="member">Cluster</ref>-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>[i]<sp/>+</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/><sp/><sp/>(Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1ae03871d16f8d02e97e24401324565ab5" kindref="member">Min</ref>[i]<sp/>+<sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a6f553b49759c072107a7c1c5606bbc72" kindref="member">Max</ref>[i])<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]<sp/>=</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/><sp/><sp/>(Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a6f553b49759c072107a7c1c5606bbc72" kindref="member">Max</ref>[i]<sp/>-<sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1ae03871d16f8d02e97e24401324565ab5" kindref="member">Min</ref>[i])<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]<sp/>&lt;<sp/><ref refid="cluster_8cpp_1ab070d4fc08948b5047625cb799a9ac89" kindref="member">MINVARIANCE</ref>)</highlight></codeline>
<codeline lineno="1392"><highlight class="normal"><sp/><sp/><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]<sp/>=<sp/><ref refid="cluster_8cpp_1ab070d4fc08948b5047625cb799a9ac89" kindref="member">MINVARIANCE</ref>;</highlight></codeline>
<codeline lineno="1393"><highlight class="normal"></highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>subtract<sp/>out<sp/>the<sp/>previous<sp/>magnitude<sp/>of<sp/>this<sp/>dimension<sp/>from<sp/>the<sp/>total</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a40a4a7e28d83ad5ad3c64e54734104be" kindref="member">TotalMagnitude</ref><sp/>/=<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a0b016afed9c049598aa41feb3770fc15" kindref="member">Magnitude</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i];</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a0b016afed9c049598aa41feb3770fc15" kindref="member">Magnitude</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]<sp/>=</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/>1.0<sp/>/<sp/>(2.0<sp/>*<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]);</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a40a4a7e28d83ad5ad3c64e54734104be" kindref="member">TotalMagnitude</ref><sp/>*=<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a0b016afed9c049598aa41feb3770fc15" kindref="member">Magnitude</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i];</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aefd3ba15fc4dd0029aa9cda07092382b" kindref="member">LogMagnitude</ref><sp/>=<sp/>log<sp/>((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a40a4a7e28d83ad5ad3c64e54734104be" kindref="member">TotalMagnitude</ref>);</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"></highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>note<sp/>that<sp/>the<sp/>proto<sp/>Weight<sp/>is<sp/>irrelevant<sp/>for<sp/>uniform<sp/>protos</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1402"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MakeDimUniform</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1403"><highlight class="normal"></highlight></codeline>
<codeline lineno="1404"><highlight class="normal"></highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><ref refid="cluster_8cpp_1aa60411f531ca1f230d001973299d1c09" kindref="member">ComputeStatistics</ref><sp/>(<ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>N,<sp/><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>ParamDesc[],<sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*<sp/>Cluster)<sp/>{</highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics;</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>j;</highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*CoVariance;</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*Distance;</highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><ref refid="structlist__rec" kindref="compound">LIST</ref><sp/>SearchState;</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><ref refid="structsample" kindref="compound">SAMPLE</ref><sp/>*Sample;</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref><sp/>SampleCountAdjustedForBias;</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"></highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>allocate<sp/>memory<sp/>to<sp/>hold<sp/>the<sp/>statistics<sp/>results</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/>Statistics<sp/>=<sp/>(<ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref>));</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a1a87c66cfa2a256ff9b13d5858bf9650" kindref="member">CoVariance</ref><sp/>=<sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(N<sp/>*<sp/>N<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>));</highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1ae03871d16f8d02e97e24401324565ab5" kindref="member">Min</ref><sp/>=<sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(N<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>));</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a6f553b49759c072107a7c1c5606bbc72" kindref="member">Max</ref><sp/>=<sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(N<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>));</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"></highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>allocate<sp/>temporary<sp/>memory<sp/>to<sp/>hold<sp/>the<sp/>sample<sp/>to<sp/>mean<sp/>distances</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/>Distance<sp/>=<sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(N<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>));</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"></highlight></codeline>
<codeline lineno="1440"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>initialize<sp/>the<sp/>statistics</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1aec33c119c63aad5cd1c4e75c6afe2968" kindref="member">AvgVariance</ref><sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/>CoVariance<sp/>=<sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a1a87c66cfa2a256ff9b13d5858bf9650" kindref="member">CoVariance</ref>;</highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>N;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1ae03871d16f8d02e97e24401324565ab5" kindref="member">Min</ref>[i]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a6f553b49759c072107a7c1c5606bbc72" kindref="member">Max</ref>[i]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>N;<sp/>j++,<sp/>CoVariance++)</highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>*CoVariance<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>find<sp/>each<sp/>sample<sp/>in<sp/>the<sp/>cluster<sp/>and<sp/>merge<sp/>it<sp/>into<sp/>the<sp/>statistics</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><ref refid="cluster_8h_1af125589eadf8dca87cf904ebcb77c896" kindref="member">InitSampleSearch</ref>(SearchState,<sp/>Cluster);</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((Sample<sp/>=<sp/><ref refid="cluster_8cpp_1abf5d9e3b151ac51b27bd9dc797ac261c" kindref="member">NextSample</ref><sp/>(&amp;SearchState))<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>N;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Distance[i]<sp/>=<sp/>Sample-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>[i]<sp/>-<sp/>Cluster-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>[i];</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ParamDesc[i].Circular)<sp/>{</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Distance[i]<sp/>&gt;<sp/>ParamDesc[i].HalfRange)</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Distance[i]<sp/>-=<sp/>ParamDesc[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a031dddcdc1744e777435f8ceea197448" kindref="member">Range</ref>;</highlight></codeline>
<codeline lineno="1457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Distance[i]<sp/>&lt;<sp/>-ParamDesc[i].HalfRange)</highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Distance[i]<sp/>+=<sp/>ParamDesc[i].<ref refid="struct_p_a_r_a_m___d_e_s_c_1a031dddcdc1744e777435f8ceea197448" kindref="member">Range</ref>;</highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Distance[i]<sp/>&lt;<sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1ae03871d16f8d02e97e24401324565ab5" kindref="member">Min</ref>[i])</highlight></codeline>
<codeline lineno="1461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1ae03871d16f8d02e97e24401324565ab5" kindref="member">Min</ref>[i]<sp/>=<sp/>Distance[i];</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Distance[i]<sp/>&gt;<sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a6f553b49759c072107a7c1c5606bbc72" kindref="member">Max</ref>[i])</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a6f553b49759c072107a7c1c5606bbc72" kindref="member">Max</ref>[i]<sp/>=<sp/>Distance[i];</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1465"><highlight class="normal"><sp/><sp/><sp/><sp/>CoVariance<sp/>=<sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a1a87c66cfa2a256ff9b13d5858bf9650" kindref="member">CoVariance</ref>;</highlight></codeline>
<codeline lineno="1466"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>N;<sp/>i++)</highlight></codeline>
<codeline lineno="1467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>N;<sp/>j++,<sp/>CoVariance++)</highlight></codeline>
<codeline lineno="1468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*CoVariance<sp/>+=<sp/>Distance[i]<sp/>*<sp/>Distance[j];</highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1470"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>normalize<sp/>the<sp/>variances<sp/>by<sp/>the<sp/>total<sp/>number<sp/>of<sp/>samples</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1471"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>use<sp/>SampleCount-1<sp/>instead<sp/>of<sp/>SampleCount<sp/>to<sp/>get<sp/>an<sp/>unbiased<sp/>estimate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1472"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>also<sp/>compute<sp/>the<sp/>geometic<sp/>mean<sp/>of<sp/>the<sp/>diagonal<sp/>variances</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1473"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>ensure<sp/>that<sp/>clusters<sp/>with<sp/>only<sp/>1<sp/>sample<sp/>are<sp/>handled<sp/>correctly</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1474"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Cluster-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref><sp/>&gt;<sp/>1)</highlight></codeline>
<codeline lineno="1475"><highlight class="normal"><sp/><sp/><sp/><sp/>SampleCountAdjustedForBias<sp/>=<sp/>Cluster-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref><sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="1476"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1477"><highlight class="normal"><sp/><sp/><sp/><sp/>SampleCountAdjustedForBias<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1478"><highlight class="normal"><sp/><sp/>CoVariance<sp/>=<sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a1a87c66cfa2a256ff9b13d5858bf9650" kindref="member">CoVariance</ref>;</highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>N;<sp/>i++)</highlight></codeline>
<codeline lineno="1480"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>N;<sp/>j++,<sp/>CoVariance++)<sp/>{</highlight></codeline>
<codeline lineno="1481"><highlight class="normal"><sp/><sp/><sp/><sp/>*CoVariance<sp/>/=<sp/>SampleCountAdjustedForBias;</highlight></codeline>
<codeline lineno="1482"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j<sp/>==<sp/>i)<sp/>{</highlight></codeline>
<codeline lineno="1483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*CoVariance<sp/>&lt;<sp/><ref refid="cluster_8cpp_1ab070d4fc08948b5047625cb799a9ac89" kindref="member">MINVARIANCE</ref>)</highlight></codeline>
<codeline lineno="1484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*CoVariance<sp/>=<sp/><ref refid="cluster_8cpp_1ab070d4fc08948b5047625cb799a9ac89" kindref="member">MINVARIANCE</ref>;</highlight></codeline>
<codeline lineno="1485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1aec33c119c63aad5cd1c4e75c6afe2968" kindref="member">AvgVariance</ref><sp/>*=<sp/>*CoVariance;</highlight></codeline>
<codeline lineno="1486"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1aec33c119c63aad5cd1c4e75c6afe2968" kindref="member">AvgVariance</ref><sp/>=<sp/>(float)pow((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1aec33c119c63aad5cd1c4e75c6afe2968" kindref="member">AvgVariance</ref>,</highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.0<sp/>/<sp/>N);</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"></highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>release<sp/>temporary<sp/>memory<sp/>and<sp/>return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref>(Distance);</highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Statistics);</highlight></codeline>
<codeline lineno="1494"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ComputeStatistics</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1495"><highlight class="normal"></highlight></codeline>
<codeline lineno="1496"><highlight class="normal"></highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1a96019ee068587b2d17ddb6f43ded872b" kindref="member">NewSphericalProto</ref>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>N,</highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics)<sp/>{</highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><sp/><sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto;</highlight></codeline>
<codeline lineno="1514"><highlight class="normal"></highlight></codeline>
<codeline lineno="1515"><highlight class="normal"><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1adf2445f2aae1e1e03f06eefb85c95b8d" kindref="member">NewSimpleProto</ref><sp/>(N,<sp/>Cluster);</highlight></codeline>
<codeline lineno="1516"><highlight class="normal"></highlight></codeline>
<codeline lineno="1517"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1ad883f0258d034e4fd77ce450c3e058d2" kindref="member">Spherical</ref><sp/>=<sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1aec33c119c63aad5cd1c4e75c6afe2968" kindref="member">AvgVariance</ref>;</highlight></codeline>
<codeline lineno="1518"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1ad883f0258d034e4fd77ce450c3e058d2" kindref="member">Spherical</ref><sp/>&lt;<sp/><ref refid="cluster_8cpp_1ab070d4fc08948b5047625cb799a9ac89" kindref="member">MINVARIANCE</ref>)</highlight></codeline>
<codeline lineno="1519"><highlight class="normal"><sp/><sp/><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1ad883f0258d034e4fd77ce450c3e058d2" kindref="member">Spherical</ref><sp/>=<sp/><ref refid="cluster_8cpp_1ab070d4fc08948b5047625cb799a9ac89" kindref="member">MINVARIANCE</ref>;</highlight></codeline>
<codeline lineno="1520"><highlight class="normal"></highlight></codeline>
<codeline lineno="1521"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a0b016afed9c049598aa41feb3770fc15" kindref="member">Magnitude</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1ad883f0258d034e4fd77ce450c3e058d2" kindref="member">Spherical</ref><sp/>=</highlight></codeline>
<codeline lineno="1522"><highlight class="normal"><sp/><sp/><sp/><sp/>1.0<sp/>/<sp/>sqrt<sp/>((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(2.0<sp/>*<sp/><ref refid="const_8h_1a598a3330b3c21701223ee0ca14316eca" kindref="member">PI</ref><sp/>*<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1ad883f0258d034e4fd77ce450c3e058d2" kindref="member">Spherical</ref>));</highlight></codeline>
<codeline lineno="1523"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a40a4a7e28d83ad5ad3c64e54734104be" kindref="member">TotalMagnitude</ref><sp/>=<sp/>(float)pow((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a0b016afed9c049598aa41feb3770fc15" kindref="member">Magnitude</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1ad883f0258d034e4fd77ce450c3e058d2" kindref="member">Spherical</ref>,</highlight></codeline>
<codeline lineno="1524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(double)<sp/>N);</highlight></codeline>
<codeline lineno="1525"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af202ff952380614068536ea0b504285e" kindref="member">Weight</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1ad883f0258d034e4fd77ce450c3e058d2" kindref="member">Spherical</ref><sp/>=<sp/>1.0<sp/>/<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1ad883f0258d034e4fd77ce450c3e058d2" kindref="member">Spherical</ref>;</highlight></codeline>
<codeline lineno="1526"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aefd3ba15fc4dd0029aa9cda07092382b" kindref="member">LogMagnitude</ref><sp/>=<sp/>log<sp/>((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a40a4a7e28d83ad5ad3c64e54734104be" kindref="member">TotalMagnitude</ref>);</highlight></codeline>
<codeline lineno="1527"><highlight class="normal"></highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Proto);</highlight></codeline>
<codeline lineno="1529"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NewSphericalProto</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1530"><highlight class="normal"></highlight></codeline>
<codeline lineno="1531"><highlight class="normal"></highlight></codeline>
<codeline lineno="1544"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1a1453a157e92261f5331f8624dfc4d3c0" kindref="member">NewEllipticalProto</ref>(<ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>N,</highlight></codeline>
<codeline lineno="1545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="1546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics)<sp/>{</highlight></codeline>
<codeline lineno="1547"><highlight class="normal"><sp/><sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto;</highlight></codeline>
<codeline lineno="1548"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*CoVariance;</highlight></codeline>
<codeline lineno="1549"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="1550"><highlight class="normal"></highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1adf2445f2aae1e1e03f06eefb85c95b8d" kindref="member">NewSimpleProto</ref><sp/>(N,<sp/>Cluster);</highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref><sp/>=<sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(N<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>));</highlight></codeline>
<codeline lineno="1553"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a0b016afed9c049598aa41feb3770fc15" kindref="member">Magnitude</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref><sp/>=<sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(N<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>));</highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af202ff952380614068536ea0b504285e" kindref="member">Weight</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref><sp/>=<sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(N<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>));</highlight></codeline>
<codeline lineno="1555"><highlight class="normal"></highlight></codeline>
<codeline lineno="1556"><highlight class="normal"><sp/><sp/>CoVariance<sp/>=<sp/>Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a1a87c66cfa2a256ff9b13d5858bf9650" kindref="member">CoVariance</ref>;</highlight></codeline>
<codeline lineno="1557"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a40a4a7e28d83ad5ad3c64e54734104be" kindref="member">TotalMagnitude</ref><sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>N;<sp/>i++,<sp/>CoVariance<sp/>+=<sp/>N<sp/>+<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="1559"><highlight class="normal"><sp/><sp/><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]<sp/>=<sp/>*CoVariance;</highlight></codeline>
<codeline lineno="1560"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]<sp/>&lt;<sp/><ref refid="cluster_8cpp_1ab070d4fc08948b5047625cb799a9ac89" kindref="member">MINVARIANCE</ref>)</highlight></codeline>
<codeline lineno="1561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]<sp/>=<sp/><ref refid="cluster_8cpp_1ab070d4fc08948b5047625cb799a9ac89" kindref="member">MINVARIANCE</ref>;</highlight></codeline>
<codeline lineno="1562"><highlight class="normal"></highlight></codeline>
<codeline lineno="1563"><highlight class="normal"><sp/><sp/><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a0b016afed9c049598aa41feb3770fc15" kindref="member">Magnitude</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]<sp/>=</highlight></codeline>
<codeline lineno="1564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>1.0<sp/>/<sp/>sqrt<sp/>((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(2.0<sp/>*<sp/><ref refid="const_8h_1a598a3330b3c21701223ee0ca14316eca" kindref="member">PI</ref><sp/>*<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]));</highlight></codeline>
<codeline lineno="1565"><highlight class="normal"><sp/><sp/><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af202ff952380614068536ea0b504285e" kindref="member">Weight</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i]<sp/>=<sp/>1.0<sp/>/<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a35cf2e2dd8cc8b0e9476ad49f36abd24" kindref="member">Variance</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i];</highlight></codeline>
<codeline lineno="1566"><highlight class="normal"><sp/><sp/><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a40a4a7e28d83ad5ad3c64e54734104be" kindref="member">TotalMagnitude</ref><sp/>*=<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a0b016afed9c049598aa41feb3770fc15" kindref="member">Magnitude</ref>.<ref refid="union_f_l_o_a_t_u_n_i_o_n_1a4b36c5b636aac27041dd340386f3801f" kindref="member">Elliptical</ref>[i];</highlight></codeline>
<codeline lineno="1567"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1568"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aefd3ba15fc4dd0029aa9cda07092382b" kindref="member">LogMagnitude</ref><sp/>=<sp/>log<sp/>((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a40a4a7e28d83ad5ad3c64e54734104be" kindref="member">TotalMagnitude</ref>);</highlight></codeline>
<codeline lineno="1569"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aad81f08b6e171698866b445c0b3d4b35" kindref="member">Style</ref><sp/>=<sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaa39d32ff639641ca169c9729c58614459" kindref="member">elliptical</ref>;</highlight></codeline>
<codeline lineno="1570"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Proto);</highlight></codeline>
<codeline lineno="1571"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NewEllipticalProto</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1572"><highlight class="normal"></highlight></codeline>
<codeline lineno="1573"><highlight class="normal"></highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1accc05d5eedc4d765148eaa99c1927a79" kindref="member">NewMixedProto</ref>(<ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>N,<sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,<sp/><ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics)<sp/>{</highlight></codeline>
<codeline lineno="1590"><highlight class="normal"><sp/><sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto;</highlight></codeline>
<codeline lineno="1591"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="1592"><highlight class="normal"></highlight></codeline>
<codeline lineno="1593"><highlight class="normal"><sp/><sp/>Proto<sp/>=<sp/><ref refid="cluster_8cpp_1a1453a157e92261f5331f8624dfc4d3c0" kindref="member">NewEllipticalProto</ref><sp/>(N,<sp/>Cluster,<sp/>Statistics);</highlight></codeline>
<codeline lineno="1594"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1ae53408c33cdd473a9ed1f028e8172b0b" kindref="member">Distrib</ref><sp/>=<sp/>(<ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0" kindref="member">DISTRIBUTION</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(N<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0" kindref="member">DISTRIBUTION</ref>));</highlight></codeline>
<codeline lineno="1595"><highlight class="normal"></highlight></codeline>
<codeline lineno="1596"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>N;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1597"><highlight class="normal"><sp/><sp/><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1ae53408c33cdd473a9ed1f028e8172b0b" kindref="member">Distrib</ref>[i]<sp/>=<sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0aebc81705969b8c5ae986b0b2ec08d1d5" kindref="member">normal</ref>;</highlight></codeline>
<codeline lineno="1598"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1599"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aad81f08b6e171698866b445c0b3d4b35" kindref="member">Style</ref><sp/>=<sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaab164032fff82a847826b4887d9e7be58" kindref="member">mixed</ref>;</highlight></codeline>
<codeline lineno="1600"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(Proto);</highlight></codeline>
<codeline lineno="1601"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NewMixedProto</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1602"><highlight class="normal"></highlight></codeline>
<codeline lineno="1603"><highlight class="normal"></highlight></codeline>
<codeline lineno="1614"><highlight class="normal"><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*<ref refid="cluster_8cpp_1adf2445f2aae1e1e03f06eefb85c95b8d" kindref="member">NewSimpleProto</ref>(<ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>N,<sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster)<sp/>{</highlight></codeline>
<codeline lineno="1615"><highlight class="normal"><sp/><sp/><ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*Proto;</highlight></codeline>
<codeline lineno="1616"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="1617"><highlight class="normal"></highlight></codeline>
<codeline lineno="1618"><highlight class="normal"><sp/><sp/>Proto<sp/>=<sp/>(<ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="struct_p_r_o_t_o_t_y_p_e" kindref="compound">PROTOTYPE</ref>));</highlight></codeline>
<codeline lineno="1619"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af9c4f61cdbf39f6494b4691799bd4fa6" kindref="member">Mean</ref><sp/>=<sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(N<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>));</highlight></codeline>
<codeline lineno="1620"><highlight class="normal"></highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>N;<sp/>i++)</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1af9c4f61cdbf39f6494b4691799bd4fa6" kindref="member">Mean</ref>[i]<sp/>=<sp/>Cluster-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>[i];</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1ae53408c33cdd473a9ed1f028e8172b0b" kindref="member">Distrib</ref><sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1624"><highlight class="normal"></highlight></codeline>
<codeline lineno="1625"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a5d94887aaa0acd7e4a0c04c420af5670" kindref="member">Significant</ref><sp/>=<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="1626"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a8e04c7f378d30c248bc6e55703ac69a6" kindref="member">Merged</ref><sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aad81f08b6e171698866b445c0b3d4b35" kindref="member">Style</ref><sp/>=<sp/><ref refid="cluster_8h_1a2bf647f23b4a059a559e4d991437c9eaa93d6901f160899d15f69322530595f4f" kindref="member">spherical</ref>;</highlight></codeline>
<codeline lineno="1628"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1a2ba6bfd64f308a26cdd0a75c52e002f5" kindref="member">NumSamples</ref><sp/>=<sp/>Cluster-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref>;</highlight></codeline>
<codeline lineno="1629"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aff59384612de343b799b92a5d80282b7" kindref="member">Cluster</ref><sp/>=<sp/>Cluster;</highlight></codeline>
<codeline lineno="1630"><highlight class="normal"><sp/><sp/>Proto-&gt;<ref refid="struct_p_r_o_t_o_t_y_p_e_1aff59384612de343b799b92a5d80282b7" kindref="member">Cluster</ref>-&gt;<ref refid="structsample_1af0c82e552c662971cf574f9ee8bcb40f" kindref="member">Prototype</ref><sp/>=<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="1631"><highlight class="normal"><sp/><sp/>return<sp/>(Proto);</highlight></codeline>
<codeline lineno="1632"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NewSimpleProto</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1633"><highlight class="normal"></highlight></codeline>
<codeline lineno="1634"><highlight class="normal"></highlight></codeline>
<codeline lineno="1655"><highlight class="normal"><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></highlight></codeline>
<codeline lineno="1656"><highlight class="normal"><ref refid="cluster_8cpp_1a0a6fea38a06375666937701fb21e6a05" kindref="member">Independent</ref><sp/>(<ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>ParamDesc[],</highlight></codeline>
<codeline lineno="1657"><highlight class="normal"><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>N,<sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*<sp/>CoVariance,<sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>Independence)<sp/>{</highlight></codeline>
<codeline lineno="1658"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>j;</highlight></codeline>
<codeline lineno="1659"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*VARii;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>points<sp/>to<sp/>ith<sp/>on-diagonal<sp/>element</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1660"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>*VARjj;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>points<sp/>to<sp/>jth<sp/>on-diagonal<sp/>element</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1661"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>CorrelationCoeff;</highlight></codeline>
<codeline lineno="1662"><highlight class="normal"></highlight></codeline>
<codeline lineno="1663"><highlight class="normal"><sp/><sp/>VARii<sp/>=<sp/>CoVariance;</highlight></codeline>
<codeline lineno="1664"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>N;<sp/>i++,<sp/>VARii<sp/>+=<sp/>N<sp/>+<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ParamDesc[i].NonEssential)</highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1667"><highlight class="normal"></highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/><sp/><sp/>VARjj<sp/>=<sp/>VARii<sp/>+<sp/>N<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/><sp/><sp/>CoVariance<sp/>=<sp/>VARii<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>i<sp/>+<sp/>1;<sp/>j<sp/>&lt;<sp/>N;<sp/>j++,<sp/>CoVariance++,<sp/>VARjj<sp/>+=<sp/>N<sp/>+<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="1671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ParamDesc[j].NonEssential)</highlight></codeline>
<codeline lineno="1672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1673"><highlight class="normal"></highlight></codeline>
<codeline lineno="1674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((*VARii<sp/>==<sp/>0.0)<sp/>||<sp/>(*VARjj<sp/>==<sp/>0.0))</highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CorrelationCoeff<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CorrelationCoeff<sp/>=</highlight></codeline>
<codeline lineno="1678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sqrt<sp/>(sqrt<sp/>(*CoVariance<sp/>*<sp/>*CoVariance<sp/>/<sp/>(*VARii<sp/>*<sp/>*VARjj)));</highlight></codeline>
<codeline lineno="1679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(CorrelationCoeff<sp/>&gt;<sp/>Independence)</highlight></codeline>
<codeline lineno="1680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>);</highlight></codeline>
<codeline lineno="1681"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1682"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1683"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>);</highlight></codeline>
<codeline lineno="1684"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Independent</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1685"><highlight class="normal"></highlight></codeline>
<codeline lineno="1686"><highlight class="normal"></highlight></codeline>
<codeline lineno="1705"><highlight class="normal"><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*<ref refid="cluster_8cpp_1a0924b73d8bc3cd1269aa64f5a41b633f" kindref="member">GetBuckets</ref>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref>*<sp/>clusterer,</highlight></codeline>
<codeline lineno="1706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0" kindref="member">DISTRIBUTION</ref><sp/>Distribution,</highlight></codeline>
<codeline lineno="1707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref><sp/>SampleCount,</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Confidence)<sp/>{</highlight></codeline>
<codeline lineno="1709"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>an<sp/>old<sp/>bucket<sp/>structure<sp/>with<sp/>the<sp/>same<sp/>number<sp/>of<sp/>buckets.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1710"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>NumberOfBuckets<sp/>=<sp/><ref refid="cluster_8cpp_1ab182ad32f9100ae8e29e72db623c70dd" kindref="member">OptimumNumberOfBuckets</ref>(SampleCount);</highlight></codeline>
<codeline lineno="1711"><highlight class="normal"><sp/><sp/><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets<sp/>=</highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a01b03fc9cf75b5bd7d11abde7405a23a" kindref="member">bucket_cache</ref>[Distribution][NumberOfBuckets<sp/>-<sp/><ref refid="cluster_8h_1a759b3b99f54d92a0c6c5471a4c87c42b" kindref="member">MINBUCKETS</ref>];</highlight></codeline>
<codeline lineno="1713"><highlight class="normal"></highlight></codeline>
<codeline lineno="1714"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>a<sp/>matching<sp/>bucket<sp/>structure<sp/>is<sp/>not<sp/>found,<sp/>make<sp/>one<sp/>and<sp/>save<sp/>it.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1715"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Buckets<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1716"><highlight class="normal"><sp/><sp/><sp/><sp/>Buckets<sp/>=<sp/><ref refid="cluster_8cpp_1a93a38445707d2a943e60fafebe0c2b4d" kindref="member">MakeBuckets</ref>(Distribution,<sp/>SampleCount,<sp/>Confidence);</highlight></codeline>
<codeline lineno="1717"><highlight class="normal"><sp/><sp/><sp/><sp/>clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1a01b03fc9cf75b5bd7d11abde7405a23a" kindref="member">bucket_cache</ref>[Distribution][NumberOfBuckets<sp/>-<sp/><ref refid="cluster_8h_1a759b3b99f54d92a0c6c5471a4c87c42b" kindref="member">MINBUCKETS</ref>]<sp/>=</highlight></codeline>
<codeline lineno="1718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Buckets;</highlight></codeline>
<codeline lineno="1719"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1720"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Just<sp/>adjust<sp/>the<sp/>existing<sp/>buckets.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1721"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(SampleCount<sp/>!=<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a8e352450eb27c8a017a037f71796b402" kindref="member">SampleCount</ref>)</highlight></codeline>
<codeline lineno="1722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a02e72bde5b9d967258769d4a75f07e46" kindref="member">AdjustBuckets</ref>(Buckets,<sp/>SampleCount);</highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Confidence<sp/>!=<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1aeef80a305501f83af63153e6b2e362a8" kindref="member">Confidence</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1aeef80a305501f83af63153e6b2e362a8" kindref="member">Confidence</ref><sp/>=<sp/>Confidence;</highlight></codeline>
<codeline lineno="1725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a4dedca1b6c939050313aa761b59a0a11" kindref="member">ChiSquared</ref><sp/>=<sp/><ref refid="cluster_8cpp_1a952909dfb237bce2b90d33204b3efe3e" kindref="member">ComputeChiSquared</ref>(</highlight></codeline>
<codeline lineno="1726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1acfe8f1657aa1e2a4de798d80ab637756" kindref="member">DegreesOfFreedom</ref>(Distribution,<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref>),</highlight></codeline>
<codeline lineno="1727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Confidence);</highlight></codeline>
<codeline lineno="1728"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1729"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a0f9ec282a0fa768a4b5bd0d5efaca7d2" kindref="member">InitBuckets</ref>(Buckets);</highlight></codeline>
<codeline lineno="1730"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Buckets;</highlight></codeline>
<codeline lineno="1732"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>GetBuckets</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1733"><highlight class="normal"></highlight></codeline>
<codeline lineno="1734"><highlight class="normal"></highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*<ref refid="cluster_8cpp_1a93a38445707d2a943e60fafebe0c2b4d" kindref="member">MakeBuckets</ref>(<ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0" kindref="member">DISTRIBUTION</ref><sp/>Distribution,</highlight></codeline>
<codeline lineno="1756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref><sp/>SampleCount,</highlight></codeline>
<codeline lineno="1757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Confidence)<sp/>{</highlight></codeline>
<codeline lineno="1758"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a32b61dc3b9e8987cc1a63db31c99c6e9" kindref="member">DENSITYFUNC</ref><sp/>DensityFunction[]<sp/>=</highlight></codeline>
<codeline lineno="1759"><highlight class="normal"><sp/><sp/><sp/><sp/>{<sp/><ref refid="cluster_8cpp_1a46fa6d94ca57427d93d1f306c4bbcf46" kindref="member">NormalDensity</ref>,<sp/><ref refid="cluster_8cpp_1a5abc8ec5703c3d471dc0dd172cb22168" kindref="member">UniformDensity</ref>,<sp/>UniformDensity<sp/>};</highlight></codeline>
<codeline lineno="1760"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>j;</highlight></codeline>
<codeline lineno="1761"><highlight class="normal"><sp/><sp/><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets;</highlight></codeline>
<codeline lineno="1762"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>BucketProbability;</highlight></codeline>
<codeline lineno="1763"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>NextBucketBoundary;</highlight></codeline>
<codeline lineno="1764"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Probability;</highlight></codeline>
<codeline lineno="1765"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>ProbabilityDelta;</highlight></codeline>
<codeline lineno="1766"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>LastProbDensity;</highlight></codeline>
<codeline lineno="1767"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>ProbDensity;</highlight></codeline>
<codeline lineno="1768"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>CurrentBucket;</highlight></codeline>
<codeline lineno="1769"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>Symmetrical;</highlight></codeline>
<codeline lineno="1770"><highlight class="normal"></highlight></codeline>
<codeline lineno="1771"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>allocate<sp/>memory<sp/>needed<sp/>for<sp/>data<sp/>structure</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1772"><highlight class="normal"><sp/><sp/>Buckets<sp/>=<sp/></highlight><highlight class="keyword">reinterpret_cast&lt;</highlight><highlight class="normal"><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref>*</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(<ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref>)));</highlight></codeline>
<codeline lineno="1773"><highlight class="normal"><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref><sp/>=<sp/><ref refid="cluster_8cpp_1ab182ad32f9100ae8e29e72db623c70dd" kindref="member">OptimumNumberOfBuckets</ref>(SampleCount);</highlight></codeline>
<codeline lineno="1774"><highlight class="normal"><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a8e352450eb27c8a017a037f71796b402" kindref="member">SampleCount</ref><sp/>=<sp/>SampleCount;</highlight></codeline>
<codeline lineno="1775"><highlight class="normal"><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1aeef80a305501f83af63153e6b2e362a8" kindref="member">Confidence</ref><sp/>=<sp/>Confidence;</highlight></codeline>
<codeline lineno="1776"><highlight class="normal"><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a0b281b83beb3b9c450eeec5c9f4ec763" kindref="member">Count</ref><sp/>=<sp/></highlight><highlight class="keyword">reinterpret_cast&lt;</highlight><highlight class="normal"><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref>*</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(</highlight></codeline>
<codeline lineno="1777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref>(Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref><sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref>)));</highlight></codeline>
<codeline lineno="1778"><highlight class="normal"><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a4002c4c85553bc88efee6395fe803026" kindref="member">ExpectedCount</ref><sp/>=<sp/></highlight><highlight class="keyword">reinterpret_cast&lt;</highlight><highlight class="normal"><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>*</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(</highlight></codeline>
<codeline lineno="1779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref>(Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref><sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>)));</highlight></codeline>
<codeline lineno="1780"><highlight class="normal"></highlight></codeline>
<codeline lineno="1781"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>initialize<sp/>simple<sp/>fields</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1782"><highlight class="normal"><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1ad2b1ef5944d42354519db2895a8ca062" kindref="member">Distribution</ref><sp/>=<sp/>Distribution;</highlight></codeline>
<codeline lineno="1783"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1784"><highlight class="normal"><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a0b281b83beb3b9c450eeec5c9f4ec763" kindref="member">Count</ref>[i]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1785"><highlight class="normal"><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a4002c4c85553bc88efee6395fe803026" kindref="member">ExpectedCount</ref>[i]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1786"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1787"><highlight class="normal"></highlight></codeline>
<codeline lineno="1788"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>all<sp/>currently<sp/>defined<sp/>distributions<sp/>are<sp/>symmetrical</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1789"><highlight class="normal"><sp/><sp/>Symmetrical<sp/>=<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="1790"><highlight class="normal"><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a4dedca1b6c939050313aa761b59a0a11" kindref="member">ChiSquared</ref><sp/>=<sp/><ref refid="cluster_8cpp_1a952909dfb237bce2b90d33204b3efe3e" kindref="member">ComputeChiSquared</ref>(</highlight></codeline>
<codeline lineno="1791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1acfe8f1657aa1e2a4de798d80ab637756" kindref="member">DegreesOfFreedom</ref>(Distribution,<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref>),<sp/>Confidence);</highlight></codeline>
<codeline lineno="1792"><highlight class="normal"></highlight></codeline>
<codeline lineno="1793"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Symmetrical)<sp/>{</highlight></codeline>
<codeline lineno="1794"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>allocate<sp/>buckets<sp/>so<sp/>that<sp/>all<sp/>have<sp/>approx.<sp/>equal<sp/>probability</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1795"><highlight class="normal"><sp/><sp/><sp/><sp/>BucketProbability<sp/>=<sp/>1.0<sp/>/<sp/>(<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>)<sp/>(Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref>);</highlight></codeline>
<codeline lineno="1796"><highlight class="normal"></highlight></codeline>
<codeline lineno="1797"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>distribution<sp/>is<sp/>symmetric<sp/>so<sp/>fill<sp/>in<sp/>upper<sp/>half<sp/>then<sp/>copy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1798"><highlight class="normal"><sp/><sp/><sp/><sp/>CurrentBucket<sp/>=<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref><sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1799"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="cluster_8cpp_1a0662f2b2f6ae8b7ed59d9da773c0da35" kindref="member">Odd</ref><sp/>(Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref>))</highlight></codeline>
<codeline lineno="1800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>NextBucketBoundary<sp/>=<sp/>BucketProbability<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1801"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>NextBucketBoundary<sp/>=<sp/>BucketProbability;</highlight></codeline>
<codeline lineno="1803"><highlight class="normal"></highlight></codeline>
<codeline lineno="1804"><highlight class="normal"><sp/><sp/><sp/><sp/>Probability<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1805"><highlight class="normal"><sp/><sp/><sp/><sp/>LastProbDensity<sp/>=</highlight></codeline>
<codeline lineno="1806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(*DensityFunction[(int)<sp/>Distribution])<sp/>(BUCKETTABLESIZE<sp/>/<sp/>2);</highlight></codeline>
<codeline lineno="1807"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>BUCKETTABLESIZE<sp/>/<sp/>2;<sp/>i<sp/>&lt;<sp/><ref refid="cluster_8cpp_1a0b0900161a8584a70a474237621ce953" kindref="member">BUCKETTABLESIZE</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ProbDensity<sp/>=<sp/>(*DensityFunction[(int)<sp/>Distribution])<sp/>(i<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="1809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ProbabilityDelta<sp/>=<sp/><ref refid="cluster_8cpp_1af0eb798915396ae610f1701708a7b816" kindref="member">Integral</ref><sp/>(LastProbDensity,<sp/>ProbDensity,<sp/>1.0);</highlight></codeline>
<codeline lineno="1810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Probability<sp/>+=<sp/>ProbabilityDelta;</highlight></codeline>
<codeline lineno="1811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Probability<sp/>&gt;<sp/>NextBucketBoundary)<sp/>{</highlight></codeline>
<codeline lineno="1812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(CurrentBucket<sp/>&lt;<sp/>Buckets-&gt;NumberOfBuckets<sp/>-<sp/>1)</highlight></codeline>
<codeline lineno="1813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CurrentBucket++;</highlight></codeline>
<codeline lineno="1814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NextBucketBoundary<sp/>+=<sp/>BucketProbability;</highlight></codeline>
<codeline lineno="1815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a087d99bc0da49ff3abcfa664a5effbfa" kindref="member">Bucket</ref>[i]<sp/>=<sp/>CurrentBucket;</highlight></codeline>
<codeline lineno="1817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a4002c4c85553bc88efee6395fe803026" kindref="member">ExpectedCount</ref>[CurrentBucket]<sp/>+=</highlight></codeline>
<codeline lineno="1818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>)<sp/>(ProbabilityDelta<sp/>*<sp/>SampleCount);</highlight></codeline>
<codeline lineno="1819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>LastProbDensity<sp/>=<sp/>ProbDensity;</highlight></codeline>
<codeline lineno="1820"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1821"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>place<sp/>any<sp/>leftover<sp/>probability<sp/>into<sp/>the<sp/>last<sp/>bucket</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1822"><highlight class="normal"><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a4002c4c85553bc88efee6395fe803026" kindref="member">ExpectedCount</ref>[CurrentBucket]<sp/>+=</highlight></codeline>
<codeline lineno="1823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>)<sp/>((0.5<sp/>-<sp/>Probability)<sp/>*<sp/>SampleCount);</highlight></codeline>
<codeline lineno="1824"><highlight class="normal"></highlight></codeline>
<codeline lineno="1825"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>copy<sp/>upper<sp/>half<sp/>of<sp/>distribution<sp/>to<sp/>lower<sp/>half</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1826"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0,<sp/>j<sp/>=<sp/>BUCKETTABLESIZE<sp/>-<sp/>1;<sp/>i<sp/>&lt;<sp/>j;<sp/>i++,<sp/>j--)</highlight></codeline>
<codeline lineno="1827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a087d99bc0da49ff3abcfa664a5effbfa" kindref="member">Bucket</ref>[i]<sp/>=</highlight></codeline>
<codeline lineno="1828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1a42e41a23d64c7e8a69fbfd802e72c239" kindref="member">Mirror</ref>(Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a087d99bc0da49ff3abcfa664a5effbfa" kindref="member">Bucket</ref>[j],<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref>);</highlight></codeline>
<codeline lineno="1829"><highlight class="normal"></highlight></codeline>
<codeline lineno="1830"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>copy<sp/>upper<sp/>half<sp/>of<sp/>expected<sp/>counts<sp/>to<sp/>lower<sp/>half</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1831"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0,<sp/>j<sp/>=<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref><sp/>-<sp/>1;<sp/>i<sp/>&lt;=<sp/>j;<sp/>i++,<sp/>j--)</highlight></codeline>
<codeline lineno="1832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a4002c4c85553bc88efee6395fe803026" kindref="member">ExpectedCount</ref>[i]<sp/>+=<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a4002c4c85553bc88efee6395fe803026" kindref="member">ExpectedCount</ref>[j];</highlight></codeline>
<codeline lineno="1833"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1834"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Buckets;</highlight></codeline>
<codeline lineno="1835"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MakeBuckets</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1836"><highlight class="normal"></highlight></codeline>
<codeline lineno="1837"><highlight class="normal"></highlight></codeline>
<codeline lineno="1838"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1839"><highlight class="normal"><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="cluster_8cpp_1ab182ad32f9100ae8e29e72db623c70dd" kindref="member">OptimumNumberOfBuckets</ref>(<ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref><sp/>SampleCount)<sp/>{</highlight></codeline>
<codeline lineno="1840"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1841"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="1842"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>SampleCount<sp/>number<sp/>of<sp/>samples<sp/>to<sp/>be<sp/>tested</highlight></codeline>
<codeline lineno="1843"><highlight class="comment"><sp/><sp/>**<sp/><sp/><sp/><sp/>Operation:</highlight></codeline>
<codeline lineno="1844"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>computes<sp/>the<sp/>optimum<sp/>number<sp/>of<sp/>histogram</highlight></codeline>
<codeline lineno="1845"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>buckets<sp/>that<sp/>should<sp/>be<sp/>used<sp/>in<sp/>a<sp/>chi-squared<sp/>goodness<sp/>of</highlight></codeline>
<codeline lineno="1846"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>fit<sp/>test<sp/>for<sp/>the<sp/>specified<sp/>number<sp/>of<sp/>samples.<sp/><sp/>The<sp/>optimum</highlight></codeline>
<codeline lineno="1847"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>number<sp/>is<sp/>computed<sp/>based<sp/>on<sp/>Table<sp/>4.1<sp/>on<sp/>pg.<sp/>147<sp/>of</highlight></codeline>
<codeline lineno="1848"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>&quot;Measurement<sp/>and<sp/>Analysis<sp/>of<sp/>Random<sp/>Data&quot;<sp/>by<sp/>Bendat<sp/>&amp;<sp/>Piersol.</highlight></codeline>
<codeline lineno="1849"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Linear<sp/>interpolation<sp/>is<sp/>used<sp/>to<sp/>interpolate<sp/>between<sp/>table</highlight></codeline>
<codeline lineno="1850"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>values.<sp/><sp/>The<sp/>table<sp/>is<sp/>intended<sp/>for<sp/>a<sp/>0.05<sp/>level<sp/>of</highlight></codeline>
<codeline lineno="1851"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>significance<sp/>(alpha).<sp/><sp/>This<sp/>routine<sp/>assumes<sp/>that<sp/>it<sp/>is</highlight></codeline>
<codeline lineno="1852"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>equally<sp/>valid<sp/>for<sp/>other<sp/>alpha&apos;s,<sp/>which<sp/>may<sp/>not<sp/>be<sp/>true.</highlight></codeline>
<codeline lineno="1853"><highlight class="comment"><sp/>**<sp/>Return:</highlight></codeline>
<codeline lineno="1854"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Optimum<sp/>number<sp/>of<sp/>histogram<sp/>buckets</highlight></codeline>
<codeline lineno="1855"><highlight class="comment"><sp/>**<sp/>Exceptions:</highlight></codeline>
<codeline lineno="1856"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>None</highlight></codeline>
<codeline lineno="1857"><highlight class="comment"><sp/>**<sp/>History:</highlight></codeline>
<codeline lineno="1858"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>6/5/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="1859"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1860"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a458fe97f82495945f8071bb3c18d1783" kindref="member">uinT8</ref><sp/>Last,<sp/>Next;</highlight></codeline>
<codeline lineno="1861"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>Slope;</highlight></codeline>
<codeline lineno="1862"><highlight class="normal"></highlight></codeline>
<codeline lineno="1863"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(SampleCount<sp/>&lt;<sp/>kCountTable[0])</highlight></codeline>
<codeline lineno="1864"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>kBucketsTable[0];</highlight></codeline>
<codeline lineno="1865"><highlight class="normal"></highlight></codeline>
<codeline lineno="1866"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(Last<sp/>=<sp/>0,<sp/>Next<sp/>=<sp/>1;<sp/>Next<sp/>&lt;<sp/><ref refid="cluster_8cpp_1a4342455851ae586637e6a0abaf3b3f14" kindref="member">LOOKUPTABLESIZE</ref>;<sp/>Last++,<sp/>Next++)<sp/>{</highlight></codeline>
<codeline lineno="1867"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(SampleCount<sp/>&lt;=<sp/>kCountTable[Next])<sp/>{</highlight></codeline>
<codeline lineno="1868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Slope<sp/>=<sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>)<sp/>(kBucketsTable[Next]<sp/>-<sp/>kBucketsTable[Last])<sp/>/</highlight></codeline>
<codeline lineno="1869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>)<sp/>(kCountTable[Next]<sp/>-<sp/>kCountTable[Last]);</highlight></codeline>
<codeline lineno="1870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref>)<sp/>(kBucketsTable[Last]<sp/>+</highlight></codeline>
<codeline lineno="1871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Slope<sp/>*<sp/>(SampleCount<sp/>-<sp/>kCountTable[Last])));</highlight></codeline>
<codeline lineno="1872"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1873"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1874"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>kBucketsTable[Last];</highlight></codeline>
<codeline lineno="1875"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>OptimumNumberOfBuckets</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1876"><highlight class="normal"></highlight></codeline>
<codeline lineno="1877"><highlight class="normal"></highlight></codeline>
<codeline lineno="1878"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1879"><highlight class="normal"><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></highlight></codeline>
<codeline lineno="1880"><highlight class="normal"><ref refid="cluster_8cpp_1a952909dfb237bce2b90d33204b3efe3e" kindref="member">ComputeChiSquared</ref><sp/>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="cluster_8cpp_1acfe8f1657aa1e2a4de798d80ab637756" kindref="member">DegreesOfFreedom</ref>,<sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Alpha)</highlight></codeline>
<codeline lineno="1881"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1882"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="1883"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>DegreesOfFreedom<sp/><sp/><sp/><sp/>determines<sp/>shape<sp/>of<sp/>distribution</highlight></codeline>
<codeline lineno="1884"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Alpha<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>probability<sp/>of<sp/>right<sp/>tail</highlight></codeline>
<codeline lineno="1885"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="1886"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>computes<sp/>the<sp/>chi-squared<sp/>value<sp/>which<sp/>will</highlight></codeline>
<codeline lineno="1887"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>leave<sp/>a<sp/>cumulative<sp/>probability<sp/>of<sp/>Alpha<sp/>in<sp/>the<sp/>right<sp/>tail</highlight></codeline>
<codeline lineno="1888"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>of<sp/>a<sp/>chi-squared<sp/>distribution<sp/>with<sp/>the<sp/>specified<sp/>number<sp/>of</highlight></codeline>
<codeline lineno="1889"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>degrees<sp/>of<sp/>freedom.<sp/><sp/>Alpha<sp/>must<sp/>be<sp/>between<sp/>0<sp/>and<sp/>1.</highlight></codeline>
<codeline lineno="1890"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>DegreesOfFreedom<sp/>must<sp/>be<sp/>even.<sp/><sp/>The<sp/>routine<sp/>maintains<sp/>an</highlight></codeline>
<codeline lineno="1891"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>array<sp/>of<sp/>lists.<sp/><sp/>Each<sp/>list<sp/>corresponds<sp/>to<sp/>a<sp/>different</highlight></codeline>
<codeline lineno="1892"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>number<sp/>of<sp/>degrees<sp/>of<sp/>freedom.<sp/><sp/>Each<sp/>entry<sp/>in<sp/>the<sp/>list</highlight></codeline>
<codeline lineno="1893"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>corresponds<sp/>to<sp/>a<sp/>different<sp/>alpha<sp/>value<sp/>and<sp/>its<sp/>corresponding</highlight></codeline>
<codeline lineno="1894"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>chi-squared<sp/>value.<sp/><sp/>Therefore,<sp/>once<sp/>a<sp/>particular<sp/>chi-squared</highlight></codeline>
<codeline lineno="1895"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>value<sp/>is<sp/>computed,<sp/>it<sp/>is<sp/>stored<sp/>in<sp/>the<sp/>list<sp/>and<sp/>never</highlight></codeline>
<codeline lineno="1896"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>needs<sp/>to<sp/>be<sp/>computed<sp/>again.</highlight></codeline>
<codeline lineno="1897"><highlight class="comment"><sp/>**<sp/>Return:<sp/>Desired<sp/>chi-squared<sp/>value</highlight></codeline>
<codeline lineno="1898"><highlight class="comment"><sp/>**<sp/>Exceptions:<sp/>none</highlight></codeline>
<codeline lineno="1899"><highlight class="comment"><sp/>**<sp/>History:<sp/>6/5/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="1900"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1901"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CHIACCURACY<sp/><sp/><sp/><sp/><sp/>0.01</highlight></codeline>
<codeline lineno="1902"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>MINALPHA<sp/><sp/>(1e-200)</highlight></codeline>
<codeline lineno="1903"><highlight class="preprocessor"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1904"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="structlist__rec" kindref="compound">LIST</ref><sp/>ChiWith[<ref refid="cluster_8cpp_1a1d372c446071a329984f36c50a4e6a8f" kindref="member">MAXDEGREESOFFREEDOM</ref><sp/>+<sp/>1];</highlight></codeline>
<codeline lineno="1905"><highlight class="normal"></highlight></codeline>
<codeline lineno="1906"><highlight class="normal"><sp/><sp/><ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*OldChiSquared;</highlight></codeline>
<codeline lineno="1907"><highlight class="normal"><sp/><sp/><ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>SearchKey;</highlight></codeline>
<codeline lineno="1908"><highlight class="normal"></highlight></codeline>
<codeline lineno="1909"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>limit<sp/>the<sp/>minimum<sp/>alpha<sp/>that<sp/>can<sp/>be<sp/>used<sp/>-<sp/>if<sp/>alpha<sp/>is<sp/>too<sp/>small</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1910"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>it<sp/>may<sp/>not<sp/>be<sp/>possible<sp/>to<sp/>compute<sp/>chi-squared.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1911"><highlight class="normal"><sp/><sp/>Alpha<sp/>=<sp/><ref refid="helpers_8h_1af8739168d5b3235996eeb25dac3c4044" kindref="member">ClipToRange</ref>(Alpha,<sp/>MINALPHA,<sp/>1.0);</highlight></codeline>
<codeline lineno="1912"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="cluster_8cpp_1a0662f2b2f6ae8b7ed59d9da773c0da35" kindref="member">Odd</ref><sp/>(DegreesOfFreedom))</highlight></codeline>
<codeline lineno="1913"><highlight class="normal"><sp/><sp/><sp/><sp/>DegreesOfFreedom++;</highlight></codeline>
<codeline lineno="1914"><highlight class="normal"></highlight></codeline>
<codeline lineno="1915"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*<sp/>find<sp/>the<sp/>list<sp/>of<sp/>chi-squared<sp/>values<sp/>which<sp/>have<sp/>already<sp/>been<sp/>computed</highlight></codeline>
<codeline lineno="1916"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>for<sp/>the<sp/>specified<sp/>number<sp/>of<sp/>degrees<sp/>of<sp/>freedom.<sp/><sp/>Search<sp/>the<sp/>list<sp/>for</highlight></codeline>
<codeline lineno="1917"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>the<sp/>desired<sp/>chi-squared.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1918"><highlight class="normal"><sp/><sp/>SearchKey.<ref refid="struct_c_h_i_s_t_r_u_c_t_1a58a4707e32861b244d471e6d152fe43a" kindref="member">Alpha</ref><sp/>=<sp/>Alpha;</highlight></codeline>
<codeline lineno="1919"><highlight class="normal"><sp/><sp/>OldChiSquared<sp/>=<sp/>(<ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*)<sp/><ref refid="oldlist_8h_1a69547be764424f18b0be535400747978" kindref="member">first_node</ref><sp/>(<ref refid="oldlist_8cpp_1a1d8af9328f064a9df6d6f88336dd054e" kindref="member">search</ref><sp/>(ChiWith[DegreesOfFreedom],</highlight></codeline>
<codeline lineno="1920"><highlight class="normal"><sp/><sp/><sp/><sp/>&amp;SearchKey,<sp/><ref refid="cluster_8cpp_1ad39bd07ace019e3862769098fae02f93" kindref="member">AlphaMatch</ref>));</highlight></codeline>
<codeline lineno="1921"><highlight class="normal"></highlight></codeline>
<codeline lineno="1922"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(OldChiSquared<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1923"><highlight class="normal"><sp/><sp/><sp/><sp/>OldChiSquared<sp/>=<sp/><ref refid="cluster_8cpp_1ac16f25cf71bcb2632f695f55fb9a5980" kindref="member">NewChiStruct</ref><sp/>(DegreesOfFreedom,<sp/>Alpha);</highlight></codeline>
<codeline lineno="1924"><highlight class="normal"><sp/><sp/><sp/><sp/>OldChiSquared-&gt;<ref refid="struct_c_h_i_s_t_r_u_c_t_1ab8ebe43673dcf3e24c6a792c3bed43ea" kindref="member">ChiSquared</ref><sp/>=<sp/><ref refid="cluster_8cpp_1a8098e057438e6f07276dd005f28ef13c" kindref="member">Solve</ref><sp/>(<ref refid="cluster_8cpp_1a444724ad6aa7b59e010c1089af12b0b0" kindref="member">ChiArea</ref>,<sp/>OldChiSquared,</highlight></codeline>
<codeline lineno="1925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>)<sp/>DegreesOfFreedom,</highlight></codeline>
<codeline lineno="1926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>)<sp/>CHIACCURACY);</highlight></codeline>
<codeline lineno="1927"><highlight class="normal"><sp/><sp/><sp/><sp/>ChiWith[<ref refid="cluster_8cpp_1acfe8f1657aa1e2a4de798d80ab637756" kindref="member">DegreesOfFreedom</ref>]<sp/>=<sp/><ref refid="oldlist_8cpp_1a9c4294375af81ab4c133b6b5a3679a16" kindref="member">push</ref><sp/>(ChiWith[DegreesOfFreedom],</highlight></codeline>
<codeline lineno="1928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>OldChiSquared);</highlight></codeline>
<codeline lineno="1929"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1930"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1931"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>further<sp/>optimization<sp/>might<sp/>move<sp/>OldChiSquared<sp/>to<sp/>front<sp/>of<sp/>list</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1932"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1933"><highlight class="normal"></highlight></codeline>
<codeline lineno="1934"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(OldChiSquared-&gt;<ref refid="struct_c_h_i_s_t_r_u_c_t_1ab8ebe43673dcf3e24c6a792c3bed43ea" kindref="member">ChiSquared</ref>);</highlight></codeline>
<codeline lineno="1935"><highlight class="normal"></highlight></codeline>
<codeline lineno="1936"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ComputeChiSquared</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1937"><highlight class="normal"></highlight></codeline>
<codeline lineno="1938"><highlight class="normal"></highlight></codeline>
<codeline lineno="1939"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1940"><highlight class="normal"><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="cluster_8cpp_1a46fa6d94ca57427d93d1f306c4bbcf46" kindref="member">NormalDensity</ref>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>x)<sp/>{</highlight></codeline>
<codeline lineno="1941"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1942"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="1943"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>x<sp/><sp/><sp/>number<sp/>to<sp/>compute<sp/>the<sp/>normal<sp/>probability<sp/>density<sp/>for</highlight></codeline>
<codeline lineno="1944"><highlight class="comment"><sp/>**<sp/>Globals:</highlight></codeline>
<codeline lineno="1945"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>kNormalMean<sp/>mean<sp/>of<sp/>a<sp/>discrete<sp/>normal<sp/>distribution</highlight></codeline>
<codeline lineno="1946"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>kNormalVariance<sp/>variance<sp/>of<sp/>a<sp/>discrete<sp/>normal<sp/>distribution</highlight></codeline>
<codeline lineno="1947"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>kNormalMagnitude<sp/><sp/><sp/><sp/>magnitude<sp/>of<sp/>a<sp/>discrete<sp/>normal<sp/>distribution</highlight></codeline>
<codeline lineno="1948"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="1949"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>computes<sp/>the<sp/>probability<sp/>density<sp/>function</highlight></codeline>
<codeline lineno="1950"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>of<sp/>a<sp/>discrete<sp/>normal<sp/>distribution<sp/>defined<sp/>by<sp/>the<sp/>global</highlight></codeline>
<codeline lineno="1951"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>variables<sp/>kNormalMean,<sp/>kNormalVariance,<sp/>and<sp/>kNormalMagnitude.</highlight></codeline>
<codeline lineno="1952"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Normal<sp/>magnitude<sp/>could,<sp/>of<sp/>course,<sp/>be<sp/>computed<sp/>in<sp/>terms<sp/>of</highlight></codeline>
<codeline lineno="1953"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>the<sp/>normal<sp/>variance<sp/>but<sp/>it<sp/>is<sp/>precomputed<sp/>for<sp/>efficiency.</highlight></codeline>
<codeline lineno="1954"><highlight class="comment"><sp/>**<sp/>Return:</highlight></codeline>
<codeline lineno="1955"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>The<sp/>value<sp/>of<sp/>the<sp/>normal<sp/>distribution<sp/>at<sp/>x.</highlight></codeline>
<codeline lineno="1956"><highlight class="comment"><sp/>**<sp/>Exceptions:</highlight></codeline>
<codeline lineno="1957"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>None</highlight></codeline>
<codeline lineno="1958"><highlight class="comment"><sp/>**<sp/>History:</highlight></codeline>
<codeline lineno="1959"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>6/4/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="1960"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1961"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Distance;</highlight></codeline>
<codeline lineno="1962"><highlight class="normal"></highlight></codeline>
<codeline lineno="1963"><highlight class="normal"><sp/><sp/>Distance<sp/>=<sp/>x<sp/>-<sp/>kNormalMean;</highlight></codeline>
<codeline lineno="1964"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>kNormalMagnitude<sp/>*<sp/>exp(-0.5<sp/>*<sp/>Distance<sp/>*<sp/>Distance<sp/>/<sp/>kNormalVariance);</highlight></codeline>
<codeline lineno="1965"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NormalDensity</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1966"><highlight class="normal"></highlight></codeline>
<codeline lineno="1967"><highlight class="normal"></highlight></codeline>
<codeline lineno="1968"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1969"><highlight class="normal"><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="cluster_8cpp_1a5abc8ec5703c3d471dc0dd172cb22168" kindref="member">UniformDensity</ref>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>x)<sp/>{</highlight></codeline>
<codeline lineno="1970"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1971"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="1972"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>x<sp/><sp/><sp/>number<sp/>to<sp/>compute<sp/>the<sp/>uniform<sp/>probability<sp/>density<sp/>for</highlight></codeline>
<codeline lineno="1973"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="1974"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>computes<sp/>the<sp/>probability<sp/>density<sp/>function</highlight></codeline>
<codeline lineno="1975"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>of<sp/>a<sp/>uniform<sp/>distribution<sp/>at<sp/>the<sp/>specified<sp/>point.<sp/><sp/>The</highlight></codeline>
<codeline lineno="1976"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>range<sp/>of<sp/>the<sp/>distribution<sp/>is<sp/>from<sp/>0<sp/>to<sp/>BUCKETTABLESIZE.</highlight></codeline>
<codeline lineno="1977"><highlight class="comment"><sp/>**<sp/>Return:</highlight></codeline>
<codeline lineno="1978"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>The<sp/>value<sp/>of<sp/>the<sp/>uniform<sp/>distribution<sp/>at<sp/>x.</highlight></codeline>
<codeline lineno="1979"><highlight class="comment"><sp/>**<sp/>Exceptions:</highlight></codeline>
<codeline lineno="1980"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>None</highlight></codeline>
<codeline lineno="1981"><highlight class="comment"><sp/>**<sp/>History:</highlight></codeline>
<codeline lineno="1982"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>6/5/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="1983"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1984"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>UniformDistributionDensity<sp/>=<sp/>(<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>)<sp/>1.0<sp/>/<sp/>BUCKETTABLESIZE;</highlight></codeline>
<codeline lineno="1985"><highlight class="normal"></highlight></codeline>
<codeline lineno="1986"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((x<sp/>&gt;=<sp/>0.0)<sp/>&amp;&amp;<sp/>(x<sp/>&lt;=<sp/><ref refid="cluster_8cpp_1a0b0900161a8584a70a474237621ce953" kindref="member">BUCKETTABLESIZE</ref>))</highlight></codeline>
<codeline lineno="1987"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>UniformDistributionDensity;</highlight></codeline>
<codeline lineno="1988"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1989"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>)<sp/>0.0;</highlight></codeline>
<codeline lineno="1990"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>UniformDensity</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1991"><highlight class="normal"></highlight></codeline>
<codeline lineno="1992"><highlight class="normal"></highlight></codeline>
<codeline lineno="1993"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1994"><highlight class="normal"><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="cluster_8cpp_1af0eb798915396ae610f1701708a7b816" kindref="member">Integral</ref>(<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>f1,<sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>f2,<sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Dx)<sp/>{</highlight></codeline>
<codeline lineno="1995"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1996"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="1997"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>f1<sp/><sp/>value<sp/>of<sp/>function<sp/>at<sp/>x1</highlight></codeline>
<codeline lineno="1998"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>f2<sp/><sp/>value<sp/>of<sp/>function<sp/>at<sp/>x2</highlight></codeline>
<codeline lineno="1999"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Dx<sp/><sp/>x2<sp/>-<sp/>x1<sp/>(should<sp/>always<sp/>be<sp/>positive)</highlight></codeline>
<codeline lineno="2000"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2001"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>computes<sp/>a<sp/>trapezoidal<sp/>approximation<sp/>to<sp/>the</highlight></codeline>
<codeline lineno="2002"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>integral<sp/>of<sp/>a<sp/>function<sp/>over<sp/>a<sp/>small<sp/>delta<sp/>in<sp/>x.</highlight></codeline>
<codeline lineno="2003"><highlight class="comment"><sp/>**<sp/>Return:</highlight></codeline>
<codeline lineno="2004"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Approximation<sp/>of<sp/>the<sp/>integral<sp/>of<sp/>the<sp/>function<sp/>from<sp/>x1<sp/>to<sp/>x2.</highlight></codeline>
<codeline lineno="2005"><highlight class="comment"><sp/>**<sp/>Exceptions:</highlight></codeline>
<codeline lineno="2006"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>None</highlight></codeline>
<codeline lineno="2007"><highlight class="comment"><sp/>**<sp/>History:</highlight></codeline>
<codeline lineno="2008"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>6/5/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2009"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2010"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(f1<sp/>+<sp/>f2)<sp/>*<sp/>Dx<sp/>/<sp/>2.0;</highlight></codeline>
<codeline lineno="2011"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Integral</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2012"><highlight class="normal"></highlight></codeline>
<codeline lineno="2013"><highlight class="normal"></highlight></codeline>
<codeline lineno="2014"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2015"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a54c75ac15de9474adc1387dc0c809c0b" kindref="member">FillBuckets</ref>(<ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets,</highlight></codeline>
<codeline lineno="2016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster,</highlight></codeline>
<codeline lineno="2017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>Dim,</highlight></codeline>
<codeline lineno="2018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>*ParamDesc,</highlight></codeline>
<codeline lineno="2019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/><ref refid="cluster_8cpp_1ad99e1235a4e63880ab2f72bfdff26e28" kindref="member">Mean</ref>,</highlight></codeline>
<codeline lineno="2020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>StdDev)<sp/>{</highlight></codeline>
<codeline lineno="2021"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2022"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2023"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Buckets<sp/><sp/><sp/><sp/><sp/>histogram<sp/>buckets<sp/>to<sp/>count<sp/>samples</highlight></codeline>
<codeline lineno="2024"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Cluster<sp/><sp/><sp/><sp/><sp/>cluster<sp/>whose<sp/>samples<sp/>are<sp/>being<sp/>analyzed</highlight></codeline>
<codeline lineno="2025"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Dim<sp/><sp/><sp/><sp/><sp/>dimension<sp/>of<sp/>samples<sp/>which<sp/>is<sp/>being<sp/>analyzed</highlight></codeline>
<codeline lineno="2026"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>ParamDesc<sp/><sp/><sp/>description<sp/>of<sp/>the<sp/>dimension</highlight></codeline>
<codeline lineno="2027"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Mean<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;mean&quot;<sp/>of<sp/>the<sp/>distribution</highlight></codeline>
<codeline lineno="2028"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>StdDev<sp/><sp/><sp/><sp/><sp/><sp/>&quot;standard<sp/>deviation&quot;<sp/>of<sp/>the<sp/>distribution</highlight></codeline>
<codeline lineno="2029"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2030"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>counts<sp/>the<sp/>number<sp/>of<sp/>cluster<sp/>samples<sp/>which</highlight></codeline>
<codeline lineno="2031"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>fall<sp/>within<sp/>the<sp/>various<sp/>histogram<sp/>buckets<sp/>in<sp/>Buckets.<sp/><sp/>Only</highlight></codeline>
<codeline lineno="2032"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>one<sp/>dimension<sp/>of<sp/>each<sp/>sample<sp/>is<sp/>examined.<sp/><sp/>The<sp/>exact<sp/>meaning</highlight></codeline>
<codeline lineno="2033"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>of<sp/>the<sp/>Mean<sp/>and<sp/>StdDev<sp/>parameters<sp/>depends<sp/>on<sp/>the</highlight></codeline>
<codeline lineno="2034"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>distribution<sp/>which<sp/>is<sp/>being<sp/>analyzed<sp/>(this<sp/>info<sp/>is<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="2035"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Buckets<sp/>data<sp/>structure).<sp/><sp/>For<sp/>normal<sp/>distributions,<sp/>Mean</highlight></codeline>
<codeline lineno="2036"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>and<sp/>StdDev<sp/>have<sp/>the<sp/>expected<sp/>meanings.<sp/><sp/>For<sp/>uniform<sp/>and</highlight></codeline>
<codeline lineno="2037"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>random<sp/>distributions<sp/>the<sp/>Mean<sp/>is<sp/>the<sp/>center<sp/>point<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2038"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>range<sp/>and<sp/>the<sp/>StdDev<sp/>is<sp/>1/2<sp/>the<sp/>range.<sp/><sp/>A<sp/>dimension<sp/>with</highlight></codeline>
<codeline lineno="2039"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>zero<sp/>standard<sp/>deviation<sp/>cannot<sp/>be<sp/>statistically<sp/>analyzed.</highlight></codeline>
<codeline lineno="2040"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>In<sp/>this<sp/>case,<sp/>a<sp/>pseudo-analysis<sp/>is<sp/>used.</highlight></codeline>
<codeline lineno="2041"><highlight class="comment"><sp/>**<sp/>Return:</highlight></codeline>
<codeline lineno="2042"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>None<sp/>(the<sp/>Buckets<sp/>data<sp/>structure<sp/>is<sp/>filled<sp/>in)</highlight></codeline>
<codeline lineno="2043"><highlight class="comment"><sp/>**<sp/>Exceptions:</highlight></codeline>
<codeline lineno="2044"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>None</highlight></codeline>
<codeline lineno="2045"><highlight class="comment"><sp/>**<sp/>History:</highlight></codeline>
<codeline lineno="2046"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>6/5/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2047"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2048"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>BucketID;</highlight></codeline>
<codeline lineno="2049"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="2050"><highlight class="normal"><sp/><sp/><ref refid="structlist__rec" kindref="compound">LIST</ref><sp/>SearchState;</highlight></codeline>
<codeline lineno="2051"><highlight class="normal"><sp/><sp/><ref refid="structsample" kindref="compound">SAMPLE</ref><sp/>*Sample;</highlight></codeline>
<codeline lineno="2052"><highlight class="normal"></highlight></codeline>
<codeline lineno="2053"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>initialize<sp/>the<sp/>histogram<sp/>bucket<sp/>counts<sp/>to<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2054"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref>;<sp/>i++)</highlight></codeline>
<codeline lineno="2055"><highlight class="normal"><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a0b281b83beb3b9c450eeec5c9f4ec763" kindref="member">Count</ref>[i]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2056"><highlight class="normal"></highlight></codeline>
<codeline lineno="2057"><highlight class="normal"><sp/><sp/>if<sp/>(StdDev<sp/>==<sp/>0.0)<sp/>{</highlight></codeline>
<codeline lineno="2058"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>if<sp/>the<sp/>standard<sp/>deviation<sp/>is<sp/>zero,<sp/>then<sp/>we<sp/>can&apos;t<sp/>statistically</highlight></codeline>
<codeline lineno="2059"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>analyze<sp/>the<sp/>cluster.<sp/><sp/>Use<sp/>a<sp/>pseudo-analysis:<sp/>samples<sp/>exactly<sp/>on</highlight></codeline>
<codeline lineno="2060"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>mean<sp/>are<sp/>distributed<sp/>evenly<sp/>across<sp/>all<sp/>buckets.<sp/><sp/>Samples<sp/>greater</highlight></codeline>
<codeline lineno="2061"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>than<sp/>the<sp/>mean<sp/>are<sp/>placed<sp/>in<sp/>the<sp/>last<sp/>bucket;<sp/>samples<sp/>less<sp/>than<sp/>the</highlight></codeline>
<codeline lineno="2062"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mean<sp/>are<sp/>placed<sp/>in<sp/>the<sp/>first<sp/>bucket.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2063"><highlight class="normal"></highlight></codeline>
<codeline lineno="2064"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8h_1af125589eadf8dca87cf904ebcb77c896" kindref="member">InitSampleSearch</ref>(SearchState,<sp/>Cluster);</highlight></codeline>
<codeline lineno="2065"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2066"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((Sample<sp/>=<sp/><ref refid="cluster_8cpp_1abf5d9e3b151ac51b27bd9dc797ac261c" kindref="member">NextSample</ref><sp/>(&amp;SearchState))<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Sample-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>[Dim]<sp/>&gt;<sp/>Mean)</highlight></codeline>
<codeline lineno="2068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BucketID<sp/>=<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref><sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="2069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Sample-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>[Dim]<sp/>&lt;<sp/>Mean)</highlight></codeline>
<codeline lineno="2070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BucketID<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BucketID<sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="2073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a0b281b83beb3b9c450eeec5c9f4ec763" kindref="member">Count</ref>[BucketID]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="2074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>i++;</highlight></codeline>
<codeline lineno="2075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;=<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref>)</highlight></codeline>
<codeline lineno="2076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2077"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2078"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2079"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2080"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>search<sp/>for<sp/>all<sp/>samples<sp/>in<sp/>the<sp/>cluster<sp/>and<sp/>add<sp/>to<sp/>histogram<sp/>buckets</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2081"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8h_1af125589eadf8dca87cf904ebcb77c896" kindref="member">InitSampleSearch</ref>(SearchState,<sp/>Cluster);</highlight></codeline>
<codeline lineno="2082"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((Sample<sp/>=<sp/><ref refid="cluster_8cpp_1abf5d9e3b151ac51b27bd9dc797ac261c" kindref="member">NextSample</ref><sp/>(&amp;SearchState))<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1ad2b1ef5944d42354519db2895a8ca062" kindref="member">Distribution</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0aebc81705969b8c5ae986b0b2ec08d1d5" kindref="member">normal</ref>:</highlight></codeline>
<codeline lineno="2085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BucketID<sp/>=<sp/><ref refid="cluster_8cpp_1a8e988f373e1dc7d9a55043f3db047d09" kindref="member">NormalBucket</ref><sp/>(ParamDesc,<sp/>Sample-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>[Dim],</highlight></codeline>
<codeline lineno="2086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Mean,<sp/>StdDev);</highlight></codeline>
<codeline lineno="2087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0a21504929e31ddde091641bb817e32320" kindref="member">D_random</ref>:</highlight></codeline>
<codeline lineno="2089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0a56013d9ac59a24fb94d9acb932a04b2f" kindref="member">uniform</ref>:</highlight></codeline>
<codeline lineno="2090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BucketID<sp/>=<sp/><ref refid="cluster_8cpp_1a43e2cce8f045a700cd6fb0684761cc0c" kindref="member">UniformBucket</ref><sp/>(ParamDesc,<sp/>Sample-&gt;<ref refid="structsample_1ac4a33bc0bdd82dd732bbb2f7c593ec78" kindref="member">Mean</ref>[Dim],</highlight></codeline>
<codeline lineno="2091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Mean,<sp/>StdDev);</highlight></codeline>
<codeline lineno="2092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BucketID<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a0b281b83beb3b9c450eeec5c9f4ec763" kindref="member">Count</ref>[Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a087d99bc0da49ff3abcfa664a5effbfa" kindref="member">Bucket</ref>[BucketID]]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="2097"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2098"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2099"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>FillBuckets</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2100"><highlight class="normal"></highlight></codeline>
<codeline lineno="2101"><highlight class="normal"></highlight></codeline>
<codeline lineno="2102"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2103"><highlight class="normal"><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="cluster_8cpp_1a8e988f373e1dc7d9a55043f3db047d09" kindref="member">NormalBucket</ref>(<ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>*ParamDesc,</highlight></codeline>
<codeline lineno="2104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>x,</highlight></codeline>
<codeline lineno="2105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>Mean,</highlight></codeline>
<codeline lineno="2106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>StdDev)<sp/>{</highlight></codeline>
<codeline lineno="2107"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2108"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2109"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>ParamDesc<sp/><sp/><sp/>used<sp/>to<sp/>identify<sp/>circular<sp/>dimensions</highlight></codeline>
<codeline lineno="2110"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>x<sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>to<sp/>be<sp/>normalized</highlight></codeline>
<codeline lineno="2111"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Mean<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mean<sp/>of<sp/>normal<sp/>distribution</highlight></codeline>
<codeline lineno="2112"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>StdDev<sp/><sp/><sp/><sp/><sp/><sp/>standard<sp/>deviation<sp/>of<sp/>normal<sp/>distribution</highlight></codeline>
<codeline lineno="2113"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2114"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>determines<sp/>which<sp/>bucket<sp/>x<sp/>falls<sp/>into<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="2115"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>discrete<sp/>normal<sp/>distribution<sp/>defined<sp/>by<sp/>kNormalMean</highlight></codeline>
<codeline lineno="2116"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>and<sp/>kNormalStdDev.<sp/><sp/>x<sp/>values<sp/>which<sp/>exceed<sp/>the<sp/>range<sp/>of</highlight></codeline>
<codeline lineno="2117"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>the<sp/>discrete<sp/>distribution<sp/>are<sp/>clipped.</highlight></codeline>
<codeline lineno="2118"><highlight class="comment"><sp/>**<sp/>Return:</highlight></codeline>
<codeline lineno="2119"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Bucket<sp/>number<sp/>into<sp/>which<sp/>x<sp/>falls</highlight></codeline>
<codeline lineno="2120"><highlight class="comment"><sp/>**<sp/>Exceptions:</highlight></codeline>
<codeline lineno="2121"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>None</highlight></codeline>
<codeline lineno="2122"><highlight class="comment"><sp/>**<sp/>History:</highlight></codeline>
<codeline lineno="2123"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>6/5/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2124"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2125"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>X;</highlight></codeline>
<codeline lineno="2126"><highlight class="normal"></highlight></codeline>
<codeline lineno="2127"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>wraparound<sp/>circular<sp/>parameters<sp/>if<sp/>necessary</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2128"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ParamDesc-&gt;<ref refid="struct_p_a_r_a_m___d_e_s_c_1a55807f1e0be0daba2a33380ea29b2f1d" kindref="member">Circular</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x<sp/>-<sp/>Mean<sp/>&gt;<sp/>ParamDesc-&gt;<ref refid="struct_p_a_r_a_m___d_e_s_c_1a1df92d879d7ec8ea6662e956d27154b5" kindref="member">HalfRange</ref>)</highlight></codeline>
<codeline lineno="2130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>-=<sp/>ParamDesc-&gt;<ref refid="struct_p_a_r_a_m___d_e_s_c_1a031dddcdc1744e777435f8ceea197448" kindref="member">Range</ref>;</highlight></codeline>
<codeline lineno="2131"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x<sp/>-<sp/>Mean<sp/>&lt;<sp/>-ParamDesc-&gt;HalfRange)</highlight></codeline>
<codeline lineno="2132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>+=<sp/>ParamDesc-&gt;<ref refid="struct_p_a_r_a_m___d_e_s_c_1a031dddcdc1744e777435f8ceea197448" kindref="member">Range</ref>;</highlight></codeline>
<codeline lineno="2133"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2134"><highlight class="normal"></highlight></codeline>
<codeline lineno="2135"><highlight class="normal"><sp/><sp/>X<sp/>=<sp/>((x<sp/>-<sp/><ref refid="cluster_8cpp_1ad99e1235a4e63880ab2f72bfdff26e28" kindref="member">Mean</ref>)<sp/>/<sp/>StdDev)<sp/>*<sp/>kNormalStdDev<sp/>+<sp/>kNormalMean;</highlight></codeline>
<codeline lineno="2136"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(X<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="2137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="2138"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(X<sp/>&gt;<sp/>BUCKETTABLESIZE<sp/>-<sp/>1)</highlight></codeline>
<codeline lineno="2139"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref>)<sp/>(BUCKETTABLESIZE<sp/>-<sp/>1));</highlight></codeline>
<codeline lineno="2140"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref>)<sp/>floor((<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>)<sp/>X);</highlight></codeline>
<codeline lineno="2141"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NormalBucket</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2142"><highlight class="normal"></highlight></codeline>
<codeline lineno="2143"><highlight class="normal"></highlight></codeline>
<codeline lineno="2144"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2145"><highlight class="normal"><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="cluster_8cpp_1a43e2cce8f045a700cd6fb0684761cc0c" kindref="member">UniformBucket</ref>(<ref refid="struct_p_a_r_a_m___d_e_s_c" kindref="compound">PARAM_DESC</ref><sp/>*ParamDesc,</highlight></codeline>
<codeline lineno="2146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>x,</highlight></codeline>
<codeline lineno="2147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>Mean,</highlight></codeline>
<codeline lineno="2148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>StdDev)<sp/>{</highlight></codeline>
<codeline lineno="2149"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2150"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2151"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>ParamDesc<sp/><sp/><sp/>used<sp/>to<sp/>identify<sp/>circular<sp/>dimensions</highlight></codeline>
<codeline lineno="2152"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>x<sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>to<sp/>be<sp/>normalized</highlight></codeline>
<codeline lineno="2153"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Mean<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>center<sp/>of<sp/>range<sp/>of<sp/>uniform<sp/>distribution</highlight></codeline>
<codeline lineno="2154"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>StdDev<sp/><sp/><sp/><sp/><sp/><sp/>1/2<sp/>the<sp/>range<sp/>of<sp/>the<sp/>uniform<sp/>distribution</highlight></codeline>
<codeline lineno="2155"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2156"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>determines<sp/>which<sp/>bucket<sp/>x<sp/>falls<sp/>into<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="2157"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>discrete<sp/>uniform<sp/>distribution<sp/>defined<sp/>by</highlight></codeline>
<codeline lineno="2158"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>BUCKETTABLESIZE.<sp/><sp/>x<sp/>values<sp/>which<sp/>exceed<sp/>the<sp/>range<sp/>of</highlight></codeline>
<codeline lineno="2159"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>the<sp/>discrete<sp/>distribution<sp/>are<sp/>clipped.</highlight></codeline>
<codeline lineno="2160"><highlight class="comment"><sp/>**<sp/>Return:</highlight></codeline>
<codeline lineno="2161"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Bucket<sp/>number<sp/>into<sp/>which<sp/>x<sp/>falls</highlight></codeline>
<codeline lineno="2162"><highlight class="comment"><sp/>**<sp/>Exceptions:</highlight></codeline>
<codeline lineno="2163"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>None</highlight></codeline>
<codeline lineno="2164"><highlight class="comment"><sp/>**<sp/>History:</highlight></codeline>
<codeline lineno="2165"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>6/5/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2166"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2167"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>X;</highlight></codeline>
<codeline lineno="2168"><highlight class="normal"></highlight></codeline>
<codeline lineno="2169"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>wraparound<sp/>circular<sp/>parameters<sp/>if<sp/>necessary</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2170"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ParamDesc-&gt;<ref refid="struct_p_a_r_a_m___d_e_s_c_1a55807f1e0be0daba2a33380ea29b2f1d" kindref="member">Circular</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2171"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x<sp/>-<sp/>Mean<sp/>&gt;<sp/>ParamDesc-&gt;<ref refid="struct_p_a_r_a_m___d_e_s_c_1a1df92d879d7ec8ea6662e956d27154b5" kindref="member">HalfRange</ref>)</highlight></codeline>
<codeline lineno="2172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>-=<sp/>ParamDesc-&gt;<ref refid="struct_p_a_r_a_m___d_e_s_c_1a031dddcdc1744e777435f8ceea197448" kindref="member">Range</ref>;</highlight></codeline>
<codeline lineno="2173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x<sp/>-<sp/>Mean<sp/>&lt;<sp/>-ParamDesc-&gt;HalfRange)</highlight></codeline>
<codeline lineno="2174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>+=<sp/>ParamDesc-&gt;<ref refid="struct_p_a_r_a_m___d_e_s_c_1a031dddcdc1744e777435f8ceea197448" kindref="member">Range</ref>;</highlight></codeline>
<codeline lineno="2175"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2176"><highlight class="normal"></highlight></codeline>
<codeline lineno="2177"><highlight class="normal"><sp/><sp/>X<sp/>=<sp/>((x<sp/>-<sp/><ref refid="cluster_8cpp_1ad99e1235a4e63880ab2f72bfdff26e28" kindref="member">Mean</ref>)<sp/>/<sp/>(2<sp/>*<sp/>StdDev)<sp/>*<sp/>BUCKETTABLESIZE<sp/>+<sp/>BUCKETTABLESIZE<sp/>/<sp/>2.0);</highlight></codeline>
<codeline lineno="2178"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(X<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="2179"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="2180"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(X<sp/>&gt;<sp/>BUCKETTABLESIZE<sp/>-<sp/>1)</highlight></codeline>
<codeline lineno="2181"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref>)<sp/>(BUCKETTABLESIZE<sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="2182"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref>)<sp/>floor((<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>)<sp/>X);</highlight></codeline>
<codeline lineno="2183"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>UniformBucket</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2184"><highlight class="normal"></highlight></codeline>
<codeline lineno="2185"><highlight class="normal"></highlight></codeline>
<codeline lineno="2186"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2187"><highlight class="normal"><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/><ref refid="cluster_8cpp_1a4c5b32330cf58e89e2352deb84394332" kindref="member">DistributionOK</ref>(<ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets)<sp/>{</highlight></codeline>
<codeline lineno="2188"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2189"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2190"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Buckets<sp/><sp/><sp/><sp/><sp/>histogram<sp/>data<sp/>to<sp/>perform<sp/>chi-square<sp/>test<sp/>on</highlight></codeline>
<codeline lineno="2191"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2192"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>performs<sp/>a<sp/>chi-square<sp/>goodness<sp/>of<sp/>fit<sp/>test</highlight></codeline>
<codeline lineno="2193"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>on<sp/>the<sp/>histogram<sp/>data<sp/>in<sp/>the<sp/>Buckets<sp/>data<sp/>structure.<sp/><sp/>TRUE</highlight></codeline>
<codeline lineno="2194"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>is<sp/>returned<sp/>if<sp/>the<sp/>histogram<sp/>matches<sp/>the<sp/>probability</highlight></codeline>
<codeline lineno="2195"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>distribution<sp/>which<sp/>was<sp/>specified<sp/>when<sp/>the<sp/>Buckets</highlight></codeline>
<codeline lineno="2196"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>structure<sp/>was<sp/>originally<sp/>created.<sp/><sp/>Otherwise<sp/>FALSE<sp/>is</highlight></codeline>
<codeline lineno="2197"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>returned.</highlight></codeline>
<codeline lineno="2198"><highlight class="comment"><sp/>**<sp/>Return:</highlight></codeline>
<codeline lineno="2199"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>TRUE<sp/>if<sp/>samples<sp/>match<sp/>distribution,<sp/>FALSE<sp/>otherwise</highlight></codeline>
<codeline lineno="2200"><highlight class="comment"><sp/>**<sp/>Exceptions:</highlight></codeline>
<codeline lineno="2201"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>None</highlight></codeline>
<codeline lineno="2202"><highlight class="comment"><sp/>**<sp/>History:</highlight></codeline>
<codeline lineno="2203"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>6/5/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2204"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2205"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>FrequencyDifference;</highlight></codeline>
<codeline lineno="2206"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>TotalDifference;</highlight></codeline>
<codeline lineno="2207"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="2208"><highlight class="normal"></highlight></codeline>
<codeline lineno="2209"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>how<sp/>well<sp/>the<sp/>histogram<sp/>matches<sp/>the<sp/>expected<sp/>histogram</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2210"><highlight class="normal"><sp/><sp/>TotalDifference<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="2211"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="2212"><highlight class="normal"><sp/><sp/><sp/><sp/>FrequencyDifference<sp/>=<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a0b281b83beb3b9c450eeec5c9f4ec763" kindref="member">Count</ref>[i]<sp/>-<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a4002c4c85553bc88efee6395fe803026" kindref="member">ExpectedCount</ref>[i];</highlight></codeline>
<codeline lineno="2213"><highlight class="normal"><sp/><sp/><sp/><sp/>TotalDifference<sp/>+=<sp/>(FrequencyDifference<sp/>*<sp/>FrequencyDifference)<sp/>/</highlight></codeline>
<codeline lineno="2214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a4002c4c85553bc88efee6395fe803026" kindref="member">ExpectedCount</ref>[i];</highlight></codeline>
<codeline lineno="2215"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2216"><highlight class="normal"></highlight></codeline>
<codeline lineno="2217"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>test<sp/>to<sp/>see<sp/>if<sp/>the<sp/>difference<sp/>is<sp/>more<sp/>than<sp/>expected</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2218"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(TotalDifference<sp/>&gt;<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a4dedca1b6c939050313aa761b59a0a11" kindref="member">ChiSquared</ref>)</highlight></codeline>
<codeline lineno="2219"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="2220"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2221"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="2222"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>DistributionOK</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2223"><highlight class="normal"></highlight></codeline>
<codeline lineno="2224"><highlight class="normal"></highlight></codeline>
<codeline lineno="2225"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2226"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1aef1b69ed626e557bf84c9c0b18db6b95" kindref="member">FreeStatistics</ref>(<ref refid="struct_s_t_a_t_i_s_t_i_c_s" kindref="compound">STATISTICS</ref><sp/>*Statistics)<sp/>{</highlight></codeline>
<codeline lineno="2227"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2228"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2229"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Statistics<sp/><sp/>pointer<sp/>to<sp/>data<sp/>structure<sp/>to<sp/>be<sp/>freed</highlight></codeline>
<codeline lineno="2230"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2231"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>frees<sp/>the<sp/>memory<sp/>used<sp/>by<sp/>the<sp/>statistics</highlight></codeline>
<codeline lineno="2232"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>data<sp/>structure.</highlight></codeline>
<codeline lineno="2233"><highlight class="comment"><sp/>**<sp/>Return:</highlight></codeline>
<codeline lineno="2234"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>None</highlight></codeline>
<codeline lineno="2235"><highlight class="comment"><sp/>**<sp/>Exceptions:</highlight></codeline>
<codeline lineno="2236"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>None</highlight></codeline>
<codeline lineno="2237"><highlight class="comment"><sp/>**<sp/>History:</highlight></codeline>
<codeline lineno="2238"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>6/5/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2239"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2240"><highlight class="normal"><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref><sp/>(Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a1a87c66cfa2a256ff9b13d5858bf9650" kindref="member">CoVariance</ref>);</highlight></codeline>
<codeline lineno="2241"><highlight class="normal"><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref><sp/>(Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1ae03871d16f8d02e97e24401324565ab5" kindref="member">Min</ref>);</highlight></codeline>
<codeline lineno="2242"><highlight class="normal"><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref><sp/>(Statistics-&gt;<ref refid="struct_s_t_a_t_i_s_t_i_c_s_1a6f553b49759c072107a7c1c5606bbc72" kindref="member">Max</ref>);</highlight></codeline>
<codeline lineno="2243"><highlight class="normal"><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref>(Statistics);</highlight></codeline>
<codeline lineno="2244"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>FreeStatistics</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2245"><highlight class="normal"></highlight></codeline>
<codeline lineno="2246"><highlight class="normal"></highlight></codeline>
<codeline lineno="2247"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2248"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a1afe8a387c2e426eea3e152bb1cdd3e9" kindref="member">FreeBuckets</ref>(<ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*buckets)<sp/>{</highlight></codeline>
<codeline lineno="2249"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2250"><highlight class="comment"><sp/>**<sp/><sp/>Parameters:</highlight></codeline>
<codeline lineno="2251"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/><sp/>buckets<sp/><sp/>pointer<sp/>to<sp/>data<sp/>structure<sp/>to<sp/>be<sp/>freed</highlight></codeline>
<codeline lineno="2252"><highlight class="comment"><sp/>**<sp/><sp/>Operation:</highlight></codeline>
<codeline lineno="2253"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>properly<sp/>frees<sp/>the<sp/>memory<sp/>used<sp/>by<sp/>a<sp/>BUCKETS.</highlight></codeline>
<codeline lineno="2254"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2255"><highlight class="normal"><sp/><sp/><ref refid="emalloc_8cpp_1af846576ae65dc13e49ddc616e17baa27" kindref="member">Efree</ref>(buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a0b281b83beb3b9c450eeec5c9f4ec763" kindref="member">Count</ref>);</highlight></codeline>
<codeline lineno="2256"><highlight class="normal"><sp/><sp/><ref refid="emalloc_8cpp_1af846576ae65dc13e49ddc616e17baa27" kindref="member">Efree</ref>(buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a4002c4c85553bc88efee6395fe803026" kindref="member">ExpectedCount</ref>);</highlight></codeline>
<codeline lineno="2257"><highlight class="normal"><sp/><sp/><ref refid="emalloc_8cpp_1af846576ae65dc13e49ddc616e17baa27" kindref="member">Efree</ref>(buckets);</highlight></codeline>
<codeline lineno="2258"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>FreeBuckets</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2259"><highlight class="normal"></highlight></codeline>
<codeline lineno="2260"><highlight class="normal"></highlight></codeline>
<codeline lineno="2261"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2262"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1ac66b8beb503d71773eba9bc47d386ae8" kindref="member">FreeCluster</ref>(<ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*Cluster)<sp/>{</highlight></codeline>
<codeline lineno="2263"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2264"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2265"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Cluster<sp/><sp/><sp/><sp/><sp/>pointer<sp/>to<sp/>cluster<sp/>to<sp/>be<sp/>freed</highlight></codeline>
<codeline lineno="2266"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2267"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>frees<sp/>the<sp/>memory<sp/>consumed<sp/>by<sp/>the<sp/>specified</highlight></codeline>
<codeline lineno="2268"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>cluster<sp/>and<sp/>all<sp/>of<sp/>its<sp/>subclusters.<sp/><sp/>This<sp/>is<sp/>done<sp/>by</highlight></codeline>
<codeline lineno="2269"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>recursive<sp/>calls<sp/>to<sp/>FreeCluster().</highlight></codeline>
<codeline lineno="2270"><highlight class="comment"><sp/>**<sp/>Return:</highlight></codeline>
<codeline lineno="2271"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>None</highlight></codeline>
<codeline lineno="2272"><highlight class="comment"><sp/>**<sp/>Exceptions:</highlight></codeline>
<codeline lineno="2273"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>None</highlight></codeline>
<codeline lineno="2274"><highlight class="comment"><sp/>**<sp/>History:</highlight></codeline>
<codeline lineno="2275"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>6/6/89,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2276"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2277"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Cluster<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2278"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1ac66b8beb503d71773eba9bc47d386ae8" kindref="member">FreeCluster</ref><sp/>(Cluster-&gt;<ref refid="structsample_1ae6abb40063761a77d4275c79c5c0bb49" kindref="member">Left</ref>);</highlight></codeline>
<codeline lineno="2279"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cluster_8cpp_1ac66b8beb503d71773eba9bc47d386ae8" kindref="member">FreeCluster</ref><sp/>(Cluster-&gt;<ref refid="structsample_1a2d66168da8fd6b92aed011277f54843a" kindref="member">Right</ref>);</highlight></codeline>
<codeline lineno="2280"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref>(Cluster);</highlight></codeline>
<codeline lineno="2281"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2282"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>FreeCluster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2283"><highlight class="normal"></highlight></codeline>
<codeline lineno="2284"><highlight class="normal"></highlight></codeline>
<codeline lineno="2285"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2286"><highlight class="normal"><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/><ref refid="cluster_8cpp_1acfe8f1657aa1e2a4de798d80ab637756" kindref="member">DegreesOfFreedom</ref>(<ref refid="cluster_8h_1ade80fdcd8f2dde57393f56d0cdfaeed0" kindref="member">DISTRIBUTION</ref><sp/>Distribution,<sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>HistogramBuckets)<sp/>{</highlight></codeline>
<codeline lineno="2287"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2288"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2289"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Distribution<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>distribution<sp/>being<sp/>tested<sp/>for</highlight></codeline>
<codeline lineno="2290"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>HistogramBuckets<sp/><sp/><sp/><sp/>number<sp/>of<sp/>buckets<sp/>in<sp/>chi-square<sp/>test</highlight></codeline>
<codeline lineno="2291"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2292"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>computes<sp/>the<sp/>degrees<sp/>of<sp/>freedom<sp/>that<sp/>should</highlight></codeline>
<codeline lineno="2293"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>be<sp/>used<sp/>in<sp/>a<sp/>chi-squared<sp/>test<sp/>with<sp/>the<sp/>specified<sp/>number<sp/>of</highlight></codeline>
<codeline lineno="2294"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>histogram<sp/>buckets.<sp/><sp/>The<sp/>result<sp/>is<sp/>always<sp/>rounded<sp/>up<sp/>to</highlight></codeline>
<codeline lineno="2295"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>the<sp/>next<sp/>even<sp/>number<sp/>so<sp/>that<sp/>the<sp/>value<sp/>of<sp/>chi-squared<sp/>can<sp/>be</highlight></codeline>
<codeline lineno="2296"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>computed<sp/>more<sp/>easily.<sp/><sp/>This<sp/>will<sp/>cause<sp/>the<sp/>value<sp/>of</highlight></codeline>
<codeline lineno="2297"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>chi-squared<sp/>to<sp/>be<sp/>higher<sp/>than<sp/>the<sp/>optimum<sp/>value,<sp/>resulting</highlight></codeline>
<codeline lineno="2298"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>in<sp/>the<sp/>chi-square<sp/>test<sp/>being<sp/>more<sp/>lenient<sp/>than<sp/>optimum.</highlight></codeline>
<codeline lineno="2299"><highlight class="comment"><sp/>**<sp/>Return:<sp/>The<sp/>number<sp/>of<sp/>degrees<sp/>of<sp/>freedom<sp/>for<sp/>a<sp/>chi-square<sp/>test</highlight></codeline>
<codeline lineno="2300"><highlight class="comment"><sp/>**<sp/>Exceptions:<sp/>none</highlight></codeline>
<codeline lineno="2301"><highlight class="comment"><sp/>**<sp/>History:<sp/>Thu<sp/>Aug<sp/><sp/>3<sp/>14:04:18<sp/>1989,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2302"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2303"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="host_8h_1a458fe97f82495945f8071bb3c18d1783" kindref="member">uinT8</ref><sp/>DegreeOffsets[]<sp/>=<sp/>{<sp/>3,<sp/>3,<sp/>1<sp/>};</highlight></codeline>
<codeline lineno="2304"><highlight class="normal"></highlight></codeline>
<codeline lineno="2305"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>AdjustedNumBuckets;</highlight></codeline>
<codeline lineno="2306"><highlight class="normal"></highlight></codeline>
<codeline lineno="2307"><highlight class="normal"><sp/><sp/>AdjustedNumBuckets<sp/>=<sp/>HistogramBuckets<sp/>-<sp/>DegreeOffsets[(int)<sp/>Distribution];</highlight></codeline>
<codeline lineno="2308"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="cluster_8cpp_1a0662f2b2f6ae8b7ed59d9da773c0da35" kindref="member">Odd</ref><sp/>(AdjustedNumBuckets))</highlight></codeline>
<codeline lineno="2309"><highlight class="normal"><sp/><sp/><sp/><sp/>AdjustedNumBuckets++;</highlight></codeline>
<codeline lineno="2310"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(AdjustedNumBuckets);</highlight></codeline>
<codeline lineno="2311"><highlight class="normal"></highlight></codeline>
<codeline lineno="2312"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>DegreesOfFreedom</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2313"><highlight class="normal"></highlight></codeline>
<codeline lineno="2314"><highlight class="normal"></highlight></codeline>
<codeline lineno="2315"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2316"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1af8d341c60c044ac30867d767c6b9b091" kindref="member">NumBucketsMatch</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*arg1,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>BUCKETS<sp/>*Histogram,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*arg2)<sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>uinT16<sp/>*DesiredNumberOfBuckets)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2318"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2319"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2320"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Histogram<sp/><sp/><sp/>current<sp/>histogram<sp/>being<sp/>tested<sp/>for<sp/>a<sp/>match</highlight></codeline>
<codeline lineno="2321"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>DesiredNumberOfBuckets<sp/><sp/>match<sp/>key</highlight></codeline>
<codeline lineno="2322"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2323"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>is<sp/>used<sp/>to<sp/>search<sp/>a<sp/>list<sp/>of<sp/>histogram<sp/>data</highlight></codeline>
<codeline lineno="2324"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>structures<sp/>to<sp/>find<sp/>one<sp/>with<sp/>the<sp/>specified<sp/>number<sp/>of</highlight></codeline>
<codeline lineno="2325"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>buckets.<sp/><sp/>It<sp/>is<sp/>called<sp/>by<sp/>the<sp/>list<sp/>search<sp/>routines.</highlight></codeline>
<codeline lineno="2326"><highlight class="comment"><sp/>**<sp/>Return:<sp/>TRUE<sp/>if<sp/>Histogram<sp/>matches<sp/>DesiredNumberOfBuckets</highlight></codeline>
<codeline lineno="2327"><highlight class="comment"><sp/>**<sp/>Exceptions:<sp/>none</highlight></codeline>
<codeline lineno="2328"><highlight class="comment"><sp/>**<sp/>History:<sp/>Thu<sp/>Aug<sp/><sp/>3<sp/>14:17:33<sp/>1989,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2329"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2330"><highlight class="normal"><sp/><sp/><ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Histogram<sp/>=<sp/>(<ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*)<sp/>arg1;</highlight></codeline>
<codeline lineno="2331"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>*DesiredNumberOfBuckets<sp/>=<sp/>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>*)<sp/>arg2;</highlight></codeline>
<codeline lineno="2332"><highlight class="normal"></highlight></codeline>
<codeline lineno="2333"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(*DesiredNumberOfBuckets<sp/>==<sp/>Histogram-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref>);</highlight></codeline>
<codeline lineno="2334"><highlight class="normal"></highlight></codeline>
<codeline lineno="2335"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NumBucketsMatch</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2336"><highlight class="normal"></highlight></codeline>
<codeline lineno="2337"><highlight class="normal"></highlight></codeline>
<codeline lineno="2338"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2339"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a7f39be063580c1c7c5566faf0398dfb0" kindref="member">ListEntryMatch</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*arg1,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//ListNode</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*arg2)<sp/>{<sp/><sp/></highlight><highlight class="comment">//Key</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2341"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2342"><highlight class="comment"><sp/>**<sp/>Parameters:<sp/>none</highlight></codeline>
<codeline lineno="2343"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2344"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>is<sp/>used<sp/>to<sp/>search<sp/>a<sp/>list<sp/>for<sp/>a<sp/>list<sp/>node</highlight></codeline>
<codeline lineno="2345"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>whose<sp/>contents<sp/>match<sp/>Key.<sp/><sp/>It<sp/>is<sp/>called<sp/>by<sp/>the<sp/>list</highlight></codeline>
<codeline lineno="2346"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>delete_d<sp/>routine.</highlight></codeline>
<codeline lineno="2347"><highlight class="comment"><sp/>**<sp/>Return:<sp/>TRUE<sp/>if<sp/>ListNode<sp/>matches<sp/>Key</highlight></codeline>
<codeline lineno="2348"><highlight class="comment"><sp/>**<sp/>Exceptions:<sp/>none</highlight></codeline>
<codeline lineno="2349"><highlight class="comment"><sp/>**<sp/>History:<sp/>Thu<sp/>Aug<sp/><sp/>3<sp/>14:23:58<sp/>1989,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2350"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2351"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(arg1<sp/>==<sp/>arg2);</highlight></codeline>
<codeline lineno="2352"><highlight class="normal"></highlight></codeline>
<codeline lineno="2353"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ListEntryMatch</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2354"><highlight class="normal"></highlight></codeline>
<codeline lineno="2355"><highlight class="normal"></highlight></codeline>
<codeline lineno="2356"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2357"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a02e72bde5b9d967258769d4a75f07e46" kindref="member">AdjustBuckets</ref>(<ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets,<sp/><ref refid="host_8h_1afc8530b39ebe0b6df1e19159d2508d15" kindref="member">uinT32</ref><sp/>NewSampleCount)<sp/>{</highlight></codeline>
<codeline lineno="2358"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2359"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2360"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Buckets<sp/><sp/><sp/><sp/><sp/>histogram<sp/>data<sp/>structure<sp/>to<sp/>adjust</highlight></codeline>
<codeline lineno="2361"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>NewSampleCount<sp/><sp/>new<sp/>sample<sp/>count<sp/>to<sp/>adjust<sp/>to</highlight></codeline>
<codeline lineno="2362"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2363"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>multiplies<sp/>each<sp/>ExpectedCount<sp/>histogram<sp/>entry</highlight></codeline>
<codeline lineno="2364"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>by<sp/>NewSampleCount/OldSampleCount<sp/>so<sp/>that<sp/>the<sp/>histogram</highlight></codeline>
<codeline lineno="2365"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>is<sp/>now<sp/>adjusted<sp/>to<sp/>the<sp/>new<sp/>sample<sp/>count.</highlight></codeline>
<codeline lineno="2366"><highlight class="comment"><sp/>**<sp/>Return:<sp/>none</highlight></codeline>
<codeline lineno="2367"><highlight class="comment"><sp/>**<sp/>Exceptions:<sp/>none</highlight></codeline>
<codeline lineno="2368"><highlight class="comment"><sp/>**<sp/>History:<sp/>Thu<sp/>Aug<sp/><sp/>3<sp/>14:31:14<sp/>1989,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2369"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2370"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="2371"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>AdjustFactor;</highlight></codeline>
<codeline lineno="2372"><highlight class="normal"></highlight></codeline>
<codeline lineno="2373"><highlight class="normal"><sp/><sp/>AdjustFactor<sp/>=<sp/>(((<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>)<sp/>NewSampleCount)<sp/>/</highlight></codeline>
<codeline lineno="2374"><highlight class="normal"><sp/><sp/><sp/><sp/>((<ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref>)<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a8e352450eb27c8a017a037f71796b402" kindref="member">SampleCount</ref>));</highlight></codeline>
<codeline lineno="2375"><highlight class="normal"></highlight></codeline>
<codeline lineno="2376"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="2377"><highlight class="normal"><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a4002c4c85553bc88efee6395fe803026" kindref="member">ExpectedCount</ref>[i]<sp/>*=<sp/>AdjustFactor;</highlight></codeline>
<codeline lineno="2378"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2379"><highlight class="normal"></highlight></codeline>
<codeline lineno="2380"><highlight class="normal"><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a8e352450eb27c8a017a037f71796b402" kindref="member">SampleCount</ref><sp/>=<sp/>NewSampleCount;</highlight></codeline>
<codeline lineno="2381"><highlight class="normal"></highlight></codeline>
<codeline lineno="2382"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>AdjustBuckets</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2383"><highlight class="normal"></highlight></codeline>
<codeline lineno="2384"><highlight class="normal"></highlight></codeline>
<codeline lineno="2385"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2386"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a0f9ec282a0fa768a4b5bd0d5efaca7d2" kindref="member">InitBuckets</ref>(<ref refid="struct_b_u_c_k_e_t_s" kindref="compound">BUCKETS</ref><sp/>*Buckets)<sp/>{</highlight></codeline>
<codeline lineno="2387"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2388"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2389"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Buckets<sp/><sp/><sp/><sp/><sp/>histogram<sp/>data<sp/>structure<sp/>to<sp/>init</highlight></codeline>
<codeline lineno="2390"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2391"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>sets<sp/>the<sp/>bucket<sp/>counts<sp/>in<sp/>the<sp/>specified<sp/>histogram</highlight></codeline>
<codeline lineno="2392"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>to<sp/>zero.</highlight></codeline>
<codeline lineno="2393"><highlight class="comment"><sp/>**<sp/>Return:<sp/>none</highlight></codeline>
<codeline lineno="2394"><highlight class="comment"><sp/>**<sp/>Exceptions:<sp/>none</highlight></codeline>
<codeline lineno="2395"><highlight class="comment"><sp/>**<sp/>History:<sp/>Thu<sp/>Aug<sp/><sp/>3<sp/>14:31:14<sp/>1989,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2396"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2397"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="2398"><highlight class="normal"></highlight></codeline>
<codeline lineno="2399"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a291d5393aba4a5f429ce30913ca6b96a" kindref="member">NumberOfBuckets</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="2400"><highlight class="normal"><sp/><sp/><sp/><sp/>Buckets-&gt;<ref refid="struct_b_u_c_k_e_t_s_1a0b281b83beb3b9c450eeec5c9f4ec763" kindref="member">Count</ref>[i]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2401"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2402"><highlight class="normal"></highlight></codeline>
<codeline lineno="2403"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>InitBuckets</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2404"><highlight class="normal"></highlight></codeline>
<codeline lineno="2405"><highlight class="normal"></highlight></codeline>
<codeline lineno="2406"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2407"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1ad39bd07ace019e3862769098fae02f93" kindref="member">AlphaMatch</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*arg1,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//CHISTRUCT<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*ChiStruct,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*arg2)<sp/>{<sp/><sp/></highlight><highlight class="comment">//CHISTRUCT<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*SearchKey)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2409"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2410"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2411"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>ChiStruct<sp/><sp/><sp/>chi-squared<sp/>struct<sp/>being<sp/>tested<sp/>for<sp/>a<sp/>match</highlight></codeline>
<codeline lineno="2412"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>SearchKey<sp/><sp/><sp/>chi-squared<sp/>struct<sp/>that<sp/>is<sp/>the<sp/>search<sp/>key</highlight></codeline>
<codeline lineno="2413"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2414"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>is<sp/>used<sp/>to<sp/>search<sp/>a<sp/>list<sp/>of<sp/>structures<sp/>which</highlight></codeline>
<codeline lineno="2415"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>hold<sp/>pre-computed<sp/>chi-squared<sp/>values<sp/>for<sp/>a<sp/>chi-squared</highlight></codeline>
<codeline lineno="2416"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>value<sp/>whose<sp/>corresponding<sp/>alpha<sp/>field<sp/>matches<sp/>the<sp/>alpha</highlight></codeline>
<codeline lineno="2417"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>field<sp/>of<sp/>SearchKey.</highlight></codeline>
<codeline lineno="2418"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>It<sp/>is<sp/>called<sp/>by<sp/>the<sp/>list<sp/>search<sp/>routines.</highlight></codeline>
<codeline lineno="2419"><highlight class="comment"><sp/>**<sp/>Return:<sp/>TRUE<sp/>if<sp/>ChiStruct&apos;s<sp/>Alpha<sp/>matches<sp/>SearchKey&apos;s<sp/>Alpha</highlight></codeline>
<codeline lineno="2420"><highlight class="comment"><sp/>**<sp/>Exceptions:<sp/>none</highlight></codeline>
<codeline lineno="2421"><highlight class="comment"><sp/>**<sp/>History:<sp/>Thu<sp/>Aug<sp/><sp/>3<sp/>14:17:33<sp/>1989,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2422"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2423"><highlight class="normal"><sp/><sp/><ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*ChiStruct<sp/>=<sp/>(<ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*)<sp/>arg1;</highlight></codeline>
<codeline lineno="2424"><highlight class="normal"><sp/><sp/><ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*SearchKey<sp/>=<sp/>(<ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*)<sp/>arg2;</highlight></codeline>
<codeline lineno="2425"><highlight class="normal"></highlight></codeline>
<codeline lineno="2426"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(ChiStruct-&gt;<ref refid="struct_c_h_i_s_t_r_u_c_t_1a58a4707e32861b244d471e6d152fe43a" kindref="member">Alpha</ref><sp/>==<sp/>SearchKey-&gt;<ref refid="struct_c_h_i_s_t_r_u_c_t_1a58a4707e32861b244d471e6d152fe43a" kindref="member">Alpha</ref>);</highlight></codeline>
<codeline lineno="2427"><highlight class="normal"></highlight></codeline>
<codeline lineno="2428"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>AlphaMatch</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2429"><highlight class="normal"></highlight></codeline>
<codeline lineno="2430"><highlight class="normal"></highlight></codeline>
<codeline lineno="2431"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2432"><highlight class="normal"><ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*<ref refid="cluster_8cpp_1ac16f25cf71bcb2632f695f55fb9a5980" kindref="member">NewChiStruct</ref>(<ref refid="host_8h_1acb2dfad543247740dab87d31bb49dfff" kindref="member">uinT16</ref><sp/>DegreesOfFreedom,<sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Alpha)<sp/>{</highlight></codeline>
<codeline lineno="2433"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2434"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2435"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>DegreesOfFreedom<sp/><sp/><sp/><sp/>degrees<sp/>of<sp/>freedom<sp/>for<sp/>new<sp/>chi<sp/>value</highlight></codeline>
<codeline lineno="2436"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Alpha<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>confidence<sp/>level<sp/>for<sp/>new<sp/>chi<sp/>value</highlight></codeline>
<codeline lineno="2437"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2438"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>allocates<sp/>a<sp/>new<sp/>data<sp/>structure<sp/>which<sp/>is<sp/>used</highlight></codeline>
<codeline lineno="2439"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>to<sp/>hold<sp/>a<sp/>chi-squared<sp/>value<sp/>along<sp/>with<sp/>its<sp/>associated</highlight></codeline>
<codeline lineno="2440"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>number<sp/>of<sp/>degrees<sp/>of<sp/>freedom<sp/>and<sp/>alpha<sp/>value.</highlight></codeline>
<codeline lineno="2441"><highlight class="comment"><sp/>**<sp/>Return:<sp/>none</highlight></codeline>
<codeline lineno="2442"><highlight class="comment"><sp/>**<sp/>Exceptions:<sp/>none</highlight></codeline>
<codeline lineno="2443"><highlight class="comment"><sp/>**<sp/>History:<sp/>Fri<sp/>Aug<sp/><sp/>4<sp/>11:04:59<sp/>1989,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2444"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2445"><highlight class="normal"><sp/><sp/><ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*<ref refid="cluster_8cpp_1ac16f25cf71bcb2632f695f55fb9a5980" kindref="member">NewChiStruct</ref>;</highlight></codeline>
<codeline lineno="2446"><highlight class="normal"></highlight></codeline>
<codeline lineno="2447"><highlight class="normal"><sp/><sp/>NewChiStruct<sp/>=<sp/>(<ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref>));</highlight></codeline>
<codeline lineno="2448"><highlight class="normal"><sp/><sp/>NewChiStruct-&gt;<ref refid="struct_c_h_i_s_t_r_u_c_t_1a15a3b870d88bb0fcedd7accc60d195c7" kindref="member">DegreesOfFreedom</ref><sp/>=<sp/><ref refid="cluster_8cpp_1acfe8f1657aa1e2a4de798d80ab637756" kindref="member">DegreesOfFreedom</ref>;</highlight></codeline>
<codeline lineno="2449"><highlight class="normal"><sp/><sp/>NewChiStruct-&gt;<ref refid="struct_c_h_i_s_t_r_u_c_t_1a58a4707e32861b244d471e6d152fe43a" kindref="member">Alpha</ref><sp/>=<sp/>Alpha;</highlight></codeline>
<codeline lineno="2450"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(NewChiStruct);</highlight></codeline>
<codeline lineno="2451"><highlight class="normal"></highlight></codeline>
<codeline lineno="2452"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>NewChiStruct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2453"><highlight class="normal"></highlight></codeline>
<codeline lineno="2454"><highlight class="normal"></highlight></codeline>
<codeline lineno="2455"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2456"><highlight class="normal"><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref></highlight></codeline>
<codeline lineno="2457"><highlight class="normal"><ref refid="cluster_8cpp_1a8098e057438e6f07276dd005f28ef13c" kindref="member">Solve</ref><sp/>(<ref refid="cluster_8cpp_1a170fa76dec6514a98bb069c4b9652f2d" kindref="member">SOLVEFUNC</ref><sp/>Function,</highlight></codeline>
<codeline lineno="2458"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*FunctionParams,<sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>InitialGuess,<sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Accuracy)</highlight></codeline>
<codeline lineno="2459"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2460"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2461"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Function<sp/><sp/><sp/><sp/>function<sp/>whose<sp/>zero<sp/>is<sp/>to<sp/>be<sp/>found</highlight></codeline>
<codeline lineno="2462"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>FunctionParams<sp/><sp/>arbitrary<sp/>data<sp/>to<sp/>pass<sp/>to<sp/>function</highlight></codeline>
<codeline lineno="2463"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>InitialGuess<sp/><sp/><sp/><sp/>point<sp/>to<sp/>start<sp/>solution<sp/>search<sp/>at</highlight></codeline>
<codeline lineno="2464"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Accuracy<sp/><sp/><sp/><sp/>maximum<sp/>allowed<sp/>error</highlight></codeline>
<codeline lineno="2465"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2466"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>attempts<sp/>to<sp/>find<sp/>an<sp/>x<sp/>value<sp/>at<sp/>which<sp/>Function</highlight></codeline>
<codeline lineno="2467"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>goes<sp/>to<sp/>zero<sp/>(i.e.<sp/>a<sp/>root<sp/>of<sp/>the<sp/>function<sp/>).<sp/><sp/>It<sp/>will<sp/>only</highlight></codeline>
<codeline lineno="2468"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>work<sp/>correctly<sp/>if<sp/>a<sp/>solution<sp/>actually<sp/>exists<sp/>and<sp/>there</highlight></codeline>
<codeline lineno="2469"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>are<sp/>no<sp/>extrema<sp/>between<sp/>the<sp/>solution<sp/>and<sp/>the<sp/>InitialGuess.</highlight></codeline>
<codeline lineno="2470"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>The<sp/>algorithms<sp/>used<sp/>are<sp/>extremely<sp/>primitive.</highlight></codeline>
<codeline lineno="2471"><highlight class="comment"><sp/>**<sp/>Return:<sp/>Solution<sp/>of<sp/>function<sp/>(<sp/>x<sp/>for<sp/>which<sp/>f(x)<sp/>=<sp/>0<sp/>).</highlight></codeline>
<codeline lineno="2472"><highlight class="comment"><sp/>**<sp/>Exceptions:<sp/>none</highlight></codeline>
<codeline lineno="2473"><highlight class="comment"><sp/>**<sp/>History:<sp/>Fri<sp/>Aug<sp/><sp/>4<sp/>11:08:59<sp/>1989,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2474"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2475"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>INITIALDELTA<sp/><sp/><sp/><sp/>0.1</highlight></codeline>
<codeline lineno="2476"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/><sp/>DELTARATIO<sp/><sp/><sp/><sp/><sp/>0.1</highlight></codeline>
<codeline lineno="2477"><highlight class="preprocessor"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="2478"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>x;</highlight></codeline>
<codeline lineno="2479"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>;</highlight></codeline>
<codeline lineno="2480"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Slope;</highlight></codeline>
<codeline lineno="2481"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Delta;</highlight></codeline>
<codeline lineno="2482"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>NewDelta;</highlight></codeline>
<codeline lineno="2483"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>xDelta;</highlight></codeline>
<codeline lineno="2484"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>LastPosX,<sp/>LastNegX;</highlight></codeline>
<codeline lineno="2485"><highlight class="normal"></highlight></codeline>
<codeline lineno="2486"><highlight class="normal"><sp/><sp/>x<sp/>=<sp/>InitialGuess;</highlight></codeline>
<codeline lineno="2487"><highlight class="normal"><sp/><sp/>Delta<sp/>=<sp/><ref refid="cluster_8cpp_1a3ac44273f534b72f12afd0d6560bbbed" kindref="member">INITIALDELTA</ref>;</highlight></codeline>
<codeline lineno="2488"><highlight class="normal"><sp/><sp/>LastPosX<sp/>=<sp/><ref refid="host_8h_1a9adcee815220ec9db98062213806ed04" kindref="member">MAX_FLOAT32</ref>;</highlight></codeline>
<codeline lineno="2489"><highlight class="normal"><sp/><sp/>LastNegX<sp/>=<sp/>-<ref refid="host_8h_1a9adcee815220ec9db98062213806ed04" kindref="member">MAX_FLOAT32</ref>;</highlight></codeline>
<codeline lineno="2490"><highlight class="normal"><sp/><sp/>f<sp/>=<sp/>(*Function)<sp/>((<ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*)<sp/>FunctionParams,<sp/>x);</highlight></codeline>
<codeline lineno="2491"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="cluster_8cpp_1a060002a5aeab470cb24c8343daa1db08" kindref="member">Abs</ref><sp/>(LastPosX<sp/>-<sp/>LastNegX)<sp/>&gt;<sp/>Accuracy)<sp/>{</highlight></codeline>
<codeline lineno="2492"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>keep<sp/>track<sp/>of<sp/>outer<sp/>bounds<sp/>of<sp/>current<sp/>estimate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2493"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref><sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="2494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>LastNegX<sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="2495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>LastPosX<sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="2497"><highlight class="normal"></highlight></codeline>
<codeline lineno="2498"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>approx.<sp/>slope<sp/>of<sp/>f(x)<sp/>at<sp/>the<sp/>current<sp/>point</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2499"><highlight class="normal"><sp/><sp/><sp/><sp/>Slope<sp/>=</highlight></codeline>
<codeline lineno="2500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>((*Function)<sp/>((<ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*)<sp/>FunctionParams,<sp/>x<sp/>+<sp/>Delta)<sp/>-<sp/><ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>)<sp/>/<sp/>Delta;</highlight></codeline>
<codeline lineno="2501"><highlight class="normal"></highlight></codeline>
<codeline lineno="2502"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>next<sp/>solution<sp/>guess<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2503"><highlight class="normal"><sp/><sp/><sp/><sp/>xDelta<sp/>=<sp/><ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref><sp/>/<sp/>Slope;</highlight></codeline>
<codeline lineno="2504"><highlight class="normal"><sp/><sp/><sp/><sp/>x<sp/>-=<sp/>xDelta;</highlight></codeline>
<codeline lineno="2505"><highlight class="normal"></highlight></codeline>
<codeline lineno="2506"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>reduce<sp/>the<sp/>delta<sp/>used<sp/>for<sp/>computing<sp/>slope<sp/>to<sp/>be<sp/>a<sp/>fraction<sp/>of</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2507"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//the<sp/>amount<sp/>moved<sp/>to<sp/>get<sp/>to<sp/>the<sp/>new<sp/>guess</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2508"><highlight class="normal"><sp/><sp/><sp/><sp/>NewDelta<sp/>=<sp/><ref refid="cluster_8cpp_1a060002a5aeab470cb24c8343daa1db08" kindref="member">Abs</ref><sp/>(xDelta)<sp/>*<sp/><ref refid="cluster_8cpp_1a4a4390b86d05eddc0eb81787727debf8" kindref="member">DELTARATIO</ref>;</highlight></codeline>
<codeline lineno="2509"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(NewDelta<sp/>&lt;<sp/>Delta)</highlight></codeline>
<codeline lineno="2510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Delta<sp/>=<sp/>NewDelta;</highlight></codeline>
<codeline lineno="2511"><highlight class="normal"></highlight></codeline>
<codeline lineno="2512"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>the<sp/>value<sp/>of<sp/>the<sp/>function<sp/>at<sp/>the<sp/>new<sp/>guess</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2513"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref><sp/>=<sp/>(*Function)<sp/>((<ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*)<sp/>FunctionParams,<sp/>x);</highlight></codeline>
<codeline lineno="2514"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2515"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(x);</highlight></codeline>
<codeline lineno="2516"><highlight class="normal"></highlight></codeline>
<codeline lineno="2517"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Solve</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2518"><highlight class="normal"></highlight></codeline>
<codeline lineno="2519"><highlight class="normal"></highlight></codeline>
<codeline lineno="2520"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2521"><highlight class="normal"><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/><ref refid="cluster_8cpp_1a444724ad6aa7b59e010c1089af12b0b0" kindref="member">ChiArea</ref>(<ref refid="struct_c_h_i_s_t_r_u_c_t" kindref="compound">CHISTRUCT</ref><sp/>*ChiParams,<sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>x)<sp/>{</highlight></codeline>
<codeline lineno="2522"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2523"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2524"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>ChiParams<sp/><sp/><sp/>contains<sp/>degrees<sp/>of<sp/>freedom<sp/>and<sp/>alpha</highlight></codeline>
<codeline lineno="2525"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>x<sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>of<sp/>chi-squared<sp/>to<sp/>evaluate</highlight></codeline>
<codeline lineno="2526"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2527"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>computes<sp/>the<sp/>area<sp/>under<sp/>a<sp/>chi<sp/>density<sp/>curve</highlight></codeline>
<codeline lineno="2528"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>from<sp/>0<sp/>to<sp/>x,<sp/>minus<sp/>the<sp/>desired<sp/>area<sp/>under<sp/>the<sp/>curve.<sp/><sp/>The</highlight></codeline>
<codeline lineno="2529"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>number<sp/>of<sp/>degrees<sp/>of<sp/>freedom<sp/>of<sp/>the<sp/>chi<sp/>curve<sp/>is<sp/>specified</highlight></codeline>
<codeline lineno="2530"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>in<sp/>the<sp/>ChiParams<sp/>structure.<sp/><sp/>The<sp/>desired<sp/>area<sp/>is<sp/>also</highlight></codeline>
<codeline lineno="2531"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>specified<sp/>in<sp/>the<sp/>ChiParams<sp/>structure<sp/>as<sp/>Alpha<sp/>(<sp/>or<sp/>1<sp/>minus</highlight></codeline>
<codeline lineno="2532"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>the<sp/>desired<sp/>area<sp/>).<sp/><sp/>This<sp/>routine<sp/>is<sp/>intended<sp/>to<sp/>be<sp/>passed</highlight></codeline>
<codeline lineno="2533"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>to<sp/>the<sp/>Solve()<sp/>function<sp/>to<sp/>find<sp/>the<sp/>value<sp/>of<sp/>chi-squared</highlight></codeline>
<codeline lineno="2534"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>which<sp/>will<sp/>yield<sp/>a<sp/>desired<sp/>area<sp/>under<sp/>the<sp/>right<sp/>tail<sp/>of</highlight></codeline>
<codeline lineno="2535"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>the<sp/>chi<sp/>density<sp/>curve.<sp/><sp/>The<sp/>function<sp/>will<sp/>only<sp/>work<sp/>for</highlight></codeline>
<codeline lineno="2536"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>even<sp/>degrees<sp/>of<sp/>freedom.<sp/><sp/>The<sp/>equations<sp/>are<sp/>based<sp/>on</highlight></codeline>
<codeline lineno="2537"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>integrating<sp/>the<sp/>chi<sp/>density<sp/>curve<sp/>in<sp/>parts<sp/>to<sp/>obtain</highlight></codeline>
<codeline lineno="2538"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>a<sp/>series<sp/>that<sp/>can<sp/>be<sp/>used<sp/>to<sp/>compute<sp/>the<sp/>area<sp/>under<sp/>the</highlight></codeline>
<codeline lineno="2539"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>curve.</highlight></codeline>
<codeline lineno="2540"><highlight class="comment"><sp/>**<sp/>Return:<sp/>Error<sp/>between<sp/>actual<sp/>and<sp/>desired<sp/>area<sp/>under<sp/>the<sp/>chi<sp/>curve.</highlight></codeline>
<codeline lineno="2541"><highlight class="comment"><sp/>**<sp/>Exceptions:<sp/>none</highlight></codeline>
<codeline lineno="2542"><highlight class="comment"><sp/>**<sp/>History:<sp/>Fri<sp/>Aug<sp/><sp/>4<sp/>12:48:41<sp/>1989,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2543"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2544"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>N;</highlight></codeline>
<codeline lineno="2545"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>SeriesTotal;</highlight></codeline>
<codeline lineno="2546"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>Denominator;</highlight></codeline>
<codeline lineno="2547"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aa8336782d864ba03efadb73a51260961" kindref="member">FLOAT64</ref><sp/>PowerOfx;</highlight></codeline>
<codeline lineno="2548"><highlight class="normal"></highlight></codeline>
<codeline lineno="2549"><highlight class="normal"><sp/><sp/>N<sp/>=<sp/>ChiParams-&gt;<ref refid="struct_c_h_i_s_t_r_u_c_t_1a15a3b870d88bb0fcedd7accc60d195c7" kindref="member">DegreesOfFreedom</ref><sp/>/<sp/>2<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="2550"><highlight class="normal"><sp/><sp/>SeriesTotal<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2551"><highlight class="normal"><sp/><sp/>Denominator<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2552"><highlight class="normal"><sp/><sp/>PowerOfx<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2553"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>1;<sp/>i<sp/>&lt;=<sp/>N;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="2554"><highlight class="normal"><sp/><sp/><sp/><sp/>Denominator<sp/>*=<sp/>2<sp/>*<sp/>i;</highlight></codeline>
<codeline lineno="2555"><highlight class="normal"><sp/><sp/><sp/><sp/>PowerOfx<sp/>*=<sp/>x;</highlight></codeline>
<codeline lineno="2556"><highlight class="normal"><sp/><sp/><sp/><sp/>SeriesTotal<sp/>+=<sp/>PowerOfx<sp/>/<sp/>Denominator;</highlight></codeline>
<codeline lineno="2557"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2558"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((SeriesTotal<sp/>*<sp/>exp<sp/>(-0.5<sp/>*<sp/>x))<sp/>-<sp/>ChiParams-&gt;<ref refid="struct_c_h_i_s_t_r_u_c_t_1a58a4707e32861b244d471e6d152fe43a" kindref="member">Alpha</ref>);</highlight></codeline>
<codeline lineno="2559"><highlight class="normal"></highlight></codeline>
<codeline lineno="2560"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ChiArea</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2561"><highlight class="normal"></highlight></codeline>
<codeline lineno="2562"><highlight class="normal"></highlight></codeline>
<codeline lineno="2563"><highlight class="normal"></highlight><highlight class="comment">//---------------------------------------------------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2564"><highlight class="normal"><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></highlight></codeline>
<codeline lineno="2565"><highlight class="normal"><ref refid="cluster_8cpp_1a39583ff2f6db38f0c2e26f7ad87f2c0c" kindref="member">MultipleCharSamples</ref><sp/>(<ref refid="struct_c_l_u_s_t_e_r_e_r" kindref="compound">CLUSTERER</ref><sp/>*<sp/>Clusterer,</highlight></codeline>
<codeline lineno="2566"><highlight class="normal"><ref refid="structsample" kindref="compound">CLUSTER</ref><sp/>*<sp/>Cluster,<sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>MaxIllegal)</highlight></codeline>
<codeline lineno="2567"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2568"><highlight class="comment"><sp/>**<sp/>Parameters:</highlight></codeline>
<codeline lineno="2569"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Clusterer<sp/><sp/><sp/>data<sp/>structure<sp/>holding<sp/>cluster<sp/>tree</highlight></codeline>
<codeline lineno="2570"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Cluster<sp/><sp/><sp/><sp/><sp/>cluster<sp/>containing<sp/>samples<sp/>to<sp/>be<sp/>tested</highlight></codeline>
<codeline lineno="2571"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>MaxIllegal<sp/><sp/>max<sp/>percentage<sp/>of<sp/>samples<sp/>allowed<sp/>to<sp/>have</highlight></codeline>
<codeline lineno="2572"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>more<sp/>than<sp/>1<sp/>feature<sp/>in<sp/>the<sp/>cluster</highlight></codeline>
<codeline lineno="2573"><highlight class="comment"><sp/>**<sp/>Operation:</highlight></codeline>
<codeline lineno="2574"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>This<sp/>routine<sp/>looks<sp/>at<sp/>all<sp/>samples<sp/>in<sp/>the<sp/>specified<sp/>cluster.</highlight></codeline>
<codeline lineno="2575"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>It<sp/>computes<sp/>a<sp/>running<sp/>estimate<sp/>of<sp/>the<sp/>percentage<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="2576"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>charaters<sp/>which<sp/>have<sp/>more<sp/>than<sp/>1<sp/>sample<sp/>in<sp/>the<sp/>cluster.</highlight></codeline>
<codeline lineno="2577"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>When<sp/>this<sp/>percentage<sp/>exceeds<sp/>MaxIllegal,<sp/>TRUE<sp/>is<sp/>returned.</highlight></codeline>
<codeline lineno="2578"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>Otherwise<sp/>FALSE<sp/>is<sp/>returned.<sp/><sp/>The<sp/>CharID</highlight></codeline>
<codeline lineno="2579"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>fields<sp/>must<sp/>contain<sp/>integers<sp/>which<sp/>identify<sp/>the<sp/>training</highlight></codeline>
<codeline lineno="2580"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>characters<sp/>which<sp/>were<sp/>used<sp/>to<sp/>generate<sp/>the<sp/>sample.<sp/><sp/>One</highlight></codeline>
<codeline lineno="2581"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>integer<sp/>is<sp/>used<sp/>for<sp/>each<sp/>sample.<sp/><sp/>The<sp/>NumChar<sp/>field<sp/>in</highlight></codeline>
<codeline lineno="2582"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>the<sp/>Clusterer<sp/>must<sp/>contain<sp/>the<sp/>number<sp/>of<sp/>characters<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="2583"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>training<sp/>set.<sp/><sp/>All<sp/>CharID<sp/>fields<sp/>must<sp/>be<sp/>between<sp/>0<sp/>and</highlight></codeline>
<codeline lineno="2584"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>NumChar-1.<sp/><sp/>The<sp/>main<sp/>function<sp/>of<sp/>this<sp/>routine<sp/>is<sp/>to<sp/>help</highlight></codeline>
<codeline lineno="2585"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>identify<sp/>clusters<sp/>which<sp/>need<sp/>to<sp/>be<sp/>split<sp/>further,<sp/>i.e.<sp/>if</highlight></codeline>
<codeline lineno="2586"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>numerous<sp/>training<sp/>characters<sp/>have<sp/>2<sp/>or<sp/>more<sp/>features<sp/>which<sp/>are</highlight></codeline>
<codeline lineno="2587"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>contained<sp/>in<sp/>the<sp/>same<sp/>cluster,<sp/>then<sp/>the<sp/>cluster<sp/>should<sp/>be</highlight></codeline>
<codeline lineno="2588"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>split.</highlight></codeline>
<codeline lineno="2589"><highlight class="comment"><sp/>**<sp/>Return:<sp/>TRUE<sp/>if<sp/>the<sp/>cluster<sp/>should<sp/>be<sp/>split,<sp/>FALSE<sp/>otherwise.</highlight></codeline>
<codeline lineno="2590"><highlight class="comment"><sp/>**<sp/>Exceptions:<sp/>none</highlight></codeline>
<codeline lineno="2591"><highlight class="comment"><sp/>**<sp/>History:<sp/>Wed<sp/>Aug<sp/>30<sp/>11:13:05<sp/>1989,<sp/>DSJ,<sp/>Created.</highlight></codeline>
<codeline lineno="2592"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/>2/22/90,<sp/>DSJ,<sp/>Added<sp/>MaxIllegal<sp/>control<sp/>rather<sp/>than<sp/>always</highlight></codeline>
<codeline lineno="2593"><highlight class="comment"><sp/>**<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>splitting<sp/>illegal<sp/>clusters.</highlight></codeline>
<codeline lineno="2594"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2595"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ILLEGAL_CHAR<sp/><sp/><sp/><sp/>2</highlight></codeline>
<codeline lineno="2596"><highlight class="preprocessor"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="2597"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>*CharFlags<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="2598"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>NumFlags<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2599"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="2600"><highlight class="normal"><sp/><sp/><ref refid="structlist__rec" kindref="compound">LIST</ref><sp/>SearchState;</highlight></codeline>
<codeline lineno="2601"><highlight class="normal"><sp/><sp/><ref refid="structsample" kindref="compound">SAMPLE</ref><sp/>*Sample;</highlight></codeline>
<codeline lineno="2602"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>CharID;</highlight></codeline>
<codeline lineno="2603"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>NumCharInCluster;</highlight></codeline>
<codeline lineno="2604"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>NumIllegalInCluster;</highlight></codeline>
<codeline lineno="2605"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref><sp/>PercentIllegal;</highlight></codeline>
<codeline lineno="2606"><highlight class="normal"></highlight></codeline>
<codeline lineno="2607"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>initial<sp/>estimate<sp/>assumes<sp/>that<sp/>no<sp/>illegal<sp/>chars<sp/>exist<sp/>in<sp/>the<sp/>cluster</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2608"><highlight class="normal"><sp/><sp/>NumCharInCluster<sp/>=<sp/>Cluster-&gt;<ref refid="structsample_1a71cac0608666e1abfdfb3ab40e26b249" kindref="member">SampleCount</ref>;</highlight></codeline>
<codeline lineno="2609"><highlight class="normal"><sp/><sp/>NumIllegalInCluster<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2610"><highlight class="normal"></highlight></codeline>
<codeline lineno="2611"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1aa4a7b4654dcb4918ac9a282d976b72d9" kindref="member">NumChar</ref><sp/>&gt;<sp/>NumFlags)<sp/>{</highlight></codeline>
<codeline lineno="2612"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(CharFlags<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="2613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="freelist_8cpp_1ab462a857e5edf360ae4881bcc92a0bcf" kindref="member">memfree</ref>(CharFlags);</highlight></codeline>
<codeline lineno="2614"><highlight class="normal"><sp/><sp/><sp/><sp/>NumFlags<sp/>=<sp/>Clusterer-&gt;<ref refid="struct_c_l_u_s_t_e_r_e_r_1aa4a7b4654dcb4918ac9a282d976b72d9" kindref="member">NumChar</ref>;</highlight></codeline>
<codeline lineno="2615"><highlight class="normal"><sp/><sp/><sp/><sp/>CharFlags<sp/>=<sp/>(<ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>*)<sp/><ref refid="emalloc_8cpp_1a55f2088f1a7b3333bb5c7275ab726bba" kindref="member">Emalloc</ref><sp/>(NumFlags<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref>));</highlight></codeline>
<codeline lineno="2616"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2617"><highlight class="normal"></highlight></codeline>
<codeline lineno="2618"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>NumFlags;<sp/>i++)</highlight></codeline>
<codeline lineno="2619"><highlight class="normal"><sp/><sp/><sp/><sp/>CharFlags[i]<sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="2620"><highlight class="normal"></highlight></codeline>
<codeline lineno="2621"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>find<sp/>each<sp/>sample<sp/>in<sp/>the<sp/>cluster<sp/>and<sp/>check<sp/>if<sp/>we<sp/>have<sp/>seen<sp/>it<sp/>before</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2622"><highlight class="normal"><sp/><sp/><ref refid="cluster_8h_1af125589eadf8dca87cf904ebcb77c896" kindref="member">InitSampleSearch</ref>(SearchState,<sp/>Cluster);</highlight></codeline>
<codeline lineno="2623"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((Sample<sp/>=<sp/><ref refid="cluster_8cpp_1abf5d9e3b151ac51b27bd9dc797ac261c" kindref="member">NextSample</ref><sp/>(&amp;SearchState))<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2624"><highlight class="normal"><sp/><sp/><sp/><sp/>CharID<sp/>=<sp/>Sample-&gt;<ref refid="structsample_1a564df9059b85a37e9f4e69843eec3e20" kindref="member">CharID</ref>;</highlight></codeline>
<codeline lineno="2625"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(CharFlags[CharID]<sp/>==<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CharFlags[CharID]<sp/>=<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="2627"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2628"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(CharFlags[CharID]<sp/>==<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NumIllegalInCluster++;</highlight></codeline>
<codeline lineno="2631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CharFlags[CharID]<sp/>=<sp/><ref refid="cluster_8cpp_1a9d9bc16d6dee64280de6063de97939c1" kindref="member">ILLEGAL_CHAR</ref>;</highlight></codeline>
<codeline lineno="2632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>NumCharInCluster--;</highlight></codeline>
<codeline lineno="2634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>PercentIllegal<sp/>=<sp/>(<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>)<sp/>NumIllegalInCluster<sp/>/<sp/>NumCharInCluster;</highlight></codeline>
<codeline lineno="2635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(PercentIllegal<sp/>&gt;<sp/>MaxIllegal)<sp/>{</highlight></codeline>
<codeline lineno="2636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="oldlist_8cpp_1a338e68bdadcbdf51db4c7268c4529409" kindref="member">destroy</ref>(SearchState);</highlight></codeline>
<codeline lineno="2637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>);</highlight></codeline>
<codeline lineno="2638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2639"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2640"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2641"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>);</highlight></codeline>
<codeline lineno="2642"><highlight class="normal"></highlight></codeline>
<codeline lineno="2643"><highlight class="normal">}<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>MultipleCharSamples</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2644"><highlight class="normal"></highlight></codeline>
<codeline lineno="2645"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Compute<sp/>the<sp/>inverse<sp/>of<sp/>a<sp/>matrix<sp/>using<sp/>LU<sp/>decomposition<sp/>with<sp/>partial<sp/>pivoting.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2646"><highlight class="normal"></highlight><highlight class="comment">//<sp/>The<sp/>return<sp/>value<sp/>is<sp/>the<sp/>sum<sp/>of<sp/>norms<sp/>of<sp/>the<sp/>off-diagonal<sp/>terms<sp/>of<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2647"><highlight class="normal"></highlight><highlight class="comment">//<sp/>product<sp/>of<sp/>a<sp/>and<sp/>inv.<sp/>(A<sp/>measure<sp/>of<sp/>the<sp/>error.)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2648"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="cluster_8cpp_1a40c47f6785ad5d50a9b113761e16ab9d" kindref="member">InvertMatrix</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>input,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>size,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal">*<sp/>inv)<sp/>{</highlight></codeline>
<codeline lineno="2649"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Allocate<sp/>memory<sp/>for<sp/>the<sp/>2D<sp/>arrays.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2650"><highlight class="normal"><sp/><sp/><ref refid="class_g_e_n_e_r_i_c__2_d___a_r_r_a_y" kindref="compound">GENERIC_2D_ARRAY&lt;double&gt;</ref><sp/>U(size,<sp/>size,<sp/>0.0);</highlight></codeline>
<codeline lineno="2651"><highlight class="normal"><sp/><sp/><ref refid="class_g_e_n_e_r_i_c__2_d___a_r_r_a_y" kindref="compound">GENERIC_2D_ARRAY&lt;double&gt;</ref><sp/>U_inv(size,<sp/>size,<sp/>0.0);</highlight></codeline>
<codeline lineno="2652"><highlight class="normal"><sp/><sp/><ref refid="class_g_e_n_e_r_i_c__2_d___a_r_r_a_y" kindref="compound">GENERIC_2D_ARRAY&lt;double&gt;</ref><sp/>L(size,<sp/>size,<sp/>0.0);</highlight></codeline>
<codeline lineno="2653"><highlight class="normal"></highlight></codeline>
<codeline lineno="2654"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Initialize<sp/>the<sp/>working<sp/>matrices.<sp/>U<sp/>starts<sp/>as<sp/>input,<sp/>L<sp/>as<sp/>I<sp/>and<sp/>U_inv<sp/>as<sp/>O.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2655"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>row;</highlight></codeline>
<codeline lineno="2656"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>col;</highlight></codeline>
<codeline lineno="2657"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row<sp/>=<sp/>0;<sp/>row<sp/>&lt;<sp/>size;<sp/>row++)<sp/>{</highlight></codeline>
<codeline lineno="2658"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(col<sp/>=<sp/>0;<sp/>col<sp/>&lt;<sp/>size;<sp/>col++)<sp/>{</highlight></codeline>
<codeline lineno="2659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>U[row][col]<sp/>=<sp/>input[row*size<sp/>+<sp/>col];</highlight></codeline>
<codeline lineno="2660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>L[row][col]<sp/>=<sp/>row<sp/>==<sp/>col<sp/>?<sp/>1.0<sp/>:<sp/>0.0;</highlight></codeline>
<codeline lineno="2661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>U_inv[row][col]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="2662"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2663"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2664"><highlight class="normal"></highlight></codeline>
<codeline lineno="2665"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Compute<sp/>forward<sp/>matrix<sp/>by<sp/>inversion<sp/>by<sp/>LU<sp/>decomposition<sp/>of<sp/>input.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2666"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(col<sp/>=<sp/>0;<sp/>col<sp/>&lt;<sp/>size;<sp/>++col)<sp/>{</highlight></codeline>
<codeline lineno="2667"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Find<sp/>best<sp/>pivot</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2668"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>best_row<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2669"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>best_pivot<sp/>=<sp/>-1.0;</highlight></codeline>
<codeline lineno="2670"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row<sp/>=<sp/>col;<sp/>row<sp/>&lt;<sp/>size;<sp/>++row)<sp/>{</highlight></codeline>
<codeline lineno="2671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="cluster_8cpp_1a060002a5aeab470cb24c8343daa1db08" kindref="member">Abs</ref>(U[row][col])<sp/>&gt;<sp/>best_pivot)<sp/>{</highlight></codeline>
<codeline lineno="2672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>best_pivot<sp/>=<sp/><ref refid="cluster_8cpp_1a060002a5aeab470cb24c8343daa1db08" kindref="member">Abs</ref>(U[row][col]);</highlight></codeline>
<codeline lineno="2673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>best_row<sp/>=<sp/>row;</highlight></codeline>
<codeline lineno="2674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2675"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2676"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Exchange<sp/>pivot<sp/>rows.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2677"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(best_row<sp/>!=<sp/>col)<sp/>{</highlight></codeline>
<codeline lineno="2678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/>size;<sp/>++k)<sp/>{</highlight></codeline>
<codeline lineno="2679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tmp<sp/>=<sp/>U[best_row][k];</highlight></codeline>
<codeline lineno="2680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>U[best_row][k]<sp/>=<sp/>U[col][k];</highlight></codeline>
<codeline lineno="2681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>U[col][k]<sp/>=<sp/>tmp;</highlight></codeline>
<codeline lineno="2682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp<sp/>=<sp/>L[best_row][k];</highlight></codeline>
<codeline lineno="2683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>L[best_row][k]<sp/>=<sp/>L[col][k];</highlight></codeline>
<codeline lineno="2684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>L[col][k]<sp/>=<sp/>tmp;</highlight></codeline>
<codeline lineno="2685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2686"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Now<sp/>do<sp/>the<sp/>pivot<sp/>itself.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2688"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row<sp/>=<sp/>col<sp/>+<sp/>1;<sp/>row<sp/>&lt;<sp/>size;<sp/>++row)<sp/>{</highlight></codeline>
<codeline lineno="2689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ratio<sp/>=<sp/>-U[row][col]<sp/>/<sp/>U[col][col];</highlight></codeline>
<codeline lineno="2690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j<sp/>=<sp/>col;<sp/>j<sp/>&lt;<sp/>size;<sp/>++j)<sp/>{</highlight></codeline>
<codeline lineno="2691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>U[row][j]<sp/>+=<sp/>U[col][j]<sp/>*<sp/>ratio;</highlight></codeline>
<codeline lineno="2692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/>size;<sp/>++k)<sp/>{</highlight></codeline>
<codeline lineno="2694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>L[row][k]<sp/>+=<sp/>L[col][k]<sp/>*<sp/>ratio;</highlight></codeline>
<codeline lineno="2695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2696"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2697"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2698"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Next<sp/>invert<sp/>U.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2699"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(col<sp/>=<sp/>0;<sp/>col<sp/>&lt;<sp/>size;<sp/>++col)<sp/>{</highlight></codeline>
<codeline lineno="2700"><highlight class="normal"><sp/><sp/><sp/><sp/>U_inv[col][col]<sp/>=<sp/>1.0<sp/>/<sp/>U[col][col];</highlight></codeline>
<codeline lineno="2701"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row<sp/>=<sp/>col<sp/>-<sp/>1;<sp/>row<sp/>&gt;=<sp/>0;<sp/>--row)<sp/>{</highlight></codeline>
<codeline lineno="2702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>total<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="2703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>col;<sp/>k<sp/>&gt;<sp/>row;<sp/>--k)<sp/>{</highlight></codeline>
<codeline lineno="2704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>total<sp/>+=<sp/>U[row][k]<sp/>*<sp/>U_inv[k][col];</highlight></codeline>
<codeline lineno="2705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>U_inv[row][col]<sp/>=<sp/>-total<sp/>/<sp/>U[row][row];</highlight></codeline>
<codeline lineno="2707"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2708"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2709"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Now<sp/>the<sp/>answer<sp/>is<sp/>U_inv.L.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2710"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row<sp/>=<sp/>0;<sp/>row<sp/>&lt;<sp/>size;<sp/>row++)<sp/>{</highlight></codeline>
<codeline lineno="2711"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(col<sp/>=<sp/>0;<sp/>col<sp/>&lt;<sp/>size;<sp/>col++)<sp/>{</highlight></codeline>
<codeline lineno="2712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sum<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="2713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>row;<sp/>k<sp/>&lt;<sp/>size;<sp/>++k)<sp/>{</highlight></codeline>
<codeline lineno="2714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sum<sp/>+=<sp/>U_inv[row][k]<sp/>*<sp/>L[k][col];</highlight></codeline>
<codeline lineno="2715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>inv[row*size<sp/>+<sp/>col]<sp/>=<sp/>sum;</highlight></codeline>
<codeline lineno="2717"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2718"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2719"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Check<sp/>matrix<sp/>product.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2720"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>error_sum<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="2721"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row<sp/>=<sp/>0;<sp/>row<sp/>&lt;<sp/>size;<sp/>row++)<sp/>{</highlight></codeline>
<codeline lineno="2722"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(col<sp/>=<sp/>0;<sp/>col<sp/>&lt;<sp/>size;<sp/>col++)<sp/>{</highlight></codeline>
<codeline lineno="2723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sum<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="2724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/>size;<sp/>++k)<sp/>{</highlight></codeline>
<codeline lineno="2725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sum<sp/>+=<sp/>input[row*size<sp/>+<sp/>k]<sp/>*<sp/>inv[k<sp/>*size<sp/>+<sp/>col];</highlight></codeline>
<codeline lineno="2726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row<sp/>!=<sp/>col)<sp/>{</highlight></codeline>
<codeline lineno="2728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>error_sum<sp/>+=<sp/><ref refid="cluster_8cpp_1a060002a5aeab470cb24c8343daa1db08" kindref="member">Abs</ref>(sum);</highlight></codeline>
<codeline lineno="2729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2730"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2731"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2732"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>error_sum;</highlight></codeline>
<codeline lineno="2733"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/Users/makoto/Desktop/trunk/classify/cluster.cpp"/>
  </compounddef>
</doxygen>
