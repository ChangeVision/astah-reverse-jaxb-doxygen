<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.4">
  <compounddef id="intfeaturemap_8cpp" kind="file">
    <compoundname>intfeaturemap.cpp</compoundname>
    <includes refid="intfeaturemap_8h" local="yes">intfeaturemap.h</includes>
    <includes refid="intfeaturespace_8h" local="yes">intfeaturespace.h</includes>
    <includes refid="intfx_8h" local="yes">intfx.h</includes>
    <incdepgraph>
      <node id="24886">
        <label>cutil_class.h</label>
        <link refid="cutil__class_8h"/>
        <childnode refid="24887" relation="include">
        </childnode>
        <childnode refid="24898" relation="include">
        </childnode>
        <childnode refid="24883" relation="include">
        </childnode>
      </node>
      <node id="24873">
        <label>ndminx.h</label>
        <link refid="ndminx_8h"/>
      </node>
      <node id="24860">
        <label>classify/intfeaturemap.cpp</label>
        <link refid="intfeaturemap.cpp"/>
        <childnode refid="24861" relation="include">
        </childnode>
        <childnode refid="24862" relation="include">
        </childnode>
        <childnode refid="24913" relation="include">
        </childnode>
      </node>
      <node id="24898">
        <label>const.h</label>
        <link refid="const_8h"/>
      </node>
      <node id="24865">
        <label>stdlib.h</label>
      </node>
      <node id="24868">
        <label>platform.h</label>
        <link refid="platform_8h"/>
        <childnode refid="24869" relation="include">
        </childnode>
      </node>
      <node id="24910">
        <label>bitvec.h</label>
        <link refid="bitvec_8h"/>
        <childnode refid="24867" relation="include">
        </childnode>
      </node>
      <node id="24887">
        <label>ccutil.h</label>
        <link refid="ccutil_8h"/>
        <childnode refid="24888" relation="include">
        </childnode>
        <childnode refid="24870" relation="include">
        </childnode>
        <childnode refid="24883" relation="include">
        </childnode>
        <childnode refid="24895" relation="include">
        </childnode>
        <childnode refid="24882" relation="include">
        </childnode>
        <childnode refid="24893" relation="include">
        </childnode>
        <childnode refid="24896" relation="include">
        </childnode>
        <childnode refid="24897" relation="include">
        </childnode>
      </node>
      <node id="24907">
        <label>scrollview.h</label>
        <link refid="scrollview_8h"/>
        <childnode refid="24864" relation="include">
        </childnode>
      </node>
      <node id="24890">
        <label>serialis.h</label>
        <link refid="serialis_8h"/>
        <childnode refid="24865" relation="include">
        </childnode>
        <childnode refid="24872" relation="include">
        </childnode>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24884" relation="include">
        </childnode>
        <childnode refid="24870" relation="include">
        </childnode>
        <childnode refid="24891" relation="include">
        </childnode>
      </node>
      <node id="24903">
        <label>clst.h</label>
        <link refid="clst_8h"/>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24867" relation="include">
        </childnode>
        <childnode refid="24890" relation="include">
        </childnode>
        <childnode refid="24892" relation="include">
        </childnode>
      </node>
      <node id="24901">
        <label>baseline.h</label>
        <link refid="baseline_8h"/>
        <childnode refid="24867" relation="include">
        </childnode>
        <childnode refid="24902" relation="include">
        </childnode>
        <childnode refid="24882" relation="include">
        </childnode>
      </node>
      <node id="24862">
        <label>intfeaturespace.h</label>
        <link refid="intfeaturespace_8h"/>
        <childnode refid="24863" relation="include">
        </childnode>
        <childnode refid="24874" relation="include">
        </childnode>
      </node>
      <node id="24885">
        <label>stddef.h</label>
      </node>
      <node id="24877">
        <label>memory.h</label>
      </node>
      <node id="24899">
        <label>fpoint.h</label>
        <link refid="fpoint_8h"/>
        <childnode refid="24867" relation="include">
        </childnode>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24900" relation="include">
        </childnode>
      </node>
      <node id="24870">
        <label>errcode.h</label>
        <link refid="errcode_8h"/>
        <childnode refid="24867" relation="include">
        </childnode>
      </node>
      <node id="24875">
        <label>matchdefs.h</label>
        <link refid="matchdefs_8h"/>
        <childnode refid="24867" relation="include">
        </childnode>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24876" relation="include">
        </childnode>
      </node>
      <node id="24869">
        <label>limits.h</label>
      </node>
      <node id="24913">
        <label>intfx.h</label>
        <link refid="intfx_8h"/>
        <childnode refid="24902" relation="include">
        </childnode>
        <childnode refid="24874" relation="include">
        </childnode>
        <childnode refid="24914" relation="include">
        </childnode>
        <childnode refid="24900" relation="include">
        </childnode>
      </node>
      <node id="24906">
        <label>ipoints.h</label>
        <link refid="ipoints_8h"/>
        <childnode refid="24900" relation="include">
        </childnode>
      </node>
      <node id="24896">
        <label>pthread.h</label>
      </node>
      <node id="24861">
        <label>intfeaturemap.h</label>
        <link refid="intfeaturemap_8h"/>
        <childnode refid="24862" relation="include">
        </childnode>
        <childnode refid="24912" relation="include">
        </childnode>
        <childnode refid="24874" relation="include">
        </childnode>
      </node>
      <node id="24872">
        <label>string.h</label>
      </node>
      <node id="24894">
        <label>unicharmap.h</label>
        <link refid="unicharmap_8h"/>
        <childnode refid="24876" relation="include">
        </childnode>
      </node>
      <node id="24876">
        <label>unichar.h</label>
        <link refid="unichar_8h"/>
        <childnode refid="24877" relation="include">
        </childnode>
        <childnode refid="24872" relation="include">
        </childnode>
      </node>
      <node id="24880">
        <label>cutil.h</label>
        <link refid="cutil_8h"/>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24872" relation="include">
        </childnode>
        <childnode refid="24865" relation="include">
        </childnode>
        <childnode refid="24867" relation="include">
        </childnode>
        <childnode refid="24881" relation="include">
        </childnode>
        <childnode refid="24886" relation="include">
        </childnode>
      </node>
      <node id="24904">
        <label>rect.h</label>
        <link refid="rect_8h"/>
        <childnode refid="24900" relation="include">
        </childnode>
        <childnode refid="24905" relation="include">
        </childnode>
        <childnode refid="24873" relation="include">
        </childnode>
        <childnode refid="24907" relation="include">
        </childnode>
        <childnode refid="24881" relation="include">
        </childnode>
      </node>
      <node id="24866">
        <label>tesscallback.h</label>
        <link refid="tesscallback_8h"/>
        <childnode refid="24867" relation="include">
        </childnode>
      </node>
      <node id="24897">
        <label>semaphore.h</label>
      </node>
      <node id="24891">
        <label>fileerr.h</label>
        <link refid="fileerr_8h"/>
        <childnode refid="24870" relation="include">
        </childnode>
      </node>
      <node id="24878">
        <label>mfoutline.h</label>
        <link refid="mfoutline_8h"/>
        <childnode refid="24867" relation="include">
        </childnode>
        <childnode refid="24879" relation="include">
        </childnode>
        <childnode refid="24899" relation="include">
        </childnode>
        <childnode refid="24901" relation="include">
        </childnode>
        <childnode refid="24882" relation="include">
        </childnode>
      </node>
      <node id="24888">
        <label>ambigs.h</label>
        <link refid="ambigs_8h"/>
        <childnode refid="24889" relation="include">
        </childnode>
        <childnode refid="24881" relation="include">
        </childnode>
        <childnode refid="24876" relation="include">
        </childnode>
        <childnode refid="24893" relation="include">
        </childnode>
        <childnode refid="24863" relation="include">
        </childnode>
      </node>
      <node id="24911">
        <label>unicity_table.h</label>
        <link refid="unicity__table_8h"/>
        <childnode refid="24866" relation="include">
        </childnode>
        <childnode refid="24870" relation="include">
        </childnode>
        <childnode refid="24863" relation="include">
        </childnode>
      </node>
      <node id="24900">
        <label>math.h</label>
      </node>
      <node id="24892">
        <label>lsterr.h</label>
        <link refid="lsterr_8h"/>
        <childnode refid="24870" relation="include">
        </childnode>
      </node>
      <node id="24908">
        <label>vecfuncs.h</label>
        <link refid="vecfuncs_8h"/>
        <childnode refid="24900" relation="include">
        </childnode>
        <childnode refid="24902" relation="include">
        </childnode>
      </node>
      <node id="24879">
        <label>oldlist.h</label>
        <link refid="oldlist_8h"/>
        <childnode refid="24880" relation="include">
        </childnode>
        <childnode refid="24866" relation="include">
        </childnode>
      </node>
      <node id="24882">
        <label>params.h</label>
        <link refid="params_8h"/>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24863" relation="include">
        </childnode>
        <childnode refid="24883" relation="include">
        </childnode>
      </node>
      <node id="24863">
        <label>genericvector.h</label>
        <link refid="genericvector_8h"/>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24865" relation="include">
        </childnode>
        <childnode refid="24866" relation="include">
        </childnode>
        <childnode refid="24870" relation="include">
        </childnode>
        <childnode refid="24871" relation="include">
        </childnode>
        <childnode refid="24873" relation="include">
        </childnode>
      </node>
      <node id="24884">
        <label>memry.h</label>
        <link refid="memry_8h"/>
        <childnode refid="24885" relation="include">
        </childnode>
        <childnode refid="24867" relation="include">
        </childnode>
      </node>
      <node id="24909">
        <label>protos.h</label>
        <link refid="protos_8h"/>
        <childnode refid="24910" relation="include">
        </childnode>
        <childnode refid="24880" relation="include">
        </childnode>
        <childnode refid="24876" relation="include">
        </childnode>
        <childnode refid="24911" relation="include">
        </childnode>
        <childnode refid="24882" relation="include">
        </childnode>
      </node>
      <node id="24889">
        <label>elst.h</label>
        <link refid="elst_8h"/>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24867" relation="include">
        </childnode>
        <childnode refid="24890" relation="include">
        </childnode>
        <childnode refid="24892" relation="include">
        </childnode>
      </node>
      <node id="24893">
        <label>unicharset.h</label>
        <link refid="unicharset_8h"/>
        <childnode refid="24870" relation="include">
        </childnode>
        <childnode refid="24871" relation="include">
        </childnode>
        <childnode refid="24883" relation="include">
        </childnode>
        <childnode refid="24866" relation="include">
        </childnode>
        <childnode refid="24876" relation="include">
        </childnode>
        <childnode refid="24894" relation="include">
        </childnode>
      </node>
      <node id="24905">
        <label>points.h</label>
        <link refid="points_8h"/>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24900" relation="include">
        </childnode>
        <childnode refid="24889" relation="include">
        </childnode>
        <childnode refid="24906" relation="include">
        </childnode>
      </node>
      <node id="24881">
        <label>tprintf.h</label>
        <link refid="tprintf_8h"/>
        <childnode refid="24882" relation="include">
        </childnode>
      </node>
      <node id="24867">
        <label>host.h</label>
        <link refid="host_8h"/>
        <childnode refid="24868" relation="include">
        </childnode>
      </node>
      <node id="24864">
        <label>stdio.h</label>
      </node>
      <node id="24912">
        <label>indexmapbidi.h</label>
        <link refid="indexmapbidi_8h"/>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24863" relation="include">
        </childnode>
      </node>
      <node id="24874">
        <label>intproto.h</label>
        <link refid="intproto_8h"/>
        <childnode refid="24863" relation="include">
        </childnode>
        <childnode refid="24875" relation="include">
        </childnode>
        <childnode refid="24878" relation="include">
        </childnode>
        <childnode refid="24909" relation="include">
        </childnode>
        <childnode refid="24907" relation="include">
        </childnode>
        <childnode refid="24893" relation="include">
        </childnode>
      </node>
      <node id="24895">
        <label>tessdatamanager.h</label>
        <link refid="tessdatamanager_8h"/>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24867" relation="include">
        </childnode>
        <childnode refid="24881" relation="include">
        </childnode>
      </node>
      <node id="24914">
        <label>normalis.h</label>
        <link refid="normalis_8h"/>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24867" relation="include">
        </childnode>
      </node>
      <node id="24883">
        <label>strngs.h</label>
        <link refid="strngs_8h"/>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24872" relation="include">
        </childnode>
        <childnode refid="24868" relation="include">
        </childnode>
        <childnode refid="24884" relation="include">
        </childnode>
      </node>
      <node id="24902">
        <label>blobs.h</label>
        <link refid="blobs_8h"/>
        <childnode refid="24903" relation="include">
        </childnode>
        <childnode refid="24904" relation="include">
        </childnode>
        <childnode refid="24908" relation="include">
        </childnode>
      </node>
      <node id="24871">
        <label>helpers.h</label>
        <link refid="helpers_8h"/>
        <childnode refid="24864" relation="include">
        </childnode>
        <childnode refid="24872" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <innernamespace refid="namespacetesseract">tesseract</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//<sp/>Copyright<sp/>2010<sp/>Google<sp/>Inc.<sp/>All<sp/>Rights<sp/>Reserved.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Author:<sp/>rays@google.com<sp/>(Ray<sp/>Smith)</highlight></codeline>
<codeline lineno="4"><highlight class="comment"></highlight><highlight class="comment">//<sp/>File:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>intfeaturemap.cpp</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Description:<sp/>Encapsulation<sp/>of<sp/>IntFeatureSpace<sp/>with<sp/>IndexMapBiDi</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>provide<sp/>a<sp/>subspace<sp/>mapping<sp/>and<sp/>fast<sp/>feature<sp/>lookup.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Created:<sp/><sp/><sp/><sp/><sp/>Tue<sp/>Oct<sp/>26<sp/>08:58:30<sp/>PDT<sp/>2010</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Licensed<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the<sp/>&quot;License&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="comment">//<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance<sp/>with<sp/>the<sp/>License.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">//<sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="comment">//<sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,<sp/>software</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="comment">//<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="comment">//<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="comment">//<sp/>See<sp/>the<sp/>License<sp/>for<sp/>the<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="comment">//<sp/>limitations<sp/>under<sp/>the<sp/>License.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="comment">//</highlight></codeline>
<codeline lineno="20"><highlight class="comment"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="intfeaturemap_8h" kindref="compound">intfeaturemap.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="intfeaturespace_8h" kindref="compound">intfeaturespace.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="intfx_8h" kindref="compound">intfx.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="comment">//<sp/>These<sp/>includes<sp/>do<sp/>not<sp/>exist<sp/>yet,<sp/>but<sp/>will<sp/>be<sp/>coming<sp/>soon.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="comment">//#include<sp/>&quot;sampleiterator.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="comment">//#include<sp/>&quot;trainingsample.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="comment">//#include<sp/>&quot;trainingsampleset.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespacetesseract-c__api-demo_1afed58feacb84df2de88bdd613cfdba6d" kindref="member">tesseract</ref><sp/>{</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a5ed5ea7e3054219b18144501c5ec3d1e" kindref="member">kMaxOffsetDist</ref><sp/>=<sp/>32;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="namespacetesseract_1a49cc91997030c04f4b29b8ddf620f021" kindref="member">kMinPCLengthIncrease</ref><sp/>=<sp/>1.0<sp/>/<sp/>1024;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"><ref refid="classtesseract_1_1_int_feature_map_1a3fbd4062c08d2b3234e43b6fb8278bca" kindref="member">IntFeatureMap::IntFeatureMap</ref>()</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/>:<sp/>mapping_changed_(true),<sp/>compact_size_(0)<sp/>{</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dir<sp/>=<sp/>0;<sp/>dir<sp/>&lt;<sp/>kNumOffsetMaps;<sp/>++dir)<sp/>{</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/>offset_plus_[dir]<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/>offset_minus_[dir]<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="41"><highlight class="normal">}</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><ref refid="classtesseract_1_1_int_feature_map_1ae7cf24a11435b7ebabbaa21f55d14325" kindref="member">IntFeatureMap::~IntFeatureMap</ref>()<sp/>{</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/>Clear();</highlight></codeline>
<codeline lineno="45"><highlight class="normal">}</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Pseudo-accessors.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_int_feature_map_1a39cd610b08359c77cbb9cce314d74d10" kindref="member">IntFeatureMap::IndexFeature</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t" kindref="compound">INT_FEATURE_STRUCT</ref>&amp;<sp/><ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>feature_space_.<ref refid="classtesseract_1_1_int_feature_space_1ace7ac6191c34b569cc501a7afbb9a223" kindref="member">Index</ref>(f);</highlight></codeline>
<codeline lineno="50"><highlight class="normal">}</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_int_feature_map_1a3690350765e201ac4d65cc6818bee4cf" kindref="member">IntFeatureMap::MapFeature</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t" kindref="compound">INT_FEATURE_STRUCT</ref>&amp;<sp/>f)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_bi_di_1a2c0f96f5d5fad6c9973e1b074fac5a03" kindref="member">SparseToCompact</ref>(feature_space_.<ref refid="classtesseract_1_1_int_feature_space_1ace7ac6191c34b569cc501a7afbb9a223" kindref="member">Index</ref>(f));</highlight></codeline>
<codeline lineno="53"><highlight class="normal">}</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_int_feature_map_1acc5af5a18d8315076f1b9bee55cb2ea8" kindref="member">IntFeatureMap::MapIndexFeature</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>index_feature)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_bi_di_1a2c0f96f5d5fad6c9973e1b074fac5a03" kindref="member">SparseToCompact</ref>(index_feature);</highlight></codeline>
<codeline lineno="56"><highlight class="normal">}</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t" kindref="compound">INT_FEATURE_STRUCT</ref><sp/><ref refid="classtesseract_1_1_int_feature_map_1aec31c0d13a466e3957a42fe70511d47f" kindref="member">IntFeatureMap::InverseIndexFeature</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>index_feature)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>feature_space_.<ref refid="classtesseract_1_1_int_feature_space_1afe76aa77c41fa6362ed3630afed656f8" kindref="member">PositionFromIndex</ref>(index_feature);</highlight></codeline>
<codeline lineno="59"><highlight class="normal">}</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t" kindref="compound">INT_FEATURE_STRUCT</ref><sp/><ref refid="classtesseract_1_1_int_feature_map_1a53738bef24bcebaaac0c6b4298eedb6f" kindref="member">IntFeatureMap::InverseMapFeature</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>map_feature)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>index<sp/>=<sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_1ad9e50b500bcbadf8f3be98cd672f0c4a" kindref="member">CompactToSparse</ref>(map_feature);</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>feature_space_.<ref refid="classtesseract_1_1_int_feature_space_1afe76aa77c41fa6362ed3630afed656f8" kindref="member">PositionFromIndex</ref>(index);</highlight></codeline>
<codeline lineno="63"><highlight class="normal">}</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_int_feature_map_1a9f520c6a69fa114d9eff812d936063a2" kindref="member">IntFeatureMap::DeleteMapFeature</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>map_feature)<sp/>{</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_bi_di_1a2065aea120b8bbad4afc135bc3473044" kindref="member">Merge</ref>(-1,<sp/>map_feature);</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/>mapping_changed_<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="67"><highlight class="normal">}</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_int_feature_map_1ad8bb4fca93cf4ca2de3716f28ee982b5" kindref="member">IntFeatureMap::IsMapFeatureDeleted</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>map_feature)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_bi_di_1a8df00cfcea90afefcb1cdf0e6738546d" kindref="member">IsCompactDeleted</ref>(map_feature);</highlight></codeline>
<codeline lineno="70"><highlight class="normal">}</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Copies<sp/>the<sp/>given<sp/>feature_space<sp/>and<sp/>uses<sp/>it<sp/>as<sp/>the<sp/>index<sp/>feature<sp/>map</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="comment">//<sp/>from<sp/>INT_FEATURE_STRUCT.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_int_feature_map_1aa2a41837ff48a80829cf8c7d5ca4917d" kindref="member">IntFeatureMap::Init</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>IntFeatureSpace&amp;<sp/>feature_space)<sp/>{</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/>feature_space_<sp/>=<sp/><ref refid="classtesseract_1_1_int_feature_map_1ad9eca6f10e8740cc82c239b6c7dfdb90" kindref="member">feature_space</ref>;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/>mapping_changed_<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_int_feature_map_1a4b8c11f257a4325f1caf5df974e514f6" kindref="member">sparse_size</ref><sp/>=<sp/>feature_space_.<ref refid="classtesseract_1_1_int_feature_space_1a90a3d06fba59fba2178efdab7dd49539" kindref="member">Size</ref>();</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_bi_di_1a165b8de5eeba0557d206f76b556793d9" kindref="member">Init</ref>(sparse_size,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_bi_di_1a909e48dddc1488311f4d7083544eca56" kindref="member">Setup</ref>();</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/>compact_size_<sp/>=<sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_1ab2904b1640580ad7ba6b2c14522dc3e8" kindref="member">CompactSize</ref>();</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Initialize<sp/>look-up<sp/>tables<sp/>if<sp/>needed.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>dir<sp/>=<sp/><ref refid="intfx_8cpp_1a31bfe591242811378902d7342621a59b" kindref="member">FeatureDirection</ref>(0);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dir.<ref refid="class_f_c_o_o_r_d_1a9edadbfc357c730f62fa3c92677b0d58" kindref="member">x</ref>()<sp/>==<sp/>0.0f<sp/>&amp;&amp;<sp/>dir.<ref refid="class_f_c_o_o_r_d_1a397f7ce997b246df18e7bd5a20cc422e" kindref="member">y</ref>()<sp/>==<sp/>0.0f)</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="intfx_8cpp_1a1281b17b87e56c99d53fe6bb1f7c2d55" kindref="member">InitIntegerFX</ref>();</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Compute<sp/>look-up<sp/>tables<sp/>to<sp/>generate<sp/>offset<sp/>features.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dir<sp/>=<sp/>0;<sp/>dir<sp/>&lt;<sp/>kNumOffsetMaps;<sp/>++dir)<sp/>{</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>[]<sp/>offset_plus_[dir];</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>[]<sp/>offset_minus_[dir];</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/>offset_plus_[dir]<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">[<ref refid="classtesseract_1_1_int_feature_map_1a4b8c11f257a4325f1caf5df974e514f6" kindref="member">sparse_size</ref>];</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/>offset_minus_[dir]<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">[<ref refid="classtesseract_1_1_int_feature_map_1a4b8c11f257a4325f1caf5df974e514f6" kindref="member">sparse_size</ref>];</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dir<sp/>=<sp/>1;<sp/>dir<sp/>&lt;=<sp/>kNumOffsetMaps;<sp/>++dir)<sp/>{</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="classtesseract_1_1_int_feature_map_1a4b8c11f257a4325f1caf5df974e514f6" kindref="member">sparse_size</ref>;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>offset_index<sp/>=<sp/>ComputeOffsetFeature(i,<sp/>dir);</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>offset_plus_[dir<sp/>-<sp/>1][i]<sp/>=<sp/>offset_index;</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>offset_index<sp/>=<sp/>ComputeOffsetFeature(i,<sp/>-dir);</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>offset_minus_[dir<sp/>-<sp/>1][i]<sp/>=<sp/>offset_index;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="100"><highlight class="normal">}</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Helper<sp/>to<sp/>return<sp/>an<sp/>offset<sp/>index<sp/>feature.<sp/>In<sp/>this<sp/>context<sp/>an<sp/>offset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight><highlight class="comment">//<sp/>feature<sp/>with<sp/>a<sp/>dir<sp/>of<sp/>+/-1<sp/>is<sp/>a<sp/>feature<sp/>of<sp/>a<sp/>similar<sp/>direction,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight><highlight class="comment">//<sp/>but<sp/>shifted<sp/>perpendicular<sp/>to<sp/>the<sp/>direction<sp/>of<sp/>the<sp/>feature.<sp/>An<sp/>offset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight><highlight class="comment">//<sp/>feature<sp/>with<sp/>a<sp/>dir<sp/>of<sp/>+/-2<sp/>is<sp/>feature<sp/>at<sp/>the<sp/>same<sp/>position,<sp/>but<sp/>rotated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight><highlight class="comment">//<sp/>by<sp/>+/-<sp/>one<sp/>[compact]<sp/>quantum.<sp/>Returns<sp/>the<sp/>index<sp/>of<sp/>the<sp/>generated<sp/>offset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight><highlight class="comment">//<sp/>feature,<sp/>or<sp/>-1<sp/>if<sp/>it<sp/>doesn&apos;t<sp/>exist.<sp/>Dir<sp/>should<sp/>be<sp/>in</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight><highlight class="comment">//<sp/>[-kNumOffsetMaps,<sp/>kNumOffsetMaps]<sp/>to<sp/>indicate<sp/>the<sp/>relative<sp/>direction.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="comment">//<sp/>A<sp/>dir<sp/>of<sp/>0<sp/>is<sp/>an<sp/>identity<sp/>transformation.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Both<sp/>input<sp/>and<sp/>output<sp/>are<sp/>from<sp/>the<sp/>index(sparse)<sp/>feature<sp/>space,<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight><highlight class="comment">//<sp/>the<sp/>mapped/compact<sp/>feature<sp/>space,<sp/>but<sp/>the<sp/>offset<sp/>feature<sp/>is<sp/>the<sp/>minimum</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight><highlight class="comment">//<sp/>distance<sp/>moved<sp/>from<sp/>the<sp/>input<sp/>to<sp/>guarantee<sp/>that<sp/>it<sp/>maps<sp/>to<sp/>the<sp/>next</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight><highlight class="comment">//<sp/>available<sp/>quantum<sp/>in<sp/>the<sp/>mapped/compact<sp/>space.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_int_feature_map_1a125a91be52f2dc6622587a81a25256f9" kindref="member">IntFeatureMap::OffsetFeature</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>index_feature,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dir)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dir<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/>dir<sp/>&lt;=<sp/>kNumOffsetMaps)</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>offset_plus_[dir<sp/>-<sp/>1][index_feature];</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dir<sp/>&lt;<sp/>0<sp/>&amp;&amp;<sp/>-dir<sp/>&lt;=<sp/>kNumOffsetMaps)</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>offset_minus_[-dir<sp/>-<sp/>1][index_feature];</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dir<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>index_feature;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="123"><highlight class="normal">}</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight><highlight class="comment">//#define<sp/>EXPERIMENT_ON</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>EXPERIMENT_ON<sp/><sp/>//<sp/>This<sp/>code<sp/>is<sp/>commented<sp/>out<sp/>as<sp/>SampleIterator<sp/>and</highlight></codeline>
<codeline lineno="128"><highlight class="preprocessor"></highlight><highlight class="comment">//<sp/>TrainingSample<sp/>are<sp/>not<sp/>reviewed/checked<sp/>in<sp/>yet,<sp/>but<sp/>these<sp/>functions<sp/>are<sp/>a</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight><highlight class="comment">//<sp/>useful<sp/>indicator<sp/>of<sp/>how<sp/>an<sp/>IntFeatureMap<sp/>is<sp/>setup.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Computes<sp/>the<sp/>features<sp/>used<sp/>by<sp/>the<sp/>subset<sp/>of<sp/>samples<sp/>defined<sp/>by</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight><highlight class="comment">//<sp/>the<sp/>iterator<sp/>and<sp/>sets<sp/>up<sp/>the<sp/>feature<sp/>mapping.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Returns<sp/>the<sp/>size<sp/>of<sp/>the<sp/>compacted<sp/>feature<sp/>space.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_int_feature_map_1aa04a441902ce2cc53b225dc6487e6650" kindref="member">IntFeatureMap::FindNZFeatureMapping</ref>(SampleIterator*<sp/>it)<sp/>{</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_bi_di_1a165b8de5eeba0557d206f76b556793d9" kindref="member">Init</ref>(feature_space_.<ref refid="classtesseract_1_1_int_feature_space_1a90a3d06fba59fba2178efdab7dd49539" kindref="member">Size</ref>(),<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>total_samples<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(it-&gt;Begin();<sp/>!it-&gt;AtEnd();<sp/>it-&gt;Next())<sp/>{</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>TrainingSample&amp;<sp/><ref refid="structsample" kindref="compound">sample</ref><sp/>=<sp/>it-&gt;GetSample();</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_generic_vector" kindref="compound">GenericVector&lt;int&gt;</ref><sp/>features;</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/>feature_space_.<ref refid="classtesseract_1_1_int_feature_space_1abeeaf9aa04a1a933bbfa50b2a13ac5c4" kindref="member">IndexAndSortFeatures</ref>(sample.features(),</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sample.num_features(),</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;features);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_features<sp/>=<sp/>features.<ref refid="class_generic_vector_1a111b51dd0bf1324cfb69ef70703d8e70" kindref="member">size</ref>();</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>f<sp/>=<sp/>0;<sp/>f<sp/>&lt;<sp/>num_features;<sp/>++<ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>)</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_bi_di_1a3b4579cc4934a996ea688de031e758f2" kindref="member">SetMap</ref>(features[f],<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/>++total_samples;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_bi_di_1a909e48dddc1488311f4d7083544eca56" kindref="member">Setup</ref>();</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/>compact_size_<sp/>=<sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_1ab2904b1640580ad7ba6b2c14522dc3e8" kindref="member">CompactSize</ref>();</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/>mapping_changed_<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_int_feature_map_1af3348594a6926c20c0366e3acb56a4ef" kindref="member">FinalizeMapping</ref>(it);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;%d<sp/>non-zero<sp/>features<sp/>found<sp/>in<sp/>%d<sp/>samples\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>compact_size_,<sp/>total_samples);</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>compact_size_;</highlight></codeline>
<codeline lineno="155"><highlight class="normal">}</highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="157"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight><highlight class="comment">//<sp/>After<sp/>deleting<sp/>some<sp/>features,<sp/>finish<sp/>setting<sp/>up<sp/>the<sp/>mapping,<sp/>and<sp/>map</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight><highlight class="comment">//<sp/>all<sp/>the<sp/>samples.<sp/>Returns<sp/>the<sp/>size<sp/>of<sp/>the<sp/>compacted<sp/>feature<sp/>space.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_int_feature_map_1af3348594a6926c20c0366e3acb56a4ef" kindref="member">IntFeatureMap::FinalizeMapping</ref>(SampleIterator*<sp/>it)<sp/>{</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(mapping_changed_)<sp/>{</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_bi_di_1ab809f6fe92e0f3a7bce25eeb183ab120" kindref="member">CompleteMerges</ref>();</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/>compact_size_<sp/>=<sp/>feature_map_.<ref refid="classtesseract_1_1_index_map_1ab2904b1640580ad7ba6b2c14522dc3e8" kindref="member">CompactSize</ref>();</highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>EXPERIMENT_ON</highlight></codeline>
<codeline lineno="165"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/>it-&gt;MapSampleFeatures(*</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="167"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/>mapping_changed_<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>compact_size_;</highlight></codeline>
<codeline lineno="170"><highlight class="normal">}</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Prints<sp/>the<sp/>map<sp/>features<sp/>from<sp/>the<sp/>set<sp/>in<sp/>human-readable<sp/>form.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classtesseract_1_1_int_feature_map_1ac69ac65f1ffcf6eaba34582fc399cd68" kindref="member">IntFeatureMap::DebugMapFeatures</ref>(</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_generic_vector" kindref="compound">GenericVector&lt;int&gt;</ref>&amp;<sp/>map_features)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>map_features.<ref refid="class_generic_vector_1a111b51dd0bf1324cfb69ef70703d8e70" kindref="member">size</ref>();<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t" kindref="compound">INT_FEATURE_STRUCT</ref><sp/>f<sp/>=<sp/><ref refid="classtesseract_1_1_int_feature_map_1a53738bef24bcebaaac0c6b4298eedb6f" kindref="member">InverseMapFeature</ref>(map_features[i]);</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/>f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1a8e441f7715985972c22a29e4f4ab139e" kindref="member">print</ref>();</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="179"><highlight class="normal">}</highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>IntFeatureMap::Clear()<sp/>{</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dir<sp/>=<sp/>0;<sp/>dir<sp/>&lt;<sp/>kNumOffsetMaps;<sp/>++dir)<sp/>{</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>[]<sp/>offset_plus_[dir];</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>[]<sp/>offset_minus_[dir];</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/>offset_plus_[dir]<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/>offset_minus_[dir]<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="188"><highlight class="normal">}</highlight></codeline>
<codeline lineno="189"><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Helper<sp/>to<sp/>compute<sp/>an<sp/>offset<sp/>index<sp/>feature.<sp/>In<sp/>this<sp/>context<sp/>an<sp/>offset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight><highlight class="comment">//<sp/>feature<sp/>with<sp/>a<sp/>dir<sp/>of<sp/>+/-1<sp/>is<sp/>a<sp/>feature<sp/>of<sp/>a<sp/>similar<sp/>direction,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"></highlight><highlight class="comment">//<sp/>but<sp/>shifted<sp/>perpendicular<sp/>to<sp/>the<sp/>direction<sp/>of<sp/>the<sp/>feature.<sp/>An<sp/>offset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"></highlight><highlight class="comment">//<sp/>feature<sp/>with<sp/>a<sp/>dir<sp/>of<sp/>+/-2<sp/>is<sp/>feature<sp/>at<sp/>the<sp/>same<sp/>position,<sp/>but<sp/>rotated</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight><highlight class="comment">//<sp/>by<sp/>+/-<sp/>one<sp/>[compact]<sp/>quantum.<sp/>Returns<sp/>the<sp/>index<sp/>of<sp/>the<sp/>generated<sp/>offset</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight><highlight class="comment">//<sp/>feature,<sp/>or<sp/>-1<sp/>if<sp/>it<sp/>doesn&apos;t<sp/>exist.<sp/>Dir<sp/>should<sp/>be<sp/>in</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight><highlight class="comment">//<sp/>[-kNumOffsetMaps,<sp/>kNumOffsetMaps]<sp/>to<sp/>indicate<sp/>the<sp/>relative<sp/>direction.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight><highlight class="comment">//<sp/>A<sp/>dir<sp/>of<sp/>0<sp/>is<sp/>an<sp/>identity<sp/>transformation.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Both<sp/>input<sp/>and<sp/>output<sp/>are<sp/>from<sp/>the<sp/>index(sparse)<sp/>feature<sp/>space,<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight><highlight class="comment">//<sp/>the<sp/>mapped/compact<sp/>feature<sp/>space,<sp/>but<sp/>the<sp/>offset<sp/>feature<sp/>is<sp/>the<sp/>minimum</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight><highlight class="comment">//<sp/>distance<sp/>moved<sp/>from<sp/>the<sp/>input<sp/>to<sp/>guarantee<sp/>that<sp/>it<sp/>maps<sp/>to<sp/>the<sp/>next</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight><highlight class="comment">//<sp/>available<sp/>quantum<sp/>in<sp/>the<sp/>mapped/compact<sp/>space.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>IntFeatureMap::ComputeOffsetFeature(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>index_feature,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dir)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t" kindref="compound">INT_FEATURE_STRUCT</ref><sp/>f<sp/>=<sp/><ref refid="classtesseract_1_1_int_feature_map_1aec31c0d13a466e3957a42fe70511d47f" kindref="member">InverseIndexFeature</ref>(index_feature);</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref>(<ref refid="classtesseract_1_1_int_feature_map_1a39cd610b08359c77cbb9cce314d74d10" kindref="member">IndexFeature</ref>(f)<sp/>==<sp/>index_feature);</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dir<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>index_feature;</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dir<sp/>==<sp/>1<sp/>||<sp/>dir<sp/>==<sp/>-1)<sp/>{</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>feature_dir<sp/>=<sp/><ref refid="intfx_8cpp_1a31bfe591242811378902d7342621a59b" kindref="member">FeatureDirection</ref>(f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1af4a2ea6a7d9a82cba06f6ca9a126461b" kindref="member">Theta</ref>);</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>rotation90(0.0f,<sp/>1.0f);</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/>feature_dir.<ref refid="class_f_c_o_o_r_d_1a81ca9ea0cac4cd8c1bca0314e29bb28d" kindref="member">rotate</ref>(rotation90);</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Find<sp/>the<sp/>nearest<sp/>existing<sp/>feature.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>m<sp/>=<sp/>1;<sp/>m<sp/>&lt;<sp/><ref refid="namespacetesseract_1a5ed5ea7e3054219b18144501c5ec3d1e" kindref="member">kMaxOffsetDist</ref>;<sp/>++m)<sp/>{</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>x_pos<sp/>=<sp/>f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1a6b250df12a9b06b5ed0c1a7c403f0275" kindref="member">X</ref><sp/>+<sp/>feature_dir.<ref refid="class_f_c_o_o_r_d_1a9edadbfc357c730f62fa3c92677b0d58" kindref="member">x</ref>()<sp/>*<sp/>(m<sp/>*<sp/>dir);</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>y_pos<sp/>=<sp/>f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1a09931683890fb52d22ec6c75048a2bce" kindref="member">Y</ref><sp/>+<sp/>feature_dir.<ref refid="class_f_c_o_o_r_d_1a397f7ce997b246df18e7bd5a20cc422e" kindref="member">y</ref>()<sp/>*<sp/>(m<sp/>*<sp/>dir);</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x<sp/>=<sp/><ref refid="helpers_8h_1ab60e4f82956a1f5fdb54d0d8303e95b7" kindref="member">IntCastRounded</ref>(x_pos);</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y<sp/>=<sp/><ref refid="helpers_8h_1ab60e4f82956a1f5fdb54d0d8303e95b7" kindref="member">IntCastRounded</ref>(y_pos);</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x<sp/>&gt;=<sp/>0<sp/>&amp;&amp;<sp/>x<sp/>&lt;=<sp/>MAX_UINT8<sp/>&amp;&amp;<sp/>y<sp/>&gt;=<sp/>0<sp/>&amp;&amp;<sp/>y<sp/>&lt;=<sp/><ref refid="host_8h_1a05682ca8de174141447ff05a2289a27c" kindref="member">MAX_UINT8</ref>)<sp/>{</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t" kindref="compound">INT_FEATURE_STRUCT</ref><sp/>offset_f;</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset_f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1a6b250df12a9b06b5ed0c1a7c403f0275" kindref="member">X</ref><sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset_f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1a09931683890fb52d22ec6c75048a2bce" kindref="member">Y</ref><sp/>=<sp/>y;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset_f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1af4a2ea6a7d9a82cba06f6ca9a126461b" kindref="member">Theta</ref><sp/>=<sp/>f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1af4a2ea6a7d9a82cba06f6ca9a126461b" kindref="member">Theta</ref>;</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>offset_index<sp/>=<sp/><ref refid="classtesseract_1_1_int_feature_map_1a39cd610b08359c77cbb9cce314d74d10" kindref="member">IndexFeature</ref>(offset_f);</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(offset_index<sp/>!=<sp/>index_feature<sp/>&amp;&amp;<sp/>offset_index<sp/>&gt;=<sp/>0)</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>offset_index;<sp/><sp/></highlight><highlight class="comment">//<sp/>Found<sp/>one.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;<sp/><sp/></highlight><highlight class="comment">//<sp/>Hit<sp/>the<sp/>edge<sp/>of<sp/>feature<sp/>space.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dir<sp/>==<sp/>2<sp/>||<sp/>dir<sp/>==<sp/>-2)<sp/>{</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Find<sp/>the<sp/>nearest<sp/>existing<sp/>index_feature.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>m<sp/>=<sp/>1;<sp/>m<sp/>&lt;<sp/><ref refid="namespacetesseract_1a5ed5ea7e3054219b18144501c5ec3d1e" kindref="member">kMaxOffsetDist</ref>;<sp/>++m)<sp/>{</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>theta<sp/>=<sp/>f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1af4a2ea6a7d9a82cba06f6ca9a126461b" kindref="member">Theta</ref><sp/>+<sp/>m<sp/>*<sp/>dir<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t" kindref="compound">INT_FEATURE_STRUCT</ref><sp/>offset_f;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>offset_f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1a6b250df12a9b06b5ed0c1a7c403f0275" kindref="member">X</ref><sp/>=<sp/>f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1a6b250df12a9b06b5ed0c1a7c403f0275" kindref="member">X</ref>;</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>offset_f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1a09931683890fb52d22ec6c75048a2bce" kindref="member">Y</ref><sp/>=<sp/>f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1a09931683890fb52d22ec6c75048a2bce" kindref="member">Y</ref>;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>offset_f.<ref refid="struct_i_n_t___f_e_a_t_u_r_e___s_t_r_u_c_t_1af4a2ea6a7d9a82cba06f6ca9a126461b" kindref="member">Theta</ref><sp/>=<sp/><ref refid="helpers_8h_1a560c3ba94fe224dd67b10bd4cb5a6886" kindref="member">Modulo</ref>(theta,<sp/>256);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>offset_index<sp/>=<sp/><ref refid="classtesseract_1_1_int_feature_map_1a39cd610b08359c77cbb9cce314d74d10" kindref="member">IndexFeature</ref>(offset_f);</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(offset_index<sp/>!=<sp/>index_feature<sp/>&amp;&amp;<sp/>offset_index<sp/>&gt;=<sp/>0)</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>offset_index;<sp/><sp/></highlight><highlight class="comment">//<sp/>Found<sp/>one.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;<sp/><sp/></highlight><highlight class="comment">//<sp/>Nothing<sp/>within<sp/>the<sp/>max<sp/>distance.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal">}</highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal">}<sp/><sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>tesseract.</highlight><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="/Users/makoto/Desktop/trunk/classify/intfeaturemap.cpp"/>
  </compounddef>
</doxygen>
