<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.4">
  <compounddef id="makerow_8cpp" kind="file">
    <compoundname>makerow.cpp</compoundname>
    <includes refid="mfcpch_8h" local="yes">mfcpch.h</includes>
    <includes refid="stderr_8h" local="yes">stderr.h</includes>
    <includes refid="blobbox_8h" local="yes">blobbox.h</includes>
    <includes refid="ccstruct_8h" local="yes">ccstruct.h</includes>
    <includes refid="detlinefit_8h" local="yes">detlinefit.h</includes>
    <includes refid="statistc_8h" local="yes">statistc.h</includes>
    <includes refid="drawtord_8h" local="yes">drawtord.h</includes>
    <includes refid="blkocc_8h" local="yes">blkocc.h</includes>
    <includes refid="sortflts_8h" local="yes">sortflts.h</includes>
    <includes refid="oldbasel_8h" local="yes">oldbasel.h</includes>
    <includes refid="textord_8h" local="yes">textord.h</includes>
    <includes refid="tordmain_8h" local="yes">tordmain.h</includes>
    <includes refid="underlin_8h" local="yes">underlin.h</includes>
    <includes refid="makerow_8h" local="yes">makerow.h</includes>
    <includes refid="tprintf_8h" local="yes">tprintf.h</includes>
    <includes refid="tovars_8h" local="yes">tovars.h</includes>
    <incdepgraph>
      <node id="38626">
        <label>cutil_class.h</label>
        <link refid="cutil__class_8h"/>
        <childnode refid="38627" relation="include">
        </childnode>
        <childnode refid="38636" relation="include">
        </childnode>
        <childnode refid="38599" relation="include">
        </childnode>
      </node>
      <node id="38637">
        <label>image.h</label>
        <link refid="image_8h"/>
      </node>
      <node id="38582">
        <label>blobbox.h</label>
        <link refid="blobbox_8h"/>
        <childnode refid="38583" relation="include">
        </childnode>
        <childnode refid="38592" relation="include">
        </childnode>
        <childnode refid="38593" relation="include">
        </childnode>
        <childnode refid="38616" relation="include">
        </childnode>
        <childnode refid="38623" relation="include">
        </childnode>
      </node>
      <node id="38576">
        <label>mfcpch.h</label>
        <link refid="mfcpch_8h"/>
      </node>
      <node id="38577">
        <label>stderr.h</label>
        <link refid="stderr_8h"/>
        <childnode refid="38578" relation="include">
        </childnode>
      </node>
      <node id="38598">
        <label>ndminx.h</label>
        <link refid="ndminx_8h"/>
      </node>
      <node id="38623">
        <label>statistc.h</label>
        <link refid="statistc_8h"/>
        <childnode refid="38584" relation="include">
        </childnode>
        <childnode refid="38579" relation="include">
        </childnode>
        <childnode refid="38611" relation="include">
        </childnode>
      </node>
      <node id="38636">
        <label>const.h</label>
        <link refid="const_8h"/>
      </node>
      <node id="38586">
        <label>stdlib.h</label>
      </node>
      <node id="38580">
        <label>platform.h</label>
        <link refid="platform_8h"/>
        <childnode refid="38581" relation="include">
        </childnode>
      </node>
      <node id="38638">
        <label>detlinefit.h</label>
        <link refid="detlinefit_8h"/>
        <childnode refid="38605" relation="include">
        </childnode>
      </node>
      <node id="38601">
        <label>blckerr.h</label>
        <link refid="blckerr_8h"/>
        <childnode refid="38578" relation="include">
        </childnode>
      </node>
      <node id="38645">
        <label>oldbasel.h</label>
        <link refid="oldbasel_8h"/>
        <childnode refid="38594" relation="include">
        </childnode>
        <childnode refid="38582" relation="include">
        </childnode>
        <childnode refid="38642" relation="include">
        </childnode>
      </node>
      <node id="38627">
        <label>ccutil.h</label>
        <link refid="ccutil_8h"/>
        <childnode refid="38628" relation="include">
        </childnode>
        <childnode refid="38578" relation="include">
        </childnode>
        <childnode refid="38599" relation="include">
        </childnode>
        <childnode refid="38633" relation="include">
        </childnode>
        <childnode refid="38594" relation="include">
        </childnode>
        <childnode refid="38631" relation="include">
        </childnode>
        <childnode refid="38634" relation="include">
        </childnode>
        <childnode refid="38635" relation="include">
        </childnode>
      </node>
      <node id="38611">
        <label>scrollview.h</label>
        <link refid="scrollview_8h"/>
        <childnode refid="38584" relation="include">
        </childnode>
      </node>
      <node id="38639">
        <label>drawtord.h</label>
        <link refid="drawtord_8h"/>
        <childnode refid="38594" relation="include">
        </childnode>
        <childnode refid="38611" relation="include">
        </childnode>
        <childnode refid="38640" relation="include">
        </childnode>
        <childnode refid="38582" relation="include">
        </childnode>
        <childnode refid="38642" relation="include">
        </childnode>
      </node>
      <node id="38641">
        <label>pithsync.h</label>
        <link refid="pithsync_8h"/>
        <childnode refid="38582" relation="include">
        </childnode>
        <childnode refid="38594" relation="include">
        </childnode>
        <childnode refid="38623" relation="include">
        </childnode>
        <childnode refid="38642" relation="include">
        </childnode>
      </node>
      <node id="38585">
        <label>serialis.h</label>
        <link refid="serialis_8h"/>
        <childnode refid="38586" relation="include">
        </childnode>
        <childnode refid="38587" relation="include">
        </childnode>
        <childnode refid="38584" relation="include">
        </childnode>
        <childnode refid="38588" relation="include">
        </childnode>
        <childnode refid="38578" relation="include">
        </childnode>
        <childnode refid="38590" relation="include">
        </childnode>
      </node>
      <node id="38583">
        <label>clst.h</label>
        <link refid="clst_8h"/>
        <childnode refid="38584" relation="include">
        </childnode>
        <childnode refid="38579" relation="include">
        </childnode>
        <childnode refid="38585" relation="include">
        </childnode>
        <childnode refid="38591" relation="include">
        </childnode>
      </node>
      <node id="38575">
        <label>textord/makerow.cpp</label>
        <link refid="makerow.cpp"/>
        <childnode refid="38576" relation="include">
        </childnode>
        <childnode refid="38577" relation="include">
        </childnode>
        <childnode refid="38582" relation="include">
        </childnode>
        <childnode refid="38624" relation="include">
        </childnode>
        <childnode refid="38638" relation="include">
        </childnode>
        <childnode refid="38623" relation="include">
        </childnode>
        <childnode refid="38639" relation="include">
        </childnode>
        <childnode refid="38643" relation="include">
        </childnode>
        <childnode refid="38644" relation="include">
        </childnode>
        <childnode refid="38645" relation="include">
        </childnode>
        <childnode refid="38646" relation="include">
        </childnode>
        <childnode refid="38648" relation="include">
        </childnode>
        <childnode refid="38652" relation="include">
        </childnode>
        <childnode refid="38654" relation="include">
        </childnode>
        <childnode refid="38612" relation="include">
        </childnode>
        <childnode refid="38655" relation="include">
        </childnode>
      </node>
      <node id="38624">
        <label>ccstruct.h</label>
        <link refid="ccstruct_8h"/>
        <childnode refid="38625" relation="include">
        </childnode>
        <childnode refid="38637" relation="include">
        </childnode>
      </node>
      <node id="38602">
        <label>stepblob.h</label>
        <link refid="stepblob_8h"/>
        <childnode refid="38603" relation="include">
        </childnode>
        <childnode refid="38610" relation="include">
        </childnode>
      </node>
      <node id="38589">
        <label>stddef.h</label>
      </node>
      <node id="38630">
        <label>memory.h</label>
      </node>
      <node id="38643">
        <label>blkocc.h</label>
        <link refid="blkocc_8h"/>
        <childnode refid="38594" relation="include">
        </childnode>
        <childnode refid="38607" relation="include">
        </childnode>
        <childnode refid="38642" relation="include">
        </childnode>
      </node>
      <node id="38578">
        <label>errcode.h</label>
        <link refid="errcode_8h"/>
        <childnode refid="38579" relation="include">
        </childnode>
      </node>
      <node id="38621">
        <label>polyblk.h</label>
        <link refid="polyblk_8h"/>
        <childnode refid="38619" relation="include">
        </childnode>
        <childnode refid="38607" relation="include">
        </childnode>
        <childnode refid="38605" relation="include">
        </childnode>
        <childnode refid="38610" relation="include">
        </childnode>
        <childnode refid="38611" relation="include">
        </childnode>
        <childnode refid="38622" relation="include">
        </childnode>
      </node>
      <node id="38644">
        <label>sortflts.h</label>
        <link refid="sortflts_8h"/>
        <childnode refid="38607" relation="include">
        </childnode>
        <childnode refid="38642" relation="include">
        </childnode>
      </node>
      <node id="38581">
        <label>limits.h</label>
      </node>
      <node id="38654">
        <label>makerow.h</label>
        <link refid="makerow_8h"/>
        <childnode refid="38594" relation="include">
        </childnode>
        <childnode refid="38616" relation="include">
        </childnode>
        <childnode refid="38650" relation="include">
        </childnode>
        <childnode refid="38582" relation="include">
        </childnode>
        <childnode refid="38623" relation="include">
        </childnode>
        <childnode refid="38642" relation="include">
        </childnode>
      </node>
      <node id="38640">
        <label>pitsync1.h</label>
        <link refid="pitsync1_8h"/>
        <childnode refid="38607" relation="include">
        </childnode>
        <childnode refid="38583" relation="include">
        </childnode>
        <childnode refid="38582" relation="include">
        </childnode>
        <childnode refid="38594" relation="include">
        </childnode>
        <childnode refid="38623" relation="include">
        </childnode>
        <childnode refid="38641" relation="include">
        </childnode>
        <childnode refid="38642" relation="include">
        </childnode>
      </node>
      <node id="38608">
        <label>ipoints.h</label>
        <link refid="ipoints_8h"/>
        <childnode refid="38606" relation="include">
        </childnode>
      </node>
      <node id="38609">
        <label>mod128.h</label>
        <link refid="mod128_8h"/>
        <childnode refid="38605" relation="include">
        </childnode>
      </node>
      <node id="38592">
        <label>elst2.h</label>
        <link refid="elst2_8h"/>
        <childnode refid="38584" relation="include">
        </childnode>
        <childnode refid="38579" relation="include">
        </childnode>
        <childnode refid="38585" relation="include">
        </childnode>
        <childnode refid="38591" relation="include">
        </childnode>
      </node>
      <node id="38634">
        <label>pthread.h</label>
      </node>
      <node id="38587">
        <label>string.h</label>
      </node>
      <node id="38632">
        <label>unicharmap.h</label>
        <link refid="unicharmap_8h"/>
        <childnode refid="38629" relation="include">
        </childnode>
      </node>
      <node id="38629">
        <label>unichar.h</label>
        <link refid="unichar_8h"/>
        <childnode refid="38630" relation="include">
        </childnode>
        <childnode refid="38587" relation="include">
        </childnode>
      </node>
      <node id="38625">
        <label>cutil.h</label>
        <link refid="cutil_8h"/>
        <childnode refid="38584" relation="include">
        </childnode>
        <childnode refid="38587" relation="include">
        </childnode>
        <childnode refid="38586" relation="include">
        </childnode>
        <childnode refid="38579" relation="include">
        </childnode>
        <childnode refid="38612" relation="include">
        </childnode>
        <childnode refid="38626" relation="include">
        </childnode>
      </node>
      <node id="38652">
        <label>underlin.h</label>
        <link refid="underlin_8h"/>
        <childnode refid="38653" relation="include">
        </childnode>
        <childnode refid="38642" relation="include">
        </childnode>
      </node>
      <node id="38610">
        <label>rect.h</label>
        <link refid="rect_8h"/>
        <childnode refid="38606" relation="include">
        </childnode>
        <childnode refid="38605" relation="include">
        </childnode>
        <childnode refid="38598" relation="include">
        </childnode>
        <childnode refid="38611" relation="include">
        </childnode>
        <childnode refid="38612" relation="include">
        </childnode>
      </node>
      <node id="38600">
        <label>bits16.h</label>
        <link refid="bits16_8h"/>
        <childnode refid="38579" relation="include">
        </childnode>
      </node>
      <node id="38596">
        <label>tesscallback.h</label>
        <link refid="tesscallback_8h"/>
        <childnode refid="38579" relation="include">
        </childnode>
      </node>
      <node id="38635">
        <label>semaphore.h</label>
      </node>
      <node id="38603">
        <label>coutln.h</label>
        <link refid="coutln_8h"/>
        <childnode refid="38604" relation="include">
        </childnode>
        <childnode refid="38609" relation="include">
        </childnode>
        <childnode refid="38600" relation="include">
        </childnode>
        <childnode refid="38610" relation="include">
        </childnode>
        <childnode refid="38601" relation="include">
        </childnode>
        <childnode refid="38611" relation="include">
        </childnode>
      </node>
      <node id="38593">
        <label>werd.h</label>
        <link refid="werd_8h"/>
        <childnode refid="38594" relation="include">
        </childnode>
        <childnode refid="38600" relation="include">
        </childnode>
        <childnode refid="38592" relation="include">
        </childnode>
        <childnode refid="38599" relation="include">
        </childnode>
        <childnode refid="38601" relation="include">
        </childnode>
        <childnode refid="38602" relation="include">
        </childnode>
        <childnode refid="38613" relation="include">
        </childnode>
      </node>
      <node id="38655">
        <label>tovars.h</label>
        <link refid="tovars_8h"/>
        <childnode refid="38594" relation="include">
        </childnode>
        <childnode refid="38642" relation="include">
        </childnode>
      </node>
      <node id="38613">
        <label>ocrrow.h</label>
        <link refid="ocrrow_8h"/>
        <childnode refid="38584" relation="include">
        </childnode>
        <childnode refid="38614" relation="include">
        </childnode>
        <childnode refid="38593" relation="include">
        </childnode>
      </node>
      <node id="38590">
        <label>fileerr.h</label>
        <link refid="fileerr_8h"/>
        <childnode refid="38578" relation="include">
        </childnode>
      </node>
      <node id="38628">
        <label>ambigs.h</label>
        <link refid="ambigs_8h"/>
        <childnode refid="38607" relation="include">
        </childnode>
        <childnode refid="38612" relation="include">
        </childnode>
        <childnode refid="38629" relation="include">
        </childnode>
        <childnode refid="38631" relation="include">
        </childnode>
        <childnode refid="38595" relation="include">
        </childnode>
      </node>
      <node id="38649">
        <label>time.h</label>
      </node>
      <node id="38606">
        <label>math.h</label>
      </node>
      <node id="38604">
        <label>crakedge.h</label>
        <link refid="crakedge_8h"/>
        <childnode refid="38605" relation="include">
        </childnode>
        <childnode refid="38609" relation="include">
        </childnode>
      </node>
      <node id="38591">
        <label>lsterr.h</label>
        <link refid="lsterr_8h"/>
        <childnode refid="38578" relation="include">
        </childnode>
      </node>
      <node id="38648">
        <label>tordmain.h</label>
        <link refid="tordmain_8h"/>
        <childnode refid="38649" relation="include">
        </childnode>
        <childnode refid="38594" relation="include">
        </childnode>
        <childnode refid="38616" relation="include">
        </childnode>
        <childnode refid="38650" relation="include">
        </childnode>
        <childnode refid="38582" relation="include">
        </childnode>
        <childnode refid="38642" relation="include">
        </childnode>
      </node>
      <node id="38615">
        <label>quadratc.h</label>
        <link refid="quadratc_8h"/>
        <childnode refid="38605" relation="include">
        </childnode>
      </node>
      <node id="38653">
        <label>fpchop.h</label>
        <link refid="fpchop_8h"/>
        <childnode refid="38594" relation="include">
        </childnode>
        <childnode refid="38582" relation="include">
        </childnode>
        <childnode refid="38642" relation="include">
        </childnode>
      </node>
      <node id="38651">
        <label>vecfuncs.h</label>
        <link refid="vecfuncs_8h"/>
        <childnode refid="38606" relation="include">
        </childnode>
        <childnode refid="38650" relation="include">
        </childnode>
      </node>
      <node id="38619">
        <label>publictypes.h</label>
        <link refid="publictypes_8h"/>
      </node>
      <node id="38647">
        <label>gap_map.h</label>
        <link refid="gap__map_8h"/>
        <childnode refid="38582" relation="include">
        </childnode>
        <childnode refid="38642" relation="include">
        </childnode>
      </node>
      <node id="38616">
        <label>ocrblock.h</label>
        <link refid="ocrblock_8h"/>
        <childnode refid="38617" relation="include">
        </childnode>
        <childnode refid="38618" relation="include">
        </childnode>
        <childnode refid="38613" relation="include">
        </childnode>
        <childnode refid="38620" relation="include">
        </childnode>
      </node>
      <node id="38594">
        <label>params.h</label>
        <link refid="params_8h"/>
        <childnode refid="38584" relation="include">
        </childnode>
        <childnode refid="38595" relation="include">
        </childnode>
        <childnode refid="38599" relation="include">
        </childnode>
      </node>
      <node id="38595">
        <label>genericvector.h</label>
        <link refid="genericvector_8h"/>
        <childnode refid="38584" relation="include">
        </childnode>
        <childnode refid="38586" relation="include">
        </childnode>
        <childnode refid="38596" relation="include">
        </childnode>
        <childnode refid="38578" relation="include">
        </childnode>
        <childnode refid="38597" relation="include">
        </childnode>
        <childnode refid="38598" relation="include">
        </childnode>
      </node>
      <node id="38588">
        <label>memry.h</label>
        <link refid="memry_8h"/>
        <childnode refid="38589" relation="include">
        </childnode>
        <childnode refid="38579" relation="include">
        </childnode>
      </node>
      <node id="38646">
        <label>textord.h</label>
        <link refid="textord_8h"/>
        <childnode refid="38624" relation="include">
        </childnode>
        <childnode refid="38582" relation="include">
        </childnode>
        <childnode refid="38647" relation="include">
        </childnode>
        <childnode refid="38642" relation="include">
        </childnode>
        <childnode refid="38619" relation="include">
        </childnode>
      </node>
      <node id="38618">
        <label>ocrpara.h</label>
        <link refid="ocrpara_8h"/>
        <childnode refid="38619" relation="include">
        </childnode>
        <childnode refid="38607" relation="include">
        </childnode>
        <childnode refid="38599" relation="include">
        </childnode>
      </node>
      <node id="38607">
        <label>elst.h</label>
        <link refid="elst_8h"/>
        <childnode refid="38584" relation="include">
        </childnode>
        <childnode refid="38579" relation="include">
        </childnode>
        <childnode refid="38585" relation="include">
        </childnode>
        <childnode refid="38591" relation="include">
        </childnode>
      </node>
      <node id="38631">
        <label>unicharset.h</label>
        <link refid="unicharset_8h"/>
        <childnode refid="38578" relation="include">
        </childnode>
        <childnode refid="38597" relation="include">
        </childnode>
        <childnode refid="38599" relation="include">
        </childnode>
        <childnode refid="38596" relation="include">
        </childnode>
        <childnode refid="38629" relation="include">
        </childnode>
        <childnode refid="38632" relation="include">
        </childnode>
      </node>
      <node id="38605">
        <label>points.h</label>
        <link refid="points_8h"/>
        <childnode refid="38584" relation="include">
        </childnode>
        <childnode refid="38606" relation="include">
        </childnode>
        <childnode refid="38607" relation="include">
        </childnode>
        <childnode refid="38608" relation="include">
        </childnode>
      </node>
      <node id="38642">
        <label>notdll.h</label>
        <link refid="notdll_8h"/>
      </node>
      <node id="38617">
        <label>img.h</label>
        <link refid="img_8h"/>
        <childnode refid="38588" relation="include">
        </childnode>
      </node>
      <node id="38612">
        <label>tprintf.h</label>
        <link refid="tprintf_8h"/>
        <childnode refid="38594" relation="include">
        </childnode>
      </node>
      <node id="38622">
        <label>hpddef.h</label>
        <link refid="hpddef_8h"/>
      </node>
      <node id="38579">
        <label>host.h</label>
        <link refid="host_8h"/>
        <childnode refid="38580" relation="include">
        </childnode>
      </node>
      <node id="38620">
        <label>pdblock.h</label>
        <link refid="pdblock_8h"/>
        <childnode refid="38583" relation="include">
        </childnode>
        <childnode refid="38617" relation="include">
        </childnode>
        <childnode refid="38599" relation="include">
        </childnode>
        <childnode refid="38621" relation="include">
        </childnode>
        <childnode refid="38622" relation="include">
        </childnode>
      </node>
      <node id="38584">
        <label>stdio.h</label>
      </node>
      <node id="38633">
        <label>tessdatamanager.h</label>
        <link refid="tessdatamanager_8h"/>
        <childnode refid="38584" relation="include">
        </childnode>
        <childnode refid="38579" relation="include">
        </childnode>
        <childnode refid="38612" relation="include">
        </childnode>
      </node>
      <node id="38599">
        <label>strngs.h</label>
        <link refid="strngs_8h"/>
        <childnode refid="38584" relation="include">
        </childnode>
        <childnode refid="38587" relation="include">
        </childnode>
        <childnode refid="38580" relation="include">
        </childnode>
        <childnode refid="38588" relation="include">
        </childnode>
      </node>
      <node id="38650">
        <label>blobs.h</label>
        <link refid="blobs_8h"/>
        <childnode refid="38583" relation="include">
        </childnode>
        <childnode refid="38610" relation="include">
        </childnode>
        <childnode refid="38651" relation="include">
        </childnode>
      </node>
      <node id="38597">
        <label>helpers.h</label>
        <link refid="helpers_8h"/>
        <childnode refid="38584" relation="include">
        </childnode>
        <childnode refid="38587" relation="include">
        </childnode>
      </node>
      <node id="38614">
        <label>quspline.h</label>
        <link refid="quspline_8h"/>
        <childnode refid="38615" relation="include">
        </childnode>
        <childnode refid="38585" relation="include">
        </childnode>
        <childnode refid="38588" relation="include">
        </childnode>
        <childnode refid="38610" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <innernamespace refid="namespacetesseract">tesseract</innernamespace>
      <sectiondef kind="user-defined">
      <header>make_single_row</header>
      <description><para>Arrange the blobs into a single row... well actually, if there is only a single blob, it makes 2 rows, in case the top-level blob is a container of the real blobs to recognize. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a8ebead3fdc06fe853348b0ea851a3e31" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>float</type>
        <definition>float make_single_row</definition>
        <argsstring>(ICOORD page_tr, TO_BLOCK *block, TO_BLOCK_LIST *blocks)</argsstring>
        <name>make_single_row</name>
        <param>
          <type><ref refid="class_i_c_o_o_r_d" kindref="compound">ICOORD</ref></type>
          <declname>page_tr</declname>
        </param>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type>TO_BLOCK_LIST *</type>
          <declname>blocks</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="167" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="167" bodyend="190"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>make_rows</header>
      <description><para>Arrange the blobs into rows. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1ade98619ec77aab7e466a06b0940088a5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>float</type>
        <definition>float make_rows</definition>
        <argsstring>(ICOORD page_tr, TO_BLOCK_LIST *port_blocks)</argsstring>
        <name>make_rows</name>
        <param>
          <type><ref refid="class_i_c_o_o_r_d" kindref="compound">ICOORD</ref></type>
          <declname>page_tr</declname>
        </param>
        <param>
          <type>TO_BLOCK_LIST *</type>
          <declname>port_blocks</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="197" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="197" bodyend="216"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>make_initial_textrows</header>
      <description><para>Arrange the good blobs into rows of text. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a48c3f4056000484fe2915d98be4ce681" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void make_initial_textrows</definition>
        <argsstring>(ICOORD page_tr, TO_BLOCK *block, FCOORD rotation, BOOL8 testing_on)</argsstring>
        <name>make_initial_textrows</name>
        <param>
          <type><ref refid="class_i_c_o_o_r_d" kindref="compound">ICOORD</ref></type>
          <declname>page_tr</declname>
        </param>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref></type>
          <declname>rotation</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
          <declname>testing_on</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="236" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="236" bodyend="268"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>fit_lms_line</header>
      <description><para>Fit an LMS line to a row. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1ab33fbd787683743809a9c6036d541ee9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void fit_lms_line</definition>
        <argsstring>(TO_ROW *row)</argsstring>
        <name>fit_lms_line</name>
        <param>
          <type><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref> *</type>
          <declname>row</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="276" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="276" bodyend="287"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>compute_page_skew</header>
      <description><para>Compute the skew over a full page by averaging the gradients over all the lines. Get the error of the same row. </para></description>
      <memberdef kind="variable" id="makerow_8cpp_1af9da918f4c268e7bfd9300632b056be2" prot="public" static="no" mutable="no">
        <type>const double</type>
        <definition>const double kNoiseSize</definition>
        <argsstring></argsstring>
        <name>kNoiseSize</name>
        <initializer>= 0.5</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="392" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="392" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="makerow_8cpp_1a1baaf7ab16613cd7b5a13a28d65412b3" prot="public" static="no" mutable="no">
        <type>const int</type>
        <definition>const int kMinSize</definition>
        <argsstring></argsstring>
        <name>kMinSize</name>
        <initializer>= 8</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="393" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="393" bodyend="-1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1ab9ad937a552fbb9c0f7f24e94b9d5e09" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void compute_page_skew</definition>
        <argsstring>(TO_BLOCK_LIST *blocks, float &amp;page_m, float &amp;page_err)</argsstring>
        <name>compute_page_skew</name>
        <param>
          <type>TO_BLOCK_LIST *</type>
          <declname>blocks</declname>
        </param>
        <param>
          <type>float &amp;</type>
          <declname>page_m</declname>
        </param>
        <param>
          <type>float &amp;</type>
          <declname>page_err</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="296" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="296" bodyend="390"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a90ccf46408d4dc726cb6ad4b7abb731d" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>bool</type>
        <definition>static bool dot_of_i</definition>
        <argsstring>(BLOBNBOX *dot, BLOBNBOX *i, TO_ROW *row)</argsstring>
        <name>dot_of_i</name>
        <param>
          <type><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref> *</type>
          <declname>dot</declname>
        </param>
        <param>
          <type><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref> *</type>
          <declname>i</declname>
        </param>
        <param>
          <type><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref> *</type>
          <declname>row</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Return true if the dot looks like it is part of the i. Doesn&apos;t work for any other diacritical. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="399" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="399" bodyend="480"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1afdc4c4b87028fd7aafcb679f92364d21" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void vigorous_noise_removal</definition>
        <argsstring>(TO_BLOCK *block)</argsstring>
        <name>vigorous_noise_removal</name>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="482" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="482" bodyend="527"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a963ac786bbbcafd731d9b974f9164645" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void cleanup_rows_making</definition>
        <argsstring>(ICOORD page_tr, TO_BLOCK *block, float gradient, FCOORD rotation, inT32 block_edge, BOOL8 testing_on)</argsstring>
        <name>cleanup_rows_making</name>
        <param>
          <type><ref refid="class_i_c_o_o_r_d" kindref="compound">ICOORD</ref></type>
          <declname>page_tr</declname>
        </param>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type>float</type>
          <declname>gradient</declname>
        </param>
        <param>
          <type><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref></type>
          <declname>rotation</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>block_edge</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
          <declname>testing_on</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>cleanup_rows_making</para><para>Remove overlapping rows and fit all the blobs to what&apos;s left. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="534" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="534" bodyend="580"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a064bc924e529f5c292a533328065c880" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void delete_non_dropout_rows</definition>
        <argsstring>(TO_BLOCK *block, float gradient, FCOORD rotation, inT32 block_edge, BOOL8 testing_on)</argsstring>
        <name>delete_non_dropout_rows</name>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type>float</type>
          <declname>gradient</declname>
        </param>
        <param>
          <type><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref></type>
          <declname>rotation</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>block_edge</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
          <declname>testing_on</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>delete_non_dropout_rows</para><para>Compute the linespacing and offset. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="667" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="667" bodyend="746"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>find_best_dropout_row</header>
      <description><para>Delete this row if it has a neighbour with better dropout characteristics. TRUE is returned if the row should be deleted. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a691a8a66ddd732c9c3e57a0561ed3848" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
        <definition>BOOL8 find_best_dropout_row</definition>
        <argsstring>(TO_ROW *row, inT32 distance, float dist_limit, inT32 line_index, TO_ROW_IT *row_it, BOOL8 testing_on)</argsstring>
        <name>find_best_dropout_row</name>
        <param>
          <type><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref> *</type>
          <declname>row</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>distance</declname>
        </param>
        <param>
          <type>float</type>
          <declname>dist_limit</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>line_index</declname>
        </param>
        <param>
          <type>TO_ROW_IT *</type>
          <declname>row_it</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
          <declname>testing_on</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="755" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="755" bodyend="826"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>deskew_block_coords</header>
      <description><para>Compute the bounding box of all the blobs in the block if they were deskewed without actually doing it. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1afcd9d2bb6d7f6b16e31ed5a75799f43d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref></type>
        <definition>TBOX deskew_block_coords</definition>
        <argsstring>(TO_BLOCK *block, float gradient)</argsstring>
        <name>deskew_block_coords</name>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type>float</type>
          <declname>gradient</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="835" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="835" bodyend="862"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>compute_line_occupation</header>
      <description><para>Compute the pixel projection back on the y axis given the global skew. Also compute the 1st derivative. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a8c7ec8665e61df259e140e8e1c81a743" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void compute_line_occupation</definition>
        <argsstring>(TO_BLOCK *block, float gradient, inT32 min_y, inT32 max_y, inT32 *occupation, inT32 *deltas)</argsstring>
        <name>compute_line_occupation</name>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type>float</type>
          <declname>gradient</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>min_y</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>max_y</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref> *</type>
          <declname>occupation</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref> *</type>
          <declname>deltas</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="871" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="871" bodyend="929"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a3a483ed820ddbd43d809542e5a3d934f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void compute_occupation_threshold</definition>
        <argsstring>(inT32 low_window, inT32 high_window, inT32 line_count, inT32 *occupation, inT32 *thresholds)</argsstring>
        <name>compute_occupation_threshold</name>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>low_window</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>high_window</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>line_count</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref> *</type>
          <declname>occupation</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref> *</type>
          <declname>thresholds</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>compute_occupation_threshold</para><para>Compute thresholds for textline or not for the occupation array. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="937" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="937" bodyend="1010"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>compute_dropout_distances</header>
      <description><para>Compute the distance from each coordinate to the nearest dropout. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1ac0e0c477a9aaee3c2ff39b540a814d50" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void compute_dropout_distances</definition>
        <argsstring>(inT32 *occupation, inT32 *thresholds, inT32 line_count)</argsstring>
        <name>compute_dropout_distances</name>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref> *</type>
          <declname>occupation</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref> *</type>
          <declname>thresholds</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>line_count</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="1018" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="1018" bodyend="1055"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>expand_rows</header>
      <description><para>Expand each row to the least of its allowed size and touching its neighbours. If the expansion would entirely swallow a neighbouring row then do so. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1aa7a5766705cc30b622092e75022c5cbf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void expand_rows</definition>
        <argsstring>(ICOORD page_tr, TO_BLOCK *block, float gradient, FCOORD rotation, inT32 block_edge, BOOL8 testing_on)</argsstring>
        <name>expand_rows</name>
        <param>
          <type><ref refid="class_i_c_o_o_r_d" kindref="compound">ICOORD</ref></type>
          <declname>page_tr</declname>
        </param>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type>float</type>
          <declname>gradient</declname>
        </param>
        <param>
          <type><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref></type>
          <declname>rotation</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>block_edge</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
          <declname>testing_on</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="1065" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="1065" bodyend="1215"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1af6c80d96579d43cb4e29057c8f1e0f41" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void adjust_row_limits</definition>
        <argsstring>(TO_BLOCK *block)</argsstring>
        <name>adjust_row_limits</name>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>adjust_row_limits</para><para>Change the limits of rows to suit the default fractions. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="1223" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="1223" bodyend="1251"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>compute_row_stats</header>
      <description><para>Compute the linespacing and offset. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a268477cc476799d18c47302827f53bcc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void compute_row_stats</definition>
        <argsstring>(TO_BLOCK *block, BOOL8 testing_on)</argsstring>
        <name>compute_row_stats</name>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
          <declname>testing_on</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="1259" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="1259" bodyend="1341"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>fill_heights</header>
      <description><para>Fill the given heights with heights of the blobs that are legal candidates for estimating xheight. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a0bb04d9973fd564b4ada5c96c24adb09" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void fill_heights</definition>
        <argsstring>(TO_ROW *row, float gradient, int min_height, int max_height, STATS *heights, STATS *floating_heights)</argsstring>
        <name>fill_heights</name>
        <param>
          <type><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref> *</type>
          <declname>row</declname>
        </param>
        <param>
          <type>float</type>
          <declname>gradient</declname>
        </param>
        <param>
          <type>int</type>
          <declname>min_height</declname>
        </param>
        <param>
          <type>int</type>
          <declname>max_height</declname>
        </param>
        <param>
          <type><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref> *</type>
          <declname>heights</declname>
        </param>
        <param>
          <type><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref> *</type>
          <declname>floating_heights</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="1526" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="1526" bodyend="1569"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>compute_xheight_from_modes</header>
      <description><para>Given a <ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref> object heights, looks for two most frequently occurring heights that look like xheight and xheight + ascrise. If found, sets the values of *xheight and *ascrise accordingly, otherwise sets xheight to any most frequently occurring height and sets *ascrise to 0. Returns the number of times xheight occurred in heights. For each mode that is considered for being an xheight the count of floating blobs (stored in floating_heights) is subtracted from the total count of the blobs of this height. This is done because blobs that sit far above the baseline could represent valid ascenders, but it is highly unlikely that such a character&apos;s height will be an xheight (e.g. -, &apos;, =, ^, `, ", &apos;, etc) If cap_only, then force finding of only the top mode. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a4c2a6be7aee93caa4d9f9ca9f919b2a1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int compute_xheight_from_modes</definition>
        <argsstring>(STATS *heights, STATS *floating_heights, bool cap_only, int min_height, int max_height, float *xheight, float *ascrise)</argsstring>
        <name>compute_xheight_from_modes</name>
        <param>
          <type><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref> *</type>
          <declname>heights</declname>
        </param>
        <param>
          <type><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref> *</type>
          <declname>floating_heights</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>cap_only</declname>
        </param>
        <param>
          <type>int</type>
          <declname>min_height</declname>
        </param>
        <param>
          <type>int</type>
          <declname>max_height</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>xheight</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>ascrise</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="1587" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="1587" bodyend="1669"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>compute_row_descdrop</header>
      <description><para>Estimates the descdrop of this row. This function looks for &quot;significant&quot; descenders of lowercase letters (those that could not just be the small descenders of upper case letters like Q,J). The function also takes into account how many potential ascenders this row might contain. If the number of potential ascenders along with descenders is close to the expected fraction of the total number of blobs in the row, the function returns the descender height, returns 0 otherwise. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1ad04f46fc69514ad2086061ef889b5e23" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
        <definition>inT32 compute_row_descdrop</definition>
        <argsstring>(TO_ROW *row, float gradient, int xheight_blob_count, STATS *asc_heights)</argsstring>
        <name>compute_row_descdrop</name>
        <param>
          <type><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref> *</type>
          <declname>row</declname>
        </param>
        <param>
          <type>float</type>
          <declname>gradient</declname>
        </param>
        <param>
          <type>int</type>
          <declname>xheight_blob_count</declname>
        </param>
        <param>
          <type><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref> *</type>
          <declname>asc_heights</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="1683" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="1683" bodyend="1734"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>compute_height_modes</header>
      <description><para>Find the top maxmodes values in the input array and put their indices in the output in the order in which they occurred. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a796af03d9d0fe26e0563a5714cb83741" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
        <definition>inT32 compute_height_modes</definition>
        <argsstring>(STATS *heights, inT32 min_height, inT32 max_height, inT32 *modes, inT32 maxmodes)</argsstring>
        <name>compute_height_modes</name>
        <param>
          <type><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref> *</type>
          <declname>heights</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>min_height</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>max_height</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref> *</type>
          <declname>modes</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>maxmodes</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="1743" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="1743" bodyend="1796"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>correct_row_xheight</header>
      <description><para>Adjust the xheight etc of this row if not within reasonable limits of the average for the block. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a816de2bcfeae782b4ba8506075925284" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void correct_row_xheight</definition>
        <argsstring>(TO_ROW *row, float xheight, float ascrise, float descdrop)</argsstring>
        <name>correct_row_xheight</name>
        <param>
          <type><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref> *</type>
          <declname>row</declname>
        </param>
        <param>
          <type>float</type>
          <declname>xheight</declname>
        </param>
        <param>
          <type>float</type>
          <declname>ascrise</declname>
        </param>
        <param>
          <type>float</type>
          <declname>descdrop</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="1805" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="1805" bodyend="1870"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a0bf5ce532c73d8c9663a76166aafcf43" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>static int CountOverlaps</definition>
        <argsstring>(const TBOX &amp;box, int min_height, BLOBNBOX_LIST *blobs)</argsstring>
        <name>CountOverlaps</name>
        <param>
          <type>const <ref refid="class_t_b_o_x" kindref="compound">TBOX</ref> &amp;</type>
          <declname>box</declname>
        </param>
        <param>
          <type>int</type>
          <declname>min_height</declname>
        </param>
        <param>
          <type>BLOBNBOX_LIST *</type>
          <declname>blobs</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="1872" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="1872" bodyend="1884"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>separate_underlines</header>
      <description><para>Test wide objects for being potential underlines. If they are then put them in a separate list in the block. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a004e5d894712f552369ef523a09bc3ce" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void separate_underlines</definition>
        <argsstring>(TO_BLOCK *block, float gradient, FCOORD rotation, BOOL8 testing_on)</argsstring>
        <name>separate_underlines</name>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type>float</type>
          <declname>gradient</declname>
        </param>
        <param>
          <type><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref></type>
          <declname>rotation</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
          <declname>testing_on</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="1892" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="1892" bodyend="1957"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>pre_associate_blobs</header>
      <description><para>Associate overlapping blobs and fake chop wide blobs. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a8a932e3bd44fc2fc6fbdc291cdc9b942" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void pre_associate_blobs</definition>
        <argsstring>(ICOORD page_tr, TO_BLOCK *block, FCOORD rotation, BOOL8 testing_on)</argsstring>
        <name>pre_associate_blobs</name>
        <param>
          <type><ref refid="class_i_c_o_o_r_d" kindref="compound">ICOORD</ref></type>
          <declname>page_tr</declname>
        </param>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref></type>
          <declname>rotation</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
          <declname>testing_on</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="1965" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="1965" bodyend="2043"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>fit_parallel_rows</header>
      <description><para>Re-fit the rows in the block to the given gradient. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1abd52b97627f2779855a74b0b9fcae6b2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void fit_parallel_rows</definition>
        <argsstring>(TO_BLOCK *block, float gradient, FCOORD rotation, inT32 block_edge, BOOL8 testing_on)</argsstring>
        <name>fit_parallel_rows</name>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type>float</type>
          <declname>gradient</declname>
        </param>
        <param>
          <type><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref></type>
          <declname>rotation</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>block_edge</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
          <declname>testing_on</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="2051" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="2051" bodyend="2083"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>fit_parallel_lms</header>
      <description><para>Fit an LMS line to a row. Make the fit parallel to the given gradient and set the row accordingly. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a7f6f87295a49c2966d0487e5fdddad3f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void fit_parallel_lms</definition>
        <argsstring>(float gradient, TO_ROW *row)</argsstring>
        <name>fit_parallel_lms</name>
        <param>
          <type>float</type>
          <declname>gradient</declname>
        </param>
        <param>
          <type><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref> *</type>
          <declname>row</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="2093" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="2093" bodyend="2114"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>make_baseline_spline</header>
      <description><para>Fit an LMS line to a row. Make the fit parallel to the given gradient and set the row accordingly. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1aff7570e5894808af04a93d3e967c65a2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void make_baseline_spline</definition>
        <argsstring>(TO_ROW *row, TO_BLOCK *block)</argsstring>
        <name>make_baseline_spline</name>
        <param>
          <type><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref> *</type>
          <declname>row</declname>
        </param>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="2178" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="2178" bodyend="2201"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>segment_baseline</header>
      <description><para>Divide the baseline up into segments which require a different quadratic fitted to them. Return TRUE if enough blobs were far enough away to need a quadratic. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a484016bb062f4465f67644f12326ccdd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
        <definition>BOOL8 segment_baseline</definition>
        <argsstring>(TO_ROW *row, TO_BLOCK *block, inT32 &amp;segments, inT32 xstarts[])</argsstring>
        <name>segment_baseline</name>
        <param>
          <type><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref> *</type>
          <declname>row</declname>
        </param>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref> &amp;</type>
          <declname>segments</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>xstarts</declname>
          <array>[]</array>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="2212" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="2212" bodyend="2300"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>linear_spline_baseline</header>
      <description><para>Divide the baseline up into segments which require a different quadratic fitted to them. <simplesect kind="return"><para>TRUE if enough blobs were far enough away to need a quadratic. </para></simplesect>
</para></description>
      <memberdef kind="function" id="makerow_8cpp_1a55cfd9360105594dd39d262945f56965" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double *</type>
        <definition>double* linear_spline_baseline</definition>
        <argsstring>(TO_ROW *row, TO_BLOCK *block, inT32 &amp;segments, inT32 xstarts[])</argsstring>
        <name>linear_spline_baseline</name>
        <param>
          <type><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref> *</type>
          <declname>row</declname>
        </param>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref> &amp;</type>
          <declname>segments</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></type>
          <declname>xstarts</declname>
          <array>[]</array>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="2311" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="2311" bodyend="2393"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>assign_blobs_to_rows</header>
      <description><para>Make enough rows to allocate all the given blobs to one. If a block skew is given, use that, else attempt to track it. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1af9d632b1a85d2d92bbd0597b76ba026d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void assign_blobs_to_rows</definition>
        <argsstring>(TO_BLOCK *block, float *gradient, int pass, BOOL8 reject_misses, BOOL8 make_new_rows, BOOL8 drawing_skew)</argsstring>
        <name>assign_blobs_to_rows</name>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type>float *</type>
          <declname>gradient</declname>
        </param>
        <param>
          <type>int</type>
          <declname>pass</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
          <declname>reject_misses</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
          <declname>make_new_rows</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
          <declname>drawing_skew</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="2402" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="2402" bodyend="2590"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>most_overlapping_row</header>
      <description><para>Return the row which most overlaps the blob. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a5aa796bc0402dec5d9ca2ea4a8b551a1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fd" kindref="member">OVERLAP_STATE</ref></type>
        <definition>OVERLAP_STATE most_overlapping_row</definition>
        <argsstring>(TO_ROW_IT *row_it, TO_ROW *&amp;best_row, float top, float bottom, float rowsize, BOOL8 testing_blob)</argsstring>
        <name>most_overlapping_row</name>
        <param>
          <type>TO_ROW_IT *</type>
          <declname>row_it</declname>
        </param>
        <param>
          <type><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref> *&amp;</type>
          <declname>best_row</declname>
        </param>
        <param>
          <type>float</type>
          <declname>top</declname>
        </param>
        <param>
          <type>float</type>
          <declname>bottom</declname>
        </param>
        <param>
          <type>float</type>
          <declname>rowsize</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></type>
          <declname>testing_blob</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="2598" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="2598" bodyend="2686"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>blob_x_order</header>
      <description><para>Sort function to sort blobs in x from page left. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a71e57df4cbaf6a0d8fb156f0604d1033" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int blob_x_order</definition>
        <argsstring>(const void *item1, const void *item2)</argsstring>
        <name>blob_x_order</name>
        <param>
          <type>const void *</type>
          <declname>item1</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>item2</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="2694" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="2694" bodyend="2708"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>row_y_order</header>
      <description><para>Sort function to sort rows in y from page top. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1ab27bf80d814903a9eb48e81b2cc09acc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int row_y_order</definition>
        <argsstring>(const void *item1, const void *item2)</argsstring>
        <name>row_y_order</name>
        <param>
          <type>const void *</type>
          <declname>item1</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>item2</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="2716" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="2716" bodyend="2730"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>row_spacing_order</header>
      <description><para>Qsort style function to compare 2 TO_ROWS based on their spacing value. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1aa3013c07bcccb3f1efeb4686ed340609" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int row_spacing_order</definition>
        <argsstring>(const void *item1, const void *item2)</argsstring>
        <name>row_spacing_order</name>
        <param>
          <type>const void *</type>
          <declname>item1</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>item2</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="2738" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="2738" bodyend="2752"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="user-defined">
      <header>mark_repeated_chars</header>
      <description><para>Mark blobs marked with BTFT_LEADER in repeated sets using the repeated_set member of <ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>. </para></description>
      <memberdef kind="function" id="makerow_8cpp_1a20d1c5d4b6ae64bf80b24a155aa7c189" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void mark_repeated_chars</definition>
        <argsstring>(TO_ROW *row)</argsstring>
        <name>mark_repeated_chars</name>
        <param>
          <type><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref> *</type>
          <declname>row</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="2760" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="2760" bodyend="2799"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="define">
      <memberdef kind="define" id="makerow_8cpp_1af64730edc37ce30d66430f2dd54a2089" prot="public" static="no">
        <name>MAX_HEIGHT_MODES</name>
        <initializer>12</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="105" column="9" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="105" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="makerow_8cpp_1ad8c4f2ec0d4f8b83b5dc401f35feca75" prot="public" static="no" mutable="no">
        <type>const int</type>
        <definition>const int kMinLeaderCount</definition>
        <argsstring></argsstring>
        <name>kMinLeaderCount</name>
        <initializer>= 5</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="107" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="107" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="makerow_8cpp_1a253bae1e2d83225a18176e3093bfdfa1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_heavy_nr, FALSE,&quot;Vigorously remove noise&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_heavy_nr</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref></type>
        </param>
        <param>
          <type>&quot;Vigorously remove noise&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="45" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a5f4ed17be5f69df7b9b55650b38ed3cc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_show_initial_rows, FALSE,&quot;Display row accumulation&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_show_initial_rows</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref></type>
        </param>
        <param>
          <type>&quot;Display row accumulation&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="46" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1aaa89d29e89da35d9c2acf65bb6b7913b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_show_parallel_rows, FALSE,&quot;Display page correlated rows&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_show_parallel_rows</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref></type>
        </param>
        <param>
          <type>&quot;Display page correlated rows&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="47" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1abeee12d82343cd7b7c41399b5fa24d0c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_show_expanded_rows, FALSE,&quot;Display rows after expanding&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_show_expanded_rows</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref></type>
        </param>
        <param>
          <type>&quot;Display rows after expanding&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="48" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1afce3ff71751d5fc6564472a0f1d95917" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_show_final_rows, FALSE,&quot;Display rows after final fitting&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_show_final_rows</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref></type>
        </param>
        <param>
          <type>&quot;Display rows after final fitting&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="49" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1ae85a036c79846ce9b879df7126db23e9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_show_final_blobs, FALSE,&quot;Display blob bounds after pre-ass&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_show_final_blobs</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref></type>
        </param>
        <param>
          <type>&quot;Display blob bounds after pre-ass&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="50" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a6ea159c0d976b587e66fbf7c2a1d4bcf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_test_landscape, FALSE,&quot;Tests refer to land/port&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_test_landscape</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref></type>
        </param>
        <param>
          <type>&quot;Tests refer to land/port&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="51" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1aada2bfc98f695da49431a722c8eb7ce8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_parallel_baselines, TRUE,&quot;Force parallel baselines&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_parallel_baselines</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref></type>
        </param>
        <param>
          <type>&quot;Force parallel baselines&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="52" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a2b5f9d9193ba183ba227dc153e0140d2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_straight_baselines, FALSE,&quot;Force straight baselines&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_straight_baselines</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref></type>
        </param>
        <param>
          <type>&quot;Force straight baselines&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="53" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1ac54a723a1136a08d4309295cace698c4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_old_baselines, TRUE,&quot;Use old baseline algorithm&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_old_baselines</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref></type>
        </param>
        <param>
          <type>&quot;Use old <ref refid="mfoutline_8h_1a2a4b69f9a2827dc98bc4cbc233118865a83297de004f4e58b9be2108c6cd08a23" kindref="member">baseline</ref> <ref refid="pitsync1_8h_1aef3aa0188b14627cbfc6b848e00303c9" kindref="member">algorithm</ref>&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="54" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a22752e85a8d6d91337fef957cadc4afb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_old_xheight, FALSE,&quot;Use old xheight algorithm&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_old_xheight</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref></type>
        </param>
        <param>
          <type>&quot;Use old xheight <ref refid="pitsync1_8h_1aef3aa0188b14627cbfc6b848e00303c9" kindref="member">algorithm</ref>&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="55" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1ad7d3e467a894f2d360ea4be2ee0e98ad" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_fix_xheight_bug, TRUE,&quot;Use spline baseline&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_fix_xheight_bug</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref></type>
        </param>
        <param>
          <type>&quot;Use spline <ref refid="mfoutline_8h_1a2a4b69f9a2827dc98bc4cbc233118865a83297de004f4e58b9be2108c6cd08a23" kindref="member">baseline</ref>&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="56" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1ac456d70c638853cf1a32a9f53bb893fd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_fix_makerow_bug, TRUE,&quot;Prevent multiple baselines&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_fix_makerow_bug</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref></type>
        </param>
        <param>
          <type>&quot;Prevent multiple baselines&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="57" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1ad2d99c5df8239c22dc9f9c1c77fc9c9c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_debug_xheights, FALSE,&quot;Test xheight algorithms&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_debug_xheights</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref></type>
        </param>
        <param>
          <type>&quot;Test xheight algorithms&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="58" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a44e4663ad418488be7f3fdc698337463" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_biased_skewcalc, TRUE,&quot;Bias skew estimates with line length&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_biased_skewcalc</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref></type>
        </param>
        <param>
          <type>&quot;Bias skew estimates with line length&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="59" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a3607ebfbb814ab7208020dfa56a99989" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_interpolating_skew, TRUE,&quot;Interpolate across gaps&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_interpolating_skew</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref></type>
        </param>
        <param>
          <type>&quot;Interpolate across gaps&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="60" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a38d5e48e21ef0e37f985853050c04de7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>INT_VAR</definition>
        <argsstring>(textord_skewsmooth_offset, 2,&quot;For smooth factor&quot;)</argsstring>
        <name>INT_VAR</name>
        <param>
          <type>textord_skewsmooth_offset</type>
        </param>
        <param>
          <type>2</type>
        </param>
        <param>
          <type>&quot;For smooth factor&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="61" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a86cc16d887538f2bacf00adaae610f6e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>INT_VAR</definition>
        <argsstring>(textord_skewsmooth_offset2, 1,&quot;For smooth factor&quot;)</argsstring>
        <name>INT_VAR</name>
        <param>
          <type>textord_skewsmooth_offset2</type>
        </param>
        <param>
          <type>1</type>
        </param>
        <param>
          <type>&quot;For smooth factor&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="62" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a78513c2301df772670221df798fe18fd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>INT_VAR</definition>
        <argsstring>(textord_test_x,-1,&quot;coord of test pt&quot;)</argsstring>
        <name>INT_VAR</name>
        <param>
          <type>textord_test_x</type>
        </param>
        <param>
          <type>-</type>
          <declname>1</declname>
        </param>
        <param>
          <type>&quot;coord of test pt&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="63" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1ae0f60ce24a0eae395438dc7d32a59d37" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>INT_VAR</definition>
        <argsstring>(textord_test_y,-1,&quot;coord of test pt&quot;)</argsstring>
        <name>INT_VAR</name>
        <param>
          <type>textord_test_y</type>
        </param>
        <param>
          <type>-</type>
          <declname>1</declname>
        </param>
        <param>
          <type>&quot;coord of test pt&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="64" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1ac7d30f45254aa7d4e610712e5fc099ba" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>INT_VAR</definition>
        <argsstring>(textord_min_blobs_in_row, 4,&quot;Min blobs before gradient counted&quot;)</argsstring>
        <name>INT_VAR</name>
        <param>
          <type>textord_min_blobs_in_row</type>
        </param>
        <param>
          <type>4</type>
        </param>
        <param>
          <type>&quot;Min blobs before gradient counted&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="65" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a22281a65fc9ea350a3321a7156504606" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>INT_VAR</definition>
        <argsstring>(textord_spline_minblobs, 8,&quot;Min blobs in each spline segment&quot;)</argsstring>
        <name>INT_VAR</name>
        <param>
          <type>textord_spline_minblobs</type>
        </param>
        <param>
          <type>8</type>
        </param>
        <param>
          <type>&quot;Min blobs in each spline segment&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="66" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1afa25e3e7347d901f83a904fdced7eedc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>INT_VAR</definition>
        <argsstring>(textord_spline_medianwin, 6,&quot;Size of window for spline segmentation&quot;)</argsstring>
        <name>INT_VAR</name>
        <param>
          <type>textord_spline_medianwin</type>
        </param>
        <param>
          <type>6</type>
        </param>
        <param>
          <type>&quot;Size of window for spline segmentation&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="67" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a8ad40ded75b282b61ebf0c12580695b7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>INT_VAR</definition>
        <argsstring>(textord_max_blob_overlaps, 4,&quot;Max number of blobs a big blob can overlap&quot;)</argsstring>
        <name>INT_VAR</name>
        <param>
          <type>textord_max_blob_overlaps</type>
        </param>
        <param>
          <type>4</type>
        </param>
        <param>
          <type>&quot;Max number of blobs a big blob can overlap&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="68" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a06298ae00fe41246615684f4d2fe7fdf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>INT_VAR</definition>
        <argsstring>(textord_min_xheight, 10,&quot;Min credible pixel xheight&quot;)</argsstring>
        <name>INT_VAR</name>
        <param>
          <type>textord_min_xheight</type>
        </param>
        <param>
          <type>10</type>
        </param>
        <param>
          <type>&quot;Min credible pixel xheight&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="70" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1ae2ed2e5f63a969b410e35e354fa950fb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_spline_shift_fraction, 0.02,&quot;Fraction of line spacing for quad&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_spline_shift_fraction</type>
        </param>
        <param>
          <type>0.</type>
          <declname>02</declname>
        </param>
        <param>
          <type>&quot;Fraction of line spacing for quad&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="71" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1ae0309ec5caf47ca7aab12ddbc65a2ff5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_spline_outlier_fraction, 0.1,&quot;Fraction of line spacing for outlier&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_spline_outlier_fraction</type>
        </param>
        <param>
          <type>0.</type>
          <declname>1</declname>
        </param>
        <param>
          <type>&quot;Fraction of line spacing for outlier&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="73" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a5c0546b67e53926df424804d829905d8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_skew_ile, 0.5,&quot;Ile of gradients for page skew&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_skew_ile</type>
        </param>
        <param>
          <type>0.</type>
          <declname>5</declname>
        </param>
        <param>
          <type>&quot;Ile of gradients for page skew&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="75" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1aae6adc36e0d41dde1cb5bcba653fd805" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_skew_lag, 0.01,&quot;Lag for skew on row accumulation&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_skew_lag</type>
        </param>
        <param>
          <type>0.</type>
          <declname>01</declname>
        </param>
        <param>
          <type>&quot;Lag for skew on row accumulation&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="76" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1aa02c0703de20ec986bd68f3e2371f9a0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_linespace_iqrlimit, 0.2,&quot;Max iqr/median for linespace&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_linespace_iqrlimit</type>
        </param>
        <param>
          <type>0.</type>
          <declname>2</declname>
        </param>
        <param>
          <type>&quot;Max iqr/median for linespace&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="77" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a187a30d27d7570406f4296d593ef3a76" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_width_limit, 8,&quot;Max width of blobs to make rows&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_width_limit</type>
        </param>
        <param>
          <type>8</type>
        </param>
        <param>
          <type>&quot;Max width of blobs to make rows&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="78" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1aa21073b1ef9bb2b6321c09c240de5c97" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_chop_width, 1.5,&quot;Max width before chopping&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_chop_width</type>
        </param>
        <param>
          <type>1.</type>
          <declname>5</declname>
        </param>
        <param>
          <type>&quot;Max width before chopping&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="79" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1af9c29336b6c92814570d85ce4b095f7e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_expansion_factor, 1.0,&quot;Factor to expand rows by in expand_rows&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_expansion_factor</type>
        </param>
        <param>
          <type>1.</type>
          <declname>0</declname>
        </param>
        <param>
          <type>&quot;Factor to expand rows by in <ref refid="makerow_8h_1aa7a5766705cc30b622092e75022c5cbf" kindref="member">expand_rows</ref>&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="80" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1ad736d814552d791234627db5d96f878a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_overlap_x, 0.5,&quot;Fraction of linespace for good overlap&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_overlap_x</type>
        </param>
        <param>
          <type>0.</type>
          <declname>5</declname>
        </param>
        <param>
          <type>&quot;Fraction of linespace for good overlap&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="82" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1adae135d911d81a61d838112fc01b730c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_minxh, 0.25,&quot;fraction of linesize for min xheight&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_minxh</type>
        </param>
        <param>
          <type>0.</type>
          <declname>25</declname>
        </param>
        <param>
          <type>&quot;fraction of linesize for min xheight&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="83" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1aaa169fe5c25ab136e8a450f8a1f7dc47" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_min_linesize, 1.25,&quot;* blob height for initial linesize&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_min_linesize</type>
        </param>
        <param>
          <type>1.</type>
          <declname>25</declname>
        </param>
        <param>
          <type>&quot;* blob height for initial linesize&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="84" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a3f70119c2728c271cf926818a990180f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_excess_blobsize, 1.3,&quot;New row made if blob makes row this big&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_excess_blobsize</type>
        </param>
        <param>
          <type>1.</type>
          <declname>3</declname>
        </param>
        <param>
          <type>&quot;New row made if blob makes row this big&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="85" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a59d6f9e5592c326d6f427393c1f40501" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_occupancy_threshold, 0.4,&quot;Fraction of neighbourhood&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_occupancy_threshold</type>
        </param>
        <param>
          <type>0.</type>
          <declname>4</declname>
        </param>
        <param>
          <type>&quot;Fraction of neighbourhood&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="87" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a96604f1ccb6a2855349c9f3dde20d4bb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_underline_width, 2.0,&quot;Multiple of line_size for underline&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_underline_width</type>
        </param>
        <param>
          <type>2.</type>
          <declname>0</declname>
        </param>
        <param>
          <type>&quot;Multiple of line_size for underline&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="88" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a1e73ef12183252c4555238da66f327ff" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_min_blob_height_fraction, 0.75,&quot;Min blob height/top to include blob top into xheight stats&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_min_blob_height_fraction</type>
        </param>
        <param>
          <type>0.</type>
          <declname>75</declname>
        </param>
        <param>
          <type>&quot;Min blob height/top to include blob top into xheight stats&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="89" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a5f5605d9c64b3136dd9d8927caa50f65" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_xheight_mode_fraction, 0.4,&quot;Min pile height to make xheight&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_xheight_mode_fraction</type>
        </param>
        <param>
          <type>0.</type>
          <declname>4</declname>
        </param>
        <param>
          <type>&quot;Min pile height to make xheight&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="91" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a590a55b3b9790b72a0b48c75903c11ed" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_ascheight_mode_fraction, 0.08,&quot;Min pile height to make ascheight&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_ascheight_mode_fraction</type>
        </param>
        <param>
          <type>0.</type>
          <declname>08</declname>
        </param>
        <param>
          <type>&quot;Min pile height to make ascheight&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="93" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1ace25a1d0ffb99d8e06c4a17906a6c733" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_descheight_mode_fraction, 0.08,&quot;Min pile height to make descheight&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_descheight_mode_fraction</type>
        </param>
        <param>
          <type>0.</type>
          <declname>08</declname>
        </param>
        <param>
          <type>&quot;Min pile height to make descheight&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="95" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a0b105747c5dc474bb9ec966091c2d8e8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_ascx_ratio_min, 1.25,&quot;Min cap/xheight&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_ascx_ratio_min</type>
        </param>
        <param>
          <type>1.</type>
          <declname>25</declname>
        </param>
        <param>
          <type>&quot;Min cap/xheight&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="97" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a4fc0593a3853409fc3d55f22d693dd9d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_ascx_ratio_max, 1.8,&quot;Max cap/xheight&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_ascx_ratio_max</type>
        </param>
        <param>
          <type>1.</type>
          <declname>8</declname>
        </param>
        <param>
          <type>&quot;Max cap/xheight&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="98" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1aafcf9fc359d1332ac8a5982fd4ed7a17" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_descx_ratio_min, 0.25,&quot;Min desc/xheight&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_descx_ratio_min</type>
        </param>
        <param>
          <type>0.</type>
          <declname>25</declname>
        </param>
        <param>
          <type>&quot;Min desc/xheight&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="99" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a4d0c6d0d077d6a3e370df73a140a7443" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_descx_ratio_max, 0.6,&quot;Max desc/xheight&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_descx_ratio_max</type>
        </param>
        <param>
          <type>0.</type>
          <declname>6</declname>
        </param>
        <param>
          <type>&quot;Max desc/xheight&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="100" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1acebb904292229359f3e5a1cc57ec58c1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(textord_xheight_error_margin, 0.1,&quot;Accepted variation&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>textord_xheight_error_margin</type>
        </param>
        <param>
          <type>0.</type>
          <declname>1</declname>
        </param>
        <param>
          <type>&quot;Accepted variation&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="101" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1ad8aee603021f9a4156fa73b488f2e258" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>INT_VAR</definition>
        <argsstring>(textord_lms_line_trials, 12,&quot;Number of linew fits to do&quot;)</argsstring>
        <name>INT_VAR</name>
        <param>
          <type>textord_lms_line_trials</type>
        </param>
        <param>
          <type>12</type>
        </param>
        <param>
          <type>&quot;Number of linew fits to do&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="102" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a8096bc966a0438a2373abf916d32a235" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>BOOL_VAR</definition>
        <argsstring>(textord_new_initial_xheight, TRUE,&quot;Use test xheight mechanism&quot;)</argsstring>
        <name>BOOL_VAR</name>
        <param>
          <type>textord_new_initial_xheight</type>
        </param>
        <param>
          <type><ref refid="cutil_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref></type>
        </param>
        <param>
          <type>&quot;Use test xheight mechanism&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="103" column="1"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a5ce1026e5a14018fe96fb3b8709b5943" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>float</type>
        <definition>static float MakeRowFromBlobs</definition>
        <argsstring>(float line_size, BLOBNBOX_IT *blob_it, TO_ROW_IT *row_it)</argsstring>
        <name>MakeRowFromBlobs</name>
        <param>
          <type>float</type>
          <declname>line_size</declname>
        </param>
        <param>
          <type>BLOBNBOX_IT *</type>
          <declname>blob_it</declname>
        </param>
        <param>
          <type>TO_ROW_IT *</type>
          <declname>row_it</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="111" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="111" bodyend="133"/>
      </memberdef>
      <memberdef kind="function" id="makerow_8cpp_1a5277f27bf02ddae5b083558e80b135ad" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>float</type>
        <definition>float MakeRowFromSubBlobs</definition>
        <argsstring>(TO_BLOCK *block, C_BLOB *blob, TO_ROW_IT *row_it)</argsstring>
        <name>MakeRowFromSubBlobs</name>
        <param>
          <type><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref> *</type>
          <declname>block</declname>
        </param>
        <param>
          <type><ref refid="class_c___b_l_o_b" kindref="compound">C_BLOB</ref> *</type>
          <declname>blob</declname>
        </param>
        <param>
          <type>TO_ROW_IT *</type>
          <declname>row_it</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp" line="137" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/makerow.cpp" bodystart="137" bodyend="158"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/**********************************************************************</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>File:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>makerow.cpp<sp/><sp/>(Formerly<sp/>makerows.c)</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>Description:<sp/>Code<sp/>to<sp/>arrange<sp/>blobs<sp/>into<sp/>rows<sp/>of<sp/>text.</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>Author:<sp/><sp/><sp/><sp/><sp/><sp/>Ray<sp/>Smith</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>Created:<sp/><sp/><sp/><sp/><sp/>Mon<sp/>Sep<sp/>21<sp/>14:34:48<sp/>BST<sp/>1992</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>(C)<sp/>Copyright<sp/>1992,<sp/>Hewlett-Packard<sp/>Ltd.</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>**<sp/>Licensed<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the<sp/>&quot;License&quot;);</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>**<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance<sp/>with<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>**<sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>**<sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>**<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,<sp/>software</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>**<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>**<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>**<sp/>See<sp/>the<sp/>License<sp/>for<sp/>the<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>**<sp/>limitations<sp/>under<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>**********************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="mfcpch_8h" kindref="compound">mfcpch.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__UNIX__</highlight></codeline>
<codeline lineno="22"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;assert.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="24"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="stderr_8h" kindref="compound">stderr.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="blobbox_8h" kindref="compound">blobbox.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="ccstruct_8h" kindref="compound">ccstruct.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="detlinefit_8h" kindref="compound">detlinefit.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="statistc_8h" kindref="compound">statistc.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="drawtord_8h" kindref="compound">drawtord.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="blkocc_8h" kindref="compound">blkocc.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="sortflts_8h" kindref="compound">sortflts.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="oldbasel_8h" kindref="compound">oldbasel.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="textord_8h" kindref="compound">textord.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="tordmain_8h" kindref="compound">tordmain.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="underlin_8h" kindref="compound">underlin.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="makerow_8h" kindref="compound">makerow.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="tprintf_8h" kindref="compound">tprintf.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="tovars_8h" kindref="compound">tovars.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Include<sp/>automatically<sp/>generated<sp/>configuration<sp/>file<sp/>if<sp/>running<sp/>autoconf.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>HAVE_CONFIG_H</highlight></codeline>
<codeline lineno="42"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#include<sp/>&quot;config_auto.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="44"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_heavy_nr,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Vigorously<sp/>remove<sp/>noise&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_show_initial_rows,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Display<sp/>row<sp/>accumulation&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_show_parallel_rows,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Display<sp/>page<sp/>correlated<sp/>rows&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_show_expanded_rows,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Display<sp/>rows<sp/>after<sp/>expanding&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_show_final_rows,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Display<sp/>rows<sp/>after<sp/>final<sp/>fitting&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_show_final_blobs,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Display<sp/>blob<sp/>bounds<sp/>after<sp/>pre-ass&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_test_landscape,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Tests<sp/>refer<sp/>to<sp/>land/port&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_parallel_baselines,<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Force<sp/>parallel<sp/>baselines&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_straight_baselines,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Force<sp/>straight<sp/>baselines&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_old_baselines,<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Use<sp/>old<sp/>baseline<sp/>algorithm&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_old_xheight,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Use<sp/>old<sp/>xheight<sp/>algorithm&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_fix_xheight_bug,<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Use<sp/>spline<sp/>baseline&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_fix_makerow_bug,<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Prevent<sp/>multiple<sp/>baselines&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_debug_xheights,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Test<sp/>xheight<sp/>algorithms&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_biased_skewcalc,<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Bias<sp/>skew<sp/>estimates<sp/>with<sp/>line<sp/>length&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_interpolating_skew,<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Interpolate<sp/>across<sp/>gaps&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><ref refid="params_8h_1a554d43d0cf0e3f9552921941d9e147bd" kindref="member">INT_VAR</ref>(textord_skewsmooth_offset,<sp/>2,<sp/></highlight><highlight class="stringliteral">&quot;For<sp/>smooth<sp/>factor&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><ref refid="params_8h_1a554d43d0cf0e3f9552921941d9e147bd" kindref="member">INT_VAR</ref>(textord_skewsmooth_offset2,<sp/>1,<sp/></highlight><highlight class="stringliteral">&quot;For<sp/>smooth<sp/>factor&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><ref refid="params_8h_1a554d43d0cf0e3f9552921941d9e147bd" kindref="member">INT_VAR</ref>(textord_test_x,<sp/>-1,<sp/></highlight><highlight class="stringliteral">&quot;coord<sp/>of<sp/>test<sp/>pt&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><ref refid="params_8h_1a554d43d0cf0e3f9552921941d9e147bd" kindref="member">INT_VAR</ref>(textord_test_y,<sp/>-1,<sp/></highlight><highlight class="stringliteral">&quot;coord<sp/>of<sp/>test<sp/>pt&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><ref refid="params_8h_1a554d43d0cf0e3f9552921941d9e147bd" kindref="member">INT_VAR</ref>(textord_min_blobs_in_row,<sp/>4,<sp/></highlight><highlight class="stringliteral">&quot;Min<sp/>blobs<sp/>before<sp/>gradient<sp/>counted&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><ref refid="params_8h_1a554d43d0cf0e3f9552921941d9e147bd" kindref="member">INT_VAR</ref>(textord_spline_minblobs,<sp/>8,<sp/></highlight><highlight class="stringliteral">&quot;Min<sp/>blobs<sp/>in<sp/>each<sp/>spline<sp/>segment&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><ref refid="params_8h_1a554d43d0cf0e3f9552921941d9e147bd" kindref="member">INT_VAR</ref>(textord_spline_medianwin,<sp/>6,<sp/></highlight><highlight class="stringliteral">&quot;Size<sp/>of<sp/>window<sp/>for<sp/>spline<sp/>segmentation&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><ref refid="params_8h_1a554d43d0cf0e3f9552921941d9e147bd" kindref="member">INT_VAR</ref>(textord_max_blob_overlaps,<sp/>4,</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Max<sp/>number<sp/>of<sp/>blobs<sp/>a<sp/>big<sp/>blob<sp/>can<sp/>overlap&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><ref refid="params_8h_1a554d43d0cf0e3f9552921941d9e147bd" kindref="member">INT_VAR</ref>(textord_min_xheight,<sp/>10,<sp/></highlight><highlight class="stringliteral">&quot;Min<sp/>credible<sp/>pixel<sp/>xheight&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_spline_shift_fraction,<sp/>0.02,</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Fraction<sp/>of<sp/>line<sp/>spacing<sp/>for<sp/>quad&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_spline_outlier_fraction,<sp/>0.1,</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Fraction<sp/>of<sp/>line<sp/>spacing<sp/>for<sp/>outlier&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_skew_ile,<sp/>0.5,<sp/></highlight><highlight class="stringliteral">&quot;Ile<sp/>of<sp/>gradients<sp/>for<sp/>page<sp/>skew&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_skew_lag,<sp/>0.01,<sp/></highlight><highlight class="stringliteral">&quot;Lag<sp/>for<sp/>skew<sp/>on<sp/>row<sp/>accumulation&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_linespace_iqrlimit,<sp/>0.2,<sp/></highlight><highlight class="stringliteral">&quot;Max<sp/>iqr/median<sp/>for<sp/>linespace&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_width_limit,<sp/>8,<sp/></highlight><highlight class="stringliteral">&quot;Max<sp/>width<sp/>of<sp/>blobs<sp/>to<sp/>make<sp/>rows&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_chop_width,<sp/>1.5,<sp/></highlight><highlight class="stringliteral">&quot;Max<sp/>width<sp/>before<sp/>chopping&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_expansion_factor,<sp/>1.0,</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Factor<sp/>to<sp/>expand<sp/>rows<sp/>by<sp/>in<sp/>expand_rows&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_overlap_x,<sp/>0.5,<sp/></highlight><highlight class="stringliteral">&quot;Fraction<sp/>of<sp/>linespace<sp/>for<sp/>good<sp/>overlap&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_minxh,<sp/>0.25,<sp/></highlight><highlight class="stringliteral">&quot;fraction<sp/>of<sp/>linesize<sp/>for<sp/>min<sp/>xheight&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_min_linesize,<sp/>1.25,<sp/></highlight><highlight class="stringliteral">&quot;*<sp/>blob<sp/>height<sp/>for<sp/>initial<sp/>linesize&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_excess_blobsize,<sp/>1.3,</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;New<sp/>row<sp/>made<sp/>if<sp/>blob<sp/>makes<sp/>row<sp/>this<sp/>big&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_occupancy_threshold,<sp/>0.4,<sp/></highlight><highlight class="stringliteral">&quot;Fraction<sp/>of<sp/>neighbourhood&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_underline_width,<sp/>2.0,<sp/></highlight><highlight class="stringliteral">&quot;Multiple<sp/>of<sp/>line_size<sp/>for<sp/>underline&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_min_blob_height_fraction,<sp/>0.75,</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Min<sp/>blob<sp/>height/top<sp/>to<sp/>include<sp/>blob<sp/>top<sp/>into<sp/>xheight<sp/>stats&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_xheight_mode_fraction,<sp/>0.4,</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Min<sp/>pile<sp/>height<sp/>to<sp/>make<sp/>xheight&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_ascheight_mode_fraction,<sp/>0.08,</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Min<sp/>pile<sp/>height<sp/>to<sp/>make<sp/>ascheight&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_descheight_mode_fraction,<sp/>0.08,</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Min<sp/>pile<sp/>height<sp/>to<sp/>make<sp/>descheight&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_ascx_ratio_min,<sp/>1.25,<sp/></highlight><highlight class="stringliteral">&quot;Min<sp/>cap/xheight&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_ascx_ratio_max,<sp/>1.8,<sp/></highlight><highlight class="stringliteral">&quot;Max<sp/>cap/xheight&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_descx_ratio_min,<sp/>0.25,<sp/></highlight><highlight class="stringliteral">&quot;Min<sp/>desc/xheight&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_descx_ratio_max,<sp/>0.6,<sp/></highlight><highlight class="stringliteral">&quot;Max<sp/>desc/xheight&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref>(textord_xheight_error_margin,<sp/>0.1,<sp/></highlight><highlight class="stringliteral">&quot;Accepted<sp/>variation&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><ref refid="params_8h_1a554d43d0cf0e3f9552921941d9e147bd" kindref="member">INT_VAR</ref>(textord_lms_line_trials,<sp/>12,<sp/></highlight><highlight class="stringliteral">&quot;Number<sp/>of<sp/>linew<sp/>fits<sp/>to<sp/>do&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><ref refid="params_8h_1a442e7f541a050acf5ebda026db177877" kindref="member">BOOL_VAR</ref>(textord_new_initial_xheight,<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,<sp/></highlight><highlight class="stringliteral">&quot;Use<sp/>test<sp/>xheight<sp/>mechanism&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="104"><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>MAX_HEIGHT_MODES<sp/><sp/>12</highlight></codeline>
<codeline lineno="106"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1ad8c4f2ec0d4f8b83b5dc401f35feca75" kindref="member">kMinLeaderCount</ref><sp/>=<sp/>5;</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Factored-out<sp/>helper<sp/>to<sp/>build<sp/>a<sp/>single<sp/>row<sp/>from<sp/>a<sp/>list<sp/>of<sp/>blobs.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Returns<sp/>the<sp/>mean<sp/>blob<sp/>size.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>MakeRowFromBlobs(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>line_size,</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BLOBNBOX_IT*<sp/>blob_it,<sp/>TO_ROW_IT*<sp/>row_it)<sp/>{</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/>blob_it-&gt;sort(<ref refid="makerow_8cpp_1a71e57df4cbaf6a0d8fb156f0604d1033" kindref="member">blob_x_order</ref>);</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/>blob_it-&gt;move_to_first();</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref>*<sp/>row<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>total_size<sp/>=<sp/>0.0f;</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blob_count<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Add<sp/>all<sp/>the<sp/>blobs<sp/>to<sp/>a<sp/>single<sp/>TO_ROW.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;<sp/>!blob_it-&gt;empty();<sp/>blob_it-&gt;forward())<sp/>{</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>*<sp/>blob<sp/>=<sp/>blob_it-&gt;extract();</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>top<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>();</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>bottom<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>();</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref>(blob,<sp/>top,<sp/>bottom,<sp/>line_size);</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_it-&gt;add_before_then_move(row);</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a0173e9da64e4f2d29f01da14c3a053ee" kindref="member">add_blob</ref>(blob,<sp/>top,<sp/>bottom,<sp/>line_size);</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/>total_size<sp/>+=<sp/>top<sp/>-<sp/>bottom;</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>++blob_count;</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>blob_count<sp/>&gt;<sp/>0<sp/>?<sp/>total_size<sp/>/<sp/>blob_count<sp/>:<sp/>total_size;</highlight></codeline>
<codeline lineno="133"><highlight class="normal">}</highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Helper<sp/>to<sp/>make<sp/>a<sp/>row<sp/>using<sp/>the<sp/>children<sp/>of<sp/>a<sp/>single<sp/>blob.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Returns<sp/>the<sp/>mean<sp/>size<sp/>of<sp/>the<sp/>blobs<sp/>created.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a5277f27bf02ddae5b083558e80b135ad" kindref="member">MakeRowFromSubBlobs</ref>(<ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref>*<sp/>block,<sp/><ref refid="class_c___b_l_o_b" kindref="compound">C_BLOB</ref>*<sp/>blob,<sp/>TO_ROW_IT*<sp/>row_it)<sp/>{</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>blobs<sp/>made<sp/>from<sp/>the<sp/>children<sp/>will<sp/>go<sp/>in<sp/>the<sp/>small_blobs<sp/>list.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>bb_it(&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ad16b1c18225b44c50674ca46841b0f5f" kindref="member">small_blobs</ref>);</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/>C_OUTLINE_IT<sp/>ol_it(blob-&gt;<ref refid="class_c___b_l_o_b_1ae510f3d0e7398fbb46608082429eac89" kindref="member">out_list</ref>());</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>the<sp/>children.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/>ol_it.set_to_list(ol_it.data()-&gt;child());</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ol_it.empty())</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0.0<ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>;</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(ol_it.mark_cycle_pt();<sp/>!ol_it.cycled_list();<sp/>ol_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Deep<sp/>copy<sp/>the<sp/>child<sp/>outline<sp/>and<sp/>use<sp/>that<sp/>to<sp/>make<sp/>a<sp/>blob.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c___o_u_t_l_i_n_e" kindref="compound">C_OUTLINE</ref>*<sp/>outline<sp/>=<sp/><ref refid="class_c___o_u_t_l_i_n_e_1aae5feeba94ae0da9e9ce1068d5e53a56" kindref="member">C_OUTLINE::deep_copy</ref>(ol_it.data());</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>constructor<sp/>from<sp/>a<sp/>list<sp/>of<sp/>outlines<sp/>corrects<sp/>the<sp/>direction.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/>C_OUTLINE_LIST<sp/>outlines;</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>C_OUTLINE_IT<sp/>ol_it(&amp;outlines);</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/>ol_it.add_after_then_move(outline);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c___b_l_o_b" kindref="compound">C_BLOB</ref>*<sp/>blob<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_c___b_l_o_b" kindref="compound">C_BLOB</ref>(&amp;outlines);</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>*<sp/>bbox<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>(blob);</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>bb_it.add_after_then_move(bbox);</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Now<sp/>we<sp/>can<sp/>make<sp/>a<sp/>row<sp/>from<sp/>the<sp/>blobs.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>MakeRowFromBlobs(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>,<sp/>&amp;bb_it,<sp/>row_it);</highlight></codeline>
<codeline lineno="158"><highlight class="normal">}</highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a8ebead3fdc06fe853348b0ea851a3e31" kindref="member">make_single_row</ref>(<ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref><sp/>page_tr,<sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref>*<sp/>block,<sp/>TO_BLOCK_LIST*<sp/>blocks)<sp/>{</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it<sp/>=<sp/>&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a5dd67c54162a6b60b0fd11500d4a3025" kindref="member">blobs</ref>;</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref>();</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Include<sp/>all<sp/>the<sp/>small<sp/>blobs<sp/>and<sp/>large<sp/>blobs.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/>blob_it.add_list_after(&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ad16b1c18225b44c50674ca46841b0f5f" kindref="member">small_blobs</ref>);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/>blob_it.add_list_after(&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1aa6a3757d385e79ab76f34afb6e8fc684" kindref="member">noise_blobs</ref>);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/>blob_it.add_list_after(&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1aafe2a9baa69300ee71da42e6dc18cfee" kindref="member">large_blobs</ref>);</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a5dd67c54162a6b60b0fd11500d4a3025" kindref="member">blobs</ref>.singleton())<sp/>{</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/>blob_it.move_to_first();</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>size<sp/>=<sp/><ref refid="makerow_8cpp_1a5277f27bf02ddae5b083558e80b135ad" kindref="member">MakeRowFromSubBlobs</ref>(block,<sp/>blob_it.data()-&gt;cblob(),<sp/>&amp;row_it);</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(size<sp/>&gt;<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>)</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>=<sp/>size;</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/>MakeRowFromBlobs(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>,<sp/>&amp;blob_it,<sp/>&amp;row_it);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Fit<sp/>an<sp/>LMS<sp/>line<sp/>to<sp/>the<sp/>rows.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt();<sp/>!row_it.cycled_list();<sp/>row_it.forward())</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1ab33fbd787683743809a9c6036d541ee9" kindref="member">fit_lms_line</ref>(row_it.data());</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient;</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>fit_error;</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Compute<sp/>the<sp/>skew<sp/>based<sp/>on<sp/>the<sp/>fitted<sp/>line.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1ab9ad937a552fbb9c0f7f24e94b9d5e09" kindref="member">compute_page_skew</ref>(blocks,<sp/>gradient,<sp/>fit_error);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>gradient;</highlight></codeline>
<codeline lineno="190"><highlight class="normal">}</highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1ade98619ec77aab7e466a06b0940088a5" kindref="member">make_rows</ref>(<ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref><sp/>page_tr,<sp/>TO_BLOCK_LIST<sp/>*port_blocks)<sp/>{</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>port_m;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>global<sp/>skew</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>port_err;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>global<sp/>noise</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/>TO_BLOCK_IT<sp/>block_it;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/>block_it.set_to_list(port_blocks);</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(block_it.mark_cycle_pt();<sp/>!block_it.cycled_list();</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_it.forward())</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1a48c3f4056000484fe2915d98be4ce681" kindref="member">make_initial_textrows</ref>(page_tr,<sp/>block_it.data(),<sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref>(1.0<ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>,<sp/>0.0<ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>),</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>!(<ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref>)<sp/>textord_test_landscape);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compute<sp/>globally</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1ab9ad937a552fbb9c0f7f24e94b9d5e09" kindref="member">compute_page_skew</ref>(port_blocks,<sp/>port_m,<sp/>port_err);</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/>block_it.set_to_list(port_blocks);</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(block_it.mark_cycle_pt();<sp/>!block_it.cycled_list();<sp/>block_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1a963ac786bbbcafd731d9b974f9164645" kindref="member">cleanup_rows_making</ref>(page_tr,<sp/>block_it.data(),<sp/>port_m,<sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref>(1.0<ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>,<sp/>0.0<ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>),</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_it.data()-&gt;block-&gt;bounding_box().left(),</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!(<ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref>)textord_test_landscape);</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>port_m;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>global<sp/>skew</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal">}</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespacetesseract-c__api-demo_1afed58feacb84df2de88bdd613cfdba6d" kindref="member">tesseract</ref><sp/>{</highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>Textord::fit_rows(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient,<sp/><ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref><sp/>page_tr,<sp/>TO_BLOCK_LIST<sp/>*blocks)<sp/>{</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/>TO_BLOCK_IT<sp/>block_it(blocks);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(block_it.mark_cycle_pt();<sp/>!block_it.cycled_list();<sp/>block_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/>cleanup_rows_fitting(page_tr,<sp/>block_it.data(),<sp/>gradient,<sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref>(1.0<ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>,<sp/>0.0<ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>),</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_it.data()-&gt;block-&gt;bounding_box().left(),</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!(<ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref>)textord_test_landscape);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="227"><highlight class="normal">}</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal">}<sp/><sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>tesseract.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a48c3f4056000484fe2915d98be4ce681" kindref="member">make_initial_textrows</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>lines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref><sp/>page_tr,</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/><sp/></highlight><highlight class="comment">//block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>rotation,<sp/><sp/></highlight><highlight class="comment">//for<sp/>drawing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>testing_on<sp/><sp/></highlight><highlight class="comment">//correct<sp/>orientation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>();</highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="245"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/>colour;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_initial_rows<sp/>&amp;&amp;<sp/>testing_on)<sp/>{</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref><sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1a5e0654ca01b55c243387c6535b32860b" kindref="member">create_to_win</ref>(page_tr);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="252"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//guess<sp/>skew</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1af9d632b1a85d2d92bbd0597b76ba026d" kindref="member">assign_blobs_to_rows</ref><sp/>(block,<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>,<sp/>0,<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,<sp/>textord_show_initial_rows<sp/>&amp;&amp;<sp/>testing_on);</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/>row_it.move_to_first<sp/>();</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1ab33fbd787683743809a9c6036d541ee9" kindref="member">fit_lms_line</ref><sp/>(row_it.data<sp/>());</highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="258"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_initial_rows<sp/>&amp;&amp;<sp/>testing_on)<sp/>{</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/>colour<sp/>=<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0959f7470b08ae1a38aa7e38fba29402" kindref="member">ScrollView::RED</ref>;</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1ac61d56bb753572e573a45e56823b92c0" kindref="member">plot_to_row</ref><sp/>(row_it.data<sp/>(),<sp/>colour,<sp/>rotation);</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>colour<sp/>=<sp/>(<ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref>)<sp/>(colour<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(colour<sp/>&gt;<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8aebeaaeee353c6f04b4498b1fef94bbb3" kindref="member">ScrollView::MAGENTA</ref>)</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>colour<sp/>=<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0959f7470b08ae1a38aa7e38fba29402" kindref="member">ScrollView::RED</ref>;</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="268"><highlight class="preprocessor"></highlight><highlight class="normal">}</highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1ab33fbd787683743809a9c6036d541ee9" kindref="member">fit_lms_line</ref>(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row)<sp/>{</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>m,<sp/>c;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fitted<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_det_line_fit" kindref="compound">tesseract::DetLineFit</ref><sp/>lms;</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref>();</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(blob_it.mark_cycle_pt();<sp/>!blob_it.cycled_list();<sp/>blob_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box<sp/>=<sp/>blob_it.data()-&gt;bounding_box();</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/>lms.<ref refid="classtesseract_1_1_det_line_fit_1a4eba2b6e761080e5d1a48c9c797257b2" kindref="member">Add</ref>(<ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref>((box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>+<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>())<sp/>/<sp/>2,<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>()));</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>error<sp/>=<sp/>lms.<ref refid="classtesseract_1_1_det_line_fit_1a768ec4a8f90593d8d679981c873f7a56" kindref="member">Fit</ref>(&amp;m,<sp/>&amp;c);</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a10818e7d801044a4d569466fa1d5f841" kindref="member">set_line</ref>(m,<sp/>c,<sp/>error);</highlight></codeline>
<codeline lineno="287"><highlight class="normal">}</highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1ab9ad937a552fbb9c0f7f24e94b9d5e09" kindref="member">compute_page_skew</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//get<sp/>average<sp/>gradient</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TO_BLOCK_LIST<sp/>*blocks,<sp/><sp/></highlight><highlight class="comment">//list<sp/>of<sp/>blocks</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>&amp;page_m,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//average<sp/>gradient</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>&amp;page_err<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//average<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>row_count;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//total<sp/>rows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>blob_count;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//total_blobs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>row_err;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//integer<sp/>error</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gradients;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>rows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*errors;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>rows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>row_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>total</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/>TO_BLOCK_IT<sp/>block_it<sp/>=<sp/>blocks;<sp/></highlight><highlight class="comment">//iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it;</highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/>row_count<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/>blob_count<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(block_it.mark_cycle_pt<sp/>();<sp/>!block_it.cycled_list<sp/>();</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_p_o_l_y___b_l_o_c_k" kindref="compound">POLY_BLOCK</ref>*<sp/>pb<sp/>=<sp/>block_it.data()-&gt;block-&gt;poly_block();</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pb<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>&amp;&amp;<sp/>!pb-&gt;<ref refid="class_p_o_l_y___b_l_o_c_k_1abd32dee532afe634cdbacffc0b53e660" kindref="member">IsText</ref>())</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Pretend<sp/>non-text<sp/>blocks<sp/>don&apos;t<sp/>exist.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/>row_count<sp/>+=<sp/>block_it.data<sp/>()-&gt;get_rows<sp/>()-&gt;length<sp/>();</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//count<sp/>up<sp/>rows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/>row_it.set_to_list<sp/>(block_it.data<sp/>()-&gt;get_rows<sp/>());</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_count<sp/>+=<sp/>row_it.data<sp/>()-&gt;blob_list<sp/>()-&gt;length<sp/>();</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_count<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/>page_m<sp/>=<sp/>0.0f;</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/>page_err<sp/>=<sp/>0.0f;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/>gradients<sp/>=<sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*)<sp/><ref refid="memry_8cpp_1a4c14b091498fb7866a1dd0af51a591fe" kindref="member">alloc_mem</ref><sp/>(blob_count<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//get<sp/>mem</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/>errors<sp/>=<sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*)<sp/><ref refid="memry_8cpp_1a4c14b091498fb7866a1dd0af51a591fe" kindref="member">alloc_mem</ref><sp/>(blob_count<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(gradients<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>||<sp/>errors<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="stderr_8h_1a669968baa4639e34aef50907918653df" kindref="member">MEMORY_OUT</ref>.<ref refid="class_e_r_r_c_o_d_e_1abc4cc64aad0ddb74c02523b69c95a1c1" kindref="member">error</ref><sp/>(</highlight><highlight class="stringliteral">&quot;compute_page_skew&quot;</highlight><highlight class="normal">,<sp/><ref refid="errcode_8h_1a8a3a2e51383909b357fcdf8eda803637a781ad2788df9e25c59a70894c7832096" kindref="member">ABORT</ref>,<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>);</highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/>row_index<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(block_it.mark_cycle_pt<sp/>();<sp/>!block_it.cycled_list<sp/>();</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_p_o_l_y___b_l_o_c_k" kindref="compound">POLY_BLOCK</ref>*<sp/>pb<sp/>=<sp/>block_it.data()-&gt;block-&gt;poly_block();</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pb<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>&amp;&amp;<sp/>!pb-&gt;<ref refid="class_p_o_l_y___b_l_o_c_k_1abd32dee532afe634cdbacffc0b53e660" kindref="member">IsText</ref>())</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Pretend<sp/>non-text<sp/>blocks<sp/>don&apos;t<sp/>exist.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/>row_it.set_to_list<sp/>(block_it.data<sp/>()-&gt;get_rows<sp/>());</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row<sp/>=<sp/>row_it.data<sp/>();</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_count<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref><sp/>()-&gt;length<sp/>();</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_err<sp/>=<sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>ceil<sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1a6271a66037a1ba15368e1bf3ef4a8d51" kindref="member">line_error</ref><sp/>());</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_err<sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_err<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_biased_skewcalc)<sp/>{</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_count<sp/>/=<sp/>row_err;</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(blob_count<sp/>/=<sp/>row_err;<sp/>blob_count<sp/>&gt;<sp/>0;<sp/>blob_count--)<sp/>{</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradients[row_index]<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a51cc690153d9cabdc8217e2ac336d414" kindref="member">line_m</ref><sp/>();</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>errors[row_index]<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a6271a66037a1ba15368e1bf3ef4a8d51" kindref="member">line_error</ref><sp/>();</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_index++;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blob_count<sp/>&gt;=<sp/>textord_min_blobs_in_row)<sp/>{</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//get<sp/>gradient</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradients[row_index]<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a51cc690153d9cabdc8217e2ac336d414" kindref="member">line_m</ref><sp/>();</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>errors[row_index]<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a6271a66037a1ba15368e1bf3ef4a8d51" kindref="member">line_error</ref><sp/>();</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_index++;</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_index<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//desperate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(block_it.mark_cycle_pt<sp/>();<sp/>!block_it.cycled_list<sp/>();</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_p_o_l_y___b_l_o_c_k" kindref="compound">POLY_BLOCK</ref>*<sp/>pb<sp/>=<sp/>block_it.data()-&gt;block-&gt;poly_block();</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pb<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>&amp;&amp;<sp/>!pb-&gt;<ref refid="class_p_o_l_y___b_l_o_c_k_1abd32dee532afe634cdbacffc0b53e660" kindref="member">IsText</ref>())</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Pretend<sp/>non-text<sp/>blocks<sp/>don&apos;t<sp/>exist.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_it.set_to_list<sp/>(block_it.data<sp/>()-&gt;get_rows<sp/>());</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row<sp/>=<sp/>row_it.data<sp/>();</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradients[row_index]<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a51cc690153d9cabdc8217e2ac336d414" kindref="member">line_m</ref><sp/>();</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>errors[row_index]<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a6271a66037a1ba15368e1bf3ef4a8d51" kindref="member">line_error</ref><sp/>();</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_index++;</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/>row_count<sp/>=<sp/>row_index;</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/>row_index<sp/>=<sp/><ref refid="statistc_8cpp_1ab531cf8bc727a6e03af3a6cc10b4cd7a" kindref="member">choose_nth_item</ref><sp/>((<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>(row_count<sp/>*<sp/>textord_skew_ile),</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/>gradients,<sp/>row_count);</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/>page_m<sp/>=<sp/>gradients[row_index];</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/>row_index<sp/>=<sp/><ref refid="statistc_8cpp_1ab531cf8bc727a6e03af3a6cc10b4cd7a" kindref="member">choose_nth_item</ref><sp/>((<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>(row_count<sp/>*<sp/>textord_skew_ile),</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/>errors,<sp/>row_count);</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/>page_err<sp/>=<sp/>errors[row_index];</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><ref refid="memry_8cpp_1a9ef1862b8e026e23eef238af032858e4" kindref="member">free_mem</ref>(gradients);</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><ref refid="memry_8cpp_1a9ef1862b8e026e23eef238af032858e4" kindref="member">free_mem</ref>(errors);</highlight></codeline>
<codeline lineno="390"><highlight class="normal">}</highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1af9da918f4c268e7bfd9300632b056be2" kindref="member">kNoiseSize</ref><sp/>=<sp/>0.5;<sp/><sp/></highlight><highlight class="comment">//<sp/>Fraction<sp/>of<sp/>xheight.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a1baaf7ab16613cd7b5a13a28d65412b3" kindref="member">kMinSize</ref><sp/>=<sp/>8;<sp/><sp/></highlight><highlight class="comment">//<sp/>Min<sp/>pixels<sp/>to<sp/>be<sp/>xheight.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>dot_of_i(<ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>*<sp/>dot,<sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>*<sp/>i,<sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref>*<sp/>row)<sp/>{</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>ibox<sp/>=<sp/>i-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>();</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>dotbox<sp/>=<sp/>dot-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>();</highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Must<sp/>overlap<sp/>horizontally<sp/>by<sp/>enough<sp/>and<sp/>be<sp/>high<sp/>enough.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>overlap<sp/>=<sp/><ref refid="ndminx_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(dotbox.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>(),<sp/>ibox.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>())<sp/>-</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="ndminx_8h_1aacc3ee1a7f283f8ef65cea31f4436a95" kindref="member">MAX</ref>(dotbox.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>(),<sp/>ibox.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>());</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ibox.<ref refid="class_t_b_o_x_1a8379d4bbc72bdbb1f069fc14790e632d" kindref="member">height</ref>()<sp/>&lt;=<sp/>2<sp/>*<sp/>dotbox.<ref refid="class_t_b_o_x_1a8379d4bbc72bdbb1f069fc14790e632d" kindref="member">height</ref>()<sp/>||</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(overlap<sp/>*<sp/>2<sp/>&lt;<sp/>ibox.<ref refid="class_t_b_o_x_1af95494a2ccacc70cc2b83820b2948619" kindref="member">width</ref>()<sp/>&amp;&amp;<sp/>overlap<sp/>&lt;<sp/>dotbox.<ref refid="class_t_b_o_x_1af95494a2ccacc70cc2b83820b2948619" kindref="member">width</ref>()))</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="409"><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>the<sp/>i<sp/>is<sp/>tall<sp/>and<sp/>thin<sp/>then<sp/>it<sp/>is<sp/>good.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ibox.<ref refid="class_t_b_o_x_1a8379d4bbc72bdbb1f069fc14790e632d" kindref="member">height</ref>()<sp/>&gt;<sp/>ibox.<ref refid="class_t_b_o_x_1af95494a2ccacc70cc2b83820b2948619" kindref="member">width</ref>()<sp/>*<sp/>2)</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>i<sp/>or<sp/>!<sp/>must<sp/>be<sp/>tall<sp/>and<sp/>thin.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="413"><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>It<sp/>might<sp/>still<sp/>be<sp/>tall<sp/>and<sp/>thin,<sp/>but<sp/>it<sp/>might<sp/>be<sp/>joined<sp/>to<sp/>something.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>So<sp/>search<sp/>the<sp/>outline<sp/>for<sp/>a<sp/>piece<sp/>of<sp/>large<sp/>height<sp/>close<sp/>to<sp/>the<sp/>edges</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>of<sp/>the<sp/>dot.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>kHeightFraction<sp/>=<sp/>0.6;</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>target_height<sp/>=<sp/><ref refid="ndminx_8h_1a74e75242132eaabbc1c512488a135926" kindref="member">MIN</ref>(dotbox.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>(),<sp/>ibox.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>());</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/>target_height<sp/>-=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a51cc690153d9cabdc8217e2ac336d414" kindref="member">line_m</ref>()*dotbox.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>+<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a22dc07e392af85d9ce625efdd13c6627" kindref="member">line_c</ref>();</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/>target_height<sp/>*=<sp/>kHeightFraction;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>left_min<sp/>=<sp/>dotbox.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>-<sp/>dotbox.<ref refid="class_t_b_o_x_1af95494a2ccacc70cc2b83820b2948619" kindref="member">width</ref>();</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>middle<sp/>=<sp/>(dotbox.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>+<sp/>dotbox.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>())/2;</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>right_max<sp/>=<sp/>dotbox.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>()<sp/>+<sp/>dotbox.<ref refid="class_t_b_o_x_1af95494a2ccacc70cc2b83820b2948619" kindref="member">width</ref>();</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>left_miny<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>left_maxy<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>right_miny<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>right_maxy<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>found_left<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>found_right<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>in_left<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>in_right<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><ref refid="class_c___b_l_o_b" kindref="compound">C_BLOB</ref>*<sp/>blob<sp/>=<sp/>i-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a483f44541a4dd818f02225c92f030e07" kindref="member">cblob</ref>();</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/>C_OUTLINE_IT<sp/>o_it<sp/>=<sp/>blob-&gt;<ref refid="class_c___b_l_o_b_1ae510f3d0e7398fbb46608082429eac89" kindref="member">out_list</ref>();</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(o_it.mark_cycle_pt();<sp/>!o_it.cycled_list();<sp/>o_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_c___o_u_t_l_i_n_e" kindref="compound">C_OUTLINE</ref>*<sp/>outline<sp/>=<sp/>o_it.data();</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>length<sp/>=<sp/>outline-&gt;<ref refid="class_c___o_u_t_l_i_n_e_1afb87d87d3d48e964937b068f55f3ca3a" kindref="member">pathlength</ref>();</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref><sp/>pos<sp/>=<sp/>outline-&gt;<ref refid="class_c___o_u_t_l_i_n_e_1a0f9fef7d74691bbcf45faa2272600500" kindref="member">start_pos</ref>();</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>step<sp/>=<sp/>0;<sp/>step<sp/>&lt;<sp/>length;<sp/>pos<sp/>+=<sp/>outline-&gt;<ref refid="class_c___o_u_t_l_i_n_e_1af6831ec849fb5ab1f2b49517fbbd5f85" kindref="member">step</ref>(step++))<sp/>{</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x<sp/>=<sp/>pos.<ref refid="class_i_c_o_o_r_d_1a59722a47c540007c58a539f0e35b3f33" kindref="member" tooltip="access function ">x</ref>();</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>y<sp/>=<sp/>pos.<ref refid="class_i_c_o_o_r_d_1a66bba6ff8a5f060775e1c2ca511f7f29" kindref="member" tooltip="access_function ">y</ref>();</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x<sp/>&gt;=<sp/>left_min<sp/>&amp;&amp;<sp/>x<sp/>&lt;<sp/>middle<sp/>&amp;&amp;<sp/>!found_left)<sp/>{</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>We<sp/>are<sp/>in<sp/>the<sp/>left<sp/>part<sp/>so<sp/>find<sp/>min<sp/>and<sp/>max<sp/>y.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(in_left)<sp/>{</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(y<sp/>&gt;<sp/>left_maxy)<sp/>left_maxy<sp/>=<sp/>y;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(y<sp/>&lt;<sp/>left_miny)<sp/>left_miny<sp/>=<sp/>y;</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_maxy<sp/>=<sp/>left_miny<sp/>=<sp/>y;</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>in_left<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(in_left)<sp/>{</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>We<sp/>just<sp/>left<sp/>the<sp/>left<sp/>so<sp/>look<sp/>for<sp/>size.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(left_maxy<sp/>-<sp/>left_miny<sp/>&gt;<sp/>target_height)<sp/>{</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(found_right)</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>found_left<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>in_left<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x<sp/>&lt;=<sp/>right_max<sp/>&amp;&amp;<sp/>x<sp/>&gt;<sp/>middle<sp/>&amp;&amp;<sp/>!found_right)<sp/>{</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>We<sp/>are<sp/>in<sp/>the<sp/>right<sp/>part<sp/>so<sp/>find<sp/>min<sp/>and<sp/>max<sp/>y.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(in_right)<sp/>{</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(y<sp/>&gt;<sp/>right_maxy)<sp/>right_maxy<sp/>=<sp/>y;</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(y<sp/>&lt;<sp/>right_miny)<sp/>right_miny<sp/>=<sp/>y;</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_maxy<sp/>=<sp/>right_miny<sp/>=<sp/>y;</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>in_right<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(in_right)<sp/>{</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>We<sp/>just<sp/>left<sp/>the<sp/>right<sp/>so<sp/>look<sp/>for<sp/>size.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(right_maxy<sp/>-<sp/>right_miny<sp/>&gt;<sp/>target_height)<sp/>{</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(found_left)</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>found_right<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>in_right<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="480"><highlight class="normal">}</highlight></codeline>
<codeline lineno="481"><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>vigorous_noise_removal(<ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref>*<sp/>block)<sp/>{</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>();</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref>*<sp/>row<sp/>=<sp/>row_it.data();</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/>BLOBNBOX_IT<sp/>b_it<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref>();</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Estimate<sp/>the<sp/>xheight<sp/>on<sp/>the<sp/>row.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>max_height<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(b_it.mark_cycle_pt();<sp/>!b_it.cycled_list();<sp/>b_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>*<sp/>blob<sp/>=<sp/>b_it.data();</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a8379d4bbc72bdbb1f069fc14790e632d" kindref="member">height</ref>()<sp/>&gt;<sp/>max_height)</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_height<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a8379d4bbc72bdbb1f069fc14790e632d" kindref="member">height</ref>();</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>hstats(0,<sp/>max_height<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(b_it.mark_cycle_pt();<sp/>!b_it.cycled_list();<sp/>b_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>*<sp/>blob<sp/>=<sp/>b_it.data();</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>height<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a8379d4bbc72bdbb1f069fc14790e632d" kindref="member">height</ref>();</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(height<sp/>&gt;=<sp/>kMinSize)</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hstats.add(blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a8379d4bbc72bdbb1f069fc14790e632d" kindref="member">height</ref>(),<sp/>1);</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>xheight<sp/>=<sp/>hstats.median();</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Delete<sp/>small<sp/>objects.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>*<sp/>prev<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(b_it.mark_cycle_pt();<sp/>!b_it.cycled_list();<sp/>b_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>*<sp/>blob<sp/>=<sp/>b_it.data();</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>();</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(box.<ref refid="class_t_b_o_x_1a8379d4bbc72bdbb1f069fc14790e632d" kindref="member">height</ref>()<sp/>&lt;<sp/>kNoiseSize<sp/>*<sp/>xheight)<sp/>{</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Small<sp/>so<sp/>delete<sp/>unless<sp/>it<sp/>looks<sp/>like<sp/>an<sp/>i<sp/>dot.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(prev<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dot_of_i(blob,<sp/>prev,<sp/>row))</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Looks<sp/>OK.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!b_it.at_last())<sp/>{</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>*<sp/>next<sp/>=<sp/>b_it.data_relative(1);</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dot_of_i(blob,<sp/>next,<sp/>row))</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>Looks<sp/>OK.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>It<sp/>might<sp/>be<sp/>noise<sp/>so<sp/>get<sp/>rid<sp/>of<sp/>it.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a483f44541a4dd818f02225c92f030e07" kindref="member">cblob</ref>()<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a483f44541a4dd818f02225c92f030e07" kindref="member">cblob</ref>();</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>b_it.extract();</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prev<sp/>=<sp/>blob;</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="527"><highlight class="normal">}</highlight></codeline>
<codeline lineno="528"><highlight class="normal"></highlight></codeline>
<codeline lineno="534"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a963ac786bbbcafd731d9b974f9164645" kindref="member">cleanup_rows_making</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>lines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref><sp/>page_tr,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//top<sp/>right</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/><sp/><sp/></highlight><highlight class="comment">//block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//gradient<sp/>to<sp/>fit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>rotation,<sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>drawing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>block_edge,<sp/><sp/></highlight><highlight class="comment">//edge<sp/>of<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>testing_on<sp/><sp/></highlight><highlight class="comment">//correct<sp/>orientation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//iterators</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it<sp/>=<sp/>&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a5dd67c54162a6b60b0fd11500d4a3025" kindref="member">blobs</ref>;</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>();</highlight></codeline>
<codeline lineno="545"><highlight class="normal"></highlight></codeline>
<codeline lineno="546"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="547"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_parallel_rows<sp/>&amp;&amp;<sp/>testing_on)<sp/>{</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref><sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1a5e0654ca01b55c243387c6535b32860b" kindref="member">create_to_win</ref>(page_tr);</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="551"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="552"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//get<sp/>row<sp/>coords</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1abd52b97627f2779855a74b0b9fcae6b2" kindref="member">fit_parallel_rows</ref>(block,</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradient,</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rotation,</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_edge,</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>textord_show_parallel_rows<sp/>&amp;&amp;testing_on);</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1a064bc924e529f5c292a533328065c880" kindref="member">delete_non_dropout_rows</ref>(block,</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradient,</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rotation,</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_edge,</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>textord_show_parallel_rows<sp/>&amp;&amp;testing_on);</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1aa7a5766705cc30b622092e75022c5cbf" kindref="member">expand_rows</ref>(page_tr,<sp/>block,<sp/>gradient,<sp/>rotation,<sp/>block_edge,<sp/>testing_on);</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/>blob_it.set_to_list<sp/>(&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a5dd67c54162a6b60b0fd11500d4a3025" kindref="member">blobs</ref>);</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/>row_it.set_to_list<sp/>(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>());</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/>blob_it.add_list_after<sp/>(row_it.data<sp/>()-&gt;blob_list<sp/>());</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//give<sp/>blobs<sp/>back</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1af9d632b1a85d2d92bbd0597b76ba026d" kindref="member">assign_blobs_to_rows</ref><sp/>(block,<sp/>&amp;gradient,<sp/>1,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>);</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//now<sp/>new<sp/>rows<sp/>must<sp/>be<sp/>genuine</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/>blob_it.set_to_list<sp/>(&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a5dd67c54162a6b60b0fd11500d4a3025" kindref="member">blobs</ref>);</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/>blob_it.add_list_after<sp/>(&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1aafe2a9baa69300ee71da42e6dc18cfee" kindref="member">large_blobs</ref>);</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1af9d632b1a85d2d92bbd0597b76ba026d" kindref="member">assign_blobs_to_rows</ref><sp/>(block,<sp/>&amp;gradient,<sp/>2,<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>);</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//safe<sp/>to<sp/>use<sp/>big<sp/>ones<sp/>now</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/>blob_it.set_to_list<sp/>(&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a5dd67c54162a6b60b0fd11500d4a3025" kindref="member">blobs</ref>);</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//throw<sp/>all<sp/>blobs<sp/>in</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/>blob_it.add_list_after<sp/>(&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1aa6a3757d385e79ab76f34afb6e8fc684" kindref="member">noise_blobs</ref>);</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/>blob_it.add_list_after<sp/>(&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ad16b1c18225b44c50674ca46841b0f5f" kindref="member">small_blobs</ref>);</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1af9d632b1a85d2d92bbd0597b76ba026d" kindref="member">assign_blobs_to_rows</ref><sp/>(block,<sp/>&amp;gradient,<sp/>3,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>);</highlight></codeline>
<codeline lineno="580"><highlight class="normal">}</highlight></codeline>
<codeline lineno="581"><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespacetesseract-c__api-demo_1afed58feacb84df2de88bdd613cfdba6d" kindref="member">tesseract</ref><sp/>{</highlight></codeline>
<codeline lineno="583"><highlight class="normal"></highlight></codeline>
<codeline lineno="584"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>Textord::cleanup_rows_fitting(<ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref><sp/>page_tr,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>top<sp/>right</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>gradient<sp/>to<sp/>fit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>rotation,<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>for<sp/>drawing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>block_edge,<sp/><sp/></highlight><highlight class="comment">//<sp/>edge<sp/>of<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>testing_on)<sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>correct<sp/>orientation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it<sp/>=<sp/>&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a5dd67c54162a6b60b0fd11500d4a3025" kindref="member">blobs</ref>;</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref>();</highlight></codeline>
<codeline lineno="592"><highlight class="normal"></highlight></codeline>
<codeline lineno="593"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="594"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_parallel_rows<sp/>&amp;&amp;<sp/>testing_on)<sp/>{</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref><sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1a5e0654ca01b55c243387c6535b32860b" kindref="member">create_to_win</ref>(page_tr);</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="598"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="599"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt();<sp/>!row_it.cycled_list();<sp/>row_it.forward())</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/>row_it.data()-&gt;blob_list()-&gt;sort(<ref refid="makerow_8cpp_1a71e57df4cbaf6a0d8fb156f0604d1033" kindref="member">blob_x_order</ref>);</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1abd52b97627f2779855a74b0b9fcae6b2" kindref="member">fit_parallel_rows</ref>(block,<sp/>gradient,<sp/>rotation,<sp/>block_edge,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>);</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_heavy_nr)<sp/>{</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/>vigorous_noise_removal(block);</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><ref refid="class_p_o_l_y___b_l_o_c_k" kindref="compound">POLY_BLOCK</ref>*<sp/>pb<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a16e698664028b0d6d2193db64560c16b" kindref="member">block</ref>-&gt;<ref refid="class_p_d_b_l_k_1a6670779c69aca2d574e4a0590d9b3939" kindref="member">poly_block</ref>();</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pb<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>||<sp/>pb-&gt;<ref refid="class_p_o_l_y___b_l_o_c_k_1abd32dee532afe634cdbacffc0b53e660" kindref="member">IsText</ref>())<sp/>{</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1a004e5d894712f552369ef523a09bc3ce" kindref="member">separate_underlines</ref>(block,<sp/>gradient,<sp/>rotation,<sp/>testing_on);</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1a8a932e3bd44fc2fc6fbdc291cdc9b942" kindref="member">pre_associate_blobs</ref>(page_tr,<sp/>block,<sp/>rotation,<sp/>testing_on);</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="610"><highlight class="normal"></highlight></codeline>
<codeline lineno="611"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="612"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_final_rows<sp/>&amp;&amp;<sp/>testing_on)<sp/>{</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref><sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1a5e0654ca01b55c243387c6535b32860b" kindref="member">create_to_win</ref>(page_tr);</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="616"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="617"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1abd52b97627f2779855a74b0b9fcae6b2" kindref="member">fit_parallel_rows</ref>(block,<sp/>gradient,<sp/>rotation,<sp/>block_edge,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>);</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>textord_show_final_rows<sp/>&amp;&amp;<sp/>testing_on);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/>make_spline_rows(block,</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradient,</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rotation,</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_edge,</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>textord_show_final_rows<sp/>&amp;&amp;<sp/>testing_on);</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>We<sp/>only<sp/>want<sp/>to<sp/>call<sp/>compute_block_xheight()<sp/>if</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>both<sp/>textord_old_xheight<sp/>and<sp/>textord_old_baselines<sp/>are<sp/>false.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>No<sp/>need<sp/>to<sp/>call<sp/>compute_block_xheight()<sp/>if<sp/>textord_old_baselines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>is<sp/>true,<sp/>since<sp/>all<sp/>appropriate<sp/>xheight<sp/>computation<sp/>functions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>would<sp/>be<sp/>called<sp/>from<sp/>make_old_baselines().</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Note:<sp/>it<sp/>can<sp/>not<sp/>be<sp/>the<sp/>case<sp/>that<sp/>textord_old_baselines<sp/>is</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>false,<sp/>and<sp/>textord_old_xheight<sp/>is<sp/>true.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!textord_old_xheight<sp/>&amp;&amp;<sp/>!textord_old_baselines)</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/>compute_block_xheight(block,<sp/>gradient);</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_restore_underlines)<sp/><sp/></highlight><highlight class="comment">//<sp/>fix<sp/>underlines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="underlin_8cpp_1a2118358b0e0f62667f62a0aaf2fb2ae8" kindref="member">restore_underlined_blobs</ref>(block);</highlight></codeline>
<codeline lineno="636"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="637"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_final_rows<sp/>&amp;&amp;<sp/>testing_on)<sp/>{</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/>colour<sp/>=<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0959f7470b08ae1a38aa7e38fba29402" kindref="member">ScrollView::RED</ref>;</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt();<sp/>!row_it.cycled_list();<sp/>row_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1afb1c1fd2d6af3a9851ab98454356c3cf" kindref="member">plot_parallel_row</ref>(row_it.data(),<sp/>gradient,</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_edge,<sp/>colour,<sp/>rotation);</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>colour<sp/>=<sp/>(<ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref>)<sp/>(colour<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(colour<sp/>&gt;<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8aebeaaeee353c6f04b4498b1fef94bbb3" kindref="member">ScrollView::MAGENTA</ref>)</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>colour<sp/>=<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0959f7470b08ae1a38aa7e38fba29402" kindref="member">ScrollView::RED</ref>;</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="blobbox_8cpp_1a331e6744e04cb0a2fb23c1465c82196c" kindref="member">plot_blob_list</ref>(<ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref>,<sp/>&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a5dd67c54162a6b60b0fd11500d4a3025" kindref="member">blobs</ref>,</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8aebeaaeee353c6f04b4498b1fef94bbb3" kindref="member">ScrollView::MAGENTA</ref>,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0eab2b208fc9a5e2774f92cf3e768982" kindref="member">ScrollView::WHITE</ref>);</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//show<sp/>discarded<sp/>blobs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="blobbox_8cpp_1a331e6744e04cb0a2fb23c1465c82196c" kindref="member">plot_blob_list</ref>(<ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref>,<sp/>&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1abe8092e46729fbddf38f16ad7ca07318" kindref="member">underlines</ref>,</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a61dec9bc0aaf1d527a731b2a6ce055c8" kindref="member">ScrollView::YELLOW</ref>,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a9a954d0f0149ee883cbcc5e0a379b460" kindref="member">ScrollView::CORAL</ref>);</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_final_rows<sp/>&amp;&amp;<sp/>testing_on<sp/>&amp;&amp;<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a5dd67c54162a6b60b0fd11500d4a3025" kindref="member">blobs</ref>.length<sp/>()<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;%d<sp/>blobs<sp/>discarded<sp/>as<sp/>noise\n&quot;</highlight><highlight class="normal">,<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a5dd67c54162a6b60b0fd11500d4a3025" kindref="member">blobs</ref>.length<sp/>());</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_final_rows<sp/>&amp;&amp;<sp/>testing_on)<sp/>{</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1af8aae7bd42a61b839e724a34c07b42ab" kindref="member">draw_meanlines</ref>(block,<sp/>gradient,<sp/>block_edge,<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0eab2b208fc9a5e2774f92cf3e768982" kindref="member">ScrollView::WHITE</ref>,<sp/>rotation);</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="658"><highlight class="preprocessor"></highlight><highlight class="normal">}</highlight></codeline>
<codeline lineno="659"><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal">}<sp/><sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>tesseract.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="661"><highlight class="normal"></highlight></codeline>
<codeline lineno="667"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a064bc924e529f5c292a533328065c880" kindref="member">delete_non_dropout_rows</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>lines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/><sp/><sp/></highlight><highlight class="comment">//block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//global<sp/>skew</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>rotation,<sp/><sp/><sp/></highlight><highlight class="comment">//deskew<sp/>vector</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>block_edge,<sp/><sp/></highlight><highlight class="comment">//left<sp/>edge</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>testing_on<sp/><sp/><sp/></highlight><highlight class="comment">//correct<sp/>orientation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>block_box;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//deskewed<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>*deltas;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//change<sp/>in<sp/>occupation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>*occupation;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>pixel<sp/>coords</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>max_y;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//in<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>min_y;</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>line_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>scan<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>line_count;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//no<sp/>of<sp/>scan<sp/>lines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>distance;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//to<sp/>drop-out</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>xleft;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>ybottom;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>();</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it<sp/>=<sp/>&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a5dd67c54162a6b60b0fd11500d4a3025" kindref="member">blobs</ref>;</highlight></codeline>
<codeline lineno="687"><highlight class="normal"></highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_it.length<sp/>()<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//empty<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/>block_box<sp/>=<sp/><ref refid="makerow_8cpp_1afcd9d2bb6d7f6b16e31ed5a75799f43d" kindref="member">deskew_block_coords</ref><sp/>(block,<sp/>gradient);</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/>xleft<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a16e698664028b0d6d2193db64560c16b" kindref="member">block</ref>-&gt;<ref refid="class_p_d_b_l_k_1a91950a96127b4a0bb9b237e1f5f889a4" kindref="member" tooltip="get box ">bounding_box</ref><sp/>().left<sp/>();</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/>ybottom<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a16e698664028b0d6d2193db64560c16b" kindref="member">block</ref>-&gt;<ref refid="class_p_d_b_l_k_1a91950a96127b4a0bb9b237e1f5f889a4" kindref="member" tooltip="get box ">bounding_box</ref><sp/>().bottom<sp/>();</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/>min_y<sp/>=<sp/>block_box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref><sp/>()<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/>max_y<sp/>=<sp/>block_box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref><sp/>()<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/>line_index<sp/>=<sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>floor<sp/>(row_it.data<sp/>()-&gt;intercept<sp/>());</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(line_index<sp/>&lt;=<sp/>min_y)</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>min_y<sp/>=<sp/>line_index<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(line_index<sp/>&gt;=<sp/>max_y)</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>max_y<sp/>=<sp/>line_index<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/>line_count<sp/>=<sp/>max_y<sp/>-<sp/>min_y<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(line_count<sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//empty<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/>deltas<sp/>=<sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>*)<sp/><ref refid="memry_8cpp_1a4c14b091498fb7866a1dd0af51a591fe" kindref="member">alloc_mem</ref><sp/>(line_count<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>));</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/>occupation<sp/>=<sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>*)<sp/><ref refid="memry_8cpp_1a4c14b091498fb7866a1dd0af51a591fe" kindref="member">alloc_mem</ref><sp/>(line_count<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>));</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(deltas<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref><sp/>||<sp/>occupation<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="stderr_8h_1a669968baa4639e34aef50907918653df" kindref="member">MEMORY_OUT</ref>.<ref refid="class_e_r_r_c_o_d_e_1abc4cc64aad0ddb74c02523b69c95a1c1" kindref="member">error</ref><sp/>(</highlight><highlight class="stringliteral">&quot;compute_line_spacing&quot;</highlight><highlight class="normal">,<sp/><ref refid="errcode_8h_1a8a3a2e51383909b357fcdf8eda803637a781ad2788df9e25c59a70894c7832096" kindref="member">ABORT</ref>,<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>);</highlight></codeline>
<codeline lineno="709"><highlight class="normal"></highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1a8c7ec8665e61df259e140e8e1c81a743" kindref="member">compute_line_occupation</ref>(block,<sp/>gradient,<sp/>min_y,<sp/>max_y,<sp/>occupation,<sp/>deltas);</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1a3a483ed820ddbd43d809542e5a3d934f" kindref="member">compute_occupation_threshold</ref><sp/>((<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/>ceil<sp/>(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref><sp/>*</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/>(<ref refid="classtesseract_1_1_c_c_struct_1a7e8a361df0831d295edf1c150c3ca3a3" kindref="member">tesseract::CCStruct::kDescenderFraction</ref><sp/>+</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_c_c_struct_1a9d71fddad74d9418e106713cd643b919" kindref="member">tesseract::CCStruct::kAscenderFraction</ref>)),</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>ceil<sp/>(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref><sp/>*</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/>(<ref refid="classtesseract_1_1_c_c_struct_1a737fdb37b9401ad3d04371c1bd4a0b17" kindref="member">tesseract::CCStruct::kXHeightFraction</ref><sp/>+</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_c_c_struct_1a9d71fddad74d9418e106713cd643b919" kindref="member">tesseract::CCStruct::kAscenderFraction</ref>)),</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/>max_y<sp/>-<sp/>min_y<sp/>+<sp/>1,<sp/>occupation,<sp/>deltas);</highlight></codeline>
<codeline lineno="719"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="720"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)<sp/>{</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1a6abaa0ee0ca8c43467bff43bd25db8a7" kindref="member">draw_occupation</ref>(xleft,<sp/>ybottom,<sp/>min_y,<sp/>max_y,<sp/>occupation,<sp/>deltas);</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="723"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="724"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1ac0e0c477a9aaee3c2ff39b540a814d50" kindref="member">compute_dropout_distances</ref>(occupation,<sp/>deltas,<sp/>line_count);</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/>row<sp/>=<sp/>row_it.data<sp/>();</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/>line_index<sp/>=<sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>floor<sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref><sp/>());</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/>distance<sp/>=<sp/>deltas[line_index<sp/>-<sp/>min_y];</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="makerow_8cpp_1a691a8a66ddd732c9c3e57a0561ed3848" kindref="member">find_best_dropout_row</ref><sp/>(row,<sp/>distance,<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref><sp/>/<sp/>2,</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/>line_index,<sp/>&amp;row_it,<sp/>testing_on))<sp/>{</highlight></codeline>
<codeline lineno="731"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="732"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1afb1c1fd2d6af3a9851ab98454356c3cf" kindref="member">plot_parallel_row</ref>(row,<sp/>gradient,<sp/>block_edge,</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0eab2b208fc9a5e2774f92cf3e768982" kindref="member">ScrollView::WHITE</ref>,<sp/>rotation);</highlight></codeline>
<codeline lineno="735"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="736"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.add_list_after<sp/>(row_it.data<sp/>()-&gt;blob_list<sp/>());</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>row_it.extract<sp/>();<sp/><sp/></highlight><highlight class="comment">//too<sp/>far<sp/>away</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/>blob_it.add_list_after<sp/>(row_it.data<sp/>()-&gt;blob_list<sp/>());</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="743"><highlight class="normal"></highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><ref refid="memry_8cpp_1a9ef1862b8e026e23eef238af032858e4" kindref="member">free_mem</ref>(deltas);</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><ref refid="memry_8cpp_1a9ef1862b8e026e23eef238af032858e4" kindref="member">free_mem</ref>(occupation);</highlight></codeline>
<codeline lineno="746"><highlight class="normal">}</highlight></codeline>
<codeline lineno="747"><highlight class="normal"></highlight></codeline>
<codeline lineno="748"><highlight class="normal"></highlight></codeline>
<codeline lineno="755"><highlight class="normal"><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/><ref refid="makerow_8cpp_1a691a8a66ddd732c9c3e57a0561ed3848" kindref="member">find_best_dropout_row</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>neighbours</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//row<sp/>to<sp/>test</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>distance,<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//dropout<sp/>dist</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>dist_limit,<sp/><sp/><sp/></highlight><highlight class="comment">//threshold<sp/>distance</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>line_index,<sp/><sp/><sp/></highlight><highlight class="comment">//index<sp/>of<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TO_ROW_IT<sp/>*row_it,<sp/><sp/></highlight><highlight class="comment">//current<sp/>position</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>testing_on<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//correct<sp/>orientation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>next_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>neigbouring<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>row_offset;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//from<sp/>current<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>abs_dist;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//absolute<sp/>distance</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a46145b78ae1e821253ef36fd03661208" kindref="member">inT8</ref><sp/>row_inc;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//increment<sp/>to<sp/>row_index</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*next_row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//nextious<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="768"><highlight class="normal"></highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;Row<sp/>at<sp/>%g(%g),<sp/>dropout<sp/>dist=%d,&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref><sp/>(),<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a81a46c8d6026c157c152778aa9d1ab58" kindref="member">parallel_c</ref><sp/>(),<sp/>distance);</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(distance<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/>row_inc<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/>abs_dist<sp/>=<sp/>-distance;</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/>row_inc<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/>abs_dist<sp/>=<sp/>distance;</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(abs_dist<sp/>&gt;<sp/>dist_limit)<sp/>{</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)<sp/>{</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;<sp/>too<sp/>far<sp/>-<sp/>deleting\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((distance<sp/>&lt;<sp/>0<sp/>&amp;&amp;<sp/>!row_it-&gt;at_last<sp/>())</highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/>||<sp/>(distance<sp/>&gt;=<sp/>0<sp/>&amp;&amp;<sp/>!row_it-&gt;at_first<sp/>()))<sp/>{</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/>row_offset<sp/>=<sp/>row_inc;</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>next_row<sp/>=<sp/>row_it-&gt;data_relative<sp/>(row_offset);</highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>next_index<sp/>=<sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>floor<sp/>(next_row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref><sp/>());</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((distance<sp/>&lt;<sp/>0</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>next_index<sp/>&lt;<sp/>line_index</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>next_index<sp/>&gt;<sp/>line_index<sp/>+<sp/>distance<sp/>+<sp/>distance)</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>(distance<sp/>&gt;=<sp/>0</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>next_index<sp/>&gt;<sp/>line_index</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>next_index<sp/>&lt;<sp/>line_index<sp/>+<sp/>distance<sp/>+<sp/>distance))<sp/>{</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)<sp/>{</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;<sp/>nearer<sp/>neighbour<sp/>(%d)<sp/>at<sp/>%g\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line_index<sp/>+<sp/>distance<sp/>-<sp/>next_index,</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next_row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref><sp/>());</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//other<sp/>is<sp/>nearer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(next_index<sp/>==<sp/>line_index</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>next_index<sp/>==<sp/>line_index<sp/>+<sp/>distance<sp/>+<sp/>distance)<sp/>{</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1ad75977d78697308fc64cbd42f056b9bd" kindref="member">believability</ref><sp/>()<sp/>&lt;=<sp/>next_row-&gt;<ref refid="class_t_o___r_o_w_1ad75977d78697308fc64cbd42f056b9bd" kindref="member">believability</ref><sp/>())<sp/>{</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)<sp/>{</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;<sp/>equal<sp/>but<sp/>more<sp/>believable<sp/>at<sp/>%g<sp/>(%g/%g)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next_row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref><sp/>(),</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ad75977d78697308fc64cbd42f056b9bd" kindref="member">believability</ref><sp/>(),</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next_row-&gt;<ref refid="class_t_o___r_o_w_1ad75977d78697308fc64cbd42f056b9bd" kindref="member">believability</ref><sp/>());</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//other<sp/>is<sp/>more<sp/>believable</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_offset<sp/>+=<sp/>row_inc;</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((next_index<sp/>==<sp/>line_index</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>next_index<sp/>==<sp/>line_index<sp/>+<sp/>distance<sp/>+<sp/>distance)</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>row_offset<sp/>&lt;<sp/>row_it-&gt;length<sp/>());</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;<sp/>keeping\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="826"><highlight class="normal">}</highlight></codeline>
<codeline lineno="827"><highlight class="normal"></highlight></codeline>
<codeline lineno="828"><highlight class="normal"></highlight></codeline>
<codeline lineno="835"><highlight class="normal"><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/><ref refid="makerow_8cpp_1afcd9d2bb6d7f6b16e31ed5a75799f43d" kindref="member">deskew_block_coords</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//block<sp/>box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/><sp/></highlight><highlight class="comment">//block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//global<sp/>skew</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>result;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//block<sp/>bounds</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>blob_box;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>rotation;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//deskew<sp/>vector</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>length;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>gradient<sp/>vector</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>();</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>*blob;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="847"><highlight class="normal"></highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/>length<sp/>=<sp/>sqrt<sp/>(gradient<sp/>*<sp/>gradient<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/>rotation<sp/>=<sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>(1<sp/>/<sp/>length,<sp/>-gradient<sp/>/<sp/>length);</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><sp/><sp/>row<sp/>=<sp/>row_it.data<sp/>();</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/>blob_it.set_to_list<sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref><sp/>());</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(blob_it.mark_cycle_pt<sp/>();<sp/>!blob_it.cycled_list<sp/>();</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/>blob_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob<sp/>=<sp/>blob_it.data<sp/>();</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_box<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>();</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_box.<ref refid="class_t_b_o_x_1a428e14544aeb44064bc8637d920211a0" kindref="member">rotate</ref><sp/>(rotation);</highlight><highlight class="comment">//de-skew<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/>blob_box;</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="862"><highlight class="normal">}</highlight></codeline>
<codeline lineno="863"><highlight class="normal"></highlight></codeline>
<codeline lineno="864"><highlight class="normal"></highlight></codeline>
<codeline lineno="871"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a8c7ec8665e61df259e140e8e1c81a743" kindref="member">compute_line_occupation</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//project<sp/>blobs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient,<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//global<sp/>skew</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>min_y,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//min<sp/>coord<sp/>in<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>max_y,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//in<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>*occupation,<sp/><sp/></highlight><highlight class="comment">//output<sp/>projection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>*deltas<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//derivative</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>line_count;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//maxy-miny+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>line_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>scan<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//array<sp/>index<sp/>for<sp/>daft<sp/>compilers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>top,<sp/>bottom;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//coords<sp/>of<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>width;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>();</highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>*blob;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>length;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>skew<sp/>vector</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>blob_box;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//bounding<sp/>box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>rotation;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//inverse<sp/>of<sp/>skew</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="891"><highlight class="normal"></highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/>line_count<sp/>=<sp/>max_y<sp/>-<sp/>min_y<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/>length<sp/>=<sp/>sqrt<sp/>(gradient<sp/>*<sp/>gradient<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/>rotation<sp/>=<sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>(1<sp/>/<sp/>length,<sp/>-gradient<sp/>/<sp/>length);</highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(line_index<sp/>=<sp/>0;<sp/>line_index<sp/>&lt;<sp/>line_count;<sp/>line_index++)</highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/>deltas[line_index]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/>row<sp/>=<sp/>row_it.data<sp/>();</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/>blob_it.set_to_list<sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref><sp/>());</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(blob_it.mark_cycle_pt<sp/>();<sp/>!blob_it.cycled_list<sp/>();</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/>blob_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob<sp/>=<sp/>blob_it.data<sp/>();</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_box<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>();</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_box.<ref refid="class_t_b_o_x_1a428e14544aeb44064bc8637d920211a0" kindref="member">rotate</ref><sp/>(rotation);</highlight><highlight class="comment">//de-skew<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>top<sp/>=<sp/>blob_box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref><sp/>();</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bottom<sp/>=<sp/>blob_box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref><sp/>();</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>width<sp/>=</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>floor<sp/>((<ref refid="host_8h_1a6a3da5f1db8d485c0d2f5a7ba526c4a0" kindref="member">FLOAT32</ref>)<sp/>(blob_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>()<sp/>-<sp/>blob_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>()));</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>floor<sp/>(bottom)<sp/>&lt;<sp/>min_y</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>floor<sp/>(bottom)<sp/>-<sp/>min_y<sp/>&gt;=<sp/>line_count)</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf<sp/>(stderr,</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Bad<sp/>y<sp/>coord<sp/>of<sp/>bottom,<sp/>&quot;</highlight><highlight class="normal"><sp/><ref refid="host_8h_1abe22434564efd658acebe9e8cf6235bc" kindref="member">INT32FORMAT</ref><sp/></highlight><highlight class="stringliteral">&quot;(&quot;</highlight><highlight class="normal"><sp/><ref refid="host_8h_1abe22434564efd658acebe9e8cf6235bc" kindref="member">INT32FORMAT</ref><sp/></highlight><highlight class="stringliteral">&quot;,&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1abe22434564efd658acebe9e8cf6235bc" kindref="member">INT32FORMAT</ref><sp/></highlight><highlight class="stringliteral">&quot;)\n&quot;</highlight><highlight class="normal">,<sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>floor<sp/>(bottom),<sp/>min_y,<sp/>max_y);</highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//count<sp/>transitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>=<sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>floor<sp/>(bottom)<sp/>-<sp/>min_y;</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>deltas[index]<sp/>+=<sp/>width;</highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>floor<sp/>(top)<sp/>&lt;<sp/>min_y</highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>floor<sp/>(top)<sp/>-<sp/>min_y<sp/>&gt;=<sp/>line_count)</highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf<sp/>(stderr,</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Bad<sp/>y<sp/>coord<sp/>of<sp/>top,<sp/>&quot;</highlight><highlight class="normal"><sp/>INT32FORMAT<sp/></highlight><highlight class="stringliteral">&quot;(&quot;</highlight><highlight class="normal"><sp/>INT32FORMAT<sp/></highlight><highlight class="stringliteral">&quot;,&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>INT32FORMAT<sp/></highlight><highlight class="stringliteral">&quot;)\n&quot;</highlight><highlight class="normal">,<sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>floor<sp/>(top),<sp/>min_y,<sp/>max_y);</highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>=<sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>floor<sp/>(top)<sp/>-<sp/>min_y;</highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>deltas[index]<sp/>-=<sp/>width;</highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/>occupation[0]<sp/>=<sp/>deltas[0];</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(line_index<sp/>=<sp/>1;<sp/>line_index<sp/>&lt;<sp/>line_count;<sp/>line_index++)</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/>occupation[line_index]<sp/>=<sp/>occupation[line_index<sp/>-<sp/>1]<sp/>+<sp/>deltas[line_index];</highlight></codeline>
<codeline lineno="929"><highlight class="normal">}</highlight></codeline>
<codeline lineno="930"><highlight class="normal"></highlight></codeline>
<codeline lineno="931"><highlight class="normal"></highlight></codeline>
<codeline lineno="937"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a3a483ed820ddbd43d809542e5a3d934f" kindref="member">compute_occupation_threshold</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//project<sp/>blobs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>low_window,<sp/><sp/><sp/></highlight><highlight class="comment">//below<sp/>result<sp/>point</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>high_window,<sp/><sp/></highlight><highlight class="comment">//above<sp/>result<sp/>point</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>line_count,<sp/><sp/><sp/></highlight><highlight class="comment">//array<sp/>sizes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>*occupation,<sp/><sp/></highlight><highlight class="comment">//input<sp/>projection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>*thresholds<sp/><sp/><sp/></highlight><highlight class="comment">//output<sp/>thresholds</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>line_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>thresholds<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>low_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//in<sp/>occupation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>high_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//in<sp/>occupation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>sum;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>average</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>divisor;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//to<sp/>get<sp/>thresholds</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>min_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>min<sp/>occ</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>min_occ;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//min<sp/>in<sp/>locality</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>test_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>finding<sp/>min</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="952"><highlight class="normal"></highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/>divisor<sp/>=</highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>)<sp/>ceil<sp/>((low_window<sp/>+<sp/>high_window)<sp/>/<sp/>textord_occupancy_threshold);</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(low_window<sp/>+<sp/>high_window<sp/>&lt;<sp/>line_count)<sp/>{</highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(sum<sp/>=<sp/>0,<sp/>high_index<sp/>=<sp/>0;<sp/>high_index<sp/>&lt;<sp/>low_window;<sp/>high_index++)</highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>sum<sp/>+=<sp/>occupation[high_index];</highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(low_index<sp/>=<sp/>0;<sp/>low_index<sp/>&lt;<sp/>high_window;<sp/>low_index++,<sp/>high_index++)</highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>sum<sp/>+=<sp/>occupation[high_index];</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/>min_occ<sp/>=<sp/>occupation[0];</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/>min_index<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(test_index<sp/>=<sp/>1;<sp/>test_index<sp/>&lt;<sp/>high_index;<sp/>test_index++)<sp/>{</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(occupation[test_index]<sp/>&lt;=<sp/>min_occ)<sp/>{</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_occ<sp/>=<sp/>occupation[test_index];</highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_index<sp/>=<sp/>test_index;<sp/><sp/></highlight><highlight class="comment">//find<sp/>min<sp/>in<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(line_index<sp/>=<sp/>0;<sp/>line_index<sp/>&lt;<sp/>low_window;<sp/>line_index++)</highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>thresholds[line_index]<sp/>=<sp/>(sum<sp/>-<sp/>min_occ)<sp/>/<sp/>divisor<sp/>+<sp/>min_occ;</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//same<sp/>out<sp/>to<sp/>end</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(low_index<sp/>=<sp/>0;<sp/>high_index<sp/>&lt;<sp/>line_count;<sp/>low_index++,<sp/>high_index++)<sp/>{</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>sum<sp/>-=<sp/>occupation[low_index];</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>sum<sp/>+=<sp/>occupation[high_index];</highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(occupation[high_index]<sp/>&lt;=<sp/>min_occ)<sp/>{</highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>min<sp/>in<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_occ<sp/>=<sp/>occupation[high_index];</highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_index<sp/>=<sp/>high_index;</highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//lost<sp/>min<sp/>from<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(min_index<sp/>&lt;=<sp/>low_index)<sp/>{</highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_occ<sp/>=<sp/>occupation[low_index<sp/>+<sp/>1];</highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_index<sp/>=<sp/>low_index<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(test_index<sp/>=<sp/>low_index<sp/>+<sp/>2;<sp/>test_index<sp/>&lt;=<sp/>high_index;</highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>test_index++)<sp/>{</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(occupation[test_index]<sp/>&lt;=<sp/>min_occ)<sp/>{</highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_occ<sp/>=<sp/>occupation[test_index];</highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>min<sp/>in<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_index<sp/>=<sp/>test_index;</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>thresholds[line_index++]<sp/>=<sp/>(sum<sp/>-<sp/>min_occ)<sp/>/<sp/>divisor<sp/>+<sp/>min_occ;</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="994"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/>min_occ<sp/>=<sp/>occupation[0];</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/>min_index<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(sum<sp/>=<sp/>0,<sp/>low_index<sp/>=<sp/>0;<sp/>low_index<sp/>&lt;<sp/>line_count;<sp/>low_index++)<sp/>{</highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(occupation[low_index]<sp/>&lt;<sp/>min_occ)<sp/>{</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_occ<sp/>=<sp/>occupation[low_index];</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_index<sp/>=<sp/>low_index;</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>sum<sp/>+=<sp/>occupation[low_index];</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/>line_index<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;<sp/>line_index<sp/>&lt;<sp/>line_count;<sp/>line_index++)</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/>thresholds[line_index]<sp/>=<sp/>(sum<sp/>-<sp/>min_occ)<sp/>/<sp/>divisor<sp/>+<sp/>min_occ;</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//same<sp/>out<sp/>to<sp/>end</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1010"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"></highlight></codeline>
<codeline lineno="1012"><highlight class="normal"></highlight></codeline>
<codeline lineno="1018"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1ac0e0c477a9aaee3c2ff39b540a814d50" kindref="member">compute_dropout_distances</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//project<sp/>blobs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>*occupation,<sp/><sp/></highlight><highlight class="comment">//input<sp/>projection</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>*thresholds,<sp/><sp/></highlight><highlight class="comment">//output<sp/>thresholds</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>line_count<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//array<sp/>sizes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>line_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>thresholds<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>distance;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//from<sp/>prev<sp/>dropout</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>next_dist;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//to<sp/>next<sp/>dropout</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>back_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>back<sp/>filling</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>prev_threshold;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//before<sp/>overwrite</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1028"><highlight class="normal"></highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/>distance<sp/>=<sp/>-line_count;</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/>line_index<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>distance--;</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>prev_threshold<sp/>=<sp/>thresholds[line_index];</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//distance<sp/>from<sp/>prev</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>thresholds[line_index]<sp/>=<sp/>distance;</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>line_index++;</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(line_index<sp/>&lt;<sp/>line_count</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(occupation[line_index]<sp/>&lt;<sp/>thresholds[line_index]</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>occupation[line_index<sp/>-<sp/>1]<sp/>&gt;=<sp/>prev_threshold));</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(line_index<sp/>&lt;<sp/>line_count)<sp/>{</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>back_index<sp/>=<sp/>line_index<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>next_dist<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(next_dist<sp/>&lt;<sp/>-distance<sp/>&amp;&amp;<sp/>back_index<sp/>&gt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>thresholds[back_index]<sp/>=<sp/>next_dist;</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>back_index--;</highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next_dist++;</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>distance++;</highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>distance<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(line_index<sp/>&lt;<sp/>line_count);</highlight></codeline>
<codeline lineno="1055"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"></highlight></codeline>
<codeline lineno="1057"><highlight class="normal"></highlight></codeline>
<codeline lineno="1065"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1aa7a5766705cc30b622092e75022c5cbf" kindref="member">expand_rows</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>lines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref><sp/>page_tr,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//top<sp/>right</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/><sp/><sp/></highlight><highlight class="comment">//block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//gradient<sp/>to<sp/>fit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>rotation,<sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>drawing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>block_edge,<sp/><sp/></highlight><highlight class="comment">//edge<sp/>of<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>testing_on<sp/><sp/><sp/></highlight><highlight class="comment">//correct<sp/>orientation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>swallowed_row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//eaten<sp/>a<sp/>neighbour</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>y_max,<sp/>y_min;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//new<sp/>row<sp/>limits</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>y_bottom,<sp/>y_top;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//allowed<sp/>limits</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*test_row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//next<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//iterators</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it<sp/>=<sp/>&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a5dd67c54162a6b60b0fd11500d4a3025" kindref="member">blobs</ref>;</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>();</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"></highlight></codeline>
<codeline lineno="1082"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="1083"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_expanded_rows<sp/>&amp;&amp;<sp/>testing_on)<sp/>{</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref><sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1a5e0654ca01b55c243387c6535b32860b" kindref="member">create_to_win</ref>(page_tr);</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="1088"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1af6c80d96579d43cb4e29057c8f1e0f41" kindref="member">adjust_row_limits</ref>(block);<sp/><sp/></highlight><highlight class="comment">//shift<sp/>min,max.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_new_initial_xheight)<sp/>{</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>()-&gt;length<sp/>()<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1a268477cc476799d18c47302827f53bcc" kindref="member">compute_row_stats</ref>(block,<sp/>textord_show_expanded_rows<sp/>&amp;&amp;testing_on);</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1af9d632b1a85d2d92bbd0597b76ba026d" kindref="member">assign_blobs_to_rows</ref><sp/>(block,<sp/>&amp;gradient,<sp/>4,<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>);</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//get<sp/>real<sp/>membership</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>()-&gt;length<sp/>()<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1abd52b97627f2779855a74b0b9fcae6b2" kindref="member">fit_parallel_rows</ref>(block,</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradient,</highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rotation,</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_edge,</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>textord_show_expanded_rows<sp/>&amp;&amp;testing_on);</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!textord_new_initial_xheight)</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1a268477cc476799d18c47302827f53bcc" kindref="member">compute_row_stats</ref>(block,<sp/>textord_show_expanded_rows<sp/>&amp;&amp;testing_on);</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/>row_it.move_to_last<sp/>();</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/>row<sp/>=<sp/>row_it.data<sp/>();</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/>y_max<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>();<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//get<sp/>current<sp/>limits</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/>y_min<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>();</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/>y_bottom<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref><sp/>()<sp/>-<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>*<sp/>textord_expansion_factor<sp/>*</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_c_c_struct_1a7e8a361df0831d295edf1c150c3ca3a3" kindref="member">tesseract::CCStruct::kDescenderFraction</ref>;</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/>y_top<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref><sp/>()<sp/>+<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>*<sp/>textord_expansion_factor<sp/>*</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="classtesseract_1_1_c_c_struct_1a737fdb37b9401ad3d04371c1bd4a0b17" kindref="member">tesseract::CCStruct::kXHeightFraction</ref><sp/>+</highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_c_c_struct_1a9d71fddad74d9418e106713cd643b919" kindref="member">tesseract::CCStruct::kAscenderFraction</ref>);</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(y_min<sp/>&gt;<sp/>y_bottom)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//expansion<sp/>allowed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_expanded_rows<sp/>&amp;&amp;<sp/>testing_on)</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Expanding<sp/>bottom<sp/>of<sp/>row<sp/>at<sp/>%f<sp/>from<sp/>%f<sp/>to<sp/>%f\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref>(),<sp/>y_min,<sp/>y_bottom);</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//expandable</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>swallowed_row<sp/>=<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(swallowed_row<sp/>&amp;&amp;<sp/>!row_it.at_last<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>swallowed_row<sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//get<sp/>next<sp/>one</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>test_row<sp/>=<sp/>row_it.data_relative<sp/>(1);</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//overlaps<sp/>space</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(test_row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>()<sp/>&gt;<sp/>y_bottom)<sp/>{</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(test_row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>()<sp/>&gt;<sp/>y_bottom)<sp/>{</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_expanded_rows<sp/>&amp;&amp;<sp/>testing_on)</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Eating<sp/>row<sp/>below<sp/>at<sp/>%f\n&quot;</highlight><highlight class="normal">,<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref>());</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.forward<sp/>();</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="1133"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_expanded_rows<sp/>&amp;&amp;<sp/>testing_on)</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1afb1c1fd2d6af3a9851ab98454356c3cf" kindref="member">plot_parallel_row</ref>(test_row,</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradient,</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_edge,</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0eab2b208fc9a5e2774f92cf3e768982" kindref="member">ScrollView::WHITE</ref>,</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rotation);</highlight></codeline>
<codeline lineno="1139"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="1140"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.set_to_list<sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref><sp/>());</highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.add_list_after<sp/>(test_row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref><sp/>());</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//swallow<sp/>complete<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>row_it.extract<sp/>();</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.backward<sp/>();</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>swallowed_row<sp/>=<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(test_row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>()<sp/>&lt;<sp/>y_min)<sp/>{</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//shorter<sp/>limit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y_bottom<sp/>=<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>();</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_expanded_rows<sp/>&amp;&amp;<sp/>testing_on)</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Truncating<sp/>limit<sp/>to<sp/>%f<sp/>due<sp/>to<sp/>touching<sp/>row<sp/>at<sp/>%f\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y_bottom,<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref>());</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y_bottom<sp/>=<sp/>y_min;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//can&apos;t<sp/>expand<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_expanded_rows<sp/>&amp;&amp;<sp/>testing_on)</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Not<sp/>expanding<sp/>limit<sp/>beyond<sp/>%f<sp/>due<sp/>to<sp/>touching<sp/>row<sp/>at<sp/>%f\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y_bottom,<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref>());</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>y_min<sp/>=<sp/>y_bottom;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//expand<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(y_max<sp/>&lt;<sp/>y_top)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//expansion<sp/>allowed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_expanded_rows<sp/>&amp;&amp;<sp/>testing_on)</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Expanding<sp/>top<sp/>of<sp/>row<sp/>at<sp/>%f<sp/>from<sp/>%f<sp/>to<sp/>%f\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref>(),<sp/>y_max,<sp/>y_top);</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>swallowed_row<sp/>=<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(swallowed_row<sp/>&amp;&amp;<sp/>!row_it.at_first<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>swallowed_row<sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//get<sp/>one<sp/>above</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>test_row<sp/>=<sp/>row_it.data_relative<sp/>(-1);</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(test_row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>()<sp/>&lt;<sp/>y_top)<sp/>{</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(test_row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>()<sp/>&lt;<sp/>y_top)<sp/>{</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_expanded_rows<sp/>&amp;&amp;<sp/>testing_on)</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Eating<sp/>row<sp/>above<sp/>at<sp/>%f\n&quot;</highlight><highlight class="normal">,<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref>());</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.backward<sp/>();</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.set_to_list<sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref><sp/>());</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="1180"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_expanded_rows<sp/>&amp;&amp;<sp/>testing_on)</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1afb1c1fd2d6af3a9851ab98454356c3cf" kindref="member">plot_parallel_row</ref>(test_row,</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradient,</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_edge,</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0eab2b208fc9a5e2774f92cf3e768982" kindref="member">ScrollView::WHITE</ref>,</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rotation);</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="1187"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.add_list_after<sp/>(test_row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref><sp/>());</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//swallow<sp/>complete<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>row_it.extract<sp/>();</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.forward<sp/>();</highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>swallowed_row<sp/>=<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(test_row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>()<sp/>&lt;<sp/>y_max)<sp/>{</highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//shorter<sp/>limit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y_top<sp/>=<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>();</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_expanded_rows<sp/>&amp;&amp;<sp/>testing_on)</highlight></codeline>
<codeline lineno="1197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Truncating<sp/>limit<sp/>to<sp/>%f<sp/>due<sp/>to<sp/>touching<sp/>row<sp/>at<sp/>%f\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y_top,<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref>());</highlight></codeline>
<codeline lineno="1199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y_top<sp/>=<sp/>y_max;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//can&apos;t<sp/>expand<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_expanded_rows<sp/>&amp;&amp;<sp/>testing_on)</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Not<sp/>expanding<sp/>limit<sp/>beyond<sp/>%f<sp/>due<sp/>to<sp/>touching<sp/>row<sp/>at<sp/>%f\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y_top,<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref>());</highlight></codeline>
<codeline lineno="1205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>y_max<sp/>=<sp/>y_top;</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//new<sp/>limits</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a5a5bfd657e97c2fed2cf6153eca0e98a" kindref="member">set_limits</ref><sp/>(y_min,<sp/>y_max);</highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/>row_it.backward<sp/>();</highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!row_it.at_last<sp/>());</highlight></codeline>
<codeline lineno="1215"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1216"><highlight class="normal"></highlight></codeline>
<codeline lineno="1217"><highlight class="normal"></highlight></codeline>
<codeline lineno="1223"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1af6c80d96579d43cb4e29057c8f1e0f41" kindref="member">adjust_row_limits</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//tidy<sp/>limits</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block<sp/><sp/></highlight><highlight class="comment">//block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1226"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1227"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>size;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//size<sp/>of<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1228"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>ymax;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//top<sp/>of<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1229"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>ymin;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//bottom<sp/>of<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1230"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>();</highlight></codeline>
<codeline lineno="1231"><highlight class="normal"></highlight></codeline>
<codeline lineno="1232"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_expanded_rows)</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Adjusting<sp/>row<sp/>limits<sp/>for<sp/>block(%d,%d)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a16e698664028b0d6d2193db64560c16b" kindref="member">block</ref>-&gt;<ref refid="class_p_d_b_l_k_1a91950a96127b4a0bb9b237e1f5f889a4" kindref="member" tooltip="get box ">bounding_box</ref>().left(),</highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a16e698664028b0d6d2193db64560c16b" kindref="member">block</ref>-&gt;<ref refid="class_p_d_b_l_k_1a91950a96127b4a0bb9b237e1f5f889a4" kindref="member" tooltip="get box ">bounding_box</ref>().top());</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/>row<sp/>=<sp/>row_it.data<sp/>();</highlight></codeline>
<codeline lineno="1238"><highlight class="normal"><sp/><sp/><sp/><sp/>size<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>()<sp/>-<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>();</highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_show_expanded_rows)</highlight></codeline>
<codeline lineno="1240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Row<sp/>at<sp/>%f<sp/>has<sp/>min<sp/>%f,<sp/>max<sp/>%f,<sp/>size<sp/>%f\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref>(),<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref>(),<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref>(),<sp/>size);</highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/>size<sp/>/=<sp/><ref refid="classtesseract_1_1_c_c_struct_1a737fdb37b9401ad3d04371c1bd4a0b17" kindref="member">tesseract::CCStruct::kXHeightFraction</ref><sp/>+</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_c_c_struct_1a9d71fddad74d9418e106713cd643b919" kindref="member">tesseract::CCStruct::kAscenderFraction</ref><sp/>+</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_c_c_struct_1a7e8a361df0831d295edf1c150c3ca3a3" kindref="member">tesseract::CCStruct::kDescenderFraction</ref>;</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/>ymax<sp/>=<sp/>size<sp/>*<sp/>(<ref refid="classtesseract_1_1_c_c_struct_1a737fdb37b9401ad3d04371c1bd4a0b17" kindref="member">tesseract::CCStruct::kXHeightFraction</ref><sp/>+</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_c_c_struct_1a9d71fddad74d9418e106713cd643b919" kindref="member">tesseract::CCStruct::kAscenderFraction</ref>);</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/>ymin<sp/>=<sp/>-size<sp/>*<sp/><ref refid="classtesseract_1_1_c_c_struct_1a7e8a361df0831d295edf1c150c3ca3a3" kindref="member">tesseract::CCStruct::kDescenderFraction</ref>;</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a5a5bfd657e97c2fed2cf6153eca0e98a" kindref="member">set_limits</ref><sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref><sp/>()<sp/>+<sp/>ymin,<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref><sp/>()<sp/>+<sp/>ymax);</highlight></codeline>
<codeline lineno="1249"><highlight class="normal"><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a07c3198cd3d6f647c6ab9ab1f0849c27" kindref="member">merged</ref><sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1251"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"></highlight></codeline>
<codeline lineno="1253"><highlight class="normal"></highlight></codeline>
<codeline lineno="1259"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a268477cc476799d18c47302827f53bcc" kindref="member">compute_row_stats</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>lines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/><sp/></highlight><highlight class="comment">//block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>testing_on<sp/><sp/></highlight><highlight class="comment">//correct<sp/>orientation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>row_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>median</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1264"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1265"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*prev_row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//previous<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>iqr;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//inter<sp/>quartile<sp/>range</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1267"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>();</highlight></codeline>
<codeline lineno="1268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//number<sp/>of<sp/>rows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1269"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>rowcount<sp/>=<sp/>row_it.length<sp/>();</highlight></codeline>
<codeline lineno="1270"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>**rows;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>choose<sp/>nth</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1271"><highlight class="normal"></highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/>rows<sp/>=<sp/>(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>**)<sp/><ref refid="memry_8cpp_1a4c14b091498fb7866a1dd0af51a591fe" kindref="member">alloc_mem</ref><sp/>(rowcount<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*));</highlight></codeline>
<codeline lineno="1273"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rows<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="1274"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="stderr_8h_1a669968baa4639e34aef50907918653df" kindref="member">MEMORY_OUT</ref>.<ref refid="class_e_r_r_c_o_d_e_1abc4cc64aad0ddb74c02523b69c95a1c1" kindref="member">error</ref><sp/>(</highlight><highlight class="stringliteral">&quot;compute_row_stats&quot;</highlight><highlight class="normal">,<sp/><ref refid="errcode_8h_1a8a3a2e51383909b357fcdf8eda803637a781ad2788df9e25c59a70894c7832096" kindref="member">ABORT</ref>,<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>);</highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/>rowcount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/>prev_row<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="1277"><highlight class="normal"><sp/><sp/>row_it.move_to_last<sp/>();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//start<sp/>at<sp/>bottom</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/><sp/><sp/>row<sp/>=<sp/>row_it.data<sp/>();</highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(prev_row<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rows[rowcount++]<sp/>=<sp/>prev_row;</highlight></codeline>
<codeline lineno="1282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>prev_row-&gt;<ref refid="class_t_o___r_o_w_1a54a1cf2bfa1478d255a8b79f51ca8e59" kindref="member">spacing</ref><sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref><sp/>()<sp/>-<sp/>prev_row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref><sp/>();</highlight></codeline>
<codeline lineno="1283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)</highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;Row<sp/>at<sp/>%g<sp/>yields<sp/>spacing<sp/>of<sp/>%g\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref><sp/>(),<sp/>prev_row-&gt;<ref refid="class_t_o___r_o_w_1a54a1cf2bfa1478d255a8b79f51ca8e59" kindref="member">spacing</ref>);</highlight></codeline>
<codeline lineno="1286"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/>prev_row<sp/>=<sp/>row;</highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/>row_it.backward<sp/>();</highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!row_it.at_last<sp/>());</highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a6a76a4282791ee8f215c0e8b8dd7db16" kindref="member">key_row</ref><sp/>=<sp/>prev_row;</highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1abb8334b4a0c2b2625516a1c4b54cbf1f" kindref="member">baseline_offset</ref><sp/>=</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"><sp/><sp/><sp/><sp/>fmod<sp/>(prev_row-&gt;<ref refid="class_t_o___r_o_w_1a81a46c8d6026c157c152778aa9d1ab58" kindref="member">parallel_c</ref><sp/>(),<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref>);</highlight></codeline>
<codeline lineno="1294"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)</highlight></codeline>
<codeline lineno="1295"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;Blob<sp/>based<sp/>spacing=(%g,%g),<sp/>offset=%g&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>,<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref>,<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1abb8334b4a0c2b2625516a1c4b54cbf1f" kindref="member">baseline_offset</ref>);</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rowcount<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/>row_index<sp/>=<sp/><ref refid="statistc_8cpp_1ab531cf8bc727a6e03af3a6cc10b4cd7a" kindref="member">choose_nth_item</ref><sp/>(rowcount<sp/>*<sp/>3<sp/>/<sp/>4,<sp/>rows,<sp/>rowcount,</highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*),<sp/><ref refid="makerow_8cpp_1aa3013c07bcccb3f1efeb4686ed340609" kindref="member">row_spacing_order</ref>);</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/>iqr<sp/>=<sp/>rows[row_index]-&gt;<ref refid="class_t_o___r_o_w_1a54a1cf2bfa1478d255a8b79f51ca8e59" kindref="member">spacing</ref>;</highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/>row_index<sp/>=<sp/><ref refid="statistc_8cpp_1ab531cf8bc727a6e03af3a6cc10b4cd7a" kindref="member">choose_nth_item</ref><sp/>(rowcount<sp/>/<sp/>4,<sp/>rows,<sp/>rowcount,</highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*),<sp/><ref refid="makerow_8cpp_1aa3013c07bcccb3f1efeb4686ed340609" kindref="member">row_spacing_order</ref>);</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/>iqr<sp/>-=<sp/>rows[row_index]-&gt;<ref refid="class_t_o___r_o_w_1a54a1cf2bfa1478d255a8b79f51ca8e59" kindref="member">spacing</ref>;</highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/>row_index<sp/>=<sp/><ref refid="statistc_8cpp_1ab531cf8bc727a6e03af3a6cc10b4cd7a" kindref="member">choose_nth_item</ref><sp/>(rowcount<sp/>/<sp/>2,<sp/>rows,<sp/>rowcount,</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*),<sp/><ref refid="makerow_8cpp_1aa3013c07bcccb3f1efeb4686ed340609" kindref="member">row_spacing_order</ref>);</highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a6a76a4282791ee8f215c0e8b8dd7db16" kindref="member">key_row</ref><sp/>=<sp/>rows[row_index];</highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)</highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;<sp/>row<sp/>based=%g(%g)&quot;</highlight><highlight class="normal">,<sp/>rows[row_index]-&gt;spacing,<sp/>iqr);</highlight></codeline>
<codeline lineno="1309"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rowcount<sp/>&gt;<sp/>2</highlight></codeline>
<codeline lineno="1310"><highlight class="normal"><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>iqr<sp/>&lt;<sp/>rows[row_index]-&gt;spacing<sp/>*<sp/>textord_linespace_iqrlimit)<sp/>{</highlight></codeline>
<codeline lineno="1311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!textord_new_initial_xheight)<sp/>{</highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rows[row_index]-&gt;spacing<sp/>&lt;<sp/>block-&gt;line_spacing</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>rows[row_index]-&gt;spacing<sp/>&gt;<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>)</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//within<sp/>range</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>=<sp/>rows[row_index]-&gt;<ref refid="class_t_o___r_o_w_1a54a1cf2bfa1478d255a8b79f51ca8e59" kindref="member">spacing</ref>;</highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//spacing=size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rows[row_index]-&gt;spacing<sp/>&gt;<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref>)</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref>;</highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//too<sp/>big<sp/>so<sp/>use<sp/>max</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rows[row_index]-&gt;spacing<sp/>&lt;<sp/>block-&gt;line_spacing)</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>=<sp/>rows[row_index]-&gt;<ref refid="class_t_o___r_o_w_1a54a1cf2bfa1478d255a8b79f51ca8e59" kindref="member">spacing</ref>;</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref>;</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//too<sp/>big<sp/>so<sp/>use<sp/>max</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>&lt;<sp/>textord_min_xheight)</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>=<sp/>(float)<sp/>textord_min_xheight;</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref><sp/>=<sp/>rows[row_index]-&gt;<ref refid="class_t_o___r_o_w_1a54a1cf2bfa1478d255a8b79f51ca8e59" kindref="member">spacing</ref>;</highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1abda136ff240577928343ca37453aca7a" kindref="member">max_blob_size</ref><sp/>=</highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref><sp/>*<sp/>textord_excess_blobsize;</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1abb8334b4a0c2b2625516a1c4b54cbf1f" kindref="member">baseline_offset</ref><sp/>=<sp/>fmod<sp/>(rows[row_index]-&gt;intercept<sp/>(),</highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref>);</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1337"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)</highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;\nEstimate<sp/>line<sp/>size=%g,<sp/>spacing=%g,<sp/>offset=%g\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>,<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref>,<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1abb8334b4a0c2b2625516a1c4b54cbf1f" kindref="member">baseline_offset</ref>);</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><ref refid="memry_8cpp_1a9ef1862b8e026e23eef238af032858e4" kindref="member">free_mem</ref>(rows);</highlight></codeline>
<codeline lineno="1341"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1342"><highlight class="normal"></highlight></codeline>
<codeline lineno="1343"><highlight class="normal"></highlight></codeline>
<codeline lineno="1373"><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespacetesseract-c__api-demo_1afed58feacb84df2de88bdd613cfdba6d" kindref="member">tesseract</ref><sp/>{</highlight></codeline>
<codeline lineno="1374"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>Textord::compute_block_xheight(<ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient)<sp/>{</highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>current<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>asc_frac_xheight<sp/>=<sp/><ref refid="classtesseract_1_1_c_c_struct_1a9d71fddad74d9418e106713cd643b919" kindref="member">CCStruct::kAscenderFraction</ref><sp/>/</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_c_c_struct_1a737fdb37b9401ad3d04371c1bd4a0b17" kindref="member">CCStruct::kXHeightFraction</ref>;</highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>desc_frac_xheight<sp/>=<sp/><ref refid="classtesseract_1_1_c_c_struct_1a7e8a361df0831d295edf1c150c3ca3a3" kindref="member">CCStruct::kDescenderFraction</ref><sp/>/</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_c_c_struct_1a737fdb37b9401ad3d04371c1bd4a0b17" kindref="member">CCStruct::kXHeightFraction</ref>;</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>min_height,<sp/>max_height;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>limits<sp/>on<sp/>xheight</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref>();</highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_it.empty())<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>no<sp/>rows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1383"><highlight class="normal"></highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Compute<sp/>the<sp/>best<sp/>guess<sp/>of<sp/>xheight<sp/>of<sp/>each<sp/>row<sp/>individually.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Use<sp/>xheight<sp/>and<sp/>ascrise<sp/>values<sp/>of<sp/>the<sp/>rows<sp/>where<sp/>ascenders<sp/>were<sp/>found.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/><ref refid="makerow_8h_1a8bdee2b19f529b62545b2e7b2c6beb2f" kindref="member">get_min_max_xheight</ref>(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>,<sp/>&amp;min_height,<sp/>&amp;max_height);</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>row_asc_xheights(min_height,<sp/>max_height<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>row_asc_ascrise(static_cast&lt;int&gt;(min_height<sp/>*<sp/>asc_frac_xheight),</highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>static_cast&lt;int&gt;(max_height<sp/>*<sp/>asc_frac_xheight)<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>min_desc_height<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">int</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(min_height<sp/>*<sp/>desc_frac_xheight);</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>max_desc_height<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">int</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(max_height<sp/>*<sp/>desc_frac_xheight);</highlight></codeline>
<codeline lineno="1392"><highlight class="normal"><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>row_asc_descdrop(min_desc_height,<sp/>max_desc_height<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="1393"><highlight class="normal"><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>row_desc_xheights(min_height,<sp/>max_height<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>row_desc_descdrop(min_desc_height,<sp/>max_desc_height<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>row_cap_xheights(min_height,<sp/>max_height<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>row_cap_floating_xheights(min_height,<sp/>max_height<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt();<sp/>!row_it.cycled_list();<sp/>row_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/>row<sp/>=<sp/>row_it.data();</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Compute<sp/>the<sp/>xheight<sp/>of<sp/>this<sp/>row<sp/>if<sp/>it<sp/>has<sp/>not<sp/>been<sp/>computed<sp/>before.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>&lt;=<sp/>0.0)<sp/>{</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>compute_row_xheight(row,<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a16e698664028b0d6d2193db64560c16b" kindref="member">block</ref>-&gt;<ref refid="class_b_l_o_c_k_1a34b02293bd58bf10ce6e62fd7d3953ef" kindref="member">classify_rotation</ref>(),</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gradient,<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>);</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8h_1afce0c34ba177573f61217f64c0a04d68" kindref="member">ROW_CATEGORY</ref><sp/>row_category<sp/>=<sp/><ref refid="makerow_8h_1af91de8a5d97ef84af1d5ef5cadd89bdd" kindref="member">get_row_category</ref>(row);</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_category<sp/>==<sp/><ref refid="makerow_8h_1afce0c34ba177573f61217f64c0a04d68aba1649106cf3c6301a0cd938b01af28e" kindref="member">ROW_ASCENDERS_FOUND</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_asc_xheights.add(static_cast&lt;inT32&gt;(row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref>),</highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a6aef46f37d01ec2bdc7ea6edd724ef50" kindref="member">xheight_evidence</ref>);</highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_asc_ascrise.add(static_cast&lt;inT32&gt;(row-&gt;<ref refid="class_t_o___r_o_w_1acf8bf7f0f335788e106955b8142f832a" kindref="member">ascrise</ref>),</highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a6aef46f37d01ec2bdc7ea6edd724ef50" kindref="member">xheight_evidence</ref>);</highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_asc_descdrop.add(static_cast&lt;inT32&gt;(-row-&gt;<ref refid="class_t_o___r_o_w_1acc50308b9a0cd5c73184de33971c55a8" kindref="member">descdrop</ref>),</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a6aef46f37d01ec2bdc7ea6edd724ef50" kindref="member">xheight_evidence</ref>);</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_category<sp/>==<sp/><ref refid="makerow_8h_1afce0c34ba177573f61217f64c0a04d68a25bbfc450f12f60f7a5882e37973a4b6" kindref="member">ROW_DESCENDERS_FOUND</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_desc_xheights.add(static_cast&lt;inT32&gt;(row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref>),</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a6aef46f37d01ec2bdc7ea6edd724ef50" kindref="member">xheight_evidence</ref>);</highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_desc_descdrop.add(static_cast&lt;inT32&gt;(-row-&gt;<ref refid="class_t_o___r_o_w_1acc50308b9a0cd5c73184de33971c55a8" kindref="member">descdrop</ref>),</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a6aef46f37d01ec2bdc7ea6edd724ef50" kindref="member">xheight_evidence</ref>);</highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_category<sp/>==<sp/><ref refid="makerow_8h_1afce0c34ba177573f61217f64c0a04d68ab5102ae2a7fc9f423729da68d441fa7b" kindref="member">ROW_UNKNOWN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1a0bb04d9973fd564b4ada5c96c24adb09" kindref="member">fill_heights</ref>(row,<sp/>gradient,<sp/>min_height,<sp/>max_height,</highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;row_cap_xheights,<sp/>&amp;row_cap_floating_xheights);</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"></highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>xheight<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>ascrise<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>descdrop<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Compute<sp/>our<sp/>best<sp/>guess<sp/>of<sp/>xheight<sp/>of<sp/>this<sp/>block.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_asc_xheights.get_total()<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Determine<sp/>xheight<sp/>from<sp/>rows<sp/>where<sp/>ascenders<sp/>were<sp/>found.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/>xheight<sp/>=<sp/>row_asc_xheights.median();</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/><sp/><sp/>ascrise<sp/>=<sp/>row_asc_ascrise.median();</highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/><sp/><sp/>descdrop<sp/>=<sp/>-row_asc_descdrop.median();</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_desc_xheights.get_total()<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Determine<sp/>xheight<sp/>from<sp/>rows<sp/>where<sp/>descenders<sp/>were<sp/>found.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/>xheight<sp/>=<sp/>row_desc_xheights.median();</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/>descdrop<sp/>=<sp/>-row_desc_descdrop.median();</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_cap_xheights.get_total()<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>All<sp/>the<sp/>rows<sp/>in<sp/>the<sp/>block<sp/>were<sp/>(a/de)scenderless.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Try<sp/>to<sp/>search<sp/>for<sp/>two<sp/>modes<sp/>in<sp/>row_cap_heights<sp/>that<sp/>could</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>be<sp/>the<sp/>xheight<sp/>and<sp/>the<sp/>capheight<sp/>(e.g.<sp/>some<sp/>of<sp/>the<sp/>rows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1440"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>were<sp/>lowercase,<sp/>but<sp/>did<sp/>not<sp/>have<sp/>enough<sp/>(a/de)scenders.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>such<sp/>two<sp/>modes<sp/>can<sp/>not<sp/>be<sp/>found,<sp/>this<sp/>block<sp/>is<sp/>most</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>likely<sp/>all<sp/>caps<sp/>(or<sp/>all<sp/>small<sp/>caps,<sp/>in<sp/>which<sp/>case<sp/>the<sp/>code</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>still<sp/>works<sp/>as<sp/>intended).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1a4c2a6be7aee93caa4d9f9ca9f919b2a1" kindref="member">compute_xheight_from_modes</ref>(&amp;row_cap_xheights,<sp/>&amp;row_cap_floating_xheights,</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>textord_single_height_mode<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a16e698664028b0d6d2193db64560c16b" kindref="member">block</ref>-&gt;<ref refid="class_b_l_o_c_k_1a34b02293bd58bf10ce6e62fd7d3953ef" kindref="member">classify_rotation</ref>().<ref refid="class_f_c_o_o_r_d_1a397f7ce997b246df18e7bd5a20cc422e" kindref="member">y</ref>()<sp/>==<sp/>0.0,</highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_height,<sp/>max_height,<sp/>&amp;(xheight),<sp/>&amp;(ascrise));</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ascrise<sp/>==<sp/>0)<sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>assume<sp/>only<sp/>caps<sp/>in<sp/>the<sp/>whole<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xheight<sp/>=<sp/>row_cap_xheights.median()<sp/>*<sp/><ref refid="classtesseract_1_1_c_c_struct_1a594719f667105487f0c3f78de6f85f77" kindref="member">CCStruct::kXHeightCapRatio</ref>;</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>default<sp/>block<sp/>sizes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/>xheight<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>*<sp/><ref refid="classtesseract_1_1_c_c_struct_1a737fdb37b9401ad3d04371c1bd4a0b17" kindref="member">CCStruct::kXHeightFraction</ref>;</highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Correct<sp/>xheight,<sp/>ascrise<sp/>and<sp/>descdrop<sp/>if<sp/>necessary.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>corrected_xheight<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(xheight<sp/>&lt;<sp/>textord_min_xheight)<sp/>{</highlight></codeline>
<codeline lineno="1457"><highlight class="normal"><sp/><sp/><sp/><sp/>xheight<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">float</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(textord_min_xheight);</highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><sp/><sp/><sp/><sp/>corrected_xheight<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(corrected_xheight<sp/>||<sp/>ascrise<sp/>&lt;=<sp/>0.0)<sp/>{</highlight></codeline>
<codeline lineno="1461"><highlight class="normal"><sp/><sp/><sp/><sp/>ascrise<sp/>=<sp/>xheight<sp/>*<sp/>asc_frac_xheight;</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(corrected_xheight<sp/>||<sp/>descdrop<sp/>&gt;=<sp/>0.0)<sp/>{</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/>descdrop<sp/>=<sp/>-(xheight<sp/>*<sp/>desc_frac_xheight);</highlight></codeline>
<codeline lineno="1465"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1466"><highlight class="normal"><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4d0f99a557a4950af5123a31a157749f" kindref="member">xheight</ref><sp/>=<sp/>xheight;</highlight></codeline>
<codeline lineno="1467"><highlight class="normal"></highlight></codeline>
<codeline lineno="1468"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)<sp/>{</highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Block<sp/>average<sp/>xheight=%.4f,<sp/>ascrise=%.4f,<sp/>descdrop=%.4f\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xheight,<sp/>ascrise,<sp/>descdrop);</highlight></codeline>
<codeline lineno="1471"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1472"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Correct<sp/>xheight,<sp/>ascrise,<sp/>descdrop<sp/>of<sp/>rows<sp/>based<sp/>on<sp/>block<sp/>averages.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1473"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt();<sp/>!row_it.cycled_list();<sp/>row_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="1474"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1a816de2bcfeae782b4ba8506075925284" kindref="member">correct_row_xheight</ref>(row_it.data(),<sp/>xheight,<sp/>ascrise,<sp/>descdrop);</highlight></codeline>
<codeline lineno="1475"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1476"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1477"><highlight class="normal"></highlight></codeline>
<codeline lineno="1486"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>Textord::compute_row_xheight(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>row<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref>&amp;<sp/>rotation,</highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient,<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>global<sp/>skew</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>block_line_size)<sp/>{</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Find<sp/>blobs<sp/>representing<sp/>repeated<sp/>characters<sp/>in<sp/>rows<sp/>and<sp/>mark<sp/>them.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>This<sp/>information<sp/>is<sp/>used<sp/>for<sp/>computing<sp/>row<sp/>xheight<sp/>and<sp/>at<sp/>a<sp/>later</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>stage<sp/>when<sp/>words<sp/>are<sp/>formed<sp/>by<sp/>make_words.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!row-&gt;<ref refid="class_t_o___r_o_w_1a35f5d23b0e66150cf3044a7cb3b87b21" kindref="member">rep_chars_marked</ref>())<sp/>{</highlight></codeline>
<codeline lineno="1494"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1a20d1c5d4b6ae64bf80b24a155aa7c189" kindref="member">mark_repeated_chars</ref>(row);</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1496"><highlight class="normal"></highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>min_height,<sp/>max_height;</highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/><ref refid="makerow_8h_1a8bdee2b19f529b62545b2e7b2c6beb2f" kindref="member">get_min_max_xheight</ref>(block_line_size,<sp/>&amp;min_height,<sp/>&amp;max_height);</highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>heights(min_height,<sp/>max_height<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>floating_heights(min_height,<sp/>max_height<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><ref refid="makerow_8cpp_1a0bb04d9973fd564b4ada5c96c24adb09" kindref="member">fill_heights</ref>(row,<sp/>gradient,<sp/>min_height,<sp/>max_height,</highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;heights,<sp/>&amp;floating_heights);</highlight></codeline>
<codeline lineno="1503"><highlight class="normal"><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acf8bf7f0f335788e106955b8142f832a" kindref="member">ascrise</ref><sp/>=<sp/>0.0f;</highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>=<sp/>0.0f;</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a6aef46f37d01ec2bdc7ea6edd724ef50" kindref="member">xheight_evidence</ref><sp/>=</highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1a4c2a6be7aee93caa4d9f9ca9f919b2a1" kindref="member">compute_xheight_from_modes</ref>(&amp;heights,<sp/>&amp;floating_heights,</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>textord_single_height_mode<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rotation.<ref refid="class_f_c_o_o_r_d_1a397f7ce997b246df18e7bd5a20cc422e" kindref="member">y</ref>()<sp/>==<sp/>0.0,</highlight></codeline>
<codeline lineno="1509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_height,<sp/>max_height,</highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;(row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref>),<sp/>&amp;(row-&gt;<ref refid="class_t_o___r_o_w_1acf8bf7f0f335788e106955b8142f832a" kindref="member">ascrise</ref>));</highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acc50308b9a0cd5c73184de33971c55a8" kindref="member">descdrop</ref><sp/>=<sp/>0.0f;</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>&gt;<sp/>0.0)<sp/>{</highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acc50308b9a0cd5c73184de33971c55a8" kindref="member">descdrop</ref><sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">float</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(</highlight></codeline>
<codeline lineno="1514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1ad04f46fc69514ad2086061ef889b5e23" kindref="member">compute_row_descdrop</ref>(row,<sp/>gradient,<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a6aef46f37d01ec2bdc7ea6edd724ef50" kindref="member">xheight_evidence</ref>,<sp/>&amp;heights));</highlight></codeline>
<codeline lineno="1515"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1516"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1517"><highlight class="normal"></highlight></codeline>
<codeline lineno="1518"><highlight class="normal">}<sp/><sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>tesseract.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1519"><highlight class="normal"></highlight></codeline>
<codeline lineno="1526"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a0bb04d9973fd564b4ada5c96c24adb09" kindref="member">fill_heights</ref>(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>min_height,</highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>max_height,<sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>*heights,<sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>*floating_heights)<sp/>{</highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>xcentre;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>centre<sp/>of<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1529"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>top;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>top<sp/>y<sp/>coord<sp/>of<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>height;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>height<sp/>of<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1531"><highlight class="normal"><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>*blob;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>current<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1532"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>repeated_set;</highlight></codeline>
<codeline lineno="1533"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref>();</highlight></codeline>
<codeline lineno="1534"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blob_it.empty())<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;<sp/><sp/></highlight><highlight class="comment">//<sp/>no<sp/>blobs<sp/>in<sp/>this<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1535"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>has_rep_chars<sp/>=</highlight></codeline>
<codeline lineno="1536"><highlight class="normal"><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a35f5d23b0e66150cf3044a7cb3b87b21" kindref="member">rep_chars_marked</ref>()<sp/>&amp;&amp;<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1adf3a6f3c6a3a9dfe5a01182375a7adbb" kindref="member">num_repeated_sets</ref>()<sp/>&gt;<sp/>0;</highlight></codeline>
<codeline lineno="1537"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1538"><highlight class="normal"><sp/><sp/><sp/><sp/>blob<sp/>=<sp/>blob_it.data();</highlight></codeline>
<codeline lineno="1539"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1af37f373c72851534101f4caf296a3cf7" kindref="member">joined_to_prev</ref>())<sp/>{</highlight></codeline>
<codeline lineno="1540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xcentre<sp/>=<sp/>(blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>+</highlight></codeline>
<codeline lineno="1541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>())<sp/>/<sp/>2.0<ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>;</highlight></codeline>
<codeline lineno="1542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>top<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref>();</highlight></codeline>
<codeline lineno="1543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>height<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a8379d4bbc72bdbb1f069fc14790e632d" kindref="member">height</ref>();</highlight></codeline>
<codeline lineno="1544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_fix_xheight_bug)</highlight></codeline>
<codeline lineno="1545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>top<sp/>-=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a611050c4612df0ccd0f2d64ca0005b9b" kindref="member">baseline</ref>.<ref refid="class_q_s_p_l_i_n_e_1ab9f77ca80057e3844e880a1bf003beca" kindref="member">y</ref>(xcentre);</highlight></codeline>
<codeline lineno="1546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>top<sp/>-=<sp/>gradient<sp/>*<sp/>xcentre<sp/>+<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a81a46c8d6026c157c152778aa9d1ab58" kindref="member">parallel_c</ref>();</highlight></codeline>
<codeline lineno="1548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(top<sp/>&gt;=<sp/>min_height<sp/>&amp;&amp;<sp/>top<sp/>&lt;=<sp/>max_height)<sp/>{</highlight></codeline>
<codeline lineno="1549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>heights-&gt;<ref refid="class_s_t_a_t_s_1ab8cacba14df28eed1bffc4cea0b2f87f" kindref="member">add</ref>(static_cast&lt;inT32&gt;(floor(top<sp/>+<sp/>0.5)),<sp/>1);</highlight></codeline>
<codeline lineno="1550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(height<sp/>/<sp/>top<sp/>&lt;<sp/>textord_min_blob_height_fraction)<sp/>{</highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>floating_heights-&gt;<ref refid="class_s_t_a_t_s_1ab8cacba14df28eed1bffc4cea0b2f87f" kindref="member">add</ref>(static_cast&lt;inT32&gt;(floor(top<sp/>+<sp/>0.5)),<sp/>1);</highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1555"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Skip<sp/>repeated<sp/>chars,<sp/>since<sp/>they<sp/>are<sp/>likely<sp/>to<sp/>skew<sp/>the<sp/>height<sp/>stats.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1556"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(has_rep_chars<sp/>&amp;&amp;<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a6c315527653e756b1f82f5522929da08" kindref="member">repeated_set</ref>()<sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>repeated_set<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a6c315527653e756b1f82f5522929da08" kindref="member">repeated_set</ref>();</highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.forward();</highlight></codeline>
<codeline lineno="1559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!blob_it.at_first()<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.data()-&gt;repeated_set()<sp/>==<sp/>repeated_set)<sp/>{</highlight></codeline>
<codeline lineno="1561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.forward();</highlight></codeline>
<codeline lineno="1562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)</highlight></codeline>
<codeline lineno="1563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Skipping<sp/>repeated<sp/>char<sp/>when<sp/>computing<sp/>xheight\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1565"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.forward();</highlight></codeline>
<codeline lineno="1567"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1568"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!blob_it.at_first());</highlight></codeline>
<codeline lineno="1569"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1570"><highlight class="normal"></highlight></codeline>
<codeline lineno="1587"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a4c2a6be7aee93caa4d9f9ca9f919b2a1" kindref="member">compute_xheight_from_modes</ref>(</highlight></codeline>
<codeline lineno="1588"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>*heights,<sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>*floating_heights,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>cap_only,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>min_height,</highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>max_height,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*xheight,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*ascrise)<sp/>{</highlight></codeline>
<codeline lineno="1590"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blob_index<sp/>=<sp/>heights-&gt;<ref refid="class_s_t_a_t_s_1a5d353e951f61daf06c6582dfc106ff11" kindref="member">mode</ref>();<sp/><sp/></highlight><highlight class="comment">//<sp/>find<sp/>mode</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1591"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blob_count<sp/>=<sp/>heights-&gt;<ref refid="class_s_t_a_t_s_1a4a3a320660e2092eeaa605df70bea8ea" kindref="member">pile_count</ref>(blob_index);<sp/><sp/></highlight><highlight class="comment">//<sp/>get<sp/>count<sp/>of<sp/>mode</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1592"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)<sp/>{</highlight></codeline>
<codeline lineno="1593"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;min_height=%d,<sp/>max_height=%d,<sp/>mode=%d,<sp/>count=%d,<sp/>total=%d\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_height,<sp/>max_height,<sp/>blob_index,<sp/>blob_count,</highlight></codeline>
<codeline lineno="1595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>heights-&gt;<ref refid="class_s_t_a_t_s_1a83ad18e6ba02e9f63f4f7d84fcf76aa4" kindref="member">get_total</ref>());</highlight></codeline>
<codeline lineno="1596"><highlight class="normal"><sp/><sp/><sp/><sp/>heights-&gt;<ref refid="class_s_t_a_t_s_1a78e51420aa91ecff1f635e606d4a0f88" kindref="member">print</ref>();</highlight></codeline>
<codeline lineno="1597"><highlight class="normal"><sp/><sp/><sp/><sp/>floating_heights-&gt;<ref refid="class_s_t_a_t_s_1a78e51420aa91ecff1f635e606d4a0f88" kindref="member">print</ref>();</highlight></codeline>
<codeline lineno="1598"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1599"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blob_count<sp/>==<sp/>0)<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1600"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>modes[<ref refid="makerow_8cpp_1af64730edc37ce30d66430f2dd54a2089" kindref="member">MAX_HEIGHT_MODES</ref>];<sp/><sp/></highlight><highlight class="comment">//<sp/>biggest<sp/>piles</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1601"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>in_best_pile<sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="1602"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>prev_size<sp/>=<sp/>-<ref refid="host_8h_1aac62d87844689a18b6f5339a89ed6e7f" kindref="member">MAX_INT32</ref>;</highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>best_count<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mode_count<sp/>=<sp/><ref refid="makerow_8cpp_1a796af03d9d0fe26e0563a5714cb83741" kindref="member">compute_height_modes</ref>(heights,<sp/>min_height,<sp/>max_height,</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modes,<sp/><ref refid="makerow_8cpp_1af64730edc37ce30d66430f2dd54a2089" kindref="member">MAX_HEIGHT_MODES</ref>);</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cap_only<sp/>&amp;&amp;<sp/>mode_count<sp/>&gt;<sp/>1)</highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/><sp/><sp/>mode_count<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1608"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>x;</highlight></codeline>
<codeline lineno="1609"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)<sp/>{</highlight></codeline>
<codeline lineno="1610"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;found<sp/>%d<sp/>modes:<sp/>&quot;</highlight><highlight class="normal">,<sp/>mode_count);</highlight></codeline>
<codeline lineno="1611"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>0;<sp/>x<sp/>&lt;<sp/>mode_count;<sp/>x++)<sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;%d<sp/>&quot;</highlight><highlight class="normal">,<sp/>modes[x]);</highlight></codeline>
<codeline lineno="1612"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1613"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1614"><highlight class="normal"></highlight></codeline>
<codeline lineno="1615"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>0;<sp/>x<sp/>&lt;<sp/>mode_count<sp/>-<sp/>1;<sp/>x++)<sp/>{</highlight></codeline>
<codeline lineno="1616"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(modes[x]<sp/>!=<sp/>prev_size<sp/>+<sp/>1)</highlight></codeline>
<codeline lineno="1617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>in_best_pile<sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>had<sp/>empty<sp/>height</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1618"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>modes_x_count<sp/>=<sp/>heights-&gt;<ref refid="class_s_t_a_t_s_1a4a3a320660e2092eeaa605df70bea8ea" kindref="member">pile_count</ref>(modes[x])<sp/>-</highlight></codeline>
<codeline lineno="1619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>floating_heights-&gt;<ref refid="class_s_t_a_t_s_1a4a3a320660e2092eeaa605df70bea8ea" kindref="member">pile_count</ref>(modes[x]);</highlight></codeline>
<codeline lineno="1620"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((modes_x_count<sp/>&gt;=<sp/>blob_count<sp/>*<sp/>textord_xheight_mode_fraction)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(in_best_pile<sp/>||<sp/>modes_x_count<sp/>&gt;<sp/>best_count))<sp/>{</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>asc<sp/>=<sp/>x<sp/>+<sp/>1;<sp/>asc<sp/>&lt;<sp/>mode_count;<sp/>asc++)<sp/>{</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>ratio<sp/>=</highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">float</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(modes[asc])<sp/>/<sp/>static_cast&lt;float&gt;(modes[x]);</highlight></codeline>
<codeline lineno="1625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_ascx_ratio_min<sp/>&lt;<sp/>ratio<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ratio<sp/>&lt;<sp/>textord_ascx_ratio_max<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(heights-&gt;<ref refid="class_s_t_a_t_s_1a4a3a320660e2092eeaa605df70bea8ea" kindref="member">pile_count</ref>(modes[asc])<sp/>&gt;=</highlight></codeline>
<codeline lineno="1628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_count<sp/>*<sp/>textord_ascheight_mode_fraction))<sp/>{</highlight></codeline>
<codeline lineno="1629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(modes_x_count<sp/>&gt;<sp/>best_count)<sp/>{</highlight></codeline>
<codeline lineno="1630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>in_best_pile<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>best_count<sp/>=<sp/>modes_x_count;</highlight></codeline>
<codeline lineno="1632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)<sp/>{</highlight></codeline>
<codeline lineno="1634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;X=%d,<sp/>asc=%d,<sp/>count=%d,<sp/>ratio=%g\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modes[x],<sp/>modes[asc]-modes[x],<sp/>modes_x_count,<sp/>ratio);</highlight></codeline>
<codeline lineno="1636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prev_size<sp/>=<sp/>modes[x];</highlight></codeline>
<codeline lineno="1638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*xheight<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">float</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(modes[x]);</highlight></codeline>
<codeline lineno="1639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*ascrise<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">float</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(modes[asc]<sp/>-<sp/>modes[x]);</highlight></codeline>
<codeline lineno="1640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1642"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1643"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1644"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(*xheight<sp/>==<sp/>0)<sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>single<sp/>mode</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1645"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Remove<sp/>counts<sp/>of<sp/>the<sp/>&quot;floating&quot;<sp/>blobs<sp/>(the<sp/>one<sp/>whose<sp/>height<sp/>is<sp/>too</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1646"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>small<sp/>in<sp/>relation<sp/>to<sp/>it&apos;s<sp/>top<sp/>end<sp/>of<sp/>the<sp/>bounding<sp/>box)<sp/>from<sp/>heights</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1647"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>before<sp/>computing<sp/>the<sp/>single-mode<sp/>xheight.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1648"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Restore<sp/>the<sp/>counts<sp/>in<sp/>heights<sp/>after<sp/>the<sp/>mode<sp/>is<sp/>found,<sp/>since</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1649"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>floating<sp/>blobs<sp/>might<sp/>be<sp/>useful<sp/>for<sp/>determining<sp/>potential<sp/>ascenders</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1650"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>compute_row_descdrop().</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1651"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(floating_heights-&gt;<ref refid="class_s_t_a_t_s_1a83ad18e6ba02e9f63f4f7d84fcf76aa4" kindref="member">get_total</ref>()<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>min_height;<sp/>x<sp/>&lt;<sp/>max_height;<sp/>++x)<sp/>{</highlight></codeline>
<codeline lineno="1653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>heights-&gt;<ref refid="class_s_t_a_t_s_1ab8cacba14df28eed1bffc4cea0b2f87f" kindref="member">add</ref>(x,<sp/>-(floating_heights-&gt;<ref refid="class_s_t_a_t_s_1a4a3a320660e2092eeaa605df70bea8ea" kindref="member">pile_count</ref>(x)));</highlight></codeline>
<codeline lineno="1654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_index<sp/>=<sp/>heights-&gt;<ref refid="class_s_t_a_t_s_1a5d353e951f61daf06c6582dfc106ff11" kindref="member">mode</ref>();<sp/><sp/></highlight><highlight class="comment">//<sp/>find<sp/>the<sp/>modified<sp/>mode</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>min_height;<sp/>x<sp/>&lt;<sp/>max_height;<sp/>++x)<sp/>{</highlight></codeline>
<codeline lineno="1657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>heights-&gt;<ref refid="class_s_t_a_t_s_1ab8cacba14df28eed1bffc4cea0b2f87f" kindref="member">add</ref>(x,<sp/>floating_heights-&gt;<ref refid="class_s_t_a_t_s_1a4a3a320660e2092eeaa605df70bea8ea" kindref="member">pile_count</ref>(x));</highlight></codeline>
<codeline lineno="1658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1659"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1660"><highlight class="normal"><sp/><sp/><sp/><sp/>*xheight<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">float</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(blob_index);</highlight></codeline>
<codeline lineno="1661"><highlight class="normal"><sp/><sp/><sp/><sp/>*ascrise<sp/>=<sp/>0.0f;</highlight></codeline>
<codeline lineno="1662"><highlight class="normal"><sp/><sp/><sp/><sp/>best_count<sp/>=<sp/>heights-&gt;<ref refid="class_s_t_a_t_s_1a4a3a320660e2092eeaa605df70bea8ea" kindref="member">pile_count</ref>(blob_index);</highlight></codeline>
<codeline lineno="1663"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)</highlight></codeline>
<codeline lineno="1664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Single<sp/>mode<sp/>xheight<sp/>set<sp/>to<sp/>%g\n&quot;</highlight><highlight class="normal">,<sp/>*xheight);</highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)<sp/>{</highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Multi-mode<sp/>xheight<sp/>set<sp/>to<sp/>%g,<sp/>asc=%g\n&quot;</highlight><highlight class="normal">,<sp/>*xheight,<sp/>*ascrise);</highlight></codeline>
<codeline lineno="1667"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>best_count;</highlight></codeline>
<codeline lineno="1669"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"></highlight></codeline>
<codeline lineno="1683"><highlight class="normal"><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/><ref refid="makerow_8cpp_1ad04f46fc69514ad2086061ef889b5e23" kindref="member">compute_row_descdrop</ref>(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient,</highlight></codeline>
<codeline lineno="1684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>xheight_blob_count,<sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>*asc_heights)<sp/>{</highlight></codeline>
<codeline lineno="1685"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Count<sp/>how<sp/>many<sp/>potential<sp/>ascenders<sp/>are<sp/>in<sp/>this<sp/>row.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1686"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i_min<sp/>=<sp/>asc_heights-&gt;<ref refid="class_s_t_a_t_s_1a2297ba473c03bc66c5c9ac58cf2ffbee" kindref="member">min_bucket</ref>();</highlight></codeline>
<codeline lineno="1687"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((i_min<sp/>/<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref>)<sp/>&lt;<sp/>textord_ascx_ratio_min)<sp/>{</highlight></codeline>
<codeline lineno="1688"><highlight class="normal"><sp/><sp/><sp/><sp/>i_min<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">int</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(</highlight></codeline>
<codeline lineno="1689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>floor(row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>*<sp/>textord_ascx_ratio_min<sp/>+<sp/>0.5));</highlight></codeline>
<codeline lineno="1690"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1691"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i_max<sp/>=<sp/>asc_heights-&gt;<ref refid="class_s_t_a_t_s_1a42e9cc7b119d22acdd74ea62f0f64a64" kindref="member">max_bucket</ref>();</highlight></codeline>
<codeline lineno="1692"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((i_max<sp/>/<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref>)<sp/>&gt;<sp/>textord_ascx_ratio_max)<sp/>{</highlight></codeline>
<codeline lineno="1693"><highlight class="normal"><sp/><sp/><sp/><sp/>i_max<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">int</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(floor(row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>*<sp/>textord_ascx_ratio_max));</highlight></codeline>
<codeline lineno="1694"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1695"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_potential_asc<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1696"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>i_min;<sp/>i<sp/>&lt;=<sp/>i_max;<sp/>++i)<sp/>{</highlight></codeline>
<codeline lineno="1697"><highlight class="normal"><sp/><sp/><sp/><sp/>num_potential_asc<sp/>+=<sp/>asc_heights-&gt;<ref refid="class_s_t_a_t_s_1a4a3a320660e2092eeaa605df70bea8ea" kindref="member">pile_count</ref>(i);</highlight></codeline>
<codeline lineno="1698"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1699"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>min_height<sp/>=</highlight></codeline>
<codeline lineno="1700"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="normal"><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(floor(row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>*<sp/>textord_descx_ratio_min<sp/>+<sp/>0.5));</highlight></codeline>
<codeline lineno="1701"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>max_height<sp/>=</highlight></codeline>
<codeline lineno="1702"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="normal"><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref></highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(floor(row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>*<sp/>textord_descx_ratio_max));</highlight></codeline>
<codeline lineno="1703"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>xcentre;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>centre<sp/>of<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1704"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>height;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>height<sp/>of<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1705"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref>();</highlight></codeline>
<codeline lineno="1706"><highlight class="normal"><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>*blob;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>current<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1707"><highlight class="normal"><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>heights<sp/>(min_height,<sp/>max_height<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(blob_it.mark_cycle_pt();<sp/>!blob_it.cycled_list();<sp/>blob_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="1709"><highlight class="normal"><sp/><sp/><sp/><sp/>blob<sp/>=<sp/>blob_it.data();</highlight></codeline>
<codeline lineno="1710"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1af37f373c72851534101f4caf296a3cf7" kindref="member">joined_to_prev</ref>())<sp/>{</highlight></codeline>
<codeline lineno="1711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xcentre<sp/>=<sp/>(blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>+</highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>())<sp/>/<sp/>2.0<ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>;</highlight></codeline>
<codeline lineno="1713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>height<sp/>=<sp/>(gradient<sp/>*<sp/>xcentre<sp/>+<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a81a46c8d6026c157c152778aa9d1ab58" kindref="member">parallel_c</ref>()<sp/>-</highlight></codeline>
<codeline lineno="1714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>().<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>());</highlight></codeline>
<codeline lineno="1715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(height<sp/>&gt;=<sp/>min_height<sp/>&amp;&amp;<sp/>height<sp/>&lt;=<sp/>max_height)</highlight></codeline>
<codeline lineno="1716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>heights.<ref refid="class_s_t_a_t_s_1ab8cacba14df28eed1bffc4cea0b2f87f" kindref="member">add</ref>(static_cast&lt;int&gt;(floor(height<sp/>+<sp/>0.5)),<sp/>1);</highlight></codeline>
<codeline lineno="1717"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1718"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1719"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blob_index<sp/>=<sp/>heights.<ref refid="class_s_t_a_t_s_1a5d353e951f61daf06c6582dfc106ff11" kindref="member">mode</ref>();<sp/><sp/></highlight><highlight class="comment">//<sp/>find<sp/>mode</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1720"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blob_count<sp/>=<sp/>heights.<ref refid="class_s_t_a_t_s_1a4a3a320660e2092eeaa605df70bea8ea" kindref="member">pile_count</ref>(blob_index);<sp/><sp/></highlight><highlight class="comment">//<sp/>get<sp/>count<sp/>of<sp/>mode</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1721"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>total_fraction<sp/>=</highlight></codeline>
<codeline lineno="1722"><highlight class="normal"><sp/><sp/><sp/><sp/>(textord_descheight_mode_fraction<sp/>+<sp/>textord_ascheight_mode_fraction);</highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(static_cast&lt;float&gt;(blob_count<sp/>+<sp/>num_potential_asc)<sp/>&lt;</highlight></codeline>
<codeline lineno="1724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xheight_blob_count<sp/>*<sp/>total_fraction)<sp/>{</highlight></codeline>
<codeline lineno="1725"><highlight class="normal"><sp/><sp/><sp/><sp/>blob_count<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1726"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1727"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>descdrop<sp/>=<sp/>blob_count<sp/>&gt;<sp/>0<sp/>?<sp/>-blob_index<sp/>:<sp/>0;</highlight></codeline>
<codeline lineno="1728"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)<sp/>{</highlight></codeline>
<codeline lineno="1729"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Descdrop:<sp/>%d<sp/>(potential<sp/>ascenders<sp/>%d,<sp/>descenders<sp/>%d)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>descdrop,<sp/>num_potential_asc,<sp/>blob_count);</highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/>heights.<ref refid="class_s_t_a_t_s_1a78e51420aa91ecff1f635e606d4a0f88" kindref="member">print</ref>();</highlight></codeline>
<codeline lineno="1732"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1733"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>descdrop;</highlight></codeline>
<codeline lineno="1734"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1735"><highlight class="normal"></highlight></codeline>
<codeline lineno="1736"><highlight class="normal"></highlight></codeline>
<codeline lineno="1743"><highlight class="normal"><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/><ref refid="makerow_8cpp_1a796af03d9d0fe26e0563a5714cb83741" kindref="member">compute_height_modes</ref>(<ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>*heights,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>stats<sp/>to<sp/>search</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>min_height,<sp/><sp/></highlight><highlight class="comment">//<sp/>bottom<sp/>of<sp/>range</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>max_height,<sp/><sp/></highlight><highlight class="comment">//<sp/>top<sp/>of<sp/>range</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>*modes,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>output<sp/>array</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>maxmodes)<sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>size<sp/>of<sp/>modes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1748"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>pile_count;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>no<sp/>in<sp/>source<sp/>pile</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1749"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>src_count;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>no<sp/>of<sp/>source<sp/>entries</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1750"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>src_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>current<sp/>entry</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1751"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>least_count;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>height<sp/>of<sp/>smalllest</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>least_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>index<sp/>of<sp/>least</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1753"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>dest_count;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>index<sp/>in<sp/>modes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1754"><highlight class="normal"></highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><sp/><sp/>src_count<sp/>=<sp/>max_height<sp/>+<sp/>1<sp/>-<sp/>min_height;</highlight></codeline>
<codeline lineno="1756"><highlight class="normal"><sp/><sp/>dest_count<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1757"><highlight class="normal"><sp/><sp/>least_count<sp/>=<sp/><ref refid="host_8h_1aac62d87844689a18b6f5339a89ed6e7f" kindref="member">MAX_INT32</ref>;</highlight></codeline>
<codeline lineno="1758"><highlight class="normal"><sp/><sp/>least_index<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="1759"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(src_index<sp/>=<sp/>0;<sp/>src_index<sp/>&lt;<sp/>src_count;<sp/>src_index++)<sp/>{</highlight></codeline>
<codeline lineno="1760"><highlight class="normal"><sp/><sp/><sp/><sp/>pile_count<sp/>=<sp/>heights-&gt;<ref refid="class_s_t_a_t_s_1a4a3a320660e2092eeaa605df70bea8ea" kindref="member">pile_count</ref>(min_height<sp/>+<sp/>src_index);</highlight></codeline>
<codeline lineno="1761"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pile_count<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dest_count<sp/>&lt;<sp/>maxmodes)<sp/>{</highlight></codeline>
<codeline lineno="1763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pile_count<sp/>&lt;<sp/>least_count)<sp/>{</highlight></codeline>
<codeline lineno="1764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>find<sp/>smallest<sp/>in<sp/>array</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>least_count<sp/>=<sp/>pile_count;</highlight></codeline>
<codeline lineno="1766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>least_index<sp/>=<sp/>dest_count;</highlight></codeline>
<codeline lineno="1767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modes[dest_count++]<sp/>=<sp/>min_height<sp/>+<sp/>src_index;</highlight></codeline>
<codeline lineno="1769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pile_count<sp/>&gt;=<sp/>least_count)<sp/>{</highlight></codeline>
<codeline lineno="1770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(least_index<sp/>&lt;<sp/>maxmodes<sp/>-<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="1771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modes[least_index]<sp/>=<sp/>modes[least_index<sp/>+<sp/>1];</highlight></codeline>
<codeline lineno="1772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>shuffle<sp/>up</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>least_index++;</highlight></codeline>
<codeline lineno="1774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>new<sp/>one<sp/>on<sp/>end</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modes[maxmodes<sp/>-<sp/>1]<sp/>=<sp/>min_height<sp/>+<sp/>src_index;</highlight></codeline>
<codeline lineno="1777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pile_count<sp/>==<sp/>least_count)<sp/>{</highlight></codeline>
<codeline lineno="1778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>new<sp/>smallest</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>least_index<sp/>=<sp/>maxmodes<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="1780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>least_count<sp/>=<sp/>heights-&gt;<ref refid="class_s_t_a_t_s_1a4a3a320660e2092eeaa605df70bea8ea" kindref="member">pile_count</ref>(modes[0]);</highlight></codeline>
<codeline lineno="1782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>least_index<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(dest_count<sp/>=<sp/>1;<sp/>dest_count<sp/>&lt;<sp/>maxmodes;<sp/>dest_count++)<sp/>{</highlight></codeline>
<codeline lineno="1784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pile_count<sp/>=<sp/>heights-&gt;<ref refid="class_s_t_a_t_s_1a4a3a320660e2092eeaa605df70bea8ea" kindref="member">pile_count</ref>(modes[dest_count]);</highlight></codeline>
<codeline lineno="1785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pile_count<sp/>&lt;<sp/>least_count)<sp/>{</highlight></codeline>
<codeline lineno="1786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>find<sp/>smallest</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>least_count<sp/>=<sp/>pile_count;</highlight></codeline>
<codeline lineno="1788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>least_index<sp/>=<sp/>dest_count;</highlight></codeline>
<codeline lineno="1789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1793"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1794"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1795"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dest_count;</highlight></codeline>
<codeline lineno="1796"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1797"><highlight class="normal"></highlight></codeline>
<codeline lineno="1798"><highlight class="normal"></highlight></codeline>
<codeline lineno="1805"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a816de2bcfeae782b4ba8506075925284" kindref="member">correct_row_xheight</ref>(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>xheight,</highlight></codeline>
<codeline lineno="1806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>ascrise,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>descdrop)<sp/>{</highlight></codeline>
<codeline lineno="1807"><highlight class="normal"><sp/><sp/><ref refid="makerow_8h_1afce0c34ba177573f61217f64c0a04d68" kindref="member">ROW_CATEGORY</ref><sp/>row_category<sp/>=<sp/><ref refid="makerow_8h_1af91de8a5d97ef84af1d5ef5cadd89bdd" kindref="member">get_row_category</ref>(row);</highlight></codeline>
<codeline lineno="1808"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)<sp/>{</highlight></codeline>
<codeline lineno="1809"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;correcting<sp/>row<sp/>xheight:<sp/>row-&gt;xheight<sp/>%.4f&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;,<sp/>row-&gt;acrise<sp/>%.4f<sp/>row-&gt;descdrop<sp/>%.4f\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref>,<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acf8bf7f0f335788e106955b8142f832a" kindref="member">ascrise</ref>,<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acc50308b9a0cd5c73184de33971c55a8" kindref="member">descdrop</ref>);</highlight></codeline>
<codeline lineno="1812"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1813"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>normal_xheight<sp/>=</highlight></codeline>
<codeline lineno="1814"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8h_1a06639b8bf2e9edec8aed7e189b312f88" kindref="member">within_error_margin</ref>(row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref>,<sp/>xheight,<sp/>textord_xheight_error_margin);</highlight></codeline>
<codeline lineno="1815"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>cap_xheight<sp/>=</highlight></codeline>
<codeline lineno="1816"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="makerow_8h_1a06639b8bf2e9edec8aed7e189b312f88" kindref="member">within_error_margin</ref>(row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref>,<sp/>xheight<sp/>+<sp/>ascrise,</highlight></codeline>
<codeline lineno="1817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>textord_xheight_error_margin);</highlight></codeline>
<codeline lineno="1818"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Use<sp/>the<sp/>average<sp/>xheight/ascrise<sp/>for<sp/>the<sp/>following<sp/>cases:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1819"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>--<sp/>the<sp/>xheight<sp/>of<sp/>the<sp/>row<sp/>could<sp/>not<sp/>be<sp/>determined<sp/>at<sp/>all</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1820"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>--<sp/>the<sp/>row<sp/>has<sp/>descenders<sp/>(e.g.<sp/>&quot;many<sp/>groups&quot;,<sp/>&quot;ISBN<sp/>12345<sp/>p.3&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1821"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>and<sp/>its<sp/>xheight<sp/>is<sp/>close<sp/>to<sp/>either<sp/>cap<sp/>height<sp/>or<sp/>average<sp/>xheight</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1822"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>--<sp/>the<sp/>row<sp/>does<sp/>not<sp/>have<sp/>ascenders<sp/>or<sp/>descenders,<sp/>but<sp/>its<sp/>xheight</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1823"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>is<sp/>close<sp/>to<sp/>the<sp/>average<sp/>block<sp/>xheight<sp/>(e.g.<sp/>row<sp/>with<sp/>&quot;www.mmm.com&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1824"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_category<sp/>==<sp/><ref refid="makerow_8h_1afce0c34ba177573f61217f64c0a04d68aba1649106cf3c6301a0cd938b01af28e" kindref="member">ROW_ASCENDERS_FOUND</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1825"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1acc50308b9a0cd5c73184de33971c55a8" kindref="member">descdrop</ref><sp/>&gt;=<sp/>0.0)<sp/>{</highlight></codeline>
<codeline lineno="1826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acc50308b9a0cd5c73184de33971c55a8" kindref="member">descdrop</ref><sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>*<sp/>(descdrop<sp/>/<sp/>xheight);</highlight></codeline>
<codeline lineno="1827"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1828"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_category<sp/>==<sp/><ref refid="makerow_8h_1afce0c34ba177573f61217f64c0a04d68acd93bee831837976a1dabbccb5583354" kindref="member">ROW_INVALID</ref><sp/>||</highlight></codeline>
<codeline lineno="1829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(row_category<sp/>==<sp/><ref refid="makerow_8h_1afce0c34ba177573f61217f64c0a04d68a25bbfc450f12f60f7a5882e37973a4b6" kindref="member">ROW_DESCENDERS_FOUND</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="1830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(normal_xheight<sp/>||<sp/>cap_xheight))<sp/>||</highlight></codeline>
<codeline lineno="1831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(row_category<sp/>==<sp/><ref refid="makerow_8h_1afce0c34ba177573f61217f64c0a04d68ab5102ae2a7fc9f423729da68d441fa7b" kindref="member">ROW_UNKNOWN</ref><sp/>&amp;&amp;<sp/>normal_xheight))<sp/>{</highlight></codeline>
<codeline lineno="1832"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)<sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;using<sp/>average<sp/>xheight\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1833"><highlight class="normal"><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>=<sp/>xheight;</highlight></codeline>
<codeline lineno="1834"><highlight class="normal"><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acf8bf7f0f335788e106955b8142f832a" kindref="member">ascrise</ref><sp/>=<sp/>ascrise;</highlight></codeline>
<codeline lineno="1835"><highlight class="normal"><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acc50308b9a0cd5c73184de33971c55a8" kindref="member">descdrop</ref><sp/>=<sp/>descdrop;</highlight></codeline>
<codeline lineno="1836"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_category<sp/>==<sp/><ref refid="makerow_8h_1afce0c34ba177573f61217f64c0a04d68a25bbfc450f12f60f7a5882e37973a4b6" kindref="member">ROW_DESCENDERS_FOUND</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1837"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Assume<sp/>this<sp/>is<sp/>a<sp/>row<sp/>with<sp/>mostly<sp/>lowercase<sp/>letters<sp/>and<sp/>it&apos;s<sp/>xheight</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1838"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>is<sp/>computed<sp/>correctly<sp/>(unfortunately<sp/>there<sp/>is<sp/>no<sp/>way<sp/>to<sp/>distinguish</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1839"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>this<sp/>from<sp/>the<sp/>case<sp/>when<sp/>descenders<sp/>are<sp/>found,<sp/>but<sp/>the<sp/>most<sp/>common</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1840"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>height<sp/>is<sp/>capheight).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1841"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)<sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;lowercase,<sp/>corrected<sp/>ascrise\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1842"><highlight class="normal"><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acf8bf7f0f335788e106955b8142f832a" kindref="member">ascrise</ref><sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>*<sp/>(ascrise<sp/>/<sp/>xheight);</highlight></codeline>
<codeline lineno="1843"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_category<sp/>==<sp/><ref refid="makerow_8h_1afce0c34ba177573f61217f64c0a04d68ab5102ae2a7fc9f423729da68d441fa7b" kindref="member">ROW_UNKNOWN</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1844"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Otherwise<sp/>assume<sp/>this<sp/>row<sp/>is<sp/>an<sp/>all-caps<sp/>or<sp/>small-caps<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1845"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>and<sp/>adjust<sp/>xheight<sp/>and<sp/>ascrise<sp/>of<sp/>the<sp/>row.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1846"><highlight class="normal"></highlight></codeline>
<codeline lineno="1847"><highlight class="normal"><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a28ff791a1040472676085babab439e43" kindref="member">all_caps</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1848"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cap_xheight)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>regular<sp/>all<sp/>caps</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)<sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;all<sp/>caps\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>=<sp/>xheight;</highlight></codeline>
<codeline lineno="1851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acf8bf7f0f335788e106955b8142f832a" kindref="member">ascrise</ref><sp/>=<sp/>ascrise;</highlight></codeline>
<codeline lineno="1852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acc50308b9a0cd5c73184de33971c55a8" kindref="member">descdrop</ref><sp/>=<sp/>descdrop;</highlight></codeline>
<codeline lineno="1853"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>small<sp/>caps<sp/>or<sp/>caps<sp/>with<sp/>an<sp/>odd<sp/>xheight</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)<sp/>{</highlight></codeline>
<codeline lineno="1855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>&lt;<sp/>xheight<sp/>+<sp/>ascrise<sp/>&amp;&amp;<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>&gt;<sp/>xheight)<sp/>{</highlight></codeline>
<codeline lineno="1856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;small<sp/>caps\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;all<sp/>caps<sp/>with<sp/>irregular<sp/>xheight\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acf8bf7f0f335788e106955b8142f832a" kindref="member">ascrise</ref><sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>*<sp/>(ascrise<sp/>/<sp/>(xheight<sp/>+<sp/>ascrise));</highlight></codeline>
<codeline lineno="1862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>-=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acf8bf7f0f335788e106955b8142f832a" kindref="member">ascrise</ref>;</highlight></codeline>
<codeline lineno="1863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acc50308b9a0cd5c73184de33971c55a8" kindref="member">descdrop</ref><sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref><sp/>*<sp/>(descdrop<sp/>/<sp/>xheight);</highlight></codeline>
<codeline lineno="1864"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1865"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1866"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_debug_xheights)<sp/>{</highlight></codeline>
<codeline lineno="1867"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;corrected<sp/>row-&gt;xheight<sp/>=<sp/>%.4f,<sp/>row-&gt;acrise<sp/>=<sp/>%.4f,<sp/>row-&gt;descdrop&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;<sp/>=<sp/>%.4f\n&quot;</highlight><highlight class="normal">,<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a819d94a95b9aab802acbcba097c67b2b" kindref="member">xheight</ref>,<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acf8bf7f0f335788e106955b8142f832a" kindref="member">ascrise</ref>,<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1acc50308b9a0cd5c73184de33971c55a8" kindref="member">descdrop</ref>);</highlight></codeline>
<codeline lineno="1869"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1870"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1871"><highlight class="normal"></highlight></codeline>
<codeline lineno="1872"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>CountOverlaps(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>min_height,</highlight></codeline>
<codeline lineno="1873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BLOBNBOX_LIST*<sp/>blobs)<sp/>{</highlight></codeline>
<codeline lineno="1874"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>overlaps<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1875"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it(blobs);</highlight></codeline>
<codeline lineno="1876"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(blob_it.mark_cycle_pt();<sp/>!blob_it.cycled_list();<sp/>blob_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="1877"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>*<sp/>blob<sp/>=<sp/>blob_it.data();</highlight></codeline>
<codeline lineno="1878"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>blob_box<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>();</highlight></codeline>
<codeline lineno="1879"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blob_box.<ref refid="class_t_b_o_x_1a8379d4bbc72bdbb1f069fc14790e632d" kindref="member">height</ref>()<sp/>&gt;=<sp/>min_height<sp/>&amp;&amp;<sp/>box.<ref refid="class_t_b_o_x_1aeabe87a0ee3912ca63550ffee4fb4115" kindref="member">major_overlap</ref>(blob_box))<sp/>{</highlight></codeline>
<codeline lineno="1880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>++overlaps;</highlight></codeline>
<codeline lineno="1881"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1883"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>overlaps;</highlight></codeline>
<codeline lineno="1884"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1885"><highlight class="normal"></highlight></codeline>
<codeline lineno="1892"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a004e5d894712f552369ef523a09bc3ce" kindref="member">separate_underlines</ref>(<ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/><sp/></highlight><highlight class="comment">//<sp/>block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient,<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>skew<sp/>angle</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>rotation,<sp/><sp/></highlight><highlight class="comment">//<sp/>inverse<sp/>landscape</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>testing_on)<sp/>{<sp/><sp/></highlight><highlight class="comment">//<sp/>correct<sp/>orientation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1896"><highlight class="normal"><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>*blob;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>current<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1897"><highlight class="normal"><sp/><sp/><ref refid="class_c___b_l_o_b" kindref="compound">C_BLOB</ref><sp/>*rotated_blob;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>rotated<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1898"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>current<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1899"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>length;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>of<sp/>g_vec</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1900"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>blob_box;</highlight></codeline>
<codeline lineno="1901"><highlight class="normal"><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>blob_rotation;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>inverse<sp/>of<sp/>rotation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1902"><highlight class="normal"><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>g_vec;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>skew<sp/>rotation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1903"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1905"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>under_it<sp/>=<sp/>&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1abe8092e46729fbddf38f16ad7ca07318" kindref="member">underlines</ref>;</highlight></codeline>
<codeline lineno="1906"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>large_it<sp/>=<sp/>&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1aafe2a9baa69300ee71da42e6dc18cfee" kindref="member">large_blobs</ref>;</highlight></codeline>
<codeline lineno="1907"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref>();</highlight></codeline>
<codeline lineno="1908"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>min_blob_height<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">int</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(textord_min_blob_height_fraction<sp/>*</highlight></codeline>
<codeline lineno="1909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>+<sp/>0.5);</highlight></codeline>
<codeline lineno="1910"><highlight class="normal"></highlight></codeline>
<codeline lineno="1911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>length<sp/>of<sp/>vector</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1912"><highlight class="normal"><sp/><sp/>length<sp/>=<sp/>sqrt(1<sp/>+<sp/>gradient<sp/>*<sp/>gradient);</highlight></codeline>
<codeline lineno="1913"><highlight class="normal"><sp/><sp/>g_vec<sp/>=<sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref>(1<sp/>/<sp/>length,<sp/>-gradient<sp/>/<sp/>length);</highlight></codeline>
<codeline lineno="1914"><highlight class="normal"><sp/><sp/>blob_rotation<sp/>=<sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref>(rotation.<ref refid="class_f_c_o_o_r_d_1a9edadbfc357c730f62fa3c92677b0d58" kindref="member">x</ref>(),<sp/>-rotation.<ref refid="class_f_c_o_o_r_d_1a397f7ce997b246df18e7bd5a20cc422e" kindref="member">y</ref>());</highlight></codeline>
<codeline lineno="1915"><highlight class="normal"><sp/><sp/>blob_rotation.<ref refid="class_f_c_o_o_r_d_1a81ca9ea0cac4cd8c1bca0314e29bb28d" kindref="member">rotate</ref>(g_vec);<sp/><sp/></highlight><highlight class="comment">//<sp/>undoing<sp/>everything</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1916"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt();<sp/>!row_it.cycled_list();<sp/>row_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="1917"><highlight class="normal"><sp/><sp/><sp/><sp/>row<sp/>=<sp/>row_it.data();</highlight></codeline>
<codeline lineno="1918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>get<sp/>blobs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1919"><highlight class="normal"><sp/><sp/><sp/><sp/>blob_it.set_to_list(row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref>());</highlight></codeline>
<codeline lineno="1920"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(blob_it.mark_cycle_pt();<sp/>!blob_it.cycled_list();</highlight></codeline>
<codeline lineno="1921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="1922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob<sp/>=<sp/>blob_it.data();</highlight></codeline>
<codeline lineno="1923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_box<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>();</highlight></codeline>
<codeline lineno="1924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blob_box.<ref refid="class_t_b_o_x_1af95494a2ccacc70cc2b83820b2948619" kindref="member">width</ref>()<sp/>&gt;<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>*<sp/>textord_underline_width)<sp/>{</highlight></codeline>
<codeline lineno="1925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref>(blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a483f44541a4dd818f02225c92f030e07" kindref="member">cblob</ref>()<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>);</highlight></codeline>
<codeline lineno="1926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rotated_blob<sp/>=<sp/><ref refid="blobbox_8cpp_1a4145a126880b1bd685f07c9499903b71" kindref="member">crotate_cblob</ref><sp/>(blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a483f44541a4dd818f02225c92f030e07" kindref="member">cblob</ref>(),</highlight></codeline>
<codeline lineno="1927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_rotation);</highlight></codeline>
<codeline lineno="1928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="blkocc_8cpp_1a1b548029a83d9ac05ecb47cb177c69fb" kindref="member">test_underline</ref>(</highlight></codeline>
<codeline lineno="1929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>testing_on<sp/>&amp;&amp;<sp/>textord_show_final_rows,</highlight></codeline>
<codeline lineno="1930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rotated_blob,<sp/>static_cast&lt;inT16&gt;(row-&gt;<ref refid="class_t_o___r_o_w_1ae78743484af3c62d5cff686a0b99c52a" kindref="member">intercept</ref>()),</highlight></codeline>
<codeline lineno="1931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>static_cast&lt;inT16&gt;(</highlight></codeline>
<codeline lineno="1932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>*</highlight></codeline>
<codeline lineno="1933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="classtesseract_1_1_c_c_struct_1a737fdb37b9401ad3d04371c1bd4a0b17" kindref="member">tesseract::CCStruct::kXHeightFraction</ref><sp/>+</highlight></codeline>
<codeline lineno="1934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_c_c_struct_1a9d71fddad74d9418e106713cd643b919" kindref="member">tesseract::CCStruct::kAscenderFraction</ref><sp/>/<sp/>2.0f))))<sp/>{</highlight></codeline>
<codeline lineno="1935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>under_it.add_after_then_move(blob_it.extract());</highlight></codeline>
<codeline lineno="1936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on<sp/>&amp;&amp;<sp/>textord_show_final_rows)<sp/>{</highlight></codeline>
<codeline lineno="1937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Underlined<sp/>blob<sp/>at:&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rotated_blob-&gt;bounding_box().print();</highlight></codeline>
<codeline lineno="1939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Was:&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_box.<ref refid="class_t_b_o_x_1a2e753aa9943276301d68e9f9cad99620" kindref="member">print</ref>();</highlight></codeline>
<codeline lineno="1941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(CountOverlaps(blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>(),<sp/>min_blob_height,</highlight></codeline>
<codeline lineno="1943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref>())<sp/>&gt;</highlight></codeline>
<codeline lineno="1944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>textord_max_blob_overlaps)<sp/>{</highlight></codeline>
<codeline lineno="1945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>large_it.add_after_then_move(blob_it.extract());</highlight></codeline>
<codeline lineno="1946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on<sp/>&amp;&amp;<sp/>textord_show_final_rows)<sp/>{</highlight></codeline>
<codeline lineno="1947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Large<sp/>blob<sp/>overlaps<sp/>%d<sp/>blobs<sp/>at:&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CountOverlaps(blob_box,<sp/>min_blob_height,</highlight></codeline>
<codeline lineno="1949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref>()));</highlight></codeline>
<codeline lineno="1950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_box.<ref refid="class_t_b_o_x_1a2e753aa9943276301d68e9f9cad99620" kindref="member">print</ref>();</highlight></codeline>
<codeline lineno="1951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>rotated_blob;</highlight></codeline>
<codeline lineno="1954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1955"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1956"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1957"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1958"><highlight class="normal"></highlight></codeline>
<codeline lineno="1959"><highlight class="normal"></highlight></codeline>
<codeline lineno="1965"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a8a932e3bd44fc2fc6fbdc291cdc9b942" kindref="member">pre_associate_blobs</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//make<sp/>rough<sp/>chars</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref><sp/>page_tr,<sp/><sp/><sp/></highlight><highlight class="comment">//top<sp/>right</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/><sp/></highlight><highlight class="comment">//block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>rotation,<sp/><sp/></highlight><highlight class="comment">//inverse<sp/>landscape</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>testing_on<sp/><sp/></highlight><highlight class="comment">//correct<sp/>orientation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="1971"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="1972"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/>colour;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>boxes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1973"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="1974"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>*blob;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1975"><highlight class="normal"><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>*nextblob;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//next<sp/>in<sp/>list</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1976"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>blob_box;</highlight></codeline>
<codeline lineno="1977"><highlight class="normal"><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>blob_rotation;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//inverse<sp/>of<sp/>rotation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1978"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1979"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>start_it;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1980"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>();</highlight></codeline>
<codeline lineno="1981"><highlight class="normal"></highlight></codeline>
<codeline lineno="1982"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="1983"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/>colour<sp/>=<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0959f7470b08ae1a38aa7e38fba29402" kindref="member">ScrollView::RED</ref>;</highlight></codeline>
<codeline lineno="1984"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="1985"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1986"><highlight class="normal"><sp/><sp/>blob_rotation<sp/>=<sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>(rotation.<ref refid="class_f_c_o_o_r_d_1a9edadbfc357c730f62fa3c92677b0d58" kindref="member">x</ref><sp/>(),<sp/>-rotation.<ref refid="class_f_c_o_o_r_d_1a397f7ce997b246df18e7bd5a20cc422e" kindref="member">y</ref><sp/>());</highlight></codeline>
<codeline lineno="1987"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="1988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//get<sp/>blobs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1989"><highlight class="normal"><sp/><sp/><sp/><sp/>blob_it.set_to_list<sp/>(row_it.data<sp/>()-&gt;blob_list<sp/>());</highlight></codeline>
<codeline lineno="1990"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(blob_it.mark_cycle_pt<sp/>();<sp/>!blob_it.cycled_list<sp/>();</highlight></codeline>
<codeline lineno="1991"><highlight class="normal"><sp/><sp/><sp/><sp/>blob_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="1992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob<sp/>=<sp/>blob_it.data<sp/>();</highlight></codeline>
<codeline lineno="1993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_box<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>();</highlight></codeline>
<codeline lineno="1994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>start_it<sp/>=<sp/>blob_it;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//save<sp/>start<sp/>point</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(testing_on<sp/>&amp;&amp;<sp/>textord_show_final_blobs)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tprintf(&quot;Blob<sp/>at<sp/>(%d,%d)-&gt;(%d,%d),<sp/>addr=%x,<sp/>count=%d\n&quot;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_box.left(),blob_box.bottom(),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_box.right(),blob_box.top(),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(void*)blob,blob_it.length());</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>overlap;</highlight></codeline>
<codeline lineno="2003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overlap<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!blob_it.at_last<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nextblob<sp/>=<sp/>blob_it.data_relative(1);</highlight></codeline>
<codeline lineno="2007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overlap<sp/>=<sp/>blob_box.<ref refid="class_t_b_o_x_1a9f7e4e20bdfeee0d82db2f8d24aa72dc" kindref="member">major_x_overlap</ref>(nextblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>());</highlight></codeline>
<codeline lineno="2008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(overlap)<sp/>{</highlight></codeline>
<codeline lineno="2009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1ae4415dbdf1257052f22ee726f98db893" kindref="member">merge</ref>(nextblob);<sp/></highlight><highlight class="comment">//<sp/>merge<sp/>new<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_box<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref>();<sp/></highlight><highlight class="comment">//<sp/>get<sp/>bigger<sp/>box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.forward();</highlight></codeline>
<codeline lineno="2012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(overlap);</highlight></codeline>
<codeline lineno="2016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a118eeb16f7c775dc58129a5869425f4b" kindref="member">chop</ref><sp/>(&amp;start_it,<sp/>&amp;blob_it,</highlight></codeline>
<codeline lineno="2017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_rotation,</highlight></codeline>
<codeline lineno="2018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>*<sp/><ref refid="classtesseract_1_1_c_c_struct_1a737fdb37b9401ad3d04371c1bd4a0b17" kindref="member">tesseract::CCStruct::kXHeightFraction</ref><sp/>*</highlight></codeline>
<codeline lineno="2019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>textord_chop_width);</highlight></codeline>
<codeline lineno="2020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//attempt<sp/>chop</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2021"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2022"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="2023"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on<sp/>&amp;&amp;<sp/>textord_show_final_blobs)<sp/>{</highlight></codeline>
<codeline lineno="2024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref><sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="2025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1a5e0654ca01b55c243387c6535b32860b" kindref="member">create_to_win</ref>(page_tr);</highlight></codeline>
<codeline lineno="2026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref>-&gt;<ref refid="class_scroll_view_1a79855c525ec660b452382e9813d2edb5" kindref="member">Pen</ref>(colour);</highlight></codeline>
<codeline lineno="2027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(blob_it.mark_cycle_pt<sp/>();<sp/>!blob_it.cycled_list<sp/>();</highlight></codeline>
<codeline lineno="2028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob<sp/>=<sp/>blob_it.data<sp/>();</highlight></codeline>
<codeline lineno="2030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_box<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>();</highlight></codeline>
<codeline lineno="2031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_box.<ref refid="class_t_b_o_x_1a428e14544aeb44064bc8637d920211a0" kindref="member">rotate</ref><sp/>(rotation);</highlight></codeline>
<codeline lineno="2032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1af37f373c72851534101f4caf296a3cf7" kindref="member">joined_to_prev</ref><sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref>-&gt;<ref refid="class_scroll_view_1ac2a8fdf5d37967ea4a298dc092b6ed0e" kindref="member">Rectangle</ref><sp/>(blob_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>(),<sp/>blob_box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref><sp/>(),</highlight></codeline>
<codeline lineno="2034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>(),<sp/>blob_box.<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref><sp/>());</highlight></codeline>
<codeline lineno="2035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>colour<sp/>=<sp/>(<ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref>)<sp/>(colour<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="2038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(colour<sp/>&gt;<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8aebeaaeee353c6f04b4498b1fef94bbb3" kindref="member">ScrollView::MAGENTA</ref>)</highlight></codeline>
<codeline lineno="2039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>colour<sp/>=<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0959f7470b08ae1a38aa7e38fba29402" kindref="member">ScrollView::RED</ref>;</highlight></codeline>
<codeline lineno="2040"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2041"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="2042"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2043"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2044"><highlight class="normal"></highlight></codeline>
<codeline lineno="2045"><highlight class="normal"></highlight></codeline>
<codeline lineno="2051"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1abd52b97627f2779855a74b0b9fcae6b2" kindref="member">fit_parallel_rows</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>lines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/><sp/><sp/></highlight><highlight class="comment">//block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//gradient<sp/>to<sp/>fit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>rotation,<sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>drawing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>block_edge,<sp/><sp/></highlight><highlight class="comment">//edge<sp/>of<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>testing_on<sp/><sp/><sp/></highlight><highlight class="comment">//correct<sp/>orientation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2058"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="2059"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/>colour;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2060"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="2061"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>();</highlight></codeline>
<codeline lineno="2062"><highlight class="normal"></highlight></codeline>
<codeline lineno="2063"><highlight class="normal"><sp/><sp/>row_it.move_to_first<sp/>();</highlight></codeline>
<codeline lineno="2064"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2065"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_it.data<sp/>()-&gt;blob_list<sp/>()-&gt;empty<sp/>())</highlight></codeline>
<codeline lineno="2066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>row_it.extract<sp/>();<sp/><sp/></highlight><highlight class="comment">//nothing<sp/>in<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2067"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1a7f6f87295a49c2966d0487e5fdddad3f" kindref="member">fit_parallel_lms</ref><sp/>(gradient,<sp/>row_it.data<sp/>());</highlight></codeline>
<codeline lineno="2069"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2070"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="2071"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)<sp/>{</highlight></codeline>
<codeline lineno="2072"><highlight class="normal"><sp/><sp/><sp/><sp/>colour<sp/>=<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0959f7470b08ae1a38aa7e38fba29402" kindref="member">ScrollView::RED</ref>;</highlight></codeline>
<codeline lineno="2073"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1afb1c1fd2d6af3a9851ab98454356c3cf" kindref="member">plot_parallel_row</ref><sp/>(row_it.data<sp/>(),<sp/>gradient,</highlight></codeline>
<codeline lineno="2075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block_edge,<sp/>colour,<sp/>rotation);</highlight></codeline>
<codeline lineno="2076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>colour<sp/>=<sp/>(<ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref>)<sp/>(colour<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="2077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(colour<sp/>&gt;<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8aebeaaeee353c6f04b4498b1fef94bbb3" kindref="member">ScrollView::MAGENTA</ref>)</highlight></codeline>
<codeline lineno="2078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>colour<sp/>=<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0959f7470b08ae1a38aa7e38fba29402" kindref="member">ScrollView::RED</ref>;</highlight></codeline>
<codeline lineno="2079"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2080"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2081"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="2082"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/>row_it.sort<sp/>(<ref refid="makerow_8cpp_1ab27bf80d814903a9eb48e81b2cc09acc" kindref="member">row_y_order</ref>);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//may<sp/>have<sp/>gone<sp/>out<sp/>of<sp/>order</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2083"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2084"><highlight class="normal"></highlight></codeline>
<codeline lineno="2085"><highlight class="normal"></highlight></codeline>
<codeline lineno="2093"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a7f6f87295a49c2966d0487e5fdddad3f" kindref="member">fit_parallel_lms</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient,<sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row)<sp/>{</highlight></codeline>
<codeline lineno="2094"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>c;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fitted<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2095"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blobcount;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>no<sp/>of<sp/>blobs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2096"><highlight class="normal"><sp/><sp/><sp/><ref refid="classtesseract_1_1_det_line_fit" kindref="compound">tesseract::DetLineFit</ref><sp/>lms;</highlight></codeline>
<codeline lineno="2097"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref>();</highlight></codeline>
<codeline lineno="2098"><highlight class="normal"></highlight></codeline>
<codeline lineno="2099"><highlight class="normal"><sp/><sp/>blobcount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2100"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(blob_it.mark_cycle_pt();<sp/>!blob_it.cycled_list();<sp/>blob_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="2101"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!blob_it.data()-&gt;joined_to_prev())<sp/>{</highlight></codeline>
<codeline lineno="2102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref>&amp;<sp/>box<sp/>=<sp/>blob_it.data()-&gt;bounding_box();</highlight></codeline>
<codeline lineno="2103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>lms.<ref refid="classtesseract_1_1_det_line_fit_1a4eba2b6e761080e5d1a48c9c797257b2" kindref="member">Add</ref>(<ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref>((box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>+<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>())<sp/>/<sp/>2,<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>()));</highlight></codeline>
<codeline lineno="2104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blobcount++;</highlight></codeline>
<codeline lineno="2105"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2106"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2107"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>error<sp/>=<sp/>lms.<ref refid="classtesseract_1_1_det_line_fit_1a58c6ff442c9ab172952eea607f83dca8" kindref="member">ConstrainedFit</ref>(gradient,<sp/>&amp;c);</highlight></codeline>
<codeline lineno="2108"><highlight class="normal"><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a448dbcbfc8d6c3c9c5e8c2fb127fd9d9" kindref="member">set_parallel_line</ref>(gradient,<sp/>c,<sp/>error);</highlight></codeline>
<codeline lineno="2109"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_straight_baselines<sp/>&amp;&amp;<sp/>blobcount<sp/>&gt;<sp/>textord_lms_line_trials)<sp/>{</highlight></codeline>
<codeline lineno="2110"><highlight class="normal"><sp/><sp/><sp/><sp/>error<sp/>=<sp/>lms.<ref refid="classtesseract_1_1_det_line_fit_1a768ec4a8f90593d8d679981c873f7a56" kindref="member">Fit</ref>(&amp;gradient,<sp/>&amp;c);</highlight></codeline>
<codeline lineno="2111"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//set<sp/>the<sp/>other<sp/>too</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2113"><highlight class="normal"><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a10818e7d801044a4d569466fa1d5f841" kindref="member">set_line</ref>(gradient,<sp/>c,<sp/>error);</highlight></codeline>
<codeline lineno="2114"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2115"><highlight class="normal"></highlight></codeline>
<codeline lineno="2116"><highlight class="normal"></highlight></codeline>
<codeline lineno="2122"><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespacetesseract-c__api-demo_1afed58feacb84df2de88bdd613cfdba6d" kindref="member">tesseract</ref><sp/>{</highlight></codeline>
<codeline lineno="2123"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>Textord::make_spline_rows(<ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>gradient,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>gradient<sp/>to<sp/>fit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_f_c_o_o_r_d" kindref="compound">FCOORD</ref><sp/>rotation,<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>for<sp/>drawing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>block_edge,<sp/><sp/></highlight><highlight class="comment">//<sp/>edge<sp/>of<sp/>block</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>testing_on)<sp/>{</highlight></codeline>
<codeline lineno="2128"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="2129"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref><sp/>colour;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2130"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="2131"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>();</highlight></codeline>
<codeline lineno="2132"><highlight class="normal"></highlight></codeline>
<codeline lineno="2133"><highlight class="normal"><sp/><sp/>row_it.move_to_first<sp/>();</highlight></codeline>
<codeline lineno="2134"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_it.data<sp/>()-&gt;blob_list<sp/>()-&gt;empty<sp/>())</highlight></codeline>
<codeline lineno="2136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>row_it.extract<sp/>();<sp/><sp/></highlight><highlight class="comment">//nothing<sp/>in<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="makerow_8cpp_1aff7570e5894808af04a93d3e967c65a2" kindref="member">make_baseline_spline</ref><sp/>(row_it.data<sp/>(),<sp/>block);</highlight></codeline>
<codeline lineno="2139"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2140"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_old_baselines)<sp/>{</highlight></codeline>
<codeline lineno="2141"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="2142"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)<sp/>{</highlight></codeline>
<codeline lineno="2143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>colour<sp/>=<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0959f7470b08ae1a38aa7e38fba29402" kindref="member">ScrollView::RED</ref>;</highlight></codeline>
<codeline lineno="2144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();</highlight></codeline>
<codeline lineno="2145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.data<sp/>()-&gt;baseline.plot<sp/>(<ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref>,<sp/>colour);</highlight></codeline>
<codeline lineno="2147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>colour<sp/>=<sp/>(<ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref>)<sp/>(colour<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="2148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(colour<sp/>&gt;<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8aebeaaeee353c6f04b4498b1fef94bbb3" kindref="member">ScrollView::MAGENTA</ref>)</highlight></codeline>
<codeline lineno="2149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>colour<sp/>=<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0959f7470b08ae1a38aa7e38fba29402" kindref="member">ScrollView::RED</ref>;</highlight></codeline>
<codeline lineno="2150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2151"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2152"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="2153"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/>make_old_baselines(block,<sp/>testing_on,<sp/>gradient);</highlight></codeline>
<codeline lineno="2154"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2155"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="2156"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_on)<sp/>{</highlight></codeline>
<codeline lineno="2157"><highlight class="normal"><sp/><sp/><sp/><sp/>colour<sp/>=<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0959f7470b08ae1a38aa7e38fba29402" kindref="member">ScrollView::RED</ref>;</highlight></codeline>
<codeline lineno="2158"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_it.data<sp/>()-&gt;baseline.plot<sp/>(<ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref>,<sp/>colour);</highlight></codeline>
<codeline lineno="2160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>colour<sp/>=<sp/>(<ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8" kindref="member">ScrollView::Color</ref>)<sp/>(colour<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="2161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(colour<sp/>&gt;<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8aebeaaeee353c6f04b4498b1fef94bbb3" kindref="member">ScrollView::MAGENTA</ref>)</highlight></codeline>
<codeline lineno="2162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>colour<sp/>=<sp/><ref refid="class_scroll_view_1a100504544a5423a94222149ee9ed0fe8a0959f7470b08ae1a38aa7e38fba29402" kindref="member">ScrollView::RED</ref>;</highlight></codeline>
<codeline lineno="2163"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2164"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2165"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="2166"><highlight class="preprocessor"></highlight><highlight class="normal">}</highlight></codeline>
<codeline lineno="2167"><highlight class="normal"></highlight></codeline>
<codeline lineno="2168"><highlight class="normal">}<sp/><sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>tesseract.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2169"><highlight class="normal"></highlight></codeline>
<codeline lineno="2170"><highlight class="normal"></highlight></codeline>
<codeline lineno="2178"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1aff7570e5894808af04a93d3e967c65a2" kindref="member">make_baseline_spline</ref>(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row,<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//row<sp/>to<sp/>fit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block)<sp/>{</highlight></codeline>
<codeline lineno="2180"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref><sp/>();</highlight></codeline>
<codeline lineno="2181"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>*xstarts;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>spline<sp/>boundaries</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2182"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*coeffs;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>quadratic<sp/>coeffs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2183"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>segments;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>no<sp/>of<sp/>segments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2184"><highlight class="normal"></highlight></codeline>
<codeline lineno="2185"><highlight class="normal"><sp/><sp/>xstarts<sp/>=</highlight></codeline>
<codeline lineno="2186"><highlight class="normal"><sp/><sp/><sp/><sp/>(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>*)<sp/><ref refid="memry_8cpp_1a4c14b091498fb7866a1dd0af51a591fe" kindref="member">alloc_mem</ref>((row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref>()-&gt;length()<sp/>+<sp/>1)<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref>));</highlight></codeline>
<codeline lineno="2187"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="makerow_8cpp_1a484016bb062f4465f67644f12326ccdd" kindref="member">segment_baseline</ref>(row,<sp/>block,<sp/>segments,<sp/>xstarts)</highlight></codeline>
<codeline lineno="2188"><highlight class="normal"><sp/><sp/>&amp;&amp;<sp/>!textord_straight_baselines<sp/>&amp;&amp;<sp/>!textord_parallel_baselines)<sp/>{</highlight></codeline>
<codeline lineno="2189"><highlight class="normal"><sp/><sp/><sp/><sp/>coeffs<sp/>=<sp/><ref refid="makerow_8cpp_1a55cfd9360105594dd39d262945f56965" kindref="member">linear_spline_baseline</ref>(row,<sp/>block,<sp/>segments,<sp/>xstarts);</highlight></codeline>
<codeline lineno="2190"><highlight class="normal"><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2191"><highlight class="normal"><sp/><sp/><sp/><sp/>xstarts[1]<sp/>=<sp/>xstarts[segments];</highlight></codeline>
<codeline lineno="2192"><highlight class="normal"><sp/><sp/><sp/><sp/>segments<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2193"><highlight class="normal"><sp/><sp/><sp/><sp/>coeffs<sp/>=<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*)<sp/><ref refid="memry_8cpp_1a4c14b091498fb7866a1dd0af51a591fe" kindref="member">alloc_mem</ref><sp/>(3<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="2194"><highlight class="normal"><sp/><sp/><sp/><sp/>coeffs[0]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2195"><highlight class="normal"><sp/><sp/><sp/><sp/>coeffs[1]<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a51cc690153d9cabdc8217e2ac336d414" kindref="member">line_m</ref><sp/>();</highlight></codeline>
<codeline lineno="2196"><highlight class="normal"><sp/><sp/><sp/><sp/>coeffs[2]<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a22dc07e392af85d9ce625efdd13c6627" kindref="member">line_c</ref><sp/>();</highlight></codeline>
<codeline lineno="2197"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2198"><highlight class="normal"><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a611050c4612df0ccd0f2d64ca0005b9b" kindref="member">baseline</ref><sp/>=<sp/><ref refid="class_q_s_p_l_i_n_e" kindref="compound">QSPLINE</ref><sp/>(segments,<sp/>xstarts,<sp/>coeffs);</highlight></codeline>
<codeline lineno="2199"><highlight class="normal"><sp/><sp/><ref refid="memry_8cpp_1a9ef1862b8e026e23eef238af032858e4" kindref="member">free_mem</ref>(coeffs);</highlight></codeline>
<codeline lineno="2200"><highlight class="normal"><sp/><sp/><ref refid="memry_8cpp_1a9ef1862b8e026e23eef238af032858e4" kindref="member">free_mem</ref>(xstarts);</highlight></codeline>
<codeline lineno="2201"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2202"><highlight class="normal"></highlight></codeline>
<codeline lineno="2203"><highlight class="normal"></highlight></codeline>
<codeline lineno="2211"><highlight class="normal"><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref></highlight></codeline>
<codeline lineno="2212"><highlight class="normal"><ref refid="makerow_8cpp_1a484016bb062f4465f67644f12326ccdd" kindref="member">segment_baseline</ref><sp/>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//split<sp/>baseline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2213"><highlight class="normal"><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*<sp/>row,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//row<sp/>to<sp/>fit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2214"><highlight class="normal"><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*<sp/>block,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//block<sp/>it<sp/>came<sp/>from</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2215"><highlight class="normal"><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>&amp;<sp/>segments,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//no<sp/>fo<sp/>segments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2216"><highlight class="normal"><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>xstarts[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//coords<sp/>of<sp/>segments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2217"><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="2218"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>needs_curve;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//needs<sp/>curved<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2219"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blobcount;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//no<sp/>of<sp/>blobs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2220"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blobindex;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2221"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>last_state;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//above,<sp/>on<sp/>,<sp/>below</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2222"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>state;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>current<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2223"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>yshift;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//from<sp/>baseline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2224"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>box;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//blob<sp/>box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2225"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>new_box;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//new_it<sp/>box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2226"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>middle;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//xcentre<sp/>of<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//blobs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2228"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref><sp/>();</highlight></codeline>
<codeline lineno="2229"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>new_it<sp/>=<sp/>blob_it;<sp/><sp/></highlight><highlight class="comment">//front<sp/>end</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2230"><highlight class="normal"><sp/><sp/><ref refid="class_s_o_r_t_e_d___f_l_o_a_t_s" kindref="compound">SORTED_FLOATS</ref><sp/>yshifts;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//shifts<sp/>from<sp/>baseline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2231"><highlight class="normal"></highlight></codeline>
<codeline lineno="2232"><highlight class="normal"><sp/><sp/>needs_curve<sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="2233"><highlight class="normal"><sp/><sp/>box<sp/>=<sp/><ref refid="blobbox_8cpp_1a3728c3433d1e8f6a2178bb796aa21fad" kindref="member">box_next_pre_chopped</ref><sp/>(&amp;blob_it);</highlight></codeline>
<codeline lineno="2234"><highlight class="normal"><sp/><sp/>xstarts[0]<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>();</highlight></codeline>
<codeline lineno="2235"><highlight class="normal"><sp/><sp/>segments<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2236"><highlight class="normal"><sp/><sp/>blobcount<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref><sp/>()-&gt;length<sp/>();</highlight></codeline>
<codeline lineno="2237"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_oldbl_debug)</highlight></codeline>
<codeline lineno="2238"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;Segmenting<sp/>baseline<sp/>of<sp/>%d<sp/>blobs<sp/>at<sp/>(%d,%d)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blobcount,<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>(),<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref><sp/>());</highlight></codeline>
<codeline lineno="2240"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blobcount<sp/>&lt;=<sp/>textord_spline_medianwin</highlight></codeline>
<codeline lineno="2241"><highlight class="normal"><sp/><sp/>||<sp/>blobcount<sp/>&lt;<sp/>textord_spline_minblobs)<sp/>{</highlight></codeline>
<codeline lineno="2242"><highlight class="normal"><sp/><sp/><sp/><sp/>blob_it.move_to_last<sp/>();</highlight></codeline>
<codeline lineno="2243"><highlight class="normal"><sp/><sp/><sp/><sp/>box<sp/>=<sp/>blob_it.data<sp/>()-&gt;bounding_box<sp/>();</highlight></codeline>
<codeline lineno="2244"><highlight class="normal"><sp/><sp/><sp/><sp/>xstarts[1]<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>();</highlight></codeline>
<codeline lineno="2245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="2246"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2247"><highlight class="normal"><sp/><sp/>last_state<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2248"><highlight class="normal"><sp/><sp/>new_it.mark_cycle_pt<sp/>();</highlight></codeline>
<codeline lineno="2249"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(blobindex<sp/>=<sp/>0;<sp/>blobindex<sp/>&lt;<sp/>textord_spline_medianwin;<sp/>blobindex++)<sp/>{</highlight></codeline>
<codeline lineno="2250"><highlight class="normal"><sp/><sp/><sp/><sp/>new_box<sp/>=<sp/><ref refid="blobbox_8cpp_1a3728c3433d1e8f6a2178bb796aa21fad" kindref="member">box_next_pre_chopped</ref><sp/>(&amp;new_it);</highlight></codeline>
<codeline lineno="2251"><highlight class="normal"><sp/><sp/><sp/><sp/>middle<sp/>=<sp/>(new_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>()<sp/>+<sp/>new_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>())<sp/>/<sp/>2.0;</highlight></codeline>
<codeline lineno="2252"><highlight class="normal"><sp/><sp/><sp/><sp/>yshift<sp/>=<sp/>new_box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref><sp/>()<sp/>-<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a51cc690153d9cabdc8217e2ac336d414" kindref="member">line_m</ref><sp/>()<sp/>*<sp/>middle<sp/>-<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a22dc07e392af85d9ce625efdd13c6627" kindref="member">line_c</ref><sp/>();</highlight></codeline>
<codeline lineno="2253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//record<sp/>shift</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2254"><highlight class="normal"><sp/><sp/><sp/><sp/>yshifts.<ref refid="class_s_o_r_t_e_d___f_l_o_a_t_s_1a6cbf6fb925d7bbb3478cb2c52ff43d2e" kindref="member">add</ref><sp/>(yshift,<sp/>blobindex);</highlight></codeline>
<codeline lineno="2255"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(new_it.cycled_list<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xstarts[1]<sp/>=<sp/>new_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>();</highlight></codeline>
<codeline lineno="2257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="2258"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2259"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2260"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(blobcount<sp/>=<sp/>0;<sp/>blobcount<sp/>&lt;<sp/>textord_spline_medianwin<sp/>/<sp/>2;<sp/>blobcount++)</highlight></codeline>
<codeline lineno="2261"><highlight class="normal"><sp/><sp/><sp/><sp/>box<sp/>=<sp/><ref refid="blobbox_8cpp_1a3728c3433d1e8f6a2178bb796aa21fad" kindref="member">box_next_pre_chopped</ref><sp/>(&amp;blob_it);</highlight></codeline>
<codeline lineno="2262"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2263"><highlight class="normal"><sp/><sp/><sp/><sp/>new_box<sp/>=<sp/><ref refid="blobbox_8cpp_1a3728c3433d1e8f6a2178bb796aa21fad" kindref="member">box_next_pre_chopped</ref><sp/>(&amp;new_it);</highlight></codeline>
<codeline lineno="2264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//get<sp/>middle<sp/>one</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2265"><highlight class="normal"><sp/><sp/><sp/><sp/>yshift<sp/>=<sp/>yshifts[textord_spline_medianwin<sp/>/<sp/>2];</highlight></codeline>
<codeline lineno="2266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(yshift<sp/>&gt;<sp/>textord_spline_shift_fraction<sp/>*<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>)</highlight></codeline>
<codeline lineno="2267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>state<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2268"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(-yshift<sp/>&gt;<sp/>textord_spline_shift_fraction<sp/>*<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>)</highlight></codeline>
<codeline lineno="2269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>state<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="2270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>state<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2272"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(state<sp/>!=<sp/>0)</highlight></codeline>
<codeline lineno="2273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>needs_curve<sp/>=<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="2274"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tprintf(&quot;State=%d,<sp/>prev=%d,<sp/>shift=%g\n&quot;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2275"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>state,last_state,yshift);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(state<sp/>!=<sp/>last_state<sp/>&amp;&amp;<sp/>blobcount<sp/>&gt;<sp/>textord_spline_minblobs)<sp/>{</highlight></codeline>
<codeline lineno="2277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xstarts[segments++]<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>();</highlight></codeline>
<codeline lineno="2278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blobcount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2279"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2280"><highlight class="normal"><sp/><sp/><sp/><sp/>last_state<sp/>=<sp/>state;</highlight></codeline>
<codeline lineno="2281"><highlight class="normal"><sp/><sp/><sp/><sp/>yshifts.<ref refid="class_s_o_r_t_e_d___f_l_o_a_t_s_1a15d8a45629b1cbce9ea476760d4a4e5a" kindref="member">remove</ref><sp/>(blobindex<sp/>-<sp/>textord_spline_medianwin);</highlight></codeline>
<codeline lineno="2282"><highlight class="normal"><sp/><sp/><sp/><sp/>box<sp/>=<sp/><ref refid="blobbox_8cpp_1a3728c3433d1e8f6a2178bb796aa21fad" kindref="member">box_next_pre_chopped</ref><sp/>(&amp;blob_it);</highlight></codeline>
<codeline lineno="2283"><highlight class="normal"><sp/><sp/><sp/><sp/>middle<sp/>=<sp/>(new_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>()<sp/>+<sp/>new_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>())<sp/>/<sp/>2.0;</highlight></codeline>
<codeline lineno="2284"><highlight class="normal"><sp/><sp/><sp/><sp/>yshift<sp/>=<sp/>new_box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref><sp/>()<sp/>-<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a51cc690153d9cabdc8217e2ac336d414" kindref="member">line_m</ref><sp/>()<sp/>*<sp/>middle<sp/>-<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a22dc07e392af85d9ce625efdd13c6627" kindref="member">line_c</ref><sp/>();</highlight></codeline>
<codeline lineno="2285"><highlight class="normal"><sp/><sp/><sp/><sp/>yshifts.<ref refid="class_s_o_r_t_e_d___f_l_o_a_t_s_1a6cbf6fb925d7bbb3478cb2c52ff43d2e" kindref="member">add</ref><sp/>(yshift,<sp/>blobindex);</highlight></codeline>
<codeline lineno="2286"><highlight class="normal"><sp/><sp/><sp/><sp/>blobindex++;</highlight></codeline>
<codeline lineno="2287"><highlight class="normal"><sp/><sp/><sp/><sp/>blobcount++;</highlight></codeline>
<codeline lineno="2288"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2289"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!new_it.cycled_list<sp/>());</highlight></codeline>
<codeline lineno="2290"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blobcount<sp/>&gt;<sp/>textord_spline_minblobs<sp/>||<sp/>segments<sp/>==<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="2291"><highlight class="normal"><sp/><sp/><sp/><sp/>xstarts[segments]<sp/>=<sp/>new_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>();</highlight></codeline>
<codeline lineno="2292"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2293"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2294"><highlight class="normal"><sp/><sp/><sp/><sp/>xstarts[--segments]<sp/>=<sp/>new_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>();</highlight></codeline>
<codeline lineno="2295"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2296"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_oldbl_debug)</highlight></codeline>
<codeline lineno="2297"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;Made<sp/>%d<sp/>segments<sp/>on<sp/>row<sp/>at<sp/>(%d,%d)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>segments,<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>(),<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref><sp/>());</highlight></codeline>
<codeline lineno="2299"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>needs_curve;</highlight></codeline>
<codeline lineno="2300"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2301"><highlight class="normal"></highlight></codeline>
<codeline lineno="2302"><highlight class="normal"></highlight></codeline>
<codeline lineno="2310"><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*</highlight></codeline>
<codeline lineno="2311"><highlight class="normal"><ref refid="makerow_8cpp_1a55cfd9360105594dd39d262945f56965" kindref="member">linear_spline_baseline</ref><sp/>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//split<sp/>baseline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2312"><highlight class="normal"><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*<sp/>row,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//row<sp/>to<sp/>fit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2313"><highlight class="normal"><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*<sp/>block,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//block<sp/>it<sp/>came<sp/>from</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2314"><highlight class="normal"><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>&amp;<sp/>segments,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//no<sp/>fo<sp/>segments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2315"><highlight class="normal"><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>xstarts[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//coords<sp/>of<sp/>segments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2316"><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="2317"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blobcount;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//no<sp/>of<sp/>blobs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2318"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blobindex;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2319"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>index1,<sp/>index2;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//blob<sp/>numbers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2320"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blobs_per_segment;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//blobs<sp/>in<sp/>each</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2321"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>box;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//blob<sp/>box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2322"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>new_box;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//new_it<sp/>box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//blobs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2324"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it<sp/>=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref><sp/>();</highlight></codeline>
<codeline lineno="2325"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>new_it<sp/>=<sp/>blob_it;<sp/><sp/></highlight><highlight class="comment">//front<sp/>end</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2326"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>b,<sp/>c;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//fitted<sp/>curve</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2327"><highlight class="normal"><sp/><sp/><ref refid="classtesseract_1_1_det_line_fit" kindref="compound">tesseract::DetLineFit</ref><sp/>lms;</highlight></codeline>
<codeline lineno="2328"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*coeffs;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//quadratic<sp/>coeffs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2329"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>segment;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2330"><highlight class="normal"></highlight></codeline>
<codeline lineno="2331"><highlight class="normal"><sp/><sp/>box<sp/>=<sp/><ref refid="blobbox_8cpp_1a3728c3433d1e8f6a2178bb796aa21fad" kindref="member">box_next_pre_chopped</ref><sp/>(&amp;blob_it);</highlight></codeline>
<codeline lineno="2332"><highlight class="normal"><sp/><sp/>xstarts[0]<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>();</highlight></codeline>
<codeline lineno="2333"><highlight class="normal"><sp/><sp/>blobcount<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2334"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!blob_it.at_first<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2335"><highlight class="normal"><sp/><sp/><sp/><sp/>blobcount++;</highlight></codeline>
<codeline lineno="2336"><highlight class="normal"><sp/><sp/><sp/><sp/>box<sp/>=<sp/><ref refid="blobbox_8cpp_1a3728c3433d1e8f6a2178bb796aa21fad" kindref="member">box_next_pre_chopped</ref><sp/>(&amp;blob_it);</highlight></codeline>
<codeline lineno="2337"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2338"><highlight class="normal"><sp/><sp/>segments<sp/>=<sp/>blobcount<sp/>/<sp/>textord_spline_medianwin;</highlight></codeline>
<codeline lineno="2339"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(segments<sp/>&lt;<sp/>1)</highlight></codeline>
<codeline lineno="2340"><highlight class="normal"><sp/><sp/><sp/><sp/>segments<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2341"><highlight class="normal"><sp/><sp/>blobs_per_segment<sp/>=<sp/>blobcount<sp/>/<sp/>segments;</highlight></codeline>
<codeline lineno="2342"><highlight class="normal"><sp/><sp/>coeffs<sp/>=<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*)<sp/><ref refid="memry_8cpp_1a4c14b091498fb7866a1dd0af51a591fe" kindref="member">alloc_mem</ref><sp/>(segments<sp/>*<sp/>3<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="2343"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(textord_oldbl_debug)</highlight></codeline>
<codeline lineno="2344"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref></highlight></codeline>
<codeline lineno="2345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&quot;Linear<sp/>splining<sp/>baseline<sp/>of<sp/>%d<sp/>blobs<sp/>at<sp/>(%d,%d),<sp/>into<sp/>%d<sp/>segments<sp/>of<sp/>%d<sp/>blobs\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blobcount,<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>(),<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref><sp/>(),<sp/>segments,<sp/>blobs_per_segment);</highlight></codeline>
<codeline lineno="2347"><highlight class="normal"><sp/><sp/>segment<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="2348"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(index2<sp/>=<sp/>0;<sp/>index2<sp/>&lt;<sp/>blobs_per_segment<sp/>/<sp/>2;<sp/>index2++)</highlight></codeline>
<codeline lineno="2349"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="blobbox_8cpp_1a3728c3433d1e8f6a2178bb796aa21fad" kindref="member">box_next_pre_chopped</ref>(&amp;new_it);</highlight></codeline>
<codeline lineno="2350"><highlight class="normal"><sp/><sp/>index1<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2351"><highlight class="normal"><sp/><sp/>blobindex<sp/>=<sp/>index2;</highlight></codeline>
<codeline lineno="2352"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2353"><highlight class="normal"><sp/><sp/><sp/><sp/>blobindex<sp/>+=<sp/>blobs_per_segment;</highlight></codeline>
<codeline lineno="2354"><highlight class="normal"><sp/><sp/><sp/><sp/>lms.<ref refid="classtesseract_1_1_det_line_fit_1a97c074bfc1d7106ddda618ea8cf45ff7" kindref="member">Clear</ref>();</highlight></codeline>
<codeline lineno="2355"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(index1<sp/>&lt;<sp/>blobindex<sp/>||<sp/>(segment<sp/>==<sp/>segments<sp/>&amp;&amp;<sp/>index1<sp/>&lt;<sp/>blobcount))<sp/>{</highlight></codeline>
<codeline lineno="2356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>box<sp/>=<sp/><ref refid="blobbox_8cpp_1a3728c3433d1e8f6a2178bb796aa21fad" kindref="member">box_next_pre_chopped</ref><sp/>(&amp;blob_it);</highlight></codeline>
<codeline lineno="2357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>middle<sp/>=<sp/>(box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>+<sp/>box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>())<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="2358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>lms.<ref refid="classtesseract_1_1_det_line_fit_1a4eba2b6e761080e5d1a48c9c797257b2" kindref="member">Add</ref>(<ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref>(middle,<sp/>box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>()));</highlight></codeline>
<codeline lineno="2359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>index1++;</highlight></codeline>
<codeline lineno="2360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(index1<sp/>==<sp/>blobindex<sp/>-<sp/>blobs_per_segment<sp/>/<sp/>2</highlight></codeline>
<codeline lineno="2361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>index1<sp/>==<sp/>blobcount<sp/>-<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="2362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xstarts[segment]<sp/>=<sp/>box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>();</highlight></codeline>
<codeline lineno="2363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2364"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2365"><highlight class="normal"><sp/><sp/><sp/><sp/>lms.<ref refid="classtesseract_1_1_det_line_fit_1a768ec4a8f90593d8d679981c873f7a56" kindref="member">Fit</ref>(&amp;b,<sp/>&amp;c);</highlight></codeline>
<codeline lineno="2366"><highlight class="normal"><sp/><sp/><sp/><sp/>coeffs[segment<sp/>*<sp/>3<sp/>-<sp/>3]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2367"><highlight class="normal"><sp/><sp/><sp/><sp/>coeffs[segment<sp/>*<sp/>3<sp/>-<sp/>2]<sp/>=<sp/>b;</highlight></codeline>
<codeline lineno="2368"><highlight class="normal"><sp/><sp/><sp/><sp/>coeffs[segment<sp/>*<sp/>3<sp/>-<sp/>1]<sp/>=<sp/>c;</highlight></codeline>
<codeline lineno="2369"><highlight class="normal"><sp/><sp/><sp/><sp/>segment++;</highlight></codeline>
<codeline lineno="2370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(segment<sp/>&gt;<sp/>segments)</highlight></codeline>
<codeline lineno="2371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2372"><highlight class="normal"></highlight></codeline>
<codeline lineno="2373"><highlight class="normal"><sp/><sp/><sp/><sp/>blobindex<sp/>+=<sp/>blobs_per_segment;</highlight></codeline>
<codeline lineno="2374"><highlight class="normal"><sp/><sp/><sp/><sp/>lms.<ref refid="classtesseract_1_1_det_line_fit_1a97c074bfc1d7106ddda618ea8cf45ff7" kindref="member">Clear</ref>();</highlight></codeline>
<codeline lineno="2375"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(index2<sp/>&lt;<sp/>blobindex<sp/>||<sp/>(segment<sp/>==<sp/>segments<sp/>&amp;&amp;<sp/>index2<sp/>&lt;<sp/>blobcount))<sp/>{</highlight></codeline>
<codeline lineno="2376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>new_box<sp/>=<sp/><ref refid="blobbox_8cpp_1a3728c3433d1e8f6a2178bb796aa21fad" kindref="member">box_next_pre_chopped</ref><sp/>(&amp;new_it);</highlight></codeline>
<codeline lineno="2377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>middle<sp/>=<sp/>(new_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref>()<sp/>+<sp/>new_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref>())<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="2378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>lms.<ref refid="classtesseract_1_1_det_line_fit_1a4eba2b6e761080e5d1a48c9c797257b2" kindref="member">Add</ref>(<ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref><sp/>(middle,<sp/>new_box.<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref>()));</highlight></codeline>
<codeline lineno="2379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>index2++;</highlight></codeline>
<codeline lineno="2380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(index2<sp/>==<sp/>blobindex<sp/>-<sp/>blobs_per_segment<sp/>/<sp/>2</highlight></codeline>
<codeline lineno="2381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>index2<sp/>==<sp/>blobcount<sp/>-<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="2382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xstarts[segment]<sp/>=<sp/>new_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>();</highlight></codeline>
<codeline lineno="2383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2384"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2385"><highlight class="normal"><sp/><sp/><sp/><sp/>lms.<ref refid="classtesseract_1_1_det_line_fit_1a768ec4a8f90593d8d679981c873f7a56" kindref="member">Fit</ref>(&amp;b,<sp/>&amp;c);</highlight></codeline>
<codeline lineno="2386"><highlight class="normal"><sp/><sp/><sp/><sp/>coeffs[segment<sp/>*<sp/>3<sp/>-<sp/>3]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2387"><highlight class="normal"><sp/><sp/><sp/><sp/>coeffs[segment<sp/>*<sp/>3<sp/>-<sp/>2]<sp/>=<sp/>b;</highlight></codeline>
<codeline lineno="2388"><highlight class="normal"><sp/><sp/><sp/><sp/>coeffs[segment<sp/>*<sp/>3<sp/>-<sp/>1]<sp/>=<sp/>c;</highlight></codeline>
<codeline lineno="2389"><highlight class="normal"><sp/><sp/><sp/><sp/>segment++;</highlight></codeline>
<codeline lineno="2390"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2391"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(segment<sp/>&lt;=<sp/>segments);</highlight></codeline>
<codeline lineno="2392"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>coeffs;</highlight></codeline>
<codeline lineno="2393"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2394"><highlight class="normal"></highlight></codeline>
<codeline lineno="2395"><highlight class="normal"></highlight></codeline>
<codeline lineno="2402"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1af9d632b1a85d2d92bbd0597b76ba026d" kindref="member">assign_blobs_to_rows</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>lines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___b_l_o_c_k" kindref="compound">TO_BLOCK</ref><sp/>*block,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//block<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>*gradient,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//block<sp/>skew</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>pass,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//identification</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>reject_misses,<sp/><sp/></highlight><highlight class="comment">//chuck<sp/>big<sp/>ones<sp/>out</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>make_new_rows,<sp/><sp/></highlight><highlight class="comment">//add<sp/>rows<sp/>for<sp/>unmatched</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>drawing_skew<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//draw<sp/>smoothed<sp/>skew</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2410"><highlight class="normal"><sp/><sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fd" kindref="member">OVERLAP_STATE</ref><sp/>overlap_result;<sp/><sp/></highlight><highlight class="comment">//what<sp/>to<sp/>do<sp/>with<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2411"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>ycoord;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>y</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2412"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>top,<sp/>bottom;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2413"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>g_length<sp/>=<sp/>1.0f;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//from<sp/>gradient</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2414"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>row_count;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//no<sp/>of<sp/>rows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2415"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>left_x;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//left<sp/>edge</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2416"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>last_x;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//previous<sp/>edge</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2417"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>block_skew;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//y<sp/>delta</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2418"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>smooth_factor;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>new<sp/>coords</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2419"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>near_dist;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//dist<sp/>to<sp/>nearest<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2420"><highlight class="normal"><sp/><sp/><ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref><sp/>testpt;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//testing<sp/>only</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2421"><highlight class="normal"><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>*blob;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2422"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2423"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*dest_row<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//row<sp/>to<sp/>put<sp/>blob<sp/>in</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//iterators</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2425"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it<sp/>=<sp/>&amp;block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a5dd67c54162a6b60b0fd11500d4a3025" kindref="member">blobs</ref>;</highlight></codeline>
<codeline lineno="2426"><highlight class="normal"><sp/><sp/>TO_ROW_IT<sp/>row_it<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a4846ebdcc832b4b0a762d87c0d83a056" kindref="member">get_rows</ref><sp/>();</highlight></codeline>
<codeline lineno="2427"><highlight class="normal"></highlight></codeline>
<codeline lineno="2428"><highlight class="normal"><sp/><sp/>ycoord<sp/>=</highlight></codeline>
<codeline lineno="2429"><highlight class="normal"><sp/><sp/><sp/><sp/>(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a16e698664028b0d6d2193db64560c16b" kindref="member">block</ref>-&gt;<ref refid="class_p_d_b_l_k_1a91950a96127b4a0bb9b237e1f5f889a4" kindref="member" tooltip="get box ">bounding_box</ref><sp/>().bottom<sp/>()<sp/>+</highlight></codeline>
<codeline lineno="2430"><highlight class="normal"><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a16e698664028b0d6d2193db64560c16b" kindref="member">block</ref>-&gt;<ref refid="class_p_d_b_l_k_1a91950a96127b4a0bb9b237e1f5f889a4" kindref="member" tooltip="get box ">bounding_box</ref><sp/>().top<sp/>())<sp/>/<sp/>2.0<ref refid="imgscale_8cpp_1a469169df397b589e709dc744f1346831" kindref="member">f</ref>;</highlight></codeline>
<codeline lineno="2431"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(gradient<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="2432"><highlight class="normal"><sp/><sp/><sp/><sp/>g_length<sp/>=<sp/>sqrt<sp/>(1<sp/>+<sp/>*gradient<sp/>*<sp/>*gradient);</highlight></codeline>
<codeline lineno="2433"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="2434"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(drawing_skew)</highlight></codeline>
<codeline lineno="2435"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref>-&gt;<ref refid="class_scroll_view_1a730b182e350dfe37b0986d7f0591fee5" kindref="member">SetCursor</ref>(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a16e698664028b0d6d2193db64560c16b" kindref="member">block</ref>-&gt;<ref refid="class_p_d_b_l_k_1a91950a96127b4a0bb9b237e1f5f889a4" kindref="member" tooltip="get box ">bounding_box</ref><sp/>().left<sp/>(),<sp/>ycoord);</highlight></codeline>
<codeline lineno="2436"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="2437"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/>testpt<sp/>=<sp/><ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref><sp/>(textord_test_x,<sp/>textord_test_y);</highlight></codeline>
<codeline lineno="2438"><highlight class="normal"><sp/><sp/>blob_it.sort<sp/>(<ref refid="makerow_8cpp_1a71e57df4cbaf6a0d8fb156f0604d1033" kindref="member">blob_x_order</ref>);</highlight></codeline>
<codeline lineno="2439"><highlight class="normal"><sp/><sp/>smooth_factor<sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="2440"><highlight class="normal"><sp/><sp/>block_skew<sp/>=<sp/>0.0f;</highlight></codeline>
<codeline lineno="2441"><highlight class="normal"><sp/><sp/>row_count<sp/>=<sp/>row_it.length<sp/>();<sp/><sp/></highlight><highlight class="comment">//might<sp/>have<sp/>rows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2442"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!blob_it.empty<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2443"><highlight class="normal"><sp/><sp/><sp/><sp/>left_x<sp/>=<sp/>blob_it.data<sp/>()-&gt;bounding_box<sp/>().left<sp/>();</highlight></codeline>
<codeline lineno="2444"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2445"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2446"><highlight class="normal"><sp/><sp/><sp/><sp/>left_x<sp/>=<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1a16e698664028b0d6d2193db64560c16b" kindref="member">block</ref>-&gt;<ref refid="class_p_d_b_l_k_1a91950a96127b4a0bb9b237e1f5f889a4" kindref="member" tooltip="get box ">bounding_box</ref><sp/>().left<sp/>();</highlight></codeline>
<codeline lineno="2447"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2448"><highlight class="normal"><sp/><sp/>last_x<sp/>=<sp/>left_x;</highlight></codeline>
<codeline lineno="2449"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(blob_it.mark_cycle_pt<sp/>();<sp/>!blob_it.cycled_list<sp/>();<sp/>blob_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2450"><highlight class="normal"><sp/><sp/><sp/><sp/>blob<sp/>=<sp/>blob_it.data<sp/>();</highlight></codeline>
<codeline lineno="2451"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(gradient<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>block_skew<sp/>=<sp/>(1<sp/>-<sp/>1<sp/>/<sp/>g_length)<sp/>*<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref><sp/>()</highlight></codeline>
<codeline lineno="2453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>*gradient<sp/>/<sp/>g_length<sp/>*<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>();</highlight></codeline>
<codeline lineno="2454"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2455"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>()<sp/>-<sp/>last_x<sp/>&gt;<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>/<sp/>2</highlight></codeline>
<codeline lineno="2456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>last_x<sp/>-<sp/>left_x<sp/>&gt;<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref><sp/>*<sp/>2</highlight></codeline>
<codeline lineno="2457"><highlight class="normal"><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>textord_interpolating_skew)<sp/>{</highlight></codeline>
<codeline lineno="2458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tprintf(&quot;Interpolating<sp/>skew<sp/>from<sp/>%g&quot;,block_skew);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>block_skew<sp/>*=<sp/>(float)<sp/>(blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>()<sp/>-<sp/>left_x)</highlight></codeline>
<codeline lineno="2460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/<sp/>(last_x<sp/>-<sp/>left_x);</highlight></codeline>
<codeline lineno="2461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tprintf(&quot;to<sp/>%g\n&quot;,block_skew);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2462"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2463"><highlight class="normal"><sp/><sp/><sp/><sp/>last_x<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>();</highlight></codeline>
<codeline lineno="2464"><highlight class="normal"><sp/><sp/><sp/><sp/>top<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1adf92e9fdac1bdf11c10d1c4d1178791a" kindref="member">top</ref><sp/>()<sp/>-<sp/>block_skew;</highlight></codeline>
<codeline lineno="2465"><highlight class="normal"><sp/><sp/><sp/><sp/>bottom<sp/>=<sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref><sp/>()<sp/>-<sp/>block_skew;</highlight></codeline>
<codeline lineno="2466"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>GRAPHICS_DISABLED</highlight></codeline>
<codeline lineno="2467"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(drawing_skew)</highlight></codeline>
<codeline lineno="2468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="drawtord_8cpp_1a262d35f0a34031a666b9ae158eb9f01f" kindref="member">to_win</ref>-&gt;<ref refid="class_scroll_view_1a101de80a4722fe821969f61f6e7303a6" kindref="member">DrawTo</ref>(blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>(),<sp/>ycoord<sp/>+<sp/>block_skew);</highlight></codeline>
<codeline lineno="2469"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="2470"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!row_it.empty<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.move_to_first<sp/>();</highlight></codeline>
<codeline lineno="2472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!row_it.at_last<sp/>()<sp/>&amp;&amp;<sp/>row_it.data<sp/>()-&gt;min_y<sp/>()<sp/>&gt;<sp/>top;</highlight></codeline>
<codeline lineno="2473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.forward<sp/>());</highlight></codeline>
<codeline lineno="2474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row<sp/>=<sp/>row_it.data<sp/>();</highlight></codeline>
<codeline lineno="2475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>()<sp/>&lt;=<sp/>top<sp/>&amp;&amp;<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>()<sp/>&gt;=<sp/>bottom)<sp/>{</highlight></codeline>
<codeline lineno="2476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//any<sp/>overlap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dest_row<sp/>=<sp/>row;</highlight></codeline>
<codeline lineno="2478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overlap_result<sp/>=<sp/><ref refid="makerow_8cpp_1a5aa796bc0402dec5d9ca2ea4a8b551a1" kindref="member">most_overlapping_row</ref><sp/>(&amp;row_it,<sp/>dest_row,</highlight></codeline>
<codeline lineno="2479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>top,<sp/>bottom,</highlight></codeline>
<codeline lineno="2480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>,</highlight></codeline>
<codeline lineno="2481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().</highlight></codeline>
<codeline lineno="2482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contains<sp/>(testpt));</highlight></codeline>
<codeline lineno="2483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(overlap_result<sp/>==<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fdab82f810c0bfdbb5cc6419a4bcea46404" kindref="member">NEW_ROW</ref><sp/>&amp;&amp;<sp/>!reject_misses)</highlight></codeline>
<codeline lineno="2484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overlap_result<sp/>=<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fda52a9b031766fa116251f70e65a84c01a" kindref="member">ASSIGN</ref>;</highlight></codeline>
<codeline lineno="2485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overlap_result<sp/>=<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fdab82f810c0bfdbb5cc6419a4bcea46404" kindref="member">NEW_ROW</ref>;</highlight></codeline>
<codeline lineno="2488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!make_new_rows)<sp/>{</highlight></codeline>
<codeline lineno="2489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>near_dist<sp/>=<sp/>row_it.data_relative<sp/>(-1)-&gt;min_y<sp/>()<sp/>-<sp/>top;</highlight></codeline>
<codeline lineno="2490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//below<sp/>bottom</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bottom<sp/>&lt;<sp/>row-&gt;min_y<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>()<sp/>-<sp/>bottom<sp/>&lt;=</highlight></codeline>
<codeline lineno="2493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref><sp/>-</highlight></codeline>
<codeline lineno="2494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>)<sp/>*<sp/>tesseract::CCStruct::kDescenderFraction)<sp/>{</highlight></codeline>
<codeline lineno="2495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//done<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overlap_result<sp/>=<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fda52a9b031766fa116251f70e65a84c01a" kindref="member">ASSIGN</ref>;</highlight></codeline>
<codeline lineno="2497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dest_row<sp/>=<sp/>row;</highlight></codeline>
<codeline lineno="2498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(near_dist<sp/>&gt;<sp/>0</highlight></codeline>
<codeline lineno="2501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>near_dist<sp/>&lt;<sp/>bottom<sp/>-<sp/>row-&gt;max_y<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.backward<sp/>();</highlight></codeline>
<codeline lineno="2503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dest_row<sp/>=<sp/>row_it.data<sp/>();</highlight></codeline>
<codeline lineno="2504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dest_row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>()<sp/>-<sp/>bottom<sp/>&lt;=</highlight></codeline>
<codeline lineno="2505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref><sp/>-</highlight></codeline>
<codeline lineno="2506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>)<sp/>*<sp/>tesseract::CCStruct::kDescenderFraction)<sp/>{</highlight></codeline>
<codeline lineno="2507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//done<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overlap_result<sp/>=<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fda52a9b031766fa116251f70e65a84c01a" kindref="member">ASSIGN</ref>;</highlight></codeline>
<codeline lineno="2509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(top<sp/>-<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>()<sp/>&lt;=</highlight></codeline>
<codeline lineno="2513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ac17b9c95641b2eebee9d972338c2e5f6" kindref="member">line_spacing</ref><sp/>-</highlight></codeline>
<codeline lineno="2514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>)<sp/>*<sp/>(textord_overlap_x<sp/>+</highlight></codeline>
<codeline lineno="2515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classtesseract_1_1_c_c_struct_1a9d71fddad74d9418e106713cd643b919" kindref="member">tesseract::CCStruct::kAscenderFraction</ref>))<sp/>{</highlight></codeline>
<codeline lineno="2516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//done<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overlap_result<sp/>=<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fda52a9b031766fa116251f70e65a84c01a" kindref="member">ASSIGN</ref>;</highlight></codeline>
<codeline lineno="2518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dest_row<sp/>=<sp/>row;</highlight></codeline>
<codeline lineno="2519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(overlap_result<sp/>==<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fda52a9b031766fa116251f70e65a84c01a" kindref="member">ASSIGN</ref>)</highlight></codeline>
<codeline lineno="2524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dest_row-&gt;<ref refid="class_t_o___r_o_w_1a0173e9da64e4f2d29f01da14c3a053ee" kindref="member">add_blob</ref><sp/>(blob_it.extract<sp/>(),<sp/>top,<sp/>bottom,</highlight></codeline>
<codeline lineno="2525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>);</highlight></codeline>
<codeline lineno="2526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(overlap_result<sp/>==<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fdab82f810c0bfdbb5cc6419a4bcea46404" kindref="member">NEW_ROW</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(make_new_rows<sp/>&amp;&amp;<sp/>top<sp/>-<sp/>bottom<sp/>&lt;<sp/>block-&gt;max_blob_size)<sp/>{</highlight></codeline>
<codeline lineno="2528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dest_row<sp/>=</highlight></codeline>
<codeline lineno="2529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>(blob_it.extract<sp/>(),<sp/>top,<sp/>bottom,</highlight></codeline>
<codeline lineno="2530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>);</highlight></codeline>
<codeline lineno="2531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_count++;</highlight></codeline>
<codeline lineno="2532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bottom<sp/>&gt;<sp/>row_it.data<sp/>()-&gt;min_y<sp/>())</highlight></codeline>
<codeline lineno="2533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.add_before_then_move<sp/>(dest_row);</highlight></codeline>
<codeline lineno="2534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//insert<sp/>in<sp/>right<sp/>place</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.add_after_then_move<sp/>(dest_row);</highlight></codeline>
<codeline lineno="2537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>smooth_factor<sp/>=</highlight></codeline>
<codeline lineno="2538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.0<sp/>/<sp/>(row_count<sp/>*<sp/>textord_skew_lag<sp/>+</highlight></codeline>
<codeline lineno="2539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>textord_skewsmooth_offset);</highlight></codeline>
<codeline lineno="2540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overlap_result<sp/>=<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fdaa698e39adf684fd44b5572a7b89444fb" kindref="member">REJECT</ref>;</highlight></codeline>
<codeline lineno="2543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2544"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2545"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(make_new_rows<sp/>&amp;&amp;<sp/>top<sp/>-<sp/>bottom<sp/>&lt;<sp/>block-&gt;max_blob_size)<sp/>{</highlight></codeline>
<codeline lineno="2546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>overlap_result<sp/>=<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fdab82f810c0bfdbb5cc6419a4bcea46404" kindref="member">NEW_ROW</ref>;</highlight></codeline>
<codeline lineno="2547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>dest_row<sp/>=</highlight></codeline>
<codeline lineno="2548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>(blob_it.extract<sp/>(),<sp/>top,<sp/>bottom,<sp/>block-&gt;<ref refid="class_t_o___b_l_o_c_k_1ab106233da0599f3e1595c1c765acadec" kindref="member">line_size</ref>);</highlight></codeline>
<codeline lineno="2549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_count++;</highlight></codeline>
<codeline lineno="2550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_it.add_after_then_move<sp/>(dest_row);</highlight></codeline>
<codeline lineno="2551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>smooth_factor<sp/>=<sp/>1.0<sp/>/<sp/>(row_count<sp/>*<sp/>textord_skew_lag<sp/>+</highlight></codeline>
<codeline lineno="2552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>textord_skewsmooth_offset2);</highlight></codeline>
<codeline lineno="2553"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2554"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>overlap_result<sp/>=<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fdaa698e39adf684fd44b5572a7b89444fb" kindref="member">REJECT</ref>;</highlight></codeline>
<codeline lineno="2556"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1a5d4e2c5f91b791e94d4c94e513180632" kindref="member">contains</ref><sp/>(testpt))<sp/>{</highlight></codeline>
<codeline lineno="2557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(overlap_result<sp/>!=<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fdaa698e39adf684fd44b5572a7b89444fb" kindref="member">REJECT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;Test<sp/>blob<sp/>assigned<sp/>to<sp/>row<sp/>at<sp/>(%g,%g)<sp/>on<sp/>pass<sp/>%d\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dest_row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>(),<sp/>dest_row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>(),<sp/>pass);</highlight></codeline>
<codeline lineno="2560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;Test<sp/>blob<sp/>assigned<sp/>to<sp/>no<sp/>row<sp/>on<sp/>pass<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>pass);</highlight></codeline>
<codeline lineno="2563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2564"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2565"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(overlap_result<sp/>!=<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fdaa698e39adf684fd44b5572a7b89444fb" kindref="member">REJECT</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!row_it.at_first<sp/>()</highlight></codeline>
<codeline lineno="2567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>row_it.data<sp/>()-&gt;min_y<sp/>()<sp/>&gt;</highlight></codeline>
<codeline lineno="2568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_it.data_relative<sp/>(-1)-&gt;min_y<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row<sp/>=<sp/>row_it.extract<sp/>();</highlight></codeline>
<codeline lineno="2570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.backward<sp/>();</highlight></codeline>
<codeline lineno="2571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.add_before_then_move<sp/>(row);</highlight></codeline>
<codeline lineno="2572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!row_it.at_last<sp/>()</highlight></codeline>
<codeline lineno="2574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>row_it.data<sp/>()-&gt;min_y<sp/>()<sp/>&lt;</highlight></codeline>
<codeline lineno="2575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_it.data_relative<sp/>(1)-&gt;min_y<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row<sp/>=<sp/>row_it.extract<sp/>();</highlight></codeline>
<codeline lineno="2577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.forward<sp/>();</highlight></codeline>
<codeline lineno="2578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//keep<sp/>rows<sp/>in<sp/>order</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it.add_after_then_move<sp/>(row);</highlight></codeline>
<codeline lineno="2580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>block_skew<sp/>=<sp/>(1<sp/>-<sp/>smooth_factor)<sp/>*<sp/>block_skew</highlight></codeline>
<codeline lineno="2582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>smooth_factor<sp/>*<sp/>(blob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1a4451d237f1cd18c4982d63fe36a11fc3" kindref="member">bottom</ref><sp/>()<sp/>-</highlight></codeline>
<codeline lineno="2583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dest_row-&gt;<ref refid="class_t_o___r_o_w_1a5aea8d905e2f034e7c7e75195b81fac9" kindref="member">initial_min_y</ref><sp/>());</highlight></codeline>
<codeline lineno="2584"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2585"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2586"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(row_it.mark_cycle_pt<sp/>();<sp/>!row_it.cycled_list<sp/>();<sp/>row_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2587"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row_it.data<sp/>()-&gt;blob_list<sp/>()-&gt;empty<sp/>())</highlight></codeline>
<codeline lineno="2588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>row_it.extract<sp/>();<sp/><sp/></highlight><highlight class="comment">//discard<sp/>empty<sp/>rows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2589"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2590"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2591"><highlight class="normal"></highlight></codeline>
<codeline lineno="2592"><highlight class="normal"></highlight></codeline>
<codeline lineno="2598"><highlight class="normal"><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fd" kindref="member">OVERLAP_STATE</ref><sp/><ref refid="makerow_8cpp_1a5aa796bc0402dec5d9ca2ea4a8b551a1" kindref="member">most_overlapping_row</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>best<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TO_ROW_IT<sp/>*row_it,<sp/><sp/></highlight><highlight class="comment">//iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*&amp;best_row,<sp/><sp/></highlight><highlight class="comment">//output<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>top,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//top<sp/>of<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>bottom,<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//bottom<sp/>of<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>rowsize,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//max<sp/>row<sp/>size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>testing_blob<sp/><sp/></highlight><highlight class="comment">//test<sp/>stuff</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2606"><highlight class="normal"><sp/><sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fd" kindref="member">OVERLAP_STATE</ref><sp/>result;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//result<sp/>of<sp/>tests</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2607"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>overlap;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>blob<sp/>&amp;<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2608"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>bestover;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//nearest<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2609"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>merge_top,<sp/>merge_bottom;<sp/></highlight><highlight class="comment">//size<sp/>of<sp/>merged<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2610"><highlight class="normal"><sp/><sp/><ref refid="class_i_c_o_o_r_d" kindref="compound" tooltip="integer coordinate ">ICOORD</ref><sp/>testpt;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//testing<sp/>only</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2611"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2612"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*test_row;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>multiple<sp/>overlaps</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2613"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>blob_it;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>merging<sp/>rows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2614"><highlight class="normal"></highlight></codeline>
<codeline lineno="2615"><highlight class="normal"><sp/><sp/>result<sp/>=<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fda52a9b031766fa116251f70e65a84c01a" kindref="member">ASSIGN</ref>;</highlight></codeline>
<codeline lineno="2616"><highlight class="normal"><sp/><sp/>row<sp/>=<sp/>row_it-&gt;data<sp/>();</highlight></codeline>
<codeline lineno="2617"><highlight class="normal"><sp/><sp/>bestover<sp/>=<sp/>top<sp/>-<sp/>bottom;</highlight></codeline>
<codeline lineno="2618"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(top<sp/>&gt;<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>())</highlight></codeline>
<codeline lineno="2619"><highlight class="normal"><sp/><sp/><sp/><sp/>bestover<sp/>-=<sp/>top<sp/>-<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>();</highlight></codeline>
<codeline lineno="2620"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bottom<sp/>&lt;<sp/>row-&gt;min_y<sp/>())</highlight></codeline>
<codeline lineno="2621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//compute<sp/>overlap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2622"><highlight class="normal"><sp/><sp/><sp/><sp/>bestover<sp/>-=<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>()<sp/>-<sp/>bottom;</highlight></codeline>
<codeline lineno="2623"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_blob)<sp/>{</highlight></codeline>
<codeline lineno="2624"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;Test<sp/>blob<sp/>y=(%g,%g),<sp/>row=(%f,%f),<sp/>overlap=%f\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bottom,<sp/>top,<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>(),<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>(),<sp/>bestover);</highlight></codeline>
<codeline lineno="2626"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2627"><highlight class="normal"><sp/><sp/>test_row<sp/>=<sp/>row;</highlight></codeline>
<codeline lineno="2628"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2629"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!row_it-&gt;at_last<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="2630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>row_it-&gt;forward<sp/>();</highlight></codeline>
<codeline lineno="2631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>test_row<sp/>=<sp/>row_it-&gt;data<sp/>();</highlight></codeline>
<codeline lineno="2632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(test_row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>()<sp/>&lt;=<sp/>top<sp/>&amp;&amp;<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>()<sp/>&gt;=<sp/>bottom)<sp/>{</highlight></codeline>
<codeline lineno="2633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>merge_top<sp/>=</highlight></codeline>
<codeline lineno="2634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>()<sp/>&gt;</highlight></codeline>
<codeline lineno="2635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>()?<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>()<sp/>:<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>();</highlight></codeline>
<codeline lineno="2636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>merge_bottom<sp/>=</highlight></codeline>
<codeline lineno="2637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>()<sp/>&lt;</highlight></codeline>
<codeline lineno="2638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>()?<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>()<sp/>:<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>();</highlight></codeline>
<codeline lineno="2639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(merge_top<sp/>-<sp/>merge_bottom<sp/>&lt;=<sp/>rowsize)<sp/>{</highlight></codeline>
<codeline lineno="2640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_blob)<sp/>{</highlight></codeline>
<codeline lineno="2641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;Merging<sp/>rows<sp/>at<sp/>(%g,%g),<sp/>(%g,%g)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>(),<sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>(),</highlight></codeline>
<codeline lineno="2643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>(),<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>());</highlight></codeline>
<codeline lineno="2644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1a5a5bfd657e97c2fed2cf6153eca0e98a" kindref="member">set_limits</ref><sp/>(merge_bottom,<sp/>merge_top);</highlight></codeline>
<codeline lineno="2646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.set_to_list<sp/>(test_row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref><sp/>());</highlight></codeline>
<codeline lineno="2647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.add_list_after<sp/>(row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref><sp/>());</highlight></codeline>
<codeline lineno="2648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_it.sort<sp/>(<ref refid="makerow_8cpp_1a71e57df4cbaf6a0d8fb156f0604d1033" kindref="member">blob_x_order</ref>);</highlight></codeline>
<codeline lineno="2649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it-&gt;backward<sp/>();</highlight></codeline>
<codeline lineno="2650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>row_it-&gt;extract<sp/>();</highlight></codeline>
<codeline lineno="2651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row_it-&gt;forward<sp/>();</highlight></codeline>
<codeline lineno="2652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bestover<sp/>=<sp/>-1.0f;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//force<sp/>replacement</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overlap<sp/>=<sp/>top<sp/>-<sp/>bottom;</highlight></codeline>
<codeline lineno="2655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(top<sp/>&gt;<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>())</highlight></codeline>
<codeline lineno="2656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overlap<sp/>-=<sp/>top<sp/>-<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>();</highlight></codeline>
<codeline lineno="2657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bottom<sp/>&lt;<sp/>test_row-&gt;min_y<sp/>())</highlight></codeline>
<codeline lineno="2658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overlap<sp/>-=<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>()<sp/>-<sp/>bottom;</highlight></codeline>
<codeline lineno="2659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bestover<sp/>&gt;=<sp/>rowsize<sp/>-<sp/>1<sp/>&amp;&amp;<sp/>overlap<sp/>&gt;=<sp/>rowsize<sp/>-<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="2660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fdaa698e39adf684fd44b5572a7b89444fb" kindref="member">REJECT</ref>;</highlight></codeline>
<codeline lineno="2661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(overlap<sp/>&gt;<sp/>bestover)<sp/>{</highlight></codeline>
<codeline lineno="2663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bestover<sp/>=<sp/>overlap;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>biggest<sp/>overlap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row<sp/>=<sp/>test_row;</highlight></codeline>
<codeline lineno="2665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(testing_blob)<sp/>{</highlight></codeline>
<codeline lineno="2667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref></highlight></codeline>
<codeline lineno="2668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&quot;Test<sp/>blob<sp/>y=(%g,%g),<sp/>row=(%f,%f),<sp/>overlap=%f-&gt;%f\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bottom,<sp/>top,<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>(),<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>(),</highlight></codeline>
<codeline lineno="2670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overlap,<sp/>bestover);</highlight></codeline>
<codeline lineno="2671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2673"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2674"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2675"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!row_it-&gt;at_last<sp/>()</highlight></codeline>
<codeline lineno="2676"><highlight class="normal"><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1ad00c86bd684bd454b57bc3bf2b9d0680" kindref="member">min_y</ref><sp/>()<sp/>&lt;=<sp/>top<sp/>&amp;&amp;<sp/>test_row-&gt;<ref refid="class_t_o___r_o_w_1a99b13776064db8791dd9d9f8cd9749ee" kindref="member">max_y</ref><sp/>()<sp/>&gt;=<sp/>bottom);</highlight></codeline>
<codeline lineno="2677"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(row_it-&gt;data<sp/>()<sp/>!=<sp/>row)</highlight></codeline>
<codeline lineno="2678"><highlight class="normal"><sp/><sp/><sp/><sp/>row_it-&gt;backward<sp/>();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//make<sp/>it<sp/>point<sp/>to<sp/>row</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//doesn&apos;t<sp/>overlap<sp/>much</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2680"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(top<sp/>-<sp/>bottom<sp/>-<sp/>bestover<sp/>&gt;<sp/>rowsize<sp/>*<sp/>textord_overlap_x<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="2681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>(!textord_fix_makerow_bug<sp/>||<sp/>bestover<sp/>&lt;<sp/>rowsize<sp/>*<sp/>textord_overlap_x)</highlight></codeline>
<codeline lineno="2682"><highlight class="normal"><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>result<sp/>==<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fda52a9b031766fa116251f70e65a84c01a" kindref="member">ASSIGN</ref>)</highlight></codeline>
<codeline lineno="2683"><highlight class="normal"><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="makerow_8h_1abcb4220d5ed91090720f14d9d670c3fdab82f810c0bfdbb5cc6419a4bcea46404" kindref="member">NEW_ROW</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//doesn&apos;t<sp/>overlap<sp/>enough</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2684"><highlight class="normal"><sp/><sp/>best_row<sp/>=<sp/>row;</highlight></codeline>
<codeline lineno="2685"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline lineno="2686"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2687"><highlight class="normal"></highlight></codeline>
<codeline lineno="2688"><highlight class="normal"></highlight></codeline>
<codeline lineno="2694"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a71e57df4cbaf6a0d8fb156f0604d1033" kindref="member">blob_x_order</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//sort<sp/>function</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*item1,<sp/><sp/></highlight><highlight class="comment">//items<sp/>to<sp/>compare</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*item2)<sp/>{</highlight></codeline>
<codeline lineno="2697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//converted<sp/>ptr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2698"><highlight class="normal"><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>*blob1<sp/>=<sp/>*(<ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>**)<sp/>item1;</highlight></codeline>
<codeline lineno="2699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//converted<sp/>ptr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2700"><highlight class="normal"><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>*blob2<sp/>=<sp/>*(<ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref><sp/>**)<sp/>item2;</highlight></codeline>
<codeline lineno="2701"><highlight class="normal"></highlight></codeline>
<codeline lineno="2702"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blob1-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>()<sp/>&lt;<sp/>blob2-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>())</highlight></codeline>
<codeline lineno="2703"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="2704"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blob1-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>()<sp/>&gt;<sp/>blob2-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a7b97b8bc16b1473a28f9c44011522f4e" kindref="member">bounding_box</ref><sp/>().<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>())</highlight></codeline>
<codeline lineno="2705"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="2706"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2707"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="2708"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2709"><highlight class="normal"></highlight></codeline>
<codeline lineno="2710"><highlight class="normal"></highlight></codeline>
<codeline lineno="2716"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1ab27bf80d814903a9eb48e81b2cc09acc" kindref="member">row_y_order</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//sort<sp/>function</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*item1,<sp/><sp/></highlight><highlight class="comment">//items<sp/>to<sp/>compare</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*item2)<sp/>{</highlight></codeline>
<codeline lineno="2719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//converted<sp/>ptr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2720"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row1<sp/>=<sp/>*(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>**)<sp/>item1;</highlight></codeline>
<codeline lineno="2721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//converted<sp/>ptr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2722"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row2<sp/>=<sp/>*(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>**)<sp/>item2;</highlight></codeline>
<codeline lineno="2723"><highlight class="normal"></highlight></codeline>
<codeline lineno="2724"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row1-&gt;<ref refid="class_t_o___r_o_w_1a81a46c8d6026c157c152778aa9d1ab58" kindref="member">parallel_c</ref><sp/>()<sp/>&gt;<sp/>row2-&gt;<ref refid="class_t_o___r_o_w_1a81a46c8d6026c157c152778aa9d1ab58" kindref="member">parallel_c</ref><sp/>())</highlight></codeline>
<codeline lineno="2725"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="2726"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row1-&gt;<ref refid="class_t_o___r_o_w_1a81a46c8d6026c157c152778aa9d1ab58" kindref="member">parallel_c</ref><sp/>()<sp/>&lt;<sp/>row2-&gt;<ref refid="class_t_o___r_o_w_1a81a46c8d6026c157c152778aa9d1ab58" kindref="member">parallel_c</ref><sp/>())</highlight></codeline>
<codeline lineno="2727"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="2728"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2729"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="2730"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2731"><highlight class="normal"></highlight></codeline>
<codeline lineno="2732"><highlight class="normal"></highlight></codeline>
<codeline lineno="2738"><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1aa3013c07bcccb3f1efeb4686ed340609" kindref="member">row_spacing_order</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//sort<sp/>function</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*item1,<sp/><sp/></highlight><highlight class="comment">//items<sp/>to<sp/>compare</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*item2)<sp/>{</highlight></codeline>
<codeline lineno="2741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//converted<sp/>ptr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2742"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row1<sp/>=<sp/>*(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>**)<sp/>item1;</highlight></codeline>
<codeline lineno="2743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//converted<sp/>ptr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2744"><highlight class="normal"><sp/><sp/><ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row2<sp/>=<sp/>*(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>**)<sp/>item2;</highlight></codeline>
<codeline lineno="2745"><highlight class="normal"></highlight></codeline>
<codeline lineno="2746"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row1-&gt;<ref refid="class_t_o___r_o_w_1a54a1cf2bfa1478d255a8b79f51ca8e59" kindref="member">spacing</ref><sp/>&lt;<sp/>row2-&gt;<ref refid="class_t_o___r_o_w_1a54a1cf2bfa1478d255a8b79f51ca8e59" kindref="member">spacing</ref>)</highlight></codeline>
<codeline lineno="2747"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="2748"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(row1-&gt;<ref refid="class_t_o___r_o_w_1a54a1cf2bfa1478d255a8b79f51ca8e59" kindref="member">spacing</ref><sp/>&gt;<sp/>row2-&gt;<ref refid="class_t_o___r_o_w_1a54a1cf2bfa1478d255a8b79f51ca8e59" kindref="member">spacing</ref>)</highlight></codeline>
<codeline lineno="2749"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="2750"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2751"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="2752"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2753"><highlight class="normal"></highlight></codeline>
<codeline lineno="2760"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="makerow_8cpp_1a20d1c5d4b6ae64bf80b24a155aa7c189" kindref="member">mark_repeated_chars</ref>(<ref refid="class_t_o___r_o_w" kindref="compound">TO_ROW</ref><sp/>*row)<sp/>{</highlight></codeline>
<codeline lineno="2761"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>box_it(row-&gt;<ref refid="class_t_o___r_o_w_1a39cee94572e70d35179c27cdf21a3022" kindref="member">blob_list</ref>());<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Iterator.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2762"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>num_repeated_sets<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2763"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!box_it.empty())<sp/>{</highlight></codeline>
<codeline lineno="2764"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_b_l_o_b_n_b_o_x" kindref="compound">BLOBNBOX</ref>*<sp/>bblob<sp/>=<sp/>box_it.data();</highlight></codeline>
<codeline lineno="2766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>repeat_length<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1afafe7113396a8cc27b882d622db46f05" kindref="member">flow</ref>()<sp/>==<sp/><ref refid="blobbox_8h_1aa72f1499398e9694bf46752e1cc895e1a64e3e70c4fac4d4e3facdb4638307d7f" kindref="member">BTFT_LEADER</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="2768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!bblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1af37f373c72851534101f4caf296a3cf7" kindref="member">joined_to_prev</ref>()<sp/>&amp;&amp;<sp/>bblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a483f44541a4dd818f02225c92f030e07" kindref="member">cblob</ref>()<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BLOBNBOX_IT<sp/>test_it(box_it);</highlight></codeline>
<codeline lineno="2770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(test_it.forward();<sp/>!test_it.at_first();<sp/>test_it.forward())<sp/>{</highlight></codeline>
<codeline lineno="2771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bblob<sp/>=<sp/>test_it.data();</highlight></codeline>
<codeline lineno="2772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1afafe7113396a8cc27b882d622db46f05" kindref="member">flow</ref>()<sp/>!=<sp/><ref refid="blobbox_8h_1aa72f1499398e9694bf46752e1cc895e1a64e3e70c4fac4d4e3facdb4638307d7f" kindref="member">BTFT_LEADER</ref>)</highlight></codeline>
<codeline lineno="2773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1af37f373c72851534101f4caf296a3cf7" kindref="member">joined_to_prev</ref>()<sp/>||<sp/>bblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a483f44541a4dd818f02225c92f030e07" kindref="member">cblob</ref>()<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref>(</highlight><highlight class="stringliteral">&quot;Cancelled<sp/>repeat<sp/>of<sp/>length<sp/>%d<sp/>due<sp/>to<sp/>%s\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>repeat_length,</highlight></codeline>
<codeline lineno="2777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1af37f373c72851534101f4caf296a3cf7" kindref="member">joined_to_prev</ref>()<sp/>?<sp/></highlight><highlight class="stringliteral">&quot;Joined&quot;</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;Null&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>repeat_length<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++repeat_length;</highlight></codeline>
<codeline lineno="2782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(repeat_length<sp/>&gt;=<sp/><ref refid="makerow_8cpp_1ad8c4f2ec0d4f8b83b5dc401f35feca75" kindref="member">kMinLeaderCount</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>num_repeated_sets++;</highlight></codeline>
<codeline lineno="2786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;<sp/>repeat_length<sp/>&gt;<sp/>0;<sp/>box_it.forward(),<sp/>--repeat_length)<sp/>{</highlight></codeline>
<codeline lineno="2787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bblob<sp/>=<sp/>box_it.data();</highlight></codeline>
<codeline lineno="2788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a4c2b662bd87162e3a0de4fe96845a449" kindref="member">set_repeated_set</ref>(num_repeated_sets);</highlight></codeline>
<codeline lineno="2789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!box_it.at_first())</highlight></codeline>
<codeline lineno="2791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a4c2b662bd87162e3a0de4fe96845a449" kindref="member">set_repeated_set</ref>(0);</highlight></codeline>
<codeline lineno="2792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>box_it.forward();</highlight></codeline>
<codeline lineno="2794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bblob-&gt;<ref refid="class_b_l_o_b_n_b_o_x_1a4c2b662bd87162e3a0de4fe96845a449" kindref="member">set_repeated_set</ref>(0);</highlight></codeline>
<codeline lineno="2795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2796"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!box_it.at_first());<sp/><sp/></highlight><highlight class="comment">//<sp/>until<sp/>all<sp/>done</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2797"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2798"><highlight class="normal"><sp/><sp/>row-&gt;<ref refid="class_t_o___r_o_w_1a38c6b27400b2a5ff3ff9f9f9b4b43d69" kindref="member">set_num_repeated_sets</ref>(num_repeated_sets);</highlight></codeline>
<codeline lineno="2799"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/Users/makoto/Desktop/trunk/textord/makerow.cpp"/>
  </compounddef>
</doxygen>
