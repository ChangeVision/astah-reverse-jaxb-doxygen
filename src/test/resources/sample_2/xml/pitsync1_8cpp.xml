<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.4">
  <compounddef id="pitsync1_8cpp" kind="file">
    <compoundname>pitsync1.cpp</compoundname>
    <includes refid="mfcpch_8h" local="yes">mfcpch.h</includes>
    <includes local="no">math.h</includes>
    <includes refid="memry_8h" local="yes">memry.h</includes>
    <includes refid="pitsync1_8h" local="yes">pitsync1.h</includes>
    <includes refid="notdll_8h" local="yes">notdll.h</includes>
    <incdepgraph>
      <node id="38980">
        <label>blobbox.h</label>
        <link refid="blobbox_8h"/>
        <childnode refid="38979" relation="include">
        </childnode>
        <childnode refid="38981" relation="include">
        </childnode>
        <childnode refid="38982" relation="include">
        </childnode>
        <childnode refid="39003" relation="include">
        </childnode>
        <childnode refid="39010" relation="include">
        </childnode>
      </node>
      <node id="38963">
        <label>mfcpch.h</label>
        <link refid="mfcpch_8h"/>
      </node>
      <node id="38987">
        <label>ndminx.h</label>
        <link refid="ndminx_8h"/>
      </node>
      <node id="39010">
        <label>statistc.h</label>
        <link refid="statistc_8h"/>
        <childnode refid="38972" relation="include">
        </childnode>
        <childnode refid="38967" relation="include">
        </childnode>
        <childnode refid="38998" relation="include">
        </childnode>
      </node>
      <node id="38974">
        <label>stdlib.h</label>
      </node>
      <node id="38968">
        <label>platform.h</label>
        <link refid="platform_8h"/>
        <childnode refid="38969" relation="include">
        </childnode>
      </node>
      <node id="38990">
        <label>blckerr.h</label>
        <link refid="blckerr_8h"/>
        <childnode refid="38976" relation="include">
        </childnode>
      </node>
      <node id="38998">
        <label>scrollview.h</label>
        <link refid="scrollview_8h"/>
        <childnode refid="38972" relation="include">
        </childnode>
      </node>
      <node id="39011">
        <label>pithsync.h</label>
        <link refid="pithsync_8h"/>
        <childnode refid="38980" relation="include">
        </childnode>
        <childnode refid="38983" relation="include">
        </childnode>
        <childnode refid="39010" relation="include">
        </childnode>
        <childnode refid="39012" relation="include">
        </childnode>
      </node>
      <node id="38973">
        <label>serialis.h</label>
        <link refid="serialis_8h"/>
        <childnode refid="38974" relation="include">
        </childnode>
        <childnode refid="38975" relation="include">
        </childnode>
        <childnode refid="38972" relation="include">
        </childnode>
        <childnode refid="38965" relation="include">
        </childnode>
        <childnode refid="38976" relation="include">
        </childnode>
        <childnode refid="38977" relation="include">
        </childnode>
      </node>
      <node id="38979">
        <label>clst.h</label>
        <link refid="clst_8h"/>
        <childnode refid="38972" relation="include">
        </childnode>
        <childnode refid="38967" relation="include">
        </childnode>
        <childnode refid="38973" relation="include">
        </childnode>
        <childnode refid="38978" relation="include">
        </childnode>
      </node>
      <node id="38991">
        <label>stepblob.h</label>
        <link refid="stepblob_8h"/>
        <childnode refid="38992" relation="include">
        </childnode>
        <childnode refid="38997" relation="include">
        </childnode>
      </node>
      <node id="38966">
        <label>stddef.h</label>
      </node>
      <node id="38976">
        <label>errcode.h</label>
        <link refid="errcode_8h"/>
        <childnode refid="38967" relation="include">
        </childnode>
      </node>
      <node id="39008">
        <label>polyblk.h</label>
        <link refid="polyblk_8h"/>
        <childnode refid="39006" relation="include">
        </childnode>
        <childnode refid="38971" relation="include">
        </childnode>
        <childnode refid="38994" relation="include">
        </childnode>
        <childnode refid="38997" relation="include">
        </childnode>
        <childnode refid="38998" relation="include">
        </childnode>
        <childnode refid="39009" relation="include">
        </childnode>
      </node>
      <node id="38969">
        <label>limits.h</label>
      </node>
      <node id="38970">
        <label>pitsync1.h</label>
        <link refid="pitsync1_8h"/>
        <childnode refid="38971" relation="include">
        </childnode>
        <childnode refid="38979" relation="include">
        </childnode>
        <childnode refid="38980" relation="include">
        </childnode>
        <childnode refid="38983" relation="include">
        </childnode>
        <childnode refid="39010" relation="include">
        </childnode>
        <childnode refid="39011" relation="include">
        </childnode>
        <childnode refid="39012" relation="include">
        </childnode>
      </node>
      <node id="38995">
        <label>ipoints.h</label>
        <link refid="ipoints_8h"/>
        <childnode refid="38964" relation="include">
        </childnode>
      </node>
      <node id="38996">
        <label>mod128.h</label>
        <link refid="mod128_8h"/>
        <childnode refid="38994" relation="include">
        </childnode>
      </node>
      <node id="38981">
        <label>elst2.h</label>
        <link refid="elst2_8h"/>
        <childnode refid="38972" relation="include">
        </childnode>
        <childnode refid="38967" relation="include">
        </childnode>
        <childnode refid="38973" relation="include">
        </childnode>
        <childnode refid="38978" relation="include">
        </childnode>
      </node>
      <node id="38975">
        <label>string.h</label>
      </node>
      <node id="38997">
        <label>rect.h</label>
        <link refid="rect_8h"/>
        <childnode refid="38964" relation="include">
        </childnode>
        <childnode refid="38994" relation="include">
        </childnode>
        <childnode refid="38987" relation="include">
        </childnode>
        <childnode refid="38998" relation="include">
        </childnode>
        <childnode refid="38999" relation="include">
        </childnode>
      </node>
      <node id="38989">
        <label>bits16.h</label>
        <link refid="bits16_8h"/>
        <childnode refid="38967" relation="include">
        </childnode>
      </node>
      <node id="38985">
        <label>tesscallback.h</label>
        <link refid="tesscallback_8h"/>
        <childnode refid="38967" relation="include">
        </childnode>
      </node>
      <node id="38992">
        <label>coutln.h</label>
        <link refid="coutln_8h"/>
        <childnode refid="38993" relation="include">
        </childnode>
        <childnode refid="38996" relation="include">
        </childnode>
        <childnode refid="38989" relation="include">
        </childnode>
        <childnode refid="38997" relation="include">
        </childnode>
        <childnode refid="38990" relation="include">
        </childnode>
        <childnode refid="38998" relation="include">
        </childnode>
      </node>
      <node id="38982">
        <label>werd.h</label>
        <link refid="werd_8h"/>
        <childnode refid="38983" relation="include">
        </childnode>
        <childnode refid="38989" relation="include">
        </childnode>
        <childnode refid="38981" relation="include">
        </childnode>
        <childnode refid="38988" relation="include">
        </childnode>
        <childnode refid="38990" relation="include">
        </childnode>
        <childnode refid="38991" relation="include">
        </childnode>
        <childnode refid="39000" relation="include">
        </childnode>
      </node>
      <node id="39000">
        <label>ocrrow.h</label>
        <link refid="ocrrow_8h"/>
        <childnode refid="38972" relation="include">
        </childnode>
        <childnode refid="39001" relation="include">
        </childnode>
        <childnode refid="38982" relation="include">
        </childnode>
      </node>
      <node id="38977">
        <label>fileerr.h</label>
        <link refid="fileerr_8h"/>
        <childnode refid="38976" relation="include">
        </childnode>
      </node>
      <node id="38993">
        <label>crakedge.h</label>
        <link refid="crakedge_8h"/>
        <childnode refid="38994" relation="include">
        </childnode>
        <childnode refid="38996" relation="include">
        </childnode>
      </node>
      <node id="38964">
        <label>math.h</label>
      </node>
      <node id="38978">
        <label>lsterr.h</label>
        <link refid="lsterr_8h"/>
        <childnode refid="38976" relation="include">
        </childnode>
      </node>
      <node id="39002">
        <label>quadratc.h</label>
        <link refid="quadratc_8h"/>
        <childnode refid="38994" relation="include">
        </childnode>
      </node>
      <node id="39006">
        <label>publictypes.h</label>
        <link refid="publictypes_8h"/>
      </node>
      <node id="39003">
        <label>ocrblock.h</label>
        <link refid="ocrblock_8h"/>
        <childnode refid="39004" relation="include">
        </childnode>
        <childnode refid="39005" relation="include">
        </childnode>
        <childnode refid="39000" relation="include">
        </childnode>
        <childnode refid="39007" relation="include">
        </childnode>
      </node>
      <node id="38983">
        <label>params.h</label>
        <link refid="params_8h"/>
        <childnode refid="38972" relation="include">
        </childnode>
        <childnode refid="38984" relation="include">
        </childnode>
        <childnode refid="38988" relation="include">
        </childnode>
      </node>
      <node id="38984">
        <label>genericvector.h</label>
        <link refid="genericvector_8h"/>
        <childnode refid="38972" relation="include">
        </childnode>
        <childnode refid="38974" relation="include">
        </childnode>
        <childnode refid="38985" relation="include">
        </childnode>
        <childnode refid="38976" relation="include">
        </childnode>
        <childnode refid="38986" relation="include">
        </childnode>
        <childnode refid="38987" relation="include">
        </childnode>
      </node>
      <node id="38965">
        <label>memry.h</label>
        <link refid="memry_8h"/>
        <childnode refid="38966" relation="include">
        </childnode>
        <childnode refid="38967" relation="include">
        </childnode>
      </node>
      <node id="39005">
        <label>ocrpara.h</label>
        <link refid="ocrpara_8h"/>
        <childnode refid="39006" relation="include">
        </childnode>
        <childnode refid="38971" relation="include">
        </childnode>
        <childnode refid="38988" relation="include">
        </childnode>
      </node>
      <node id="38971">
        <label>elst.h</label>
        <link refid="elst_8h"/>
        <childnode refid="38972" relation="include">
        </childnode>
        <childnode refid="38967" relation="include">
        </childnode>
        <childnode refid="38973" relation="include">
        </childnode>
        <childnode refid="38978" relation="include">
        </childnode>
      </node>
      <node id="38994">
        <label>points.h</label>
        <link refid="points_8h"/>
        <childnode refid="38972" relation="include">
        </childnode>
        <childnode refid="38964" relation="include">
        </childnode>
        <childnode refid="38971" relation="include">
        </childnode>
        <childnode refid="38995" relation="include">
        </childnode>
      </node>
      <node id="39012">
        <label>notdll.h</label>
        <link refid="notdll_8h"/>
      </node>
      <node id="39004">
        <label>img.h</label>
        <link refid="img_8h"/>
        <childnode refid="38965" relation="include">
        </childnode>
      </node>
      <node id="38999">
        <label>tprintf.h</label>
        <link refid="tprintf_8h"/>
        <childnode refid="38983" relation="include">
        </childnode>
      </node>
      <node id="38962">
        <label>textord/pitsync1.cpp</label>
        <link refid="pitsync1.cpp"/>
        <childnode refid="38963" relation="include">
        </childnode>
        <childnode refid="38964" relation="include">
        </childnode>
        <childnode refid="38965" relation="include">
        </childnode>
        <childnode refid="38970" relation="include">
        </childnode>
        <childnode refid="39012" relation="include">
        </childnode>
      </node>
      <node id="39009">
        <label>hpddef.h</label>
        <link refid="hpddef_8h"/>
      </node>
      <node id="38967">
        <label>host.h</label>
        <link refid="host_8h"/>
        <childnode refid="38968" relation="include">
        </childnode>
      </node>
      <node id="39007">
        <label>pdblock.h</label>
        <link refid="pdblock_8h"/>
        <childnode refid="38979" relation="include">
        </childnode>
        <childnode refid="39004" relation="include">
        </childnode>
        <childnode refid="38988" relation="include">
        </childnode>
        <childnode refid="39008" relation="include">
        </childnode>
        <childnode refid="39009" relation="include">
        </childnode>
      </node>
      <node id="38972">
        <label>stdio.h</label>
      </node>
      <node id="38988">
        <label>strngs.h</label>
        <link refid="strngs_8h"/>
        <childnode refid="38972" relation="include">
        </childnode>
        <childnode refid="38975" relation="include">
        </childnode>
        <childnode refid="38968" relation="include">
        </childnode>
        <childnode refid="38965" relation="include">
        </childnode>
      </node>
      <node id="38986">
        <label>helpers.h</label>
        <link refid="helpers_8h"/>
        <childnode refid="38972" relation="include">
        </childnode>
        <childnode refid="38975" relation="include">
        </childnode>
      </node>
      <node id="39001">
        <label>quspline.h</label>
        <link refid="quspline_8h"/>
        <childnode refid="39002" relation="include">
        </childnode>
        <childnode refid="38973" relation="include">
        </childnode>
        <childnode refid="38965" relation="include">
        </childnode>
        <childnode refid="38997" relation="include">
        </childnode>
      </node>
    </incdepgraph>
      <sectiondef kind="define">
      <memberdef kind="define" id="pitsync1_8cpp_1a77366c1bd428629dc898e188bfd182a3" prot="public" static="no">
        <name>EXTERN</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/pitsync1.cpp" line="31" column="9"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="pitsync1_8cpp_1aef3aa0188b14627cbfc6b848e00303c9" prot="public" static="no" mutable="no">
        <type>Use new fast</type>
        <definition>Use new fast algorithm</definition>
        <argsstring></argsstring>
        <name>algorithm</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/pitsync1.cpp" line="33" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/pitsync1.cpp" bodystart="33" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="pitsync1_8cpp_1a3c94b87b230954e74dacc7864aeb4878" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>ELISTIZE</definition>
        <argsstring>(FPSEGPT) CLISTIZE(FPSEGPT_LIST) INT_VAR(pitsync_linear_version</argsstring>
        <name>ELISTIZE</name>
        <param>
          <type><ref refid="class_f_p_s_e_g_p_t" kindref="compound">FPSEGPT</ref></type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/pitsync1.cpp" line="30" column="1"/>
      </memberdef>
      <memberdef kind="function" id="pitsync1_8cpp_1a14d5298f20e1c64bb774cbc9c9e9301d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(pitsync_joined_edge, 0.75,&quot;Dist inside big blob for chopping&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>pitsync_joined_edge</type>
        </param>
        <param>
          <type>0.</type>
          <declname>75</declname>
        </param>
        <param>
          <type>&quot;Dist inside big blob for chopping&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/pitsync1.cpp" line="35" column="1"/>
      </memberdef>
      <memberdef kind="function" id="pitsync1_8cpp_1a433d81c66e0d053ea9b456e130d6dc2a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>double_VAR</definition>
        <argsstring>(pitsync_offset_freecut_fraction, 0.25,&quot;Fraction of cut for free cuts&quot;)</argsstring>
        <name>double_VAR</name>
        <param>
          <type>pitsync_offset_freecut_fraction</type>
        </param>
        <param>
          <type>0.</type>
          <declname>25</declname>
        </param>
        <param>
          <type>&quot;Fraction of cut for free cuts&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/pitsync1.cpp" line="38" column="1"/>
      </memberdef>
      <memberdef kind="function" id="pitsync1_8cpp_1a4f705e983b9ada7688218fe96965d08d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>INT_VAR</definition>
        <argsstring>(pitsync_fake_depth, 1,&quot;Max advance fake generation&quot;)</argsstring>
        <name>INT_VAR</name>
        <param>
          <type>pitsync_fake_depth</type>
        </param>
        <param>
          <type>1</type>
        </param>
        <param>
          <type>&quot;Max advance fake generation&quot;</type>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/pitsync1.cpp" line="41" column="1"/>
      </memberdef>
      <memberdef kind="function" id="pitsync1_8cpp_1a91659398c9bdb3c1c6067f4e4da6a2ef" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double check_pitch_sync</definition>
        <argsstring>(BLOBNBOX_IT *blob_it, inT16 blob_count, inT16 pitch, inT16 pitch_error, STATS *projection, FPSEGPT_LIST *seg_list)</argsstring>
        <name>check_pitch_sync</name>
        <param>
          <type>BLOBNBOX_IT *</type>
          <declname>blob_it</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>blob_count</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>pitch</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>pitch_error</declname>
        </param>
        <param>
          <type><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref> *</type>
          <declname>projection</declname>
        </param>
        <param>
          <type>FPSEGPT_LIST *</type>
          <declname>seg_list</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/pitsync1.cpp" line="151" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/pitsync1.cpp" bodystart="151" bodyend="360"/>
      </memberdef>
      <memberdef kind="function" id="pitsync1_8cpp_1aff9ef2e9550a83b95b85a9a8791231f6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void make_illegal_segment</definition>
        <argsstring>(FPSEGPT_LIST *prev_list, TBOX blob_box, BLOBNBOX_IT blob_it, inT16 region_index, inT16 pitch, inT16 pitch_error, FPSEGPT_LIST *seg_list)</argsstring>
        <name>make_illegal_segment</name>
        <param>
          <type>FPSEGPT_LIST *</type>
          <declname>prev_list</declname>
        </param>
        <param>
          <type><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref></type>
          <declname>blob_box</declname>
        </param>
        <param>
          <type>BLOBNBOX_IT</type>
          <declname>blob_it</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>region_index</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>pitch</declname>
        </param>
        <param>
          <type><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref></type>
          <declname>pitch_error</declname>
        </param>
        <param>
          <type>FPSEGPT_LIST *</type>
          <declname>seg_list</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/makoto/Desktop/trunk/textord/pitsync1.cpp" line="369" column="1" bodyfile="/Users/makoto/Desktop/trunk/textord/pitsync1.cpp" bodystart="369" bodyend="425"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/**********************************************************************</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>File:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pitsync1.cpp<sp/><sp/>(Formerly<sp/>pitsync.c)</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>Description:<sp/>Code<sp/>to<sp/>find<sp/>the<sp/>optimum<sp/>fixed<sp/>pitch<sp/>segmentation<sp/>of<sp/>some<sp/>blobs.</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>Author:<sp/><sp/><sp/><sp/><sp/><sp/>Ray<sp/>Smith</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>Created:<sp/><sp/><sp/><sp/><sp/>Thu<sp/>Nov<sp/>19<sp/>11:48:05<sp/>GMT<sp/>1992</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>(C)<sp/>Copyright<sp/>1992,<sp/>Hewlett-Packard<sp/>Ltd.</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>**<sp/>Licensed<sp/>under<sp/>the<sp/>Apache<sp/>License,<sp/>Version<sp/>2.0<sp/>(the<sp/>&quot;License&quot;);</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>**<sp/>you<sp/>may<sp/>not<sp/>use<sp/>this<sp/>file<sp/>except<sp/>in<sp/>compliance<sp/>with<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>**<sp/>You<sp/>may<sp/>obtain<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>License<sp/>at</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>**<sp/>http://www.apache.org/licenses/LICENSE-2.0</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>**<sp/>Unless<sp/>required<sp/>by<sp/>applicable<sp/>law<sp/>or<sp/>agreed<sp/>to<sp/>in<sp/>writing,<sp/>software</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>**<sp/>distributed<sp/>under<sp/>the<sp/>License<sp/>is<sp/>distributed<sp/>on<sp/>an<sp/>&quot;AS<sp/>IS&quot;<sp/>BASIS,</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>**<sp/>WITHOUT<sp/>WARRANTIES<sp/>OR<sp/>CONDITIONS<sp/>OF<sp/>ANY<sp/>KIND,<sp/>either<sp/>express<sp/>or<sp/>implied.</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>**<sp/>See<sp/>the<sp/>License<sp/>for<sp/>the<sp/>specific<sp/>language<sp/>governing<sp/>permissions<sp/>and</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>**<sp/>limitations<sp/>under<sp/>the<sp/>License.</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>**********************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="mfcpch_8h" kindref="compound">mfcpch.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__UNIX__</highlight></codeline>
<codeline lineno="22"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;assert.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="24"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;math.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="memry_8h" kindref="compound">memry.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="pitsync1_8h" kindref="compound">pitsync1.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;<ref refid="notdll_8h" kindref="compound">notdll.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"><ref refid="elst_8h_1ab54325a3cfcd9bee58697d77e1902240" kindref="member">ELISTIZE</ref><sp/>(<ref refid="class_f_p_s_e_g_p_t" kindref="compound">FPSEGPT</ref>)<sp/><ref refid="clst_8h_1a721c1e0acc4a882f9ea934613aee64be" kindref="member">CLISTIZE</ref><sp/>(FPSEGPT_LIST)</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>EXTERN</highlight></codeline>
<codeline lineno="32"><highlight class="preprocessor"></highlight><highlight class="normal"><ref refid="tessbox_8cpp_1a77366c1bd428629dc898e188bfd182a3" kindref="member">EXTERN</ref></highlight></codeline>
<codeline lineno="33"><highlight class="normal"><ref refid="params_8h_1a554d43d0cf0e3f9552921941d9e147bd" kindref="member">INT_VAR</ref><sp/>(pitsync_linear_version,<sp/>6,<sp/></highlight><highlight class="stringliteral">&quot;Use<sp/>new<sp/>fast<sp/>algorithm&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><ref refid="tessbox_8cpp_1a77366c1bd428629dc898e188bfd182a3" kindref="member">EXTERN</ref></highlight></codeline>
<codeline lineno="35"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref><sp/>(pitsync_joined_edge,<sp/>0.75,</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;Dist<sp/>inside<sp/>big<sp/>blob<sp/>for<sp/>chopping&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><ref refid="tessbox_8cpp_1a77366c1bd428629dc898e188bfd182a3" kindref="member">EXTERN</ref></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><ref refid="params_8h_1aa855c84dbbf962a5533a96e1f458c690" kindref="member">double_VAR</ref><sp/>(pitsync_offset_freecut_fraction,<sp/>0.25,</highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;Fraction<sp/>of<sp/>cut<sp/>for<sp/>free<sp/>cuts&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><ref refid="tessbox_8cpp_1a77366c1bd428629dc898e188bfd182a3" kindref="member">EXTERN</ref></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><ref refid="params_8h_1a554d43d0cf0e3f9552921941d9e147bd" kindref="member">INT_VAR</ref><sp/>(pitsync_fake_depth,<sp/>1,<sp/></highlight><highlight class="stringliteral">&quot;Max<sp/>advance<sp/>fake<sp/>generation&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="comment">/**********************************************************************</highlight></codeline>
<codeline lineno="44"><highlight class="comment"><sp/>*<sp/>FPSEGPT::FPSEGPT</highlight></codeline>
<codeline lineno="45"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="46"><highlight class="comment"><sp/>*<sp/>Constructor<sp/>to<sp/>make<sp/>a<sp/>new<sp/>FPSEGPT.</highlight></codeline>
<codeline lineno="47"><highlight class="comment"><sp/>*<sp/>The<sp/>existing<sp/>FPCUTPT<sp/>is<sp/>duplicated.</highlight></codeline>
<codeline lineno="48"><highlight class="comment"><sp/>**********************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><ref refid="class_f_p_s_e_g_p_t_1a088aff5c1071d1ee5b4ecea021f8e733" kindref="member">FPSEGPT::FPSEGPT</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//constructor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_f_p_c_u_t_p_t" kindref="compound">FPCUTPT</ref><sp/>*cutpt<sp/><sp/></highlight><highlight class="comment">//create<sp/>from<sp/>new<sp/>form</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/>pred<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/>mean_sum<sp/>=<sp/>cutpt-&gt;<ref refid="class_f_p_c_u_t_p_t_1aa458ef97a2dfab2d805c5c58acbc2459" kindref="member">sum</ref><sp/>();</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/>sq_sum<sp/>=<sp/>cutpt-&gt;<ref refid="class_f_p_c_u_t_p_t_1a14707a25df4ff0c1a5f4a1149d676c18" kindref="member">squares</ref><sp/>();</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/>cost<sp/>=<sp/>cutpt-&gt;<ref refid="class_f_p_c_u_t_p_t_1a754e205021f03c913ca0aa5b277b1aac" kindref="member">cost_function</ref><sp/>();</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><ref refid="class_f_p_s_e_g_p_t_1aad5db657759063c17115abfdd74c0689" kindref="member">faked</ref><sp/>=<sp/>cutpt-&gt;<ref refid="class_f_p_c_u_t_p_t_1a1aac5202730ed2f48d40d4b5d6a35543" kindref="member">faked</ref>;</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><ref refid="class_f_p_s_e_g_p_t_1a5e21f19a9e0d86f3009dc96a776f0199" kindref="member">terminal</ref><sp/>=<sp/>cutpt-&gt;<ref refid="class_f_p_c_u_t_p_t_1aad85bb77d2c329c43abd41e854183f1d" kindref="member">terminal</ref>;</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><ref refid="class_f_p_s_e_g_p_t_1a3174c1dbd5dde6b07482fa5c9d1e1900" kindref="member">fake_count</ref><sp/>=<sp/>cutpt-&gt;<ref refid="class_f_p_c_u_t_p_t_1a4700de0507676a547b49f7b5b0414b1b" kindref="member">fake_count</ref>;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/>xpos<sp/>=<sp/>cutpt-&gt;<ref refid="class_f_p_c_u_t_p_t_1a4bd6376f9b5ec6825df3fdb5a7db3d6c" kindref="member">position</ref><sp/>();</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/>mid_cuts<sp/>=<sp/>cutpt-&gt;<ref refid="class_f_p_c_u_t_p_t_1abd4586d7d5bfcfc0d59c857c78bd1103" kindref="member">cheap_cuts</ref><sp/>();</highlight></codeline>
<codeline lineno="62"><highlight class="normal">}</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight><highlight class="comment">/**********************************************************************</highlight></codeline>
<codeline lineno="66"><highlight class="comment"><sp/>*<sp/>FPSEGPT::FPSEGPT</highlight></codeline>
<codeline lineno="67"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="68"><highlight class="comment"><sp/>*<sp/>Constructor<sp/>to<sp/>make<sp/>a<sp/>new<sp/>FPSEGPT.</highlight></codeline>
<codeline lineno="69"><highlight class="comment"><sp/>**********************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><ref refid="class_f_p_s_e_g_p_t_1a088aff5c1071d1ee5b4ecea021f8e733" kindref="member">FPSEGPT::FPSEGPT</ref><sp/>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//constructor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>x<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//position</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal">):xpos<sp/>(x)<sp/>{</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/>pred<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/>mean_sum<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/>sq_sum<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/>cost<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><ref refid="class_f_p_c_u_t_p_t_1a1aac5202730ed2f48d40d4b5d6a35543" kindref="member">faked</ref><sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><ref refid="class_f_p_c_u_t_p_t_1aad85bb77d2c329c43abd41e854183f1d" kindref="member">terminal</ref><sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><ref refid="class_f_p_c_u_t_p_t_1a4700de0507676a547b49f7b5b0414b1b" kindref="member">fake_count</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/>mid_cuts<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="82"><highlight class="normal">}</highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight><highlight class="comment">/**********************************************************************</highlight></codeline>
<codeline lineno="86"><highlight class="comment"><sp/>*<sp/>FPSEGPT::FPSEGPT</highlight></codeline>
<codeline lineno="87"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="88"><highlight class="comment"><sp/>*<sp/>Constructor<sp/>to<sp/>make<sp/>a<sp/>new<sp/>FPSEGPT.</highlight></codeline>
<codeline lineno="89"><highlight class="comment"><sp/>**********************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><ref refid="class_f_p_s_e_g_p_t_1a088aff5c1071d1ee5b4ecea021f8e733" kindref="member">FPSEGPT::FPSEGPT</ref><sp/>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//constructor</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>x,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//position</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><ref refid="host_8h_1a7712a7e28433d0ade59219a129549b6f" kindref="member">BOOL8</ref><sp/>faking,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//faking<sp/>this<sp/>one</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>offset,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//dist<sp/>to<sp/>gap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>region_index,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//segment<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>pitch,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//proposed<sp/>pitch</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>pitch_error,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//allowed<sp/>tolerance</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal">FPSEGPT_LIST<sp/>*<sp/>prev_list<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//previous<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal">):xpos<sp/>(x)<sp/>{</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>best_fake;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//on<sp/>previous</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><ref refid="class_f_p_s_e_g_p_t" kindref="compound">FPSEGPT</ref><sp/>*segpt;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//segment<sp/>point</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1aba1f582fd0168f3ff9225d8c90fa9eb8" kindref="member">inT32</ref><sp/>dist;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//from<sp/>prev<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sq_dist;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//squared<sp/>distance</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>mean;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//mean<sp/>pitch</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>total;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//total<sp/>dists</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>factor;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//cost<sp/>function</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/>FPSEGPT_IT<sp/>pred_it<sp/>=<sp/>prev_list;</highlight><highlight class="comment">//for<sp/>previuos<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/>cost<sp/>=<sp/><ref refid="host_8h_1a9adcee815220ec9db98062213806ed04" kindref="member">MAX_FLOAT32</ref>;</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/>pred<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><ref refid="class_f_p_c_u_t_p_t_1a1aac5202730ed2f48d40d4b5d6a35543" kindref="member">faked</ref><sp/>=<sp/>faking;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><ref refid="class_f_p_c_u_t_p_t_1aad85bb77d2c329c43abd41e854183f1d" kindref="member">terminal</ref><sp/>=<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>;</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/>best_fake<sp/>=<sp/><ref refid="host_8h_1a3905e54374e49708219791e7d59c60fb" kindref="member">MAX_INT16</ref>;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/>mid_cuts<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(pred_it.mark_cycle_pt<sp/>();<sp/>!pred_it.cycled_list<sp/>();<sp/>pred_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/>segpt<sp/>=<sp/>pred_it.data<sp/>();</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(segpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a3174c1dbd5dde6b07482fa5c9d1e1900" kindref="member">fake_count</ref><sp/>&lt;<sp/>best_fake)</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>best_fake<sp/>=<sp/>segpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a3174c1dbd5dde6b07482fa5c9d1e1900" kindref="member">fake_count</ref>;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/>dist<sp/>=<sp/>x<sp/>-<sp/>segpt-&gt;xpos;</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dist<sp/>&gt;=<sp/>pitch<sp/>-<sp/>pitch_error<sp/>&amp;&amp;<sp/>dist<sp/>&lt;=<sp/>pitch<sp/>+<sp/>pitch_error</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>!segpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a5e21f19a9e0d86f3009dc96a776f0199" kindref="member">terminal</ref>)<sp/>{</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>total<sp/>=<sp/>segpt-&gt;mean_sum<sp/>+<sp/>dist;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>sq_dist<sp/>=<sp/>dist<sp/>*<sp/>dist<sp/>+<sp/>segpt-&gt;sq_sum<sp/>+<sp/>offset<sp/>*<sp/>offset;</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//sum<sp/>of<sp/>squarees</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>mean<sp/>=<sp/>total<sp/>/<sp/>region_index;</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>factor<sp/>=<sp/>mean<sp/>-<sp/>pitch;</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>factor<sp/>*=<sp/>factor;</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>factor<sp/>+=<sp/>sq_dist<sp/>/<sp/>(region_index)<sp/>-<sp/>mean<sp/>*<sp/>mean;</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(factor<sp/>&lt;<sp/>cost)<sp/>{</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cost<sp/>=<sp/>factor;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>least<sp/>cost</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pred<sp/>=<sp/>segpt;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//save<sp/>path</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mean_sum<sp/>=<sp/>total;</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sq_sum<sp/>=<sp/>sq_dist;</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_f_p_c_u_t_p_t_1a4700de0507676a547b49f7b5b0414b1b" kindref="member">fake_count</ref><sp/>=<sp/>segpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a3174c1dbd5dde6b07482fa5c9d1e1900" kindref="member">fake_count</ref><sp/>+<sp/><ref refid="class_f_p_c_u_t_p_t_1a1aac5202730ed2f48d40d4b5d6a35543" kindref="member">faked</ref>;</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_f_p_c_u_t_p_t_1a4700de0507676a547b49f7b5b0414b1b" kindref="member">fake_count</ref><sp/>&gt;<sp/>best_fake<sp/>+<sp/>1)</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>pred<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//fail<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal">}</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight><highlight class="comment">/**********************************************************************</highlight></codeline>
<codeline lineno="144"><highlight class="comment"><sp/>*<sp/>check_pitch_sync</highlight></codeline>
<codeline lineno="145"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="146"><highlight class="comment"><sp/>*<sp/>Construct<sp/>the<sp/>lattice<sp/>of<sp/>possible<sp/>segmentation<sp/>points<sp/>and<sp/>choose<sp/>the</highlight></codeline>
<codeline lineno="147"><highlight class="comment"><sp/>*<sp/>optimal<sp/>path.<sp/>Return<sp/>the<sp/>optimal<sp/>path<sp/>only.</highlight></codeline>
<codeline lineno="148"><highlight class="comment"><sp/>*<sp/>The<sp/>return<sp/>value<sp/>is<sp/>a<sp/>measure<sp/>of<sp/>goodness<sp/>of<sp/>the<sp/>sync.</highlight></codeline>
<codeline lineno="149"><highlight class="comment"><sp/>**********************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="pitsync1_8cpp_1a91659398c9bdb3c1c6067f4e4da6a2ef" kindref="member">check_pitch_sync</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>segmentation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BLOBNBOX_IT<sp/>*blob_it,<sp/><sp/><sp/></highlight><highlight class="comment">//blobs<sp/>to<sp/>do</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>blob_count,<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//no<sp/>of<sp/>blobs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>pitch,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//pitch<sp/>estimate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>pitch_error,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//tolerance</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_s_t_a_t_s" kindref="compound">STATS</ref><sp/>*projection,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//vertical</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FPSEGPT_LIST<sp/>*seg_list<sp/><sp/></highlight><highlight class="comment">//output<sp/>list</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>x;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>coord</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>min_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//blob<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>max_index;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//blob<sp/>number</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>left_edge;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>word</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>right_edge;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//of<sp/>word</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>right_max;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//max<sp/>allowed<sp/>x</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>min_x;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//in<sp/>this<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>max_x;</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>region_index;</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>best_region_index<sp/>=<sp/>0;<sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>best<sp/>result</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>offset;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//dist<sp/>to<sp/>legal<sp/>area</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>left_best_x;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//edge<sp/>of<sp/>good<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>right_best_x;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//right<sp/>edge</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>min_box;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//bounding<sp/>box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>max_box;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//bounding<sp/>box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>next_box;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//box<sp/>of<sp/>next<sp/>blob</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><ref refid="class_f_p_s_e_g_p_t" kindref="compound">FPSEGPT</ref><sp/>*segpt;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//segment<sp/>point</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/>FPSEGPT_LIST<sp/>*segpts;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//points<sp/>in<sp/>a<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>best_cost;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//best<sp/>path</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>mean_sum;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//computes<sp/>result</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><ref refid="class_f_p_s_e_g_p_t" kindref="compound">FPSEGPT</ref><sp/>*best_end;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//end<sp/>of<sp/>best<sp/>path</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>min_it;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//copy<sp/>iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/>BLOBNBOX_IT<sp/>max_it;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//copy<sp/>iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/>FPSEGPT_IT<sp/>segpt_it;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//output<sp/>segments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/>FPSEGPT_IT<sp/>outseg_it<sp/>=<sp/>seg_list;</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/>FPSEGPT_LIST_CLIST<sp/>lattice;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//list<sp/>of<sp/>lists</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//region<sp/>iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/>FPSEGPT_LIST_C_IT<sp/>lattice_it<sp/>=<sp/>&amp;lattice;</highlight></codeline>
<codeline lineno="188"><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>tprintf(&quot;Computing<sp/>sync<sp/>on<sp/>word<sp/>of<sp/>%d<sp/>blobs<sp/>with<sp/>pitch<sp/>%d\n&quot;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>blob_count,<sp/>pitch);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(blob_count==8<sp/>&amp;&amp;<sp/>pitch==27)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>projection-&gt;print(stdout,TRUE);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pitch<sp/>&lt;<sp/>3)</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/>pitch<sp/>=<sp/>3;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//nothing<sp/>ludicrous</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((pitch<sp/>-<sp/>3)<sp/>/<sp/>2<sp/>&lt;<sp/>pitch_error)</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/>pitch_error<sp/>=<sp/>(pitch<sp/>-<sp/>3)<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/>min_it<sp/>=<sp/>*blob_it;</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/>min_box<sp/>=<sp/><ref refid="blobbox_8cpp_1a343c30f9e935058965b844710a2e3180" kindref="member">box_next</ref><sp/>(&amp;min_it);<sp/><sp/></highlight><highlight class="comment">//get<sp/>box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(blob_count==8<sp/>&amp;&amp;<sp/>pitch==27)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tprintf(&quot;1st<sp/>box<sp/>at<sp/>(%d,%d)-&gt;(%d,%d)\n&quot;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_box.left(),min_box.bottom(),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_box.right(),min_box.top());</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//left<sp/>of<sp/>word</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/>left_edge<sp/>=<sp/>min_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>()<sp/>+<sp/>pitch_error;</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(min_index<sp/>=<sp/>1;<sp/>min_index<sp/>&lt;<sp/>blob_count;<sp/>min_index++)<sp/>{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/>min_box<sp/>=<sp/><ref refid="blobbox_8cpp_1a343c30f9e935058965b844710a2e3180" kindref="member">box_next</ref><sp/>(&amp;min_it);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(blob_count==8<sp/>&amp;&amp;<sp/>pitch==27)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tprintf(&quot;Box<sp/>at<sp/>(%d,%d)-&gt;(%d,%d)\n&quot;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_box.left(),min_box.bottom(),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_box.right(),min_box.top());</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/>right_edge<sp/>=<sp/>min_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>();<sp/></highlight><highlight class="comment">//end<sp/>of<sp/>word</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/>max_x<sp/>=<sp/>left_edge;</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//min<sp/>permissible</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/>min_x<sp/>=<sp/>max_x<sp/>-<sp/>pitch<sp/>+<sp/>pitch_error<sp/>*<sp/>2<sp/>+<sp/>1;</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/>right_max<sp/>=<sp/>right_edge<sp/>+<sp/>pitch<sp/>-<sp/>pitch_error<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/>segpts<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>FPSEGPT_LIST;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//list<sp/>of<sp/>points</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/>segpt_it.set_to_list<sp/>(segpts);</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>min_x;<sp/>x<sp/>&lt;=<sp/>max_x;<sp/>x++)<sp/>{</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/>segpt<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_f_p_s_e_g_p_t" kindref="compound">FPSEGPT</ref><sp/>(x);<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//make<sp/>a<sp/>new<sp/>one</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//put<sp/>in<sp/>list</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/>segpt_it.add_after_then_move<sp/>(segpt);</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//first<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/>lattice_it.add_before_then_move<sp/>(segpts);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/>min_index<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/>region_index<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/>best_cost<sp/>=<sp/><ref refid="host_8h_1a9adcee815220ec9db98062213806ed04" kindref="member">MAX_FLOAT32</ref>;</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/>best_end<sp/>=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/>min_it<sp/>=<sp/>*blob_it;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/>min_box<sp/>=<sp/><ref refid="blobbox_8cpp_1a343c30f9e935058965b844710a2e3180" kindref="member">box_next</ref><sp/>(&amp;min_it);<sp/><sp/></highlight><highlight class="comment">//first<sp/>box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/>left_best_x<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/>right_best_x<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/>segpts<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>FPSEGPT_LIST;<sp/><sp/><sp/></highlight><highlight class="comment">//list<sp/>of<sp/>points</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/>segpt_it.set_to_list<sp/>(segpts);</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/>min_x<sp/>+=<sp/>pitch<sp/>-<sp/>pitch_error;</highlight><highlight class="comment">//next<sp/>limits</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/>max_x<sp/>+=<sp/>pitch<sp/>+<sp/>pitch_error;</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(min_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>()<sp/>&lt;<sp/>min_x<sp/>&amp;&amp;<sp/>min_index<sp/>&lt;<sp/>blob_count)<sp/>{</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>min_index++;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>min_box<sp/>=<sp/><ref refid="blobbox_8cpp_1a343c30f9e935058965b844710a2e3180" kindref="member">box_next</ref><sp/>(&amp;min_it);</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/>max_it<sp/>=<sp/>min_it;</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/>max_index<sp/>=<sp/>min_index;</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/>max_box<sp/>=<sp/>min_box;</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/>next_box<sp/>=<sp/><ref refid="blobbox_8cpp_1a343c30f9e935058965b844710a2e3180" kindref="member">box_next</ref><sp/>(&amp;max_it);</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>min_x;<sp/>x<sp/>&lt;=<sp/>max_x<sp/>&amp;&amp;<sp/>x<sp/>&lt;=<sp/>right_max;<sp/>x++)<sp/>{</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(x<sp/>&lt;<sp/>right_edge<sp/>&amp;&amp;<sp/>max_index<sp/>&lt;<sp/>blob_count</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>x<sp/>&gt;<sp/>max_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>())<sp/>{</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_index++;</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max_box<sp/>=<sp/>next_box;</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next_box<sp/>=<sp/><ref refid="blobbox_8cpp_1a343c30f9e935058965b844710a2e3180" kindref="member">box_next</ref><sp/>(&amp;max_it);</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x<sp/>&lt;=<sp/>max_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>()<sp/>+<sp/>pitch_error</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>x<sp/>&gt;=<sp/>max_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>()<sp/>-<sp/>pitch_error<sp/>||<sp/>x<sp/>&gt;=<sp/>right_edge</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>(max_index<sp/>&lt;<sp/>blob_count<sp/>-<sp/>1<sp/>&amp;&amp;<sp/>x<sp/>&gt;=<sp/>next_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>())</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>(x<sp/>-<sp/>max_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>()<sp/>&gt;<sp/>pitch<sp/>*<sp/>pitsync_joined_edge</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>max_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>()<sp/>-<sp/>x<sp/>&gt;<sp/>pitch<sp/>*<sp/>pitsync_joined_edge))<sp/>{</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>projection-&gt;local_min(x))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x<sp/>-<sp/>max_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>()<sp/>&gt;<sp/>0</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>x<sp/>-<sp/>max_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>()<sp/>&lt;=<sp/>pitch_error)</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//dist<sp/>to<sp/>real<sp/>break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset<sp/>=<sp/>x<sp/>-<sp/>max_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>();</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(max_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>()<sp/>-<sp/>x<sp/>&gt;<sp/>0</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>max_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>()<sp/>-<sp/>x<sp/>&lt;=<sp/>pitch_error</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(max_index<sp/>&gt;=<sp/>blob_count<sp/>-<sp/>1</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>x<sp/>&lt;<sp/>next_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>()))</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset<sp/>=<sp/>max_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>()<sp/>-<sp/>x;</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset=pitsync_offset_freecut_fraction*projection-&gt;pile_count(x);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>segpt<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_f_p_s_e_g_p_t" kindref="compound">FPSEGPT</ref><sp/>(x,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/>offset,<sp/>region_index,</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pitch,<sp/>pitch_error,<sp/>lattice_it.data<sp/>());</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset<sp/>=<sp/>projection-&gt;<ref refid="class_s_t_a_t_s_1a4a3a320660e2092eeaa605df70bea8ea" kindref="member">pile_count</ref><sp/>(x);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>segpt<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_f_p_s_e_g_p_t" kindref="compound">FPSEGPT</ref><sp/>(x,<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>,<sp/>offset,<sp/>region_index,</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pitch,<sp/>pitch_error,<sp/>lattice_it.data<sp/>());</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(segpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a4386c87b640304091479028601b74ff9" kindref="member">previous</ref><sp/>()<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>segpt_it.add_after_then_move<sp/>(segpt);</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(x<sp/>&gt;=<sp/>right_edge<sp/>-<sp/>pitch_error)<sp/>{</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>segpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a5e21f19a9e0d86f3009dc96a776f0199" kindref="member">terminal</ref><sp/>=<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight><highlight class="comment">//no<sp/>more<sp/>wanted</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(segpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a2d099c15bf06dc51039f45eb81927de3" kindref="member">cost_function</ref><sp/>()<sp/>&lt;<sp/>best_cost)<sp/>{</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>best_cost<sp/>=<sp/>segpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a2d099c15bf06dc51039f45eb81927de3" kindref="member">cost_function</ref><sp/>();</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>least</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>best_end<sp/>=<sp/>segpt;</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>best_region_index<sp/>=<sp/>region_index;</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_best_x<sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_best_x<sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(segpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a2d099c15bf06dc51039f45eb81927de3" kindref="member">cost_function</ref><sp/>()<sp/>==<sp/>best_cost</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>right_best_x<sp/>==<sp/>x<sp/>-<sp/>1)</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>right_best_x<sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>segpt;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//no<sp/>good</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(segpts-&gt;empty<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(best_end<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//already<sp/>found<sp/>one</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="pitsync1_8cpp_1aff9ef2e9550a83b95b85a9a8791231f6" kindref="member">make_illegal_segment</ref><sp/>(lattice_it.data<sp/>(),<sp/>min_box,<sp/>min_it,</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>region_index,<sp/>pitch,<sp/>pitch_error,<sp/>segpts);</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(right_best_x<sp/>&gt;<sp/>left_best_x<sp/>+<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>left_best_x<sp/>=<sp/>(left_best_x<sp/>+<sp/>right_best_x<sp/>+<sp/>1)<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(segpt_it.mark_cycle_pt<sp/>();<sp/>!segpt_it.cycled_list<sp/>()</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>segpt_it.data<sp/>()-&gt;position<sp/>()<sp/>!=<sp/>left_best_x;</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>segpt_it.forward<sp/>());</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(segpt_it.data<sp/>()-&gt;position<sp/>()<sp/>==<sp/>left_best_x)</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//middle<sp/>of<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>best_end<sp/>=<sp/>segpt_it.data<sp/>();</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//new<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/>lattice_it.add_before_then_move<sp/>(segpts);</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/>region_index++;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(min_x<sp/>&lt;<sp/>right_edge);</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref><sp/>(best_end<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>);</highlight><highlight class="comment">//must<sp/>always<sp/>find<sp/>some</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(lattice_it.mark_cycle_pt<sp/>();<sp/>!lattice_it.cycled_list<sp/>();</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/>lattice_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/>segpts<sp/>=<sp/>lattice_it.data<sp/>();</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/>segpt_it.set_to_list<sp/>(segpts);</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(blob_count==8<sp/>&amp;&amp;<sp/>pitch==27)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>(segpt_it.mark_cycle_pt();!segpt_it.cycled_list();segpt_it.forward())</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>segpt=segpt_it.data();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tprintf(&quot;At<sp/>%d,<sp/>(%x)<sp/>cost=%g,<sp/>m=%g,<sp/>sq=%g,<sp/>pred=%x\n&quot;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>segpt-&gt;position(),segpt,segpt-&gt;cost_function(),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>segpt-&gt;sum(),segpt-&gt;squares(),segpt-&gt;previous());</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tprintf(&quot;\n&quot;);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(segpt_it.mark_cycle_pt<sp/>();<sp/>!segpt_it.cycled_list<sp/>()</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>segpt_it.data<sp/>()<sp/>!=<sp/>best_end;<sp/>segpt_it.forward<sp/>());</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(segpt_it.data<sp/>()<sp/>==<sp/>best_end)<sp/>{</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//save<sp/>good<sp/>one</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>segpt<sp/>=<sp/>segpt_it.extract<sp/>();</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>outseg_it.add_before_then_move<sp/>(segpt);</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>best_end<sp/>=<sp/>segpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a4386c87b640304091479028601b74ff9" kindref="member">previous</ref><sp/>();</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref><sp/>(best_end<sp/>==<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref><sp/>(!outseg_it.empty<sp/>());</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/>outseg_it.move_to_last<sp/>();</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/>mean_sum<sp/>=<sp/>outseg_it.data<sp/>()-&gt;sum<sp/>();</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/>mean_sum<sp/>=<sp/>mean_sum<sp/>*<sp/>mean_sum<sp/>/<sp/>best_region_index;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(outseg_it.data<sp/>()-&gt;squares<sp/>()<sp/>-<sp/>mean_sum<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="tprintf_8cpp_1a91c3e3cd802b72db376635e0e989a4b0" kindref="member">tprintf</ref><sp/>(</highlight><highlight class="stringliteral">&quot;Impossible<sp/>sqsum=%g,<sp/>mean=%g,<sp/>total=%d\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>outseg_it.data<sp/>()-&gt;squares<sp/>(),<sp/>outseg_it.data<sp/>()-&gt;sum<sp/>(),</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>best_region_index);</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/>lattice.deep_clear<sp/>();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//shift<sp/>the<sp/>lot</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>outseg_it.data<sp/>()-&gt;squares<sp/>()<sp/>-<sp/>mean_sum;</highlight></codeline>
<codeline lineno="360"><highlight class="normal">}</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight><highlight class="comment">/**********************************************************************</highlight></codeline>
<codeline lineno="364"><highlight class="comment"><sp/>*<sp/>make_illegal_segment</highlight></codeline>
<codeline lineno="365"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="366"><highlight class="comment"><sp/>*<sp/>Make<sp/>a<sp/>fake<sp/>set<sp/>of<sp/>chop<sp/>points<sp/>due<sp/>to<sp/>having<sp/>no<sp/>legal<sp/>places.</highlight></codeline>
<codeline lineno="367"><highlight class="comment"><sp/>**********************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="pitsync1_8cpp_1aff9ef2e9550a83b95b85a9a8791231f6" kindref="member">make_illegal_segment</ref>(<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>segmentation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FPSEGPT_LIST<sp/>*prev_list,<sp/><sp/></highlight><highlight class="comment">//previous<sp/>segments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_t_b_o_x" kindref="compound">TBOX</ref><sp/>blob_box,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//bounding<sp/>box</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BLOBNBOX_IT<sp/>blob_it,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>region_index,<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//number<sp/>of<sp/>segment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>pitch,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//pitch<sp/>estimate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>pitch_error,<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//tolerance</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FPSEGPT_LIST<sp/>*seg_list<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//output<sp/>list</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>{</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>x;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//current<sp/>coord</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>min_x<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//in<sp/>this<sp/>region</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>max_x<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><ref refid="host_8h_1a8d41499d38c24d39b221ab0c158fe5a8" kindref="member">inT16</ref><sp/>offset;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//dist<sp/>to<sp/>edge</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><ref refid="class_f_p_s_e_g_p_t" kindref="compound">FPSEGPT</ref><sp/>*segpt;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//segment<sp/>point</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><ref refid="class_f_p_s_e_g_p_t" kindref="compound">FPSEGPT</ref><sp/>*prevpt;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//previous<sp/>point</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>best_cost;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//best<sp/>path</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/>FPSEGPT_IT<sp/>segpt_it<sp/>=<sp/>seg_list;</highlight><highlight class="comment">//iterator</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//previous<sp/>points</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/>FPSEGPT_IT<sp/>prevpt_it<sp/>=<sp/>prev_list;</highlight></codeline>
<codeline lineno="388"><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/>best_cost<sp/>=<sp/><ref refid="host_8h_1a9adcee815220ec9db98062213806ed04" kindref="member">MAX_FLOAT32</ref>;</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(prevpt_it.mark_cycle_pt<sp/>();<sp/>!prevpt_it.cycled_list<sp/>();</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/>prevpt_it.forward<sp/>())<sp/>{</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/>prevpt<sp/>=<sp/>prevpt_it.data<sp/>();</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(prevpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a2d099c15bf06dc51039f45eb81927de3" kindref="member">cost_function</ref><sp/>()<sp/>&lt;<sp/>best_cost)<sp/>{</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//find<sp/>least</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>best_cost<sp/>=<sp/>prevpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a2d099c15bf06dc51039f45eb81927de3" kindref="member">cost_function</ref><sp/>();</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>min_x<sp/>=<sp/>prevpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a1a63caa9483f9b0ea37ec8fda2e8fa5b" kindref="member">position</ref><sp/>();</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>max_x<sp/>=<sp/>min_x;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//limits<sp/>on<sp/>coords</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(prevpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a2d099c15bf06dc51039f45eb81927de3" kindref="member">cost_function</ref><sp/>()<sp/>==<sp/>best_cost)<sp/>{</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>max_x<sp/>=<sp/>prevpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a1a63caa9483f9b0ea37ec8fda2e8fa5b" kindref="member">position</ref><sp/>();</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/>min_x<sp/>+=<sp/>pitch<sp/>-<sp/>pitch_error;</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/>max_x<sp/>+=<sp/>pitch<sp/>+<sp/>pitch_error;</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(x<sp/>=<sp/>min_x;<sp/>x<sp/>&lt;=<sp/>max_x;<sp/>x++)<sp/>{</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(x<sp/>&gt;<sp/>blob_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>())<sp/>{</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>blob_box<sp/>=<sp/><ref refid="blobbox_8cpp_1a343c30f9e935058965b844710a2e3180" kindref="member">box_next</ref><sp/>(&amp;blob_it);</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/>offset<sp/>=<sp/>x<sp/>-<sp/>blob_box.<ref refid="class_t_b_o_x_1a724fabf566586b663577dfa944ffbc61" kindref="member">left</ref><sp/>();</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(blob_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>()<sp/>-<sp/>x<sp/>&lt;<sp/>offset)</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>offset<sp/>=<sp/>blob_box.<ref refid="class_t_b_o_x_1a8703081c1a1c26db3a4dddaca1028e34" kindref="member">right</ref><sp/>()<sp/>-<sp/>x;</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/>segpt<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_f_p_s_e_g_p_t" kindref="compound">FPSEGPT</ref><sp/>(x,<sp/><ref refid="capi_8h_1aa93f0eb578d23995850d61f7d61c55c1" kindref="member">FALSE</ref>,<sp/>offset,</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>region_index,<sp/>pitch,<sp/>pitch_error,<sp/>prev_list);</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(segpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a4386c87b640304091479028601b74ff9" kindref="member">previous</ref><sp/>()<sp/>!=<sp/><ref refid="host_8h_1a070d2ce7b6bb7e5c05602aa8c308d0c4" kindref="member">NULL</ref>)<sp/>{</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="errcode_8h_1a93a603f4063a6b9403d81caa245a583b" kindref="member">ASSERT_HOST</ref><sp/>(offset<sp/>&gt;=<sp/>0);</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>fprintf<sp/>(stderr,<sp/></highlight><highlight class="stringliteral">&quot;made<sp/>fake<sp/>at<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>x);</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//make<sp/>one<sp/>up</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>segpt_it.add_after_then_move<sp/>(segpt);</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>segpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1aad5db657759063c17115abfdd74c0689" kindref="member">faked</ref><sp/>=<sp/><ref refid="capi_8h_1aa8cecfc5c5c054d2875c03e77b7be15d" kindref="member">TRUE</ref>;</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>segpt-&gt;<ref refid="class_f_p_s_e_g_p_t_1a3174c1dbd5dde6b07482fa5c9d1e1900" kindref="member">fake_count</ref>++;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>segpt;</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="425"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/Users/makoto/Desktop/trunk/textord/pitsync1.cpp"/>
  </compounddef>
</doxygen>
